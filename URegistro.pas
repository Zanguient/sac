unit URegistro;

interface

uses
  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,
  Dialogs, Menus, ExtCtrls, ToolWin, ComCtrls, Buttons, IniFiles, DB, DBTables,
  StdCtrls, Mask, DBCtrls, Grids, ADODB, DateUtils, DBClient;

type
  TCadastro_Padrao = class
    Codigo: integer;
    Descricao: string;
    Data_Cadastro: Tdate;

  protected
    function GetCodigo: integer; virtual; abstract;
    function GetDesc: string; virtual; abstract;
    function GetData_Cadastro: Tdate; virtual; abstract;

    property Cod: integer read GetCodigo;
    property Desc: string read GetDesc;
    property Data: Tdate read GetData_Cadastro;

    procedure Inserir(var Registro: TCadastro_Padrao); virtual; abstract;
    procedure Alterar(var Registro: TCadastro_Padrao); virtual; abstract;
    procedure Excluir(var Registro: TCadastro_Padrao); virtual; abstract;
  end;

  TCadastro_Observacao_Fiscal = class
    Codigo: integer;
    Descricao: string;
    Data_Cadastro: Tdate;

    function GetCodigo: integer;
    function GetDesc: string;
    function GetData_Cadastro: Tdate;

    property Cod: integer read GetCodigo;
    property Desc: string read GetDesc;
    property Data: Tdate read GetData_Cadastro;

    procedure Inserir(var Registro: TCadastro_Observacao_Fiscal);
    procedure Alterar(var Registro: TCadastro_Observacao_Fiscal);
    procedure Excluir(var Registro: TCadastro_Observacao_Fiscal);
  end;

  TCadastro_Grupo_Produto_Tributacao = class
    Codigo: integer;
    Descricao: string;
    Codigo_Tratamento: integer;
    Data_Cadastro: Tdate;

    function GetCodigo: integer;
    function GetDesc: string;
    function GetCodigo_Tratamento: integer;
    function GetData_Cadastro: Tdate;

    property Cod: integer read GetCodigo;
    property Desc: string read GetDesc;
    property Cod_Tratamento: integer read GetCodigo_Tratamento;
    property Data: Tdate read GetData_Cadastro;

    procedure Inserir(var Registro: TCadastro_Grupo_Produto_Tributacao);
    procedure Alterar(var Registro: TCadastro_Grupo_Produto_Tributacao);
    procedure Excluir(var Registro: TCadastro_Grupo_Produto_Tributacao);
  end;

  TCadastro_Grupo_Produto_Tributacao_PIS = class
    Codigo: integer;
    Descricao: string;
    Codigo_Tratamento: integer;
    Data_Cadastro: Tdate;

    function GetCodigo: integer;
    function GetDesc: string;
    function GetCodigo_Tratamento: integer;
    function GetData_Cadastro: Tdate;

    property Cod: integer read GetCodigo;
    property Desc: string read GetDesc;
    property Cod_Tratamento: integer read GetCodigo_Tratamento;
    property Data: Tdate read GetData_Cadastro;

    procedure Inserir(var Registro: TCadastro_Grupo_Produto_Tributacao_PIS);
    procedure Alterar(var Registro: TCadastro_Grupo_Produto_Tributacao_PIS);
    procedure Excluir(var Registro: TCadastro_Grupo_Produto_Tributacao_PIS);
  end;

  TCadastro_Grupo_Produto_Tributacao_IPI = class
    Codigo: integer;
    Descricao: string;
    Codigo_Tratamento: integer;
    Data_Cadastro: Tdate;

    function GetCodigo: integer;
    function GetDesc: string;
    function GetCodigo_Tratamento: integer;
    function GetData_Cadastro: Tdate;

    property Cod: integer read GetCodigo;
    property Desc: string read GetDesc;
    property Cod_Tratamento: integer read GetCodigo_Tratamento;
    property Data: Tdate read GetData_Cadastro;

    procedure Inserir(var Registro: TCadastro_Grupo_Produto_Tributacao_IPI);
    procedure Alterar(var Registro: TCadastro_Grupo_Produto_Tributacao_IPI);
    procedure Excluir(var Registro: TCadastro_Grupo_Produto_Tributacao_IPI);
  end;

  TCadastro_Grupo_Produto_Tributacao_COFINS = class
    Codigo: integer;
    Descricao: string;
    Codigo_Tratamento: integer;
    Data_Cadastro: Tdate;

    function GetCodigo: integer;
    function GetDesc: string;
    function GetCodigo_Tratamento: integer;
    function GetData_Cadastro: Tdate;

    property Cod: integer read GetCodigo;
    property Desc: string read GetDesc;
    property Cod_Tratamento: integer read GetCodigo_Tratamento;
    property Data: Tdate read GetData_Cadastro;

    procedure Inserir(var Registro: TCadastro_Grupo_Produto_Tributacao_COFINS);
    procedure Alterar(var Registro: TCadastro_Grupo_Produto_Tributacao_COFINS);
    procedure Excluir(var Registro: TCadastro_Grupo_Produto_Tributacao_COFINS);
  end;

  TLogradouro = class(TCadastro_Padrao)
    Codigo: integer;
    Descricao: string;
    Tipo_Logradouro: string;
    CEP: string;
    Data_Cadastro: TDateTime;

    function GetCodigo: integer; overload;
    function GetDesc: string; overload;
    function GetTipo_Log: string;
    function GetCEP: string;
    function GetData_Cadastro: Tdate; overload;

    property Cod: integer read GetCodigo;
    property Desc: string read GetDesc;
    property Tip: string read GetTipo_Log;
    property CE: string read GetCEP;
    property Data: Tdate read GetData_Cadastro;

    procedure Inserir(var Registro: TLogradouro); overload;
    procedure Alterar(var Registro: TLogradouro); overload;
    procedure Excluir(var Registro: TLogradouro); overload;

    // function Selciona_Logradouro (var Registro: TLogradouro; var Condicao: string): Boolean;
  end;

  TUnidade_Medida = class(TCadastro_Padrao)
    Codigo: integer;
    Sigla: string;
    Descricao: string;
    Data_Cadastro: Tdate;

    function GetCodigo: integer; overload;
    function GetSigla: string;
    function GetDesc: string; overload;
    function GetData_Cadastro: Tdate; overload;

    property Cod: integer read GetCodigo;
    property Sig: string read GetSigla;
    property Desc: string read GetDesc;
    property Data: Tdate read GetData_Cadastro;

    procedure Inserir(var Registro: TUnidade_Medida); overload;
    procedure Alterar(var Registro: TUnidade_Medida); overload;
    procedure Excluir(var Registro: TUnidade_Medida); overload;

  end;

  TLocalidade_Produto = class
    Codigo: integer;
    Codigo_Empresa: integer;
    Local: string;
    // Detalhe: string;
    Data_Cadastro: Tdate;

    function GetCodigo: integer;
    function GetCodigo_Empresa: integer;
    function GetLocal: string;
    // function GetDetalhe: string;
    function GetData_Cadastro: Tdate;

    property Cod: integer read GetCodigo;
    property Cod_Empresa: integer read GetCodigo_Empresa;
    property Loc: string read GetLocal;
    // property Det: string read GetDetalhe;
    property Dat: Tdate read GetData_Cadastro;

    procedure Inserir(var Registro: TLocalidade_Produto);
    procedure Alterar(var Registro: TLocalidade_Produto);
    procedure Excluir(var Registro: TLocalidade_Produto);

  end;

  TCidade = class(TCadastro_Padrao)
    Codigo: integer;
    Descricao: string;
    UF: string;
    DDD: string;
    Data_Cadastro: Tdate;
    Codigo_Municipio: string;

    function GetCodigo: integer; overload;
    function GetDesc: string; overload;
    function GetUF: string;
    function GetDDD: string;
    function GetData_Cadastro: Tdate; overload;
    function GetCodigo_Municipio: string;

    property Cod: integer read GetCodigo;
    property Desc: string read GetDesc;
    property UFF: string read GetUF;
    property DD: string read GetDDD;
    property Data: Tdate read GetData_Cadastro;
    property Cod_Mun: string read GetCodigo_Municipio;

    procedure Inserir(var Registro: TCidade); overload;
    procedure Alterar(var Registro: TCidade); overload;
    procedure Excluir(var Registro: TCidade); overload;
  end;

  TSetor = class(TCadastro_Padrao)
    Codigo: integer;
    Descricao: string;
    Data_Cadastro: Tdate;

    function GetCodigo: integer; overload;
    function GetDesc: string; overload;
    function GetData_Cadastro: Tdate; overload;

    property Cod: integer read GetCodigo;
    property Desc: string read GetDesc;
    property Data: Tdate read GetData_Cadastro;

    procedure Inserir(var Registro: TSetor); overload;
    procedure Alterar(var Registro: TSetor); overload;
    procedure Excluir(var Registro: TSetor); overload;
  end;

  TCargo = class(TCadastro_Padrao)
    Codigo: integer;
    Descricao: string;
    Data_Cadastro: Tdate;

  public
    function GetCodigo: integer; overload;
    function GetDesc: string; overload;
    function GetData_Cadastro: Tdate; overload;

    property Cod: integer read GetCodigo;
    property Desc: string read GetDesc;
    property Data: Tdate read GetData_Cadastro;

    procedure Inserir(var Registro: TCargo); overload;
    procedure Alterar(var Registro: TCargo); overload;
    procedure Excluir(var Registro: TCargo); overload;
  end;

  TDepartamento = class(TCadastro_Padrao)
    Codigo: integer;
    Descricao: string;
    Data_Cadastro: Tdate;

  public
    function GetCodigo: integer; overload;
    function GetDesc: string; overload;
    function GetData_Cadastro: Tdate; overload;

    property Cod: integer read GetCodigo;
    property Desc: string read GetDesc;
    property Data: Tdate read GetData_Cadastro;

    procedure Inserir(var Registro: TDepartamento); overload;
    procedure Alterar(var Registro: TDepartamento); overload;
    procedure Excluir(var Registro: TDepartamento); overload;
  end;

  TGrupo_Produto = class(TCadastro_Padrao)
    Codigo: integer;
    Descricao: string;
    Codigo_Grupo_ICMS: integer;
    Codigo_Grupo_IPI: integer;
    Codigo_Grupo_PIS: integer;
    Codigo_Grupo_COFINS: integer;
    Data_Cadastro: Tdate;

  public
    function GetCodigo: integer;
    function GetDesc: string;
    function GetCodigo_Grupo_ICMS: integer;
    function GetCodigo_Grupo_IPI: integer;
    function GetCodigo_Grupo_PIS: integer;
    function GetCodigo_Grupo_COFINS: integer;
    function GetData_Cadastro: Tdate;

    property Cod: integer read GetCodigo;
    property Desc: string read GetDesc;
    property Cod_ICMS: integer read GetCodigo_Grupo_ICMS;
    property Cod_IPI: integer read GetCodigo_Grupo_IPI;
    property Cod_PIS: integer read GetCodigo_Grupo_PIS;
    property Cod_COFINS: integer read GetCodigo_Grupo_COFINS;
    property Data: Tdate read GetData_Cadastro;

    procedure Inserir(var Registro: TGrupo_Produto);
    procedure Alterar(var Registro: TGrupo_Produto);
    procedure Excluir(var Registro: TGrupo_Produto);
  end;

  TMarca = class(TCadastro_Padrao)
    Codigo: integer;
    Descricao: string;
    Data_Cadastro: Tdate;

  public
    function GetCodigo: integer; overload;
    function GetDesc: string; overload;
    function GetData_Cadastro: Tdate; overload;

    property Cod: integer read GetCodigo;
    property Desc: string read GetDesc;
    property Data: Tdate read GetData_Cadastro;

    procedure Inserir(var Registro: TMarca); overload;
    procedure Alterar(var Registro: TMarca); overload;
    procedure Excluir(var Registro: TMarca); overload;
  end;

  TCadastro_Tabela_Preco = class
    Codigo: integer;
    Codigo_Empresa: integer;
    Codigo_Produto: integer;
    Descricao: string;
    Data_Cadastro: Tdate;
    Data_Validade: Tdate;
    Tipo: string;
    Tipo_Calculo: string;
    Percentual_Vista: double;
    Percentual_Prazo: double;
    Atalho: string;

  public
    function GetCodigo: integer;
    function GetCodigo_Empresa: integer;
    function GetCodigo_Produto: integer;
    function GetDesc: string;
    function GetData_Cadastro: Tdate;
    function GetData_Validade: Tdate;
    function GetTipo: string;
    function GetTipo_Calculo: string;
    function GetPercentual_Vista: double;
    function GetPercentual_Prazo: double;
    function GetAtalho: string;

    property Cod: integer read GetCodigo;
    property Cod_Empresa: integer read GetCodigo_Empresa;
    property Cod_Prod: integer read GetCodigo_Produto;
    property Desc: string read GetDesc;
    property Data: Tdate read GetData_Cadastro;
    property Data_Val: Tdate read GetData_Validade;
    property Tip: string read GetTipo;
    property Tip_Calc: string read GetTipo_Calculo;
    property Perc_Vista: double read GetPercentual_Vista;
    property Perc_Prazo: double read GetPercentual_Prazo;
    property Ata: string read GetAtalho;

    procedure Inserir(var Registro: TCadastro_Tabela_Preco;
      Conexao: TADOConnection);
    procedure Alterar(var Registro: TCadastro_Tabela_Preco;
      Conexao: TADOConnection);
    procedure Excluir(var Registro: TCadastro_Tabela_Preco;
      Conexao: TADOConnection);
    procedure Excluir_Itens_Tabela(var Registro: TCadastro_Tabela_Preco;
      Conexao: TADOConnection);
    procedure Excluir_Produto_Tabela(var Registro: TCadastro_Tabela_Preco;
      Conexao: TADOConnection);
  end;

  TCadastro_Usuario = class
    Codigo: integer;
    Nome: string;
    Login: string;
    Senha: string;
    Administrador: string;
    Codigo_Perfil: integer;
    Data_Cadastro: Tdate;

  public
    function GetCodigo: integer;
    function GetNome: string;
    function GetLogin: string;
    function GetSenha: string;
    function GetAdministrador: string;
    function GetCodigo_Perfil: integer;
    function GetData_Cadastro: Tdate;

    property Cod: integer read GetCodigo;
    property Nom: string read GetNome;
    property Log: string read GetLogin;
    property Sen: string read GetSenha;
    property Adm: string read GetAdministrador;
    property Cod_Perfil: integer read GetCodigo_Perfil;
    property Data: Tdate read GetData_Cadastro;

    procedure Inserir(var Registro: TCadastro_Usuario;
      var Conexao: TADOConnection);
    procedure Alterar(var Registro: TCadastro_Usuario;
      var Conexao: TADOConnection);
    procedure Excluir(var Registro: TCadastro_Usuario;
      var Conexao: TADOConnection);
  end;

  TAbertura_Caixa = class
    Data_Abertura: TDateTime;
    Codigo_Forma_Pagamento: integer;
    Codigo_Caixa: integer;
    Codigo_Usuario: integer;
    Valor: double;
    Acerto: integer;

  public
    function GetData_Abertura: TDateTime;
    function GetCodigo_Forma_Pagamento: integer;
    function GetCodigo_Caixa: integer;
    function GetCodigo_Usuario: integer;
    function GetValor: double;
    function GetAcerto: integer;

    property Data_Ab: TDateTime read GetData_Abertura;
    property Cod_Forma_Pagamento: integer read GetCodigo_Forma_Pagamento;
    property Cod_Caixa: integer read GetCodigo_Caixa;
    property Cod_Usuario: integer read GetCodigo_Usuario;
    property Val: double read GetValor;
    property Acert: integer read GetAcerto;

    procedure Inserir(var Registro: TAbertura_Caixa);
    procedure Alterar(var Registro: TAbertura_Caixa);
    procedure Excluir(var Registro: TAbertura_Caixa);
  end;

  TFechamento_Caixa = class
    Data_Abertura: TDateTime;
    Data_Fechamento: TDateTime;
    Forma_Pagamento: string;
    Codigo_Caixa: integer;
    Codigo_Usuario: integer;
    Valor_Abertura: double;
    Valor_Fechamento: double;
    Tipo_Documento: string;

  public
    function GetData_Abertura: TDateTime;
    function GetData_Fechamento: TDateTime;
    function GetForma_Pagamento: string;
    function GetCodigo_Caixa: integer;
    function GetCodigo_Usuario: integer;
    function GetValor_Abertura: double;
    function GetValor_Fechamento: double;
    function GetTipo_Documento: string;

    property Data_Ab: TDateTime read GetData_Abertura;
    property Data_Fec: TDateTime read GetData_Fechamento;
    property Forma_Pag: string read GetForma_Pagamento;
    property Cod_Caixa: integer read GetCodigo_Caixa;
    property Cod_Usuario: integer read GetCodigo_Usuario;
    property Valor_Ab: double read GetValor_Abertura;
    property Valor_Fec: double read GetValor_Fechamento;
    property Tipo_Doc: string read GetTipo_Documento;

    procedure Inserir(var Registro: TFechamento_Caixa);
    procedure Alterar(var Registro: TFechamento_Caixa);
    procedure Excluir(var Registro: TFechamento_Caixa);
  end;

  TAcerto_Caixa = class
    Data_Abertura: TDateTime;
    Data_Fechamento: TDateTime;
    Codigo_Caixa: integer;
    Codigo_Usuario: integer;
    Valor_Abertura: double;
    Entrada: double;
    Saida: double;
    Saldo: double;
    Acerto: double;
    Fechamento: double;

  public
    function GetData_Abertura: TDateTime;
    function GetData_Fechamento: TDateTime;
    function GetCodigo_Caixa: integer;
    function GetCodigo_Usuario: integer;
    function GetValor_Abertura: double;
    function GetEntrada: double;
    function GetSaida: double;
    function GetSaldo: double;
    function GetAcerto: double;
    function GetFechamento: double;

    property Data_Ab: TDateTime read GetData_Abertura;
    property Data_Fec: TDateTime read GetData_Fechamento;
    property Cod_Caixa: integer read GetCodigo_Caixa;
    property Cod_Usuario: integer read GetCodigo_Usuario;
    property Valor_Ab: double read GetValor_Abertura;
    property Ent: double read GetEntrada;
    property Sai: double read GetSaida;
    property Sal: double read GetSaldo;
    property Acer: double read GetAcerto;
    property Fec: double read GetFechamento;

    procedure Inserir(var Registro: TAcerto_Caixa);
    procedure Alterar(var Registro: TAcerto_Caixa);
    procedure Excluir(var Registro: TAcerto_Caixa);
  end;

  TGrupo_Cliente = class(TCadastro_Padrao)
    Codigo: integer;
    Descricao: string;
    Data_Cadastro: Tdate;

  public
    function GetCodigo: integer; overload;
    function GetDesc: string; overload;
    function GetData_Cadastro: Tdate; overload;

    property Cod: integer read GetCodigo;
    property Desc: string read GetDesc;
    property Data: Tdate read GetData_Cadastro;

    procedure Inserir(var Registro: TGrupo_Cliente); overload;
    procedure Alterar(var Registro: TGrupo_Cliente); overload;
    procedure Excluir(var Registro: TGrupo_Cliente); overload;
  end;

  TTipo_Documento = class(TCadastro_Padrao)
    Codigo: integer;
    Descricao: string;
    Data_Cadastro: Tdate;

  public
    function GetCodigo: integer; overload;
    function GetDesc: string; overload;
    function GetData_Cadastro: Tdate; overload;

    property Cod: integer read GetCodigo;
    property Desc: string read GetDesc;
    property Data: Tdate read GetData_Cadastro;

    procedure Inserir(var Registro: TTipo_Documento); overload;
    procedure Alterar(var Registro: TTipo_Documento); overload;
    procedure Excluir(var Registro: TTipo_Documento); overload;
  end;

  TNCM = class
    Codigo: integer;
    Codigo_NCM: string;
    Descricao: string;
    Data_Cadastro: Tdate;

  public
    function GetCodigo: integer;
    function GetCodigo_NCM: string;
    function GetDesc: string;
    function GetData_Cadastro: Tdate;

    property Cod: integer read GetCodigo;
    property Cod_NCM: string read GetCodigo_NCM;
    property Desc: string read GetDesc;
    property Data: Tdate read GetData_Cadastro;

    procedure Inserir(var Registro: TNCM);
    procedure Alterar(var Registro: TNCM);
    procedure Excluir(var Registro: TNCM);
  end;

  TPais = class
    Codigo: integer;
    Codigo_Pais: string;
    Descricao: string;
    Data_Cadastro: Tdate;

  public
    function GetCodigo: integer;
    function GetCodigo_Pais: string;
    function GetDesc: string;
    function GetData_Cadastro: Tdate;

    property Cod: integer read GetCodigo;
    property Cod_Pais: string read GetCodigo_Pais;
    property Desc: string read GetDesc;
    property Data: Tdate read GetData_Cadastro;

    procedure Inserir(var Registro: TPais);
    procedure Alterar(var Registro: TPais);
    procedure Excluir(var Registro: TPais);
  end;

  TItens_Folha = class(TCadastro_Padrao)
    Codigo: integer;
    Descricao: string;
    Natureza: string;
    Data_Cadastro: Tdate;

  public
    function GetCodigo: integer; overload;
    function GetDesc: string; overload;
    function GetNatureza: string; overload;
    function GetData_Cadastro: Tdate; overload;

    property Cod: integer read GetCodigo;
    property Desc: string read GetDesc;
    property Nat: string read GetNatureza;
    property Data: Tdate read GetData_Cadastro;

    procedure Inserir(var Registro: TItens_Folha); overload;
    procedure Alterar(var Registro: TItens_Folha); overload;
    procedure Excluir(var Registro: TItens_Folha); overload;
  end;

  TBanco = class
    Codigo: integer;
    Codigo_Empresa: integer;
    Numero: string;
    Nome: string;
    Telefone: string;
    Contato: string;
    Data_Cadastro: Tdate;

  public
    function GetCodigo: integer;
    function GetCodigo_Empresa: integer;
    function GetNumero: string;
    function GetNome: string;
    function GetTelefone: string;
    function GetContato: string;
    function GetData_Cadastro: Tdate;

    property Cod: integer read GetCodigo;
    property Cod_Empresa: integer read GetCodigo_Empresa;
    property Num: string read GetNumero;
    property Nom: string read GetNome;
    property Tel: string read GetTelefone;
    property Cont: string read GetContato;
    property Data: Tdate read GetData_Cadastro;

    procedure Inserir(var Registro: TBanco);
    procedure Alterar(var Registro: TBanco);
    procedure Excluir(var Registro: TBanco);
  end;

  TCheque = class
    Codigo: integer;
    Codigo_Empresa: integer;
    Tipo: string;
    Emitente: string;
    Favorecido: string;
    Origem: string;
    Codigo_Banco: integer;
    Agencia: string;
    Titular: string;
    N_Cheque: string;
    Valor: double;
    Data_Cadastro: Tdate;
    Data_Vencimento: Tdate;
    Data_Saida: Tdate;
    Observacao: string;
    Status: string;

  public
    function GetCodigo: integer;
    function GetCodigo_Empresa: integer;
    function GetTipo: string;
    function GetEmitente: string;
    function GetFavorecido: string;
    function GetOrigem: string;
    function GetCodigo_Banco: integer;
    function GetAgencia: string;
    function GetTitular: string;
    function GetN_Cheque: string;
    function GetValor: double;
    function GetData_Cadastro: Tdate;
    function GetData_Vencimento: Tdate;
    function GetData_Saida: Tdate;
    function GetObservacao: string;
    function GetStatus: string;

    property Cod: integer read GetCodigo;
    property Cod_Empresa: integer read GetCodigo_Empresa;
    property Tip: string read GetTipo;
    property Emit: string read GetEmitente;
    property Fav: string read GetFavorecido;
    property Ori: string read GetOrigem;
    property Cod_Banco: integer read GetCodigo_Banco;
    property Ag: string read GetAgencia;
    property Tit: string read GetTitular;
    property N_Che: string read GetN_Cheque;
    property Val: double read GetValor;
    property Data_Cad: Tdate read GetData_Cadastro;
    property Data_Venc: Tdate read GetData_Vencimento;
    property Data_Sai: Tdate read GetData_Saida;
    property Obs: string read GetObservacao;
    property Stat: string read GetStatus;

    procedure Inserir(var Registro: TCheque);
    procedure Alterar(var Registro: TCheque);
    procedure Excluir(var Registro: TCheque);
  end;

  TMovimento_Caixa = class
    Codigo: integer;
    Codigo_Empresa: integer;
    Codigo_Caixa: integer;
    Codigo_Plano: integer;
    N_Documento: integer;
    Data_Movimentacao: Tdate;
    Descricao: string;
    Dinheiro: double;
    Cheque_Vista: double;
    Cheque_Prazo: double;
    Cartao: double;
    Juros: double;
    Desconto: double;

  public
    function GetCodigo: integer;
    function GetCodigo_Empresa: integer;
    function GetCodigo_Caixa: integer;
    function GetCodigo_Plano: integer;
    function GetData_Movimentacao: Tdate;
    function GetN_Documento: integer;
    function GetDescricao: string;
    function GetDinheiro: double;
    function GetCheque_Vista: double;
    function GetCheque_Prazo: double;
    function GetCartao: double;
    function GetJuros: double;
    function GetDesconto: double;

    property Cod: integer read GetCodigo;
    property Cod_Empresa: integer read GetCodigo_Empresa;
    property Cod_Caixa: integer read GetCodigo_Caixa;
    property Cod_Plano: integer read GetCodigo_Plano;
    property N_Doc: integer read GetN_Documento;
    property Data_Mov: Tdate read GetData_Movimentacao;
    property Desc: string read GetDescricao;
    property Din: double read GetDinheiro;
    property Che_Vis: double read GetCheque_Vista;
    property Che_Pr: double read GetCheque_Prazo;
    property Car: double read GetCartao;
    property Ju: double read GetJuros;
    property Des: double read GetDesconto;

    procedure Inserir(var Registro: TMovimento_Caixa);
    procedure Alterar(var Registro: TMovimento_Caixa);
    procedure Excluir(var Registro: TMovimento_Caixa);
  end;

  TFolha_Pagamento = class
    Codigo: integer;
    Codigo_Funcionario: integer;
    Codigo_Empresa: integer;
    Mes_Ano: string;
    Data_Fechamento: Tdate;
    Entradas: double;
    Saidas: double;
    Comissao: double;
    Desconto: double;
    Salario: double;
    Quantidade_Itens: integer;
    Observacao: string;

    function GetCodigo: integer;
    function GetCodigo_Funcionario: integer;
    function GetCodigo_Empresa: integer;
    function GetMes_Ano: string;
    function GetData_Fechamento: Tdate;
    function GetEntradas: double;
    function GetSaidas: double;
    function GetComissao: double;
    function GetDesconto: double;
    function GetSalario: double;
    function GetQuantidade_Itens: integer;
    function GetObservacao: string;

    property Cod: integer read GetCodigo;
    property Cod_Funcionario: integer read GetCodigo_Funcionario;
    property Cod_Empresa: integer read GetCodigo_Empresa;
    property Mes_An: string read GetMes_Ano;
    property Data_Fec: Tdate read GetData_Fechamento;
    property Entr: double read GetEntradas;
    property Sai: double read GetSaidas;
    property Comis: double read GetComissao;
    property Desc: double read GetDesconto;
    property Sal: double read GetSalario;
    property Quant_Itens: integer read GetQuantidade_Itens;
    property Obs: string read GetObservacao;

    procedure Inserir(var Registro: TFolha_Pagamento; Conexao: TADOConnection);
    procedure Alterar(var Registro: TFolha_Pagamento; Conexao: TADOConnection);
    procedure Excluir(var Registro: TFolha_Pagamento; Conexao: TADOConnection);
  end;

  TItens_Folha_Pagamento = class
    Codigo: integer;
    Codigo_Item: integer;
    Codigo_Item_Selecionado: integer;
    Valor: double;

    function GetCodigo: integer;
    function GetCodigo_Item: integer;
    function GetCodigo_Item_Selecionado: integer;
    function GetValor: double;

    property Cod: integer read GetCodigo;
    property Cod_Item: integer read GetCodigo_Item;
    property Cod_Item_Selecionado: integer read GetCodigo_Item_Selecionado;
    property Val: double read GetValor;

    procedure Inserir(var Registro: TItens_Folha_Pagamento;
      Conexao: TADOConnection);
    procedure Alterar(var Registro: TItens_Folha_Pagamento;
      Conexao: TADOConnection);
    procedure Excluir(var Registro: TItens_Folha_Pagamento;
      Conexao: TADOConnection);
    procedure Excluir_Tudo(var Registro: TItens_Folha_Pagamento;
      Conexao: TADOConnection);
  end;

  TFabricacao_Propria = class
    Codigo: integer;
    Codigo_Empresa: integer;
    Data_Fabricacao: Tdate;
    Data_Validade: Tdate;
    Codigo_Produto: integer;
    Qtde: double;

    function GetCodigo: integer;
    function GetCodigo_Empresa: integer;
    function GetData_Fabricacao: Tdate;
    function GetData_Validade: Tdate;
    function GetCodigo_Produto: integer;
    function GetQtde: double;

    property Cod: integer read GetCodigo;
    property Cod_Empresa: integer read GetCodigo_Empresa;
    property Data_Fab: Tdate read GetData_Fabricacao;
    property Data_Val: Tdate read GetData_Validade;
    property Cod_Produto: integer read GetCodigo_Produto;
    property Qtdee: double read GetQtde;

    procedure Inserir(var Registro: TFabricacao_Propria);
    procedure Alterar(var Registro: TFabricacao_Propria);
    procedure Excluir(var Registro: TFabricacao_Propria);
  end;

  TItens_Fabricacao_Propria = class
    Codigo: integer;
    Codigo_Insumo: integer;
    Unidade: string;
    Qtde: double;

    function GetCodigo: integer;
    function GetCodigo_Insumo: integer;
    function GetCodigo_Insumo_Selecionado: integer;
    function GetUnidade: string;
    function GetQtde: double;

    property Cod: integer read GetCodigo;
    property Cod_Insum: integer read GetCodigo_Insumo;
    property Cod_Insum_Sel: integer read GetCodigo_Insumo_Selecionado;
    property Un: string read GetUnidade;
    property Qtdee: double read GetQtde;

    procedure Inserir(var Registro: TItens_Fabricacao_Propria);
    procedure Alterar(var Registro: TItens_Fabricacao_Propria);
    procedure Excluir(var Registro: TItens_Fabricacao_Propria);
    procedure Excluir_Tudo(var Registro: TItens_Fabricacao_Propria);
  end;

  TReceita = class
    Codigo: integer;
    Codigo_Empresa: integer;
    Codigo_Produto: integer;
    Data_Cadastro: Tdate;

    function GetCodigo: integer;
    function GetCodigo_Empresa: integer;
    function GetCodigo_Produto: integer;
    function GetData_Cadastro: Tdate;

    property Cod: integer read GetCodigo;
    property Cod_Empresa: integer read GetCodigo_Empresa;
    property Cod_Produto: integer read GetCodigo_Produto;
    property Data_Cad: Tdate read GetData_Cadastro;

    procedure Inserir(var Registro: TReceita; var Conexao: TADOConnection);
    procedure Alterar(var Registro: TReceita; var Conexao : TADOConnection);
    procedure Excluir(var Registro: TReceita; var Conexao : TADOConnection);
  end;

  TItens_Receita = class
    Codigo: integer;
    Codigo_Insumo: integer;
    Unidade: string;
    Qtde: double;

    function GetCodigo: integer;
    function GetCodigo_Insumo: integer;
    function GetCodigo_Insumo_Selecionado: integer;
    function GetUnidade: string;
    function GetQtde: double;

    property Cod: integer read GetCodigo;
    property Cod_Insum: integer read GetCodigo_Insumo;
    property Cod_Insum_Sel: integer read GetCodigo_Insumo_Selecionado;
    property Un: string read GetUnidade;
    property Qtdee: double read GetQtde;

    procedure Inserir(var Registro: TItens_Receita; var Conexao : TADOConnection);
    procedure Alterar(var Registro: TItens_Receita; var Conexao : TADOConnection);
    procedure Excluir(var Registro: TItens_Receita; var Conexao : TADOConnection);
    procedure Excluir_Tudo(var Registro: TItens_Receita; var Conexao : TADOConnection);
  end;

  TMovimento_Banco = class
    Codigo: integer;
    Codigo_Empresa: integer;
    Codigo_Conta: integer;
    Codigo_Operacao: integer;
    Codigo_Plano: integer;
    N_Documento: integer;
    Data_Movimentacao: Tdate;
    Descricao: string;
    Valor: double;

  public
    function GetCodigo: integer;
    function GetCodigo_Empresa: integer;
    function GetCodigo_Conta: integer;
    function GetCodigo_Operacao: integer;
    function GetCodigo_Plano: integer;
    function GetN_Documento: integer;
    function GetData_Movimentacao: Tdate;
    function GetDescricao: string;
    function GetValor: double;

    property Cod: integer read GetCodigo;
    property Cod_Empresa: integer read GetCodigo_Empresa;
    property Cod_Conta: integer read GetCodigo_Conta;
    property Cod_Operacao: integer read GetCodigo_Operacao;
    property Cod_Plano: integer read GetCodigo_Plano;
    property N_Doc: integer read GetN_Documento;
    property Data_Mov: Tdate read GetData_Movimentacao;
    property Desc: string read GetDescricao;
    property Val: double read GetValor;

    procedure Inserir(var Registro: TMovimento_Banco);
    procedure Alterar(var Registro: TMovimento_Banco);
    procedure Excluir(var Registro: TMovimento_Banco);
  end;

  TOperacao_Bancaria = class
    Codigo: integer;
    Operacao: string;
    Tipo: string;
    Data_Cadastro: Tdate;

  public
    function GetCodigo: integer;
    function GetOperacao: string;
    function GetTipo: string;
    function GetData_Cadastro: Tdate;

    property Cod: integer read GetCodigo;
    property Op: string read GetOperacao;
    property Tip: string read GetTipo;
    property Data: Tdate read GetData_Cadastro;

    procedure Inserir(var Registro: TOperacao_Bancaria);
    procedure Alterar(var Registro: TOperacao_Bancaria);
    procedure Excluir(var Registro: TOperacao_Bancaria);
  end;

  TFechamento_Estoque = class
    Codigo: integer;
    Codigo_Empresa: integer;
    Mes: string;
    Ano: string;
    Codigo_Produto: integer;
    Un: string;
    Quantidade: double;
    Valor_Compra: double;
    Sub_Total: double;
    Ind_Prop: integer;
    Codigo_Participante: string;
    Texto_Complementar: string;
    Codigo_Conta: string;

  public
    function GetCodigo: integer;
    function GetCodigo_Empresa: integer;
    function GetMes: string;
    function GetAno: string;
    function GetCodigo_Produto: integer;
    function GetUN: string;
    function GetQuantidade: double;
    function GetValor_Compra: double;
    function GetSub_Total: double;
    function GetInd_Prop: integer;
    function GetCodigo_Participante: string;
    function GetTexto_Complementar: string;
    function GetCodigo_Conta: string;

    property Cod: integer read GetCodigo;
    property Cod_Empresa: integer read GetCodigo_Empresa;
    property Me: string read GetMes;
    property An: string read GetAno;
    property Cod_Pro: integer read GetCodigo_Produto;
    property UNN: string read GetUN;
    property Quant: double read GetQuantidade;
    property Valor_Comp: double read GetValor_Compra;
    property Sub_Tot: double read GetSub_Total;
    property Ind_Pro: integer read GetInd_Prop;
    property Cod_Part: string read GetCodigo_Participante;
    property Texto_Comp: string read GetTexto_Complementar;
    property Codigo_Cont: string read GetCodigo_Conta;

    procedure Inserir(var Registro: TFechamento_Estoque);
    procedure Alterar(var Registro: TFechamento_Estoque);
    procedure Excluir(var Registro: TFechamento_Estoque);
  end;

  TConta_Corrente = class
    Codigo: integer;
    Codigo_Empresa: integer;
    Data_Abertura: Tdate;
    Data_Cadastro: Tdate;
    Conta: string;
    Agencia: string;
    Codigo_Banco: integer;
    Nome_Agencia: string;
    Nome_Correntista: string;
    Saldo_Inicial: double;
    Limite: double;
    Saldo_Atual: double;

  public
    function GetCodigo: integer;
    function GetCodigo_Empresa: integer;
    function GetData_Abertura: Tdate;
    function GetData_Cadastro: Tdate;
    function GetConta: string;
    function GetAgencia: string;
    function GetCodigo_Banco: integer;
    function GetNome_Agencia: string;
    function GetNome_Correntista: string;
    function GetSaldo_Inicial: double;
    function GetLimite: double;
    function GetSaldo_Atual: double;

    property Cod: integer read GetCodigo;
    property Cod_Empresa: integer read GetCodigo_Empresa;
    property Dat_Ab: Tdate read GetData_Abertura;
    property Dat_Cad: Tdate read GetData_Cadastro;
    property Cont: string read GetConta;
    property Ag: string read GetAgencia;
    property Cod_Banco: integer read GetCodigo_Banco;
    property Nome_Ag: string read GetNome_Agencia;
    property Nome_Cor: string read GetNome_Correntista;
    property Saldo_Ini: double read GetSaldo_Inicial;
    property Lim: double read GetLimite;
    property Saldo_At: double read GetSaldo_Atual;

    procedure Inserir(var Registro: TConta_Corrente);
    procedure Alterar(var Registro: TConta_Corrente);
    procedure Excluir(var Registro: TConta_Corrente);
  end;

  TPlano_Financeiro = class(TCadastro_Padrao)
    Codigo: integer;
    Codigo_Empresa: integer;
    Tipo: string;
    Descricao: string;
    Subnivel: integer;
    Data_Cadastro: Tdate;
  public
    function GetCodigo: integer; overload;
    function GetCodigo_Empresa: integer;
    function GetTipo: string;
    function GetDesc: string; overload;
    function GetSubnivel: integer;
    function GetData_Cadastro: Tdate; overload;

    property Cod: integer read GetCodigo;
    property Cod_Empresa: integer read GetCodigo_Empresa;
    property Tip: string read GetTipo;
    property Desc: string read GetDesc;
    property SubN: integer read GetSubnivel;
    property Data: Tdate read GetData_Cadastro;

    procedure Inserir(var Registro: TPlano_Financeiro); overload;
    procedure Alterar(var Registro: TPlano_Financeiro); overload;
    procedure Excluir(var Registro: TPlano_Financeiro); overload;
  end;

  TCaixa = class
    Codigo: integer;
    Codigo_Empresa: integer;
    Descricao: string;
    Subnivel: integer;
    Caixa: string;
    Data_Cadastro: Tdate;

  public
    function GetCodigo: integer;
    function GetCodigo_Empresa: integer;
    function GetDesc: string;
    function GetSubnivel: integer;
    function GetCaixa: string;
    function GetData_Cadastro: Tdate;

    property Cod: integer read GetCodigo;
    property Cod_Empresa: integer read GetCodigo_Empresa;
    property Desc: string read GetDesc;
    property SubN: integer read GetSubnivel;
    property Cai: string read GetCaixa;
    property Data: Tdate read GetData_Cadastro;

    procedure Inserir(var Registro: TCaixa);
    procedure Alterar(var Registro: TCaixa);
    procedure Excluir(var Registro: TCaixa);
  end;

  TCondicao_Pagamento = class(TCadastro_Padrao)
    Codigo: integer;
    Status: string;
    Descricao: string;
    Parcela: integer;
    Prazo: integer;
    Taxa: double;
    Tipo_Pagamento: string;
    Forma_Negociacao: string;
    TEF: string;
    Cheque: string;
    Bandeira: string;
    Tipo_Juro: string;
    Data_Cadastro: Tdate;

  public
    function GetCodigo: integer; overload;
    function GetStatus: string;
    function GetDesc: string; overload;
    function GetParcela: integer;
    function GetPrazo: integer;
    function GetTaxa: double;
    function GetTipo_Pagamento: string;
    function GetForma_Negociacao: string;
    function GETTEF: string;
    function GETCheque: string;
    function GETBandeira: string;
    function GetTipo_Juro: string;
    function GetData_Cadastro: Tdate; overload;

    property Cod: integer read GetCodigo;
    property Stat: string read GetStatus;
    property Desc: string read GetDesc;
    property Par: integer read GetParcela;
    property Pr: integer read GetPrazo;
    property Tax: double read GetTaxa;
    property Tipo_Pag: string read GetTipo_Pagamento;
    property Forma_Neg: string read GetForma_Negociacao;
    property TEFF: string read GETTEF;
    property Che: string read GETCheque;
    property Band: string read GETBandeira;
    property Tipo_Ju: string read GetTipo_Juro;
    property Data: Tdate read GetData_Cadastro;

    procedure Inserir(var Registro: TCondicao_Pagamento);
    procedure Alterar(var Registro: TCondicao_Pagamento);
    procedure Excluir(var Registro: TCondicao_Pagamento);
  end;

  TPessoa = class abstract
    Codigo: integer;
    Nome: string;
    Codigo_Logradouro: integer;
    Numero: string;
    Referencia: string;
    Codigo_Setor: integer;
    Codigo_Cidade: integer;
    Telefone: string;
    Celular: string;
    Contato: string;
    Telefone_Contato: string;
    Email: string;
    Site: string;
    Data_Cadastro: Tdate;
    Observacoes: string;

  public
    function GetCodigo: integer; virtual; abstract;
    function GetNome: string; virtual; abstract;
    function GetCodigo_Logradouro: integer; virtual; abstract;
    function GetNumero: string; virtual; abstract;
    function GetReferencia: string; virtual; abstract;
    function GetCodigo_Setor: integer; virtual; abstract;
    function GetCodigo_Cidade: integer; virtual; abstract;
    function GetTelefone: string; virtual; abstract;
    function GetCelular: string; virtual; abstract;
    function GetContato: string; virtual; abstract;
    function GetTelefone_Contato: string; virtual; abstract;
    function GetEmail: string; virtual; abstract;
    function GetSite: string; virtual; abstract;
    function GetData_Cadastro: Tdate; virtual; abstract;
    function GetObservacoes: string; virtual; abstract;

    property Cod: integer read GetCodigo;
    property Nom: string read GetNome;
    property Logradouro: integer read GetCodigo_Logradouro;
    property Num: string read GetNumero;
    property Refer: string read GetReferencia;
    property Seto: integer read GetCodigo_Setor;
    property Cid: integer read GetCodigo_Cidade;
    property Tel: string read GetTelefone;
    property Cel: string read GetCelular;
    property Cont: string read GetContato;
    property Tel_Cont: string read GetTelefone_Contato;
    property Ema: string read GetEmail;
    property Sit: string read GetSite;
    property Data_Cad: Tdate read GetData_Cadastro;
    property Obs: string read GetObservacoes;

    constructor cria(var Registro: TPessoa); virtual; abstract;
    procedure Inserir(var Registro: TPessoa); virtual; abstract;
    procedure Alterar(var Registro: TPessoa); virtual; abstract;
    procedure Excluir(var Registro: TPessoa); virtual; abstract;
  end;

  TAgenda_Telefonica = class
    procedure Inserir;
    procedure Alterar;
    procedure Excluir;
  end;

  TCliente_Outros = class
    procedure Inserir(var Conexao: TADOConnection);
    procedure Alterar(var Conexao: TADOConnection);
    procedure Excluir(var Conexao: TADOConnection);
  end;

  TCliente = class(TPessoa)
    Codigo: integer;
    Codigo_Empresa: integer;
    Tipo: string;
    Enquadramento: string;
    Nome: string;
    Razao_Social: string;
    CPF: string;
    RG: string;
    Orgao_Expedidor: string;
    Data_Emissao_RG: Tdate;
    CNPJ: string;
    Insc_Estadual: string;
    Insc_Municipal: string;
    Codigo_Logradouro: integer;
    Numero: string;
    Complemento: string;
    Referencia: string;
    Codigo_Setor: integer;
    Codigo_Cidade: integer;
    Codigo_Grupo: integer;
    Suframa: string;
    Telefone: string;
    Celular: string;
    Contato: string;
    Telefone_Contato: string;
    Email: string;
    Site: string;
    Profissao: string;
    Data_Nascimento: Tdate;
    Estado_Civil: string;
    Data_Cadastro: Tdate;
    Limite_Credito: double;
    Acima_Limite_Credito: string;
    Limite_Desconto: double;
    Acima_Limite_Desconto: string;
    Observacoes: string;
    Codigo_Tabela_Preco: integer;

  public
    function GetCodigo: integer;
    function GetCodigo_Empresa: integer;
    function GetTipo: string;
    function GetEnquadramento: string;
    function GetNome_Nome_Fantasia: string;
    function GetRazao_Social: string;
    function GetCPF: string;
    function GetRG: string;
    function GetOrgao_Expedidor: string;
    function GetData_Emissao_RG: Tdate;
    function GetCNPJ: string;
    function GetInsc_Estadual: string;
    function GetInsc_Municipal: string;
    function GetCodigo_Logradouro: integer;
    function GetNumero: string;
    function GetComplemento: string;
    function GetReferencia: string;
    function GetCodigo_Setor: integer;
    function GetCodigo_Cidade: integer;
    function GetCodigo_Grupo: integer;
    function GetSuframa: string;
    function GetTelefone: string;
    function GetCelular: string;
    function GetContato: string;
    function GetTelefone_Contato: string;
    function GetEmail: string;
    function GetSite: string;
    function GetProfissao: string;
    function GetData_Nascimento: Tdate;
    function GetEstado_Civil: string;
    function GetData_Cadastro: Tdate;
    function GetLimite_Credito: double;
    function GetAcima_Limite_Credito: string;
    function GetLimite_Desconto: double;
    function GetAcima_Limite_Desconto: string;
    function GetObservacoes: string;
    function GetCodigo_Tabela_Preco: integer;

    property Cod: integer read GetCodigo;
    property Cod_Empresa: integer read GetCodigo_Empresa;
    property Tip: string read GetTipo;
    property Enquad: string read GetEnquadramento;
    property Nom: string read GetNome_Nome_Fantasia;
    property Raz: string read GetRazao_Social;
    property CP: string read GetCPF;
    property Ident: string read GetRG;
    property Orgao: string read GetOrgao_Expedidor;
    property Data_Emis: Tdate read GetData_Emissao_RG;
    property CNP: string read GetCNPJ;
    property Inscr_Estadual: string read GetInsc_Estadual;
    property Inscr_Municipal: string read GetInsc_Municipal;
    property Lograd: integer read GetCodigo_Logradouro;
    property Num: string read GetNumero;
    property Comp: string read GetComplemento;
    property Refer: string read GetReferencia;
    property Seto: integer read GetCodigo_Setor;
    property Cid: integer read GetCodigo_Cidade;
    property Grup: integer read GetCodigo_Grupo;
    property Sufr: string read GetSuframa;
    property Tel: string read GetTelefone;
    property Cel: string read GetCelular;
    property Cont: string read GetContato;
    property Tel_Cont: string read GetTelefone_Contato;
    property Ema: string read GetEmail;
    property Sit: string read GetSite;
    property Prof: string read GetProfissao;
    property Data_Nasc: Tdate read GetData_Nascimento;
    property Est_Civil: string read GetEstado_Civil;
    property Data_Cad: Tdate read GetData_Cadastro;
    property Limite_Cred: double read GetLimite_Credito;
    property Acima_Limite_Cred: string read GetAcima_Limite_Credito;
    property Limite_Desc: double read GetLimite_Desconto;
    property Acima_Limite_Desc: string read GetAcima_Limite_Desconto;
    property Obs: string read GetObservacoes;
    property Cod_Tabela_Preco: integer read GetCodigo_Tabela_Preco;

    constructor cria(var Registro: TCliente);
    procedure Inserir(var Registro: TCliente; var Conexao: TADOConnection);
    procedure Alterar(var Registro: TCliente; var Conexao: TADOConnection);
    procedure Excluir(var Registro: TCliente; var Conexao: TADOConnection);
  end;

  TFuncionario = class(TPessoa)
    Codigo: integer;
    Codigo_Empresa: integer;
    Nome: string;
    CPF: string;
    RG: string;
    Orgao_Expedidor: string;
    Data_Emissao_RG: Tdate;
    Salario: double;
    Comissao: double;
    Desconto: double;
    Codigo_Logradouro: integer;
    Numero: string;
    Referencia: string;
    Codigo_Setor: integer;
    Codigo_Cidade: integer;
    Codigo_Cargo: integer;
    Codigo_Departamento: integer;
    Telefone: string;
    Celular: string;
    Contato: string;
    Telefone_Contato: string;
    Email: string;
    Data_Nascimento: Tdate;
    Estado_Civil: string;
    Data_Cadastro: Tdate;
    Observacoes: string;

  public
    function GetCodigo: integer;
    function GetCodigo_Empresa: integer;
    function GetNome: string;
    function GetCPF: string;
    function GetRG: string;
    function GetOrgao_Expedidor: string;
    function GetData_Emissao_RG: Tdate;
    function GetSalario: double;
    function GetComissao: double;
    function GetDesconto: double;
    function GetCodigo_Logradouro: integer;
    function GetNumero: string;
    function GetReferencia: string;
    function GetCodigo_Setor: integer;
    function GetCodigo_Cidade: integer;
    function GetCodigo_Cargo: integer;
    function GetCodigo_Departamento: integer;
    function GetTelefone: string;
    function GetCelular: string;
    function GetContato: string;
    function GetTelefone_Contato: string;
    function GetEmail: string;
    function GetData_Nascimento: Tdate;
    function GetEstado_Civil: string;
    function GetData_Cadastro: Tdate;
    function GetObservacoes: string;

    property Cod: integer read GetCodigo;
    property Cod_Empresa: integer read GetCodigo_Empresa;
    property Nom: string read GetNome;
    property CP: string read GetCPF;
    property Ident: string read GetRG;
    property Orgao: string read GetOrgao_Expedidor;
    property Data_Emis: Tdate read GetData_Emissao_RG;
    property Salar: double read GetSalario;
    property Com: double read GetComissao;
    property Des: double read GetDesconto;
    property Lograd: integer read GetCodigo_Logradouro;
    property Num: string read GetNumero;
    property Refer: string read GetReferencia;
    property Seto: integer read GetCodigo_Setor;
    property Cid: integer read GetCodigo_Cidade;
    property Car: integer read GetCodigo_Cargo;
    property Depart: integer read GetCodigo_Departamento;
    property Tel: string read GetTelefone;
    property Cel: string read GetCelular;
    property Cont: string read GetContato;
    property Tel_Cont: string read GetTelefone_Contato;
    property Ema: string read GetEmail;
    property Data_Nasc: Tdate read GetData_Nascimento;
    property Est_Civil: string read GetEstado_Civil;
    property Data_Cad: Tdate read GetData_Cadastro;
    property Obs: string read GetObservacoes;

    // constructor cria(var Registro: TCliente);
    procedure Inserir(var Registro: TFuncionario; var Conexao: TADOConnection);
    procedure Inserir_Outros(var Conexao: TADOConnection);
    procedure Alterar(var Registro: TFuncionario; var Conexao: TADOConnection);
    procedure Alterar_Outros(var Conexao: TADOConnection);
    procedure Excluir(var Registro: TFuncionario; var Conexao: TADOConnection);
  end;

  TFornecedor = class(TPessoa)
    Codigo: integer;
    Codigo_Empresa: integer;
    Tipo: string;
    Nome_Fantasia: string;
    Razao_Social: string;
    CPF: string;
    RG: string;
    Orgao_Expedidor: string;
    Data_Emissao_RG: Tdate;
    CNPJ: string;
    Insc_Estadual_Municipal: string;
    Codigo_Logradouro: integer;
    Numero: string;
    Referencia: string;
    Codigo_Setor: integer;
    Codigo_Cidade: integer;
    Telefone: string;
    Celular: string;
    Email: string;
    Site: string;
    Data_Cadastro: Tdate;
    Observacoes: string;

  public
    function GetCodigo: integer;
    function GetCodigo_Empresa: integer;
    function GetTipo: string;
    function GetNome_Fantasia: string;
    function GetRazao_Social: string;
    function GetCPF: string;
    function GetRG: string;
    function GetOrgao_Expedidor: string;
    function GetData_Emissao_RG: Tdate;
    function GetCNPJ: string;
    function GetInsc_Estadual_Municipal: string;
    function GetCodigo_Logradouro: integer;
    function GetNumero: string;
    function GetReferencia: string;
    function GetCodigo_Setor: integer;
    function GetCodigo_Cidade: integer;
    function GetTelefone: string;
    function GetCelular: string;
    function GetEmail: string;
    function GetSite: string;
    function GetData_Cadastro: Tdate;
    function GetObservacoes: string;

    property Cod: integer read GetCodigo;
    property Cod_Empresa: integer read GetCodigo_Empresa;
    property Tip: string read GetTipo;
    property Nome_Fan: string read GetNome_Fantasia;
    property Raz: string read GetRazao_Social;
    property CP: string read GetCPF;
    property Ident: string read GetRG;
    property Orgao: string read GetOrgao_Expedidor;
    property Data_Emis: Tdate read GetData_Emissao_RG;
    property CNP: string read GetCNPJ;
    property Inscr: string read GetInsc_Estadual_Municipal;
    property Lograd: integer read GetCodigo_Logradouro;
    property Num: string read GetNumero;
    property Refer: string read GetReferencia;
    property Seto: integer read GetCodigo_Setor;
    property Cid: integer read GetCodigo_Cidade;
    property Tel: string read GetTelefone;
    property Cel: string read GetCelular;
    property Ema: string read GetEmail;
    property Sit: string read GetSite;
    property Data_Cad: Tdate read GetData_Cadastro;
    property Obs: string read GetObservacoes;

    procedure Inserir(var Registro: TFornecedor);
    procedure Alterar(var Registro: TFornecedor);
    procedure Excluir(var Registro: TFornecedor);
  end;

  TTransportadora = class
    Codigo: integer;
    Nome_Fantasia: string;
    Razao_Social: string;
    CPF: string;
    RG: string;
    Orgao_Expedidor: string;
    Data_Emissao_RG: Tdate;
    CNPJ: string;
    Insc_Estadual_Municipal: string;
    Codigo_Logradouro: integer;
    Numero: string;
    Referencia: string;
    Codigo_Setor: integer;
    Codigo_Cidade: integer;
    Telefone: string;
    Celular: string;
    Email: string;
    Site: string;
    Data_Cadastro: Tdate;
    Observacoes: string;

  public
    function GetCodigo: integer;
    function GetNome_Fantasia: string;
    function GetRazao_Social: string;
    function GetCPF: string;
    function GetRG: string;
    function GetOrgao_Expedidor: string;
    function GetData_Emissao_RG: Tdate;
    function GetCNPJ: string;
    function GetInsc_Estadual_Municipal: string;
    function GetCodigo_Logradouro: integer;
    function GetNumero: string;
    function GetReferencia: string;
    function GetCodigo_Setor: integer;
    function GetCodigo_Cidade: integer;
    function GetTelefone: string;
    function GetCelular: string;
    function GetEmail: string;
    function GetSite: string;
    function GetData_Cadastro: Tdate;
    function GetObservacoes: string;

    property Cod: integer read GetCodigo;
    property Nome_Fan: string read GetNome_Fantasia;
    property Raz: string read GetRazao_Social;
    property CP: string read GetCPF;
    property Ident: string read GetRG;
    property Orgao: string read GetOrgao_Expedidor;
    property Data_Emis: Tdate read GetData_Emissao_RG;
    property CNP: string read GetCNPJ;
    property Inscr: string read GetInsc_Estadual_Municipal;
    property Lograd: integer read GetCodigo_Logradouro;
    property Num: string read GetNumero;
    property Refer: string read GetReferencia;
    property Seto: integer read GetCodigo_Setor;
    property Cid: integer read GetCodigo_Cidade;
    property Tel: string read GetTelefone;
    property Cel: string read GetCelular;
    property Ema: string read GetEmail;
    property Sit: string read GetSite;
    property Data_Cad: Tdate read GetData_Cadastro;
    property Obs: string read GetObservacoes;

    procedure Inserir(var Registro: TTransportadora);
    procedure Alterar(var Registro: TTransportadora);
    procedure Excluir(var Registro: TTransportadora);
  end;

  TEmpresa = class
    Codigo: integer;
    Nome_Fantasia: string;
    Razao_Social: string;
    Proprietario: string;
    CNPJ: string;
    Insc_Estadual: string;
    Insc_Municipal: string;
    Suframa: string;
    CNAE: string;
    Regime_Tributario: integer;
    Enquadramento: string;
    Aliquota: string;
    Custo_OP: double;
    Codigo_Logradouro: integer;
    Numero: string;
    Complemento: string;
    Codigo_Setor: integer;
    Codigo_Cidade: integer;
    Telefone: string;
    Fax: string;
    Email: string;
    Senha: String;
    Site: string;
    Data_Cadastro: Tdate;
    Observacoes: string;
    Contato: string;
    Telefone_Contato: string;

  public
    function GetCodigo: integer;
    function GetNome_Fantasia: string;
    function GetRazao_Social: string;
    function GetProprietario: string;
    function GetCNPJ: string;
    function GetInsc_Estadual: string;
    function GetInsc_Municipal: string;
    function GetSuframa: string;
    function GetCNAE: string;
    function GetRegime_Tributario: integer;
    function GetEnquadramento: string;
    function GetAliquota: string;
    function GetCusto_OP: double;
    function GetCodigo_Logradouro: integer;
    function GetNumero: string;
    function GetComplemento: string;
    function GetCodigo_Setor: integer;
    function GetCodigo_Cidade: integer;
    function GetTelefone: string;
    function GetFax: string;
    function GetEmail: string;
    function GetSenha: string;
    function GetSite: string;
    function GetData_Cadastro: Tdate;
    function GetObservacoes: string;
    function GetContato: string;
    function GetTelefone_Contato: string;

    property Cod: integer read GetCodigo;
    property Nome_Fan: string read GetNome_Fantasia;
    property Raz: string read GetRazao_Social;
    property Prop: string read GetProprietario;
    property CNP: string read GetCNPJ;
    property Inscr_Est: string read GetInsc_Estadual;
    property Inscr_Mun: string read GetInsc_Municipal;
    property Sufram: string read GetSuframa;
    property CNAEE: string read GetCNAE;
    property Regime_Trib: integer read GetRegime_Tributario;
    property Enquad: string read GetEnquadramento;
    property Ali: string read GetAliquota;
    property Custo_OPP: double read GetCusto_OP;
    property Lograd: integer read GetCodigo_Logradouro;
    property Num: string read GetNumero;
    property Comp: string read GetComplemento;
    property Seto: integer read GetCodigo_Setor;
    property Cid: integer read GetCodigo_Cidade;
    property Tel: string read GetTelefone;
    property FA: string read GetFax;
    property Ema: string read GetEmail;
    property Sen: string read GetSenha;
    property Sit: string read GetSite;
    property Data_Cad: Tdate read GetData_Cadastro;
    property Obs: string read GetObservacoes;
    property Cont: string read GetContato;
    property Tel_Cont: string read GetTelefone_Contato;

    procedure Inserir(var Registro: TEmpresa);
    procedure Alterar(var Registro: TEmpresa);
    procedure Excluir(var Registro: TEmpresa);
  end;

  TContabilista = class
    Codigo_Empresa: integer;
    Nome_Contabilista: string;
    CNPJ: string;
    CPF: string;
    CRC: string;
    Codigo_Logradouro: integer;
    Numero: string;
    Complemento: string;
    Codigo_Setor: integer;
    Codigo_Cidade: integer;
    Email: string;
    Telefone: string;

  public
    function GetCodigo_Empresa: integer;
    function GetNome_Contabilista: string;
    function GetCNPJ: string;
    function GetCPF: string;
    function GetCRC: string;
    function GetCodigo_Logradouro: integer;
    function GetNumero: string;
    function GetComplemento: string;
    function GetCodigo_Setor: integer;
    function GetCodigo_Cidade: integer;
    function GetEmail: string;
    function GetTelefone: string;

    property Cod_Empresa: integer read GetCodigo_Empresa;
    property Nome_Cont: string read GetNome_Contabilista;
    property CNPJJ: string read GetCNPJ;
    property CPFF: string read GetCPF;
    property CRCC: string read GetCRC;
    property Codigo_Log: integer read GetCodigo_Logradouro;
    property Num: string read GetNumero;
    property Complem: string read GetComplemento;
    property Codigo_Set: integer read GetCodigo_Setor;
    property Codigo_Cid: integer read GetCodigo_Cidade;
    property Ema: string read GetEmail;
    property Tel: string read GetTelefone;

    procedure Inserir(var Registro: TContabilista);
    procedure Alterar(var Registro: TContabilista);
    procedure Excluir(var Registro: TContabilista);
  end;

  TProduto = class
    Codigo_Empresa: integer;
    Codigo: integer;
    Tipo: integer;
    Status: string;
    Controla_Estoque: string;
    Gera_Comissao: string;
    Aceita_Devolucao: string;
    Producao_Propria: string;
    Arred_Trunc: string;
    Codigo_Original: string;
    Codigo_Venda: string;
    Descricao: string;
    Codigo_Barra: string;
    Codigo_Fornecedor: integer;
    Codigo_Fabricante: integer;
    Codigo_Marca: integer;
    Codigo_Unidade_Medida: integer;
    Codigo_Unidade_Volume: integer;
    Codigo_Grupo: integer;
    Codigo_Grupo_Tributacao: integer;
    Codigo_Grupo_Tributacao_IPI: integer;
    Codigo_Grupo_Tributacao_PIS: integer;
    Codigo_Grupo_Tributacao_COFINS: integer;
    Codigo_Grupo_Tributacao_ISSQN: integer;
    Codigo_Local: integer;
    Data_Fabricacao: Tdate;
    Data_Validade: Tdate;
    Ultima_Compra: Tdate;
    Ultima_Venda: Tdate;
    Valor_Compra: double;
    Valor_Medio: double;
    Saldo_Estoque: double;
    Valor_Ultima_Compra: double;
    Tipo_Tributacao: string;
    Estoque_Maximo: double;
    Estoque_Minimo: double;
    Estoque: double;
    Estoque_Reservado: double;
    Volume: double;
    Volume_Total: double;
    Em_Estoque_Maximo: string;
    Em_Estoque_Minimo: string;
    Data_Cadastro: Tdate;
    Data_Atualizacao_Estoque: Tdate;
    Status_Estoque_Data: string;
    NCM: string;
    CFOP_D: string;
    CFOP_F: string;
  private

  public
    function GetCodigo_Empresa: integer;
    function GetCodigo: integer;
    function GetTipo: integer;
    function GetStatus: string;
    function GetGera_Comissao: string;
    function GetAceita_Devolucao: string;
    function GetArred_Trunc: string;
    function GetProducao_Propria: string;
    function GetCodigo_Original: string;
    function GetCodigo_Venda: string;
    function GetDescricao: string;
    function GetCodigo_Barra: string;
    function GetCodigo_Fornecedor: integer;
    function GetCodigo_Fabricante: integer;
    function GetCodigo_Marca: integer;
    function GetCodigo_Unidade_Medida: integer;
    function GetCodigo_Unidade_Volume: integer;
    function GetCodigo_Grupo: integer;
    function GetCodigo_Grupo_Tributacao: integer;
    function GetCodigo_Grupo_Tributacao_IPI: integer;
    function GetCodigo_Grupo_Tributacao_PIS: integer;
    function GetCodigo_Grupo_Tributacao_COFINS: integer;
    function GetCodigo_Grupo_Tributacao_ISSQN: integer;
    function GetCodigo_Local: integer;
    function GetData_Fabricacao: Tdate;
    function GetData_Validade: Tdate;
    function GetUltima_Compra: Tdate;
    function GetUltima_Venda: Tdate;
    function GetValor_Compra: double;
    function GetValor_Medio: double;
    function GetSaldo_Estoque: double;
    function GetValor_Ultima_Compra: double;
    function GetTipo_Tributacao: string;
    function GetEstoque_Maximo: double;
    function GetEstoque_Minimo: double;
    function GetEstoque: double;
    function GetEstoque_Reservado: double;
    function GetVolume: double;
    function GetVolume_Total: double;
    function GetEm_Estoque_Maximo: string;
    function GetEm_Estoque_Minimo: string;
    function GetData_Cadastro: Tdate;
    function GetData_Atualizacao_Estoque: Tdate;
    function GetStatus_Estoque_Data: string;
    function GetNCM: string;

    property Cod_Empresa: integer read GetCodigo_Empresa;
    property Cod: integer read GetCodigo;
    property Tip: integer read GetTipo;
    property Stat: string read GetStatus;
    property Ger_Com: string read GetGera_Comissao;
    property Ac_Dev: string read GetAceita_Devolucao;
    property Ar_Tru: string read GetArred_Trunc;
    property Prod_Propria: string read GetProducao_Propria;
    property Cod_Original: string read GetCodigo_Original;
    property Cod_Venda: string read GetCodigo_Venda;
    property Desc: string read GetDescricao;
    property Cod_Barra: string read GetCodigo_Barra;
    property Cod_Fornecedor: integer read GetCodigo_Fornecedor;
    property Cod_Fabricante: integer read GetCodigo_Fabricante;
    property Cod_Marca: integer read GetCodigo_Marca;
    property Cod_Un_Medida: integer read GetCodigo_Unidade_Medida;
    property Cod_Un_Volume: integer read GetCodigo_Unidade_Volume;
    property Cod_Grupo: integer read GetCodigo_Grupo;
    property Cod_Grupo_Tributacao: integer read GetCodigo_Grupo_Tributacao;
    property Cod_Grupo_Tributacao_IPI: integer
      read GetCodigo_Grupo_Tributacao_IPI;
    property Cod_Grupo_Tributacao_PIS: integer
      read GetCodigo_Grupo_Tributacao_PIS;
    property Cod_Grupo_Tributacao_COFINS: integer
      read GetCodigo_Grupo_Tributacao_COFINS;
    property Cod_Grupo_Tributacao_ISSQN: integer
      read GetCodigo_Grupo_Tributacao_ISSQN;
    property Cod_Local: integer read GetCodigo_Local;
    property Dat_Fabricacao: Tdate read GetData_Fabricacao;
    property Dat_Validade: Tdate read GetData_Validade;
    property Ult_Compra: Tdate read GetUltima_Compra;
    property Ult_Venda: Tdate read GetUltima_Venda;
    property Valor_Com: double read GetValor_Compra;
    property Valor_Med: double read GetValor_Medio;
    property Sal_Estoque: double read GetSaldo_Estoque;
    property Valor_Ult_Compra: double read GetValor_Ultima_Compra;
    property Tip_Tribut: string read GetTipo_Tributacao;
    property Estoque_Max: double read GetEstoque_Maximo;
    property Estoque_Min: double read GetEstoque_Minimo;
    property Esto: double read GetEstoque;
    property Esto_Res: double read GetEstoque_Reservado;
    property Volum: double read GetVolume;
    property Volum_Total: double read GetVolume_Total;
    property Em_Est_Maximo: string read GetEm_Estoque_Maximo;
    property Em_Est_Minimo: string read GetEm_Estoque_Minimo;
    property Dat_Cadastro: Tdate read GetData_Cadastro;
    property Dat_At_Est: Tdate read GetData_Atualizacao_Estoque;
    property Status_Estoque_Dat: string read GetStatus_Estoque_Data;
    property NCMM: string read GetNCM;

    procedure Inserir(var Registro: TProduto);
    procedure Alterar(var Registro: TProduto);
    procedure Excluir(var Registro: TProduto);
  end;

  TLancamento_Financeiro = class
    Codigo: integer;
    Tipo: string;
    N_Documento: integer;
    Codigo_Empresa: integer;
    Codigo_Forma_Pagamento: integer;
    Codigo_Cli_For: integer;
    Codigo_Tipo_Documento: integer;
    Historico: string;
    Codigo_Departamento: integer;
    Codigo_Plano: integer;
    Data_Lancamento: Tdate;
    Data_Vencimento: Tdate;
    Valor_Documento: double;
    Desconto: double;
    Multa: double;
    Valor_Cobrado: double;
    Observacao: string;
    Status: string;

  public
    function GetCodigo: integer;
    function GetTipo: string;
    function GetN_Documento: integer;
    function GetCodigo_Empresa: integer;
    function GetCodigo_Forma_Pagamento: integer;
    function GetCodigo_Cli_For: integer;
    function GetCodigo_Tipo_Documento: integer;
    function GetHistorico: string;
    function GetCodigo_Departamento: integer;
    function GetCodigo_Plano: integer;
    function GetData_Lancamento: Tdate;
    function GetData_Vencimento: Tdate;
    function GetValor_Documento: double;
    function GetDesconto: double;
    function GetMulta: double;
    function GetValor_Cobrado: double;
    function GetObservacao: string;
    function GetStatus: string;

    property Cod: integer read GetCodigo;
    property Tip: string read GetTipo;
    property N_Doc: integer read GetN_Documento;
    property Cod_Empresa: integer read GetCodigo_Empresa;
    property Cod_Form_Pag: integer read GetCodigo_Forma_Pagamento;
    property Cod_Cli_For: integer read GetCodigo_Cli_For;
    property Cod_Tipo_Doc: integer read GetCodigo_Tipo_Documento;
    property Hist: string read GetHistorico;
    property Cod_Depart: integer read GetCodigo_Departamento;
    property Cod_Plano: integer read GetCodigo_Plano;
    property Data_Lanc: Tdate read GetData_Lancamento;
    property Data_Venc: Tdate read GetData_Vencimento;
    property Valor_Doc: double read GetValor_Documento;
    property Desc: double read GetDesconto;
    property Mult: double read GetMulta;
    property Valor_Cob: double read GetValor_Cobrado;
    property Obs: string read GetObservacao;
    property Stat: string read GetStatus;

    procedure Inserir(var Registro: TLancamento_Financeiro);
    procedure Alterar(var Registro: TLancamento_Financeiro);
    procedure Excluir(var Registro: TLancamento_Financeiro);
  end;

  TLancamento_Banco = class
    Codigo: integer;
    Codigo_Empresa: integer;
    N_Documento: integer;
    Data_Lancamento: Tdate;
    Codigo_Conta: integer;
    Codigo_Operacao: integer;
    Codigo_Plano: integer;
    Descricao: string;
    Valor: double;
    Status: string;
  public
    function GetCodigo: integer;
    function GetCodigo_Empresa: integer;
    function GetN_Documento: integer;
    function GetData_Lancamento: Tdate;
    function GetCodigo_Conta: integer;
    function GetCodigo_Operacao: integer;
    function GetCodigo_Plano: integer;
    function GetDescricao: string;
    function GetValor: double;
    function GetStatus: string;

    property Cod: integer read GetCodigo;
    property Cod_Empresa: integer read GetCodigo_Empresa;
    property N_Doc: integer read GetN_Documento;
    property Data_Lanc: Tdate read GetData_Lancamento;
    property Cod_Conta: integer read GetCodigo_Conta;
    property Cod_Op: integer read GetCodigo_Operacao;
    property Cod_Plan: integer read GetCodigo_Plano;
    property Desc: string read GetDescricao;
    property Val: double read GetValor;
    property Stat: string read GetStatus;

    procedure Inserir(var Registro: TLancamento_Banco);
    procedure Alterar(var Registro: TLancamento_Banco);
    procedure Excluir(var Registro: TLancamento_Banco);
  end;

  TParcelas = class
    Codigo: integer;
    N_Documento: integer;
    Data_Vencimento: Tdate;
    Data_Pagamento: Tdate;
    Parcela: integer;
    Status: string;
    Valor: double;

  public
    function GetCodigo: integer;
    function GetCodigo_Selecionado: integer;
    function GetN_Documento: integer;
    function GetData_Vencimento: Tdate;
    function GetData_Pagamento: Tdate;
    function GetParcela: integer;
    function GetStatus: string;
    function GetValor: double;

    property Codi: integer read GetCodigo;
    property Codi_Selecionado: integer read GetCodigo_Selecionado;
    property N_Doc: integer read GetN_Documento;
    property Data_Venc: Tdate read GetData_Vencimento;
    property Data_Pag: Tdate read GetData_Pagamento;
    property Parc: integer read GetParcela;
    property Stat: string read GetStatus;
    property Val: double read GetValor;

    procedure Inserir(var Regis: TParcelas);
    procedure Alterar(var Regis: TParcelas);
    procedure Excluir(var Regis: TParcelas);
    procedure Excluir_Historico(var Regis: TParcelas);
  end;

  TVeiculo = class
    Codigo: integer;
    Tipo: string;
    Data_Cadastro: Tdate;
    Veiculo: string;
    Codigo_Cliente: integer;
    Marca: integer;
    Modelo: string;
    Ano_Fabricacao: string;
    Placa: string;
    UF: string;
    Chassi: string;
    Renavam: string;
    ANTT: string;

  public
    function GetCodigo: integer;
    function GetTipo: string;
    function GetData_Cadastro: Tdate;
    function GetVeiculo: string;
    function GetCodigo_Cliente: integer;
    function GetMarca: integer;
    function GetModelo: string;
    function GetAno_Fabricacao: string;
    function GetPlaca: string;
    function GetUF: string;
    function GetChassi: string;
    function GetRenavam: string;
    function GetANTT: string;

    property Cod: integer read GetCodigo;
    property Tip: string read GetTipo;
    property Data_Cad: Tdate read GetData_Cadastro;
    property Vei: string read GetVeiculo;
    property Cod_Cliente: integer read GetCodigo_Cliente;
    property Marc: integer read GetMarca;
    property Model: string read GetModelo;
    property Ano_Fab: string read GetAno_Fabricacao;
    property Plac: string read GetPlaca;
    property UFF: string read GetUF;
    property Chas: string read GetChassi;
    property Rena: string read GetRenavam;
    property ANTTT: string read GetANTT;

    procedure Inserir(var Registro: TVeiculo);
    procedure Alterar(var Registro: TVeiculo);
    procedure Excluir(var Registro: TVeiculo);
  end;

  TItens_Venda_ECF = class
    Codigo: integer;
    Codigo_Produto: integer;
    Valor_Unitario: double;
    Quantidade: integer;
    Tipo_Desconto: string;
    Desconto: double;
    Sub_Total: double;
    Cancelado: string;

  public
    function GetCodigo: integer;
    function GetCodigo_Produto: integer;
    function GetValor_Unitario: double;
    function GetQuantidade: integer;
    function GetTipo_Desconto: string;
    function GetDesconto: double;
    function GetSub_Total: double;
    function GetCancelado: string;

    property Codi: integer read GetCodigo;
    property Codi_Prod: integer read GetCodigo_Produto;
    property Val_Un: double read GetValor_Unitario;
    property Quant: integer read GetQuantidade;
    property Tip_Desconto: string read GetTipo_Desconto;
    property Desc: double read GetDesconto;
    property Sub_Tot: double read GetSub_Total;
    property Can: string read GetCancelado;

    procedure Inserir(var Registro: TItens_Venda_ECF);
    procedure Alterar(var Registro: TItens_Venda_ECF);
    procedure Excluir(var Registro: TItens_Venda_ECF);
    procedure Salva_Banco(var Registro: TItens_Venda_ECF);
  end;

  TFechamento_Venda = class
    Codigo: integer;
    Codigo_Empresa: integer;
    Codigo_Caixa: integer;
    Codigo_Usuario: integer;
    Forma_Pagamento: string;
    Valor: double;
    Troco: double;
    Data: Tdate;
    Tipo_Documento: string;
    Status: string;
    Acerto: integer;
    Tipo: string;
    Movimenta: integer;
    N_Documento: integer;
    Parcela: integer;

  public
    function GetCodigo: integer;
    function GetCodigo_Empresa: integer;
    function GetCodigo_Caixa: integer;
    function GetCodigo_Usuario: integer;
    function GetForma_Pagamento: string;
    function GetValor: double;
    function GetTroco: double;
    function GetData: Tdate;
    function GetTipo_Documento: string;
    function GetStatus: string;
    function GetAcerto: integer;
    function GetTipo: string;
    function GetMovimenta: integer;
    function GetN_Documento: integer;
    function GetParcela: integer;

    function GetCodigo_Pedido: integer;
    function GetForma_Pagamento_Pedido: string;
    function GetValor_Pedido: double;
    function GetData_Pedido: Tdate;
    function GetTipo_Documento_Pedido: string;

    property Codi: integer read GetCodigo;
    property Codi_Empresa: integer read GetCodigo_Empresa;
    property Codi_Caixa: integer read GetCodigo_Caixa;
    property Codi_Usuario: integer read GetCodigo_Usuario;
    property Form_Pag: string read GetForma_Pagamento;
    property Val: double read GetValor;
    property Trocoo: double read GetTroco;
    property Dat: Tdate read GetData;
    property Tipo_Doc: string read GetTipo_Documento;
    property Statuss: string read GetStatus;
    property Acertoo: integer read GetAcerto;
    property Tipoo: string read GetTipo;
    property Moviment: integer read GetMovimenta;
    property N_Doc: integer read GetN_Documento;
    property Parc: integer read GetParcela;

    property Codi_Ped: integer read GetCodigo_Pedido;
    property Form_Pag_Ped: string read GetForma_Pagamento_Pedido;
    property Val_Ped: double read GetValor_Pedido;
    property Dat_Ped: Tdate read GetData_Pedido;
    property Tipo_Doc_Ped: string read GetTipo_Documento_Pedido;

    procedure Inserir(var Registro: TFechamento_Venda);
    procedure Alterar(var Registro: TFechamento_Venda);
    procedure Excluir(var Registro: TFechamento_Venda);
    procedure ExcluirLocal(var Registro: TFechamento_Venda);
    procedure Salva_Banco(var Registro: TFechamento_Venda; var Conexao: TADOConnection);
    procedure Salva_Banco_PDV;
    procedure Salva_Conta(Codigo, Codigo_Empresa, Codigo_Caixa, Codigo_Usuario,
      Acerto, Movimenta, N_Documento, Parcela: integer;
      Forma_Pagamento, Tipo_Documento, Status, Tipo: Ansistring;
      Valor, Troco: double; Data: Tdate);
  end;

  TR02 = class
    Codigo_Empresa: integer;
    Tipo: string;
    Numero_Serie: string;
    MF_Adicional: string;
    Modelo: string;
    Numero_Usuario: string;
    CRZ: string;
    COO: string;
    CRO: string;
    Data_Movimento: Tdate;
    Data_Emissao: string;
    Hora_Emissao: string;
    Venda_Bruta_Diaria: string;
    ISSQN: string;
    Caixa: string;
    COO_Inicial: string;
    COO_Final: string;
    Grande_Total: string;

  public
    function GetCodigo_Empresa: integer;
    function GetTipo: string;
    function GetNumero_Serie: string;
    function GetMF_Adicional: string;
    function GetModelo: string;
    function GetNumero_Usuario: string;
    function GetCRZ: string;
    function GetCOO: string;
    function GetCRO: string;
    function GetData_Movimento: Tdate;
    function GetData_Emissao: string;
    function GetHora_Emissao: string;
    function GetVenda_Bruta_Diaria: string;
    function GetISSQN: string;
    function GetCaixa: string;
    function GetCOO_Inicial: string;
    function GetCOO_Final: string;
    function GetGrande_Total: string;

    property Cod_Empresa: integer read GetCodigo_Empresa;
    property Tip: string read GetTipo;
    property N_Serie: string read GetNumero_Serie;
    property MF_Ad: string read GetMF_Adicional;
    property Mode: string read GetModelo;
    property N_Usu: string read GetNumero_Usuario;
    property CRZZ: string read GetCRZ;
    property COOO: string read GetCOO;
    property CROO: string read GetCRO;
    property Data_Mov: Tdate read GetData_Movimento;
    property Data_Emis: string read GetData_Emissao;
    property Hora_Emis: string read GetHora_Emissao;
    property Venda_Br: string read GetVenda_Bruta_Diaria;
    property ISSQ: string read GetISSQN;
    property Caix: string read GetCaixa;
    property COO_Ini: string read GetCOO_Inicial;
    property COO_Fin: string read GetCOO_Final;
    property Grande_Tot: string read GetGrande_Total;

    function Inserir(var Registro: TR02): Boolean;
    procedure Inserir_Aux(var Registro: TR02);
  end;

  TR03 = class
    Codigo_Empresa: integer;
    Tipo: string;
    Numero_Serie: string;
    MF_Adicional: string;
    Modelo: string;
    Numero_Usuario: string;
    CRZ: string;
    Totalizador_Parcial: string;
    Valor_Acumulado: string;
    Data_Movimento: Tdate;
    Caixa: string;

  public
    function GetCodigo_Empresa: integer;
    function GetTipo: string;
    function GetNumero_Serie: string;
    function GetMF_Adicional: string;
    function GetModelo: string;
    function GetNumero_Usuario: string;
    function GetCRZ: string;
    function GetTotalizador_Parcial: string;
    function GetValor_Acumulado: string;
    function GetData_Movimento: Tdate;
    function GetCaixa: string;

    property Cod_Empresa: integer read GetCodigo_Empresa;
    property Tip: string read GetTipo;
    property N_Serie: string read GetNumero_Serie;
    property MF_Ad: string read GetMF_Adicional;
    property Mode: string read GetModelo;
    property N_Usu: string read GetNumero_Usuario;
    property CRZZ: string read GetCRZ;
    property Tot_Par: string read GetTotalizador_Parcial;
    property Valor_Acu: string read GetValor_Acumulado;
    property Data_Mov: Tdate read GetData_Movimento;
    property Caix: string read GetCaixa;

    procedure Inserir(var Registro: TR03);
    procedure Inserir_Aux(var Registro: TR03);
  end;

  TR04 = class
    N_Pedido: integer;
    Tipo: string;
    Numero_Serie: string;
    MF_Adicional: string;
    Modelo: string;
    Numero_Usuario: string;
    CCF: string;
    COO: string;
    Data_Inicio_Emissao: string;
    Sub_Total_Documento: string;
    Desconto: string;
    Tipo_Desconto: string;
    Acrecimo: string;
    Tipo_Acrecimo: string;
    Valor_Total: string;
    Cancelamento: string;
    Valor_Cancelamento_Acrecimo: string;
    Indicador_Acre_Desc: string;
    Adquirente: string;
    CPF_CNPJ_Adquirente: string;
    Data_Movimento: Tdate;
    Caixa: string;

  public
    function GetN_Pedido: integer;
    function GetTipo: string;
    function GetNumero_Serie: string;
    function GetMF_Adicional: string;
    function GetModelo: string;
    function GetNumero_Usuario: string;
    function GetCCF: string;
    function GetCOO: string;
    function GetData_Inicio_Emissao: string;
    function GetSub_Total_Documento: string;
    function GetDesconto: string;
    function GetTipo_Desconto: string;
    function GetAcrecimo: string;
    function GetTipo_Acrecimo: string;
    function GetValor_Total: string;
    function GetCancelamento: string;
    function GetValor_Cancelamento_Acrecimo: string;
    function GetIndicador_Acre_Desc: string;
    function GetAdquirente: string;
    function GetCPF_CNPJ_Adquirente: string;
    function GetData_Movimento: Tdate;
    function GetCaixa: string;

    property N_Ped: integer read GetN_Pedido;
    property Tip: string read GetTipo;
    property N_Serie: string read GetNumero_Serie;
    property MF_Ad: string read GetMF_Adicional;
    property Mode: string read GetModelo;
    property N_Usu: string read GetNumero_Usuario;
    property CCFF: string read GetCCF;
    property COOO: string read GetCOO;
    property Data_Ini_Emis: string read GetData_Inicio_Emissao;
    property Sub_Tot_Doc: string read GetSub_Total_Documento;
    property Desc: string read GetDesconto;
    property Tipo_Desc: string read GetTipo_Desconto;
    property Acre: string read GetAcrecimo;
    property Tipo_Acre: string read GetTipo_Acrecimo;
    property Valor_Tot: string read GetValor_Total;
    property Canc: string read GetCancelamento;
    property Valor_Canc_Acre: string read GetValor_Cancelamento_Acrecimo;
    property Indic_Acre_Desc: string read GetIndicador_Acre_Desc;
    property Adqui: string read GetAdquirente;
    property CPF_CNPJ_Adqui: string read GetCPF_CNPJ_Adquirente;
    property Data_Mov: Tdate read GetData_Movimento;
    property Caix: string read GetCaixa;

    procedure Inserir(var Registro: TR04);

    procedure Salva_Banco(var Registro: TR04);
    procedure Salva_Banco_PDV;
    procedure Salva_Banco_Aux(var Registro: TR04);
    procedure Excluir(var Registro: TR04);
  end;

  TR05 = class
    Tipo: string;
    N_Pedido: string;
    Numero_Serie: string;
    MF_Adicional: string;
    Modelo: string;
    Numero_Usuario: string;
    COO: string;
    CCF: string;
    N_Item: string;
    Codigo_Produto_Inteiro: integer;
    Codigo_Produto: string;
    Descricao: string;
    Quantidade: string;
    Unidade: string;
    Valor_Unitario: string;
    Desconto: string;
    Acrecimo: string;
    Valor_Total: string;
    Totalizador_Parcial: string;
    Cancelamento: string;
    Quantidade_Cancelada: string;
    Valor_Cancelado: string;
    Valor_Cancelamento_Acrecimo: string;
    IAT: string;
    IPPT: string;
    Casas_Decimais_Qtde: string;
    Casas_Decimais_Valor_Unitario: string;
    Data_Movimento: Tdate;
    Caixa: string;

  public
    function GetTipo: string;
    function GetN_Pedido: string;
    function GetNumero_Serie: string;
    function GetMF_Adicional: string;
    function GetModelo: string;
    function GetNumero_Usuario: string;
    function GetCOO: string;
    function GetCCF: string;
    function GetN_Item: string;
    function GetCodigo_Produto_Inteiro: integer;
    function GetCodigo_Produto: string;
    function GetDescricao: string;
    function GetQuantidade: string;
    function GetUnidade: string;
    function GetValor_Unitario: string;
    function GetDesconto: string;
    function GetAcrecimo: string;
    function GetValor_Total: string;
    function GetTotalizador_Parcial: string;
    function GetCancelamento: string;
    function GetQuantidade_Cancelada: string;
    function GetValor_Cancelado: string;
    function GetValor_Cancelamento_Acrecimo: string;
    function GetIAT: string;
    function GetIPPT: string;
    function GetCasas_Decimais_Qtde: string;
    function GetCasas_Decimais_Valor_Unitario: string;
    function GetData_Movimento: Tdate;
    function GetCaixa: string;

    function GetTipo_PDV: string;
    function GetN_Pedido_PDV: string;
    function GetNumero_Serie_PDV: string;
    function GetMF_Adicional_PDV: string;
    function GetModelo_PDV: string;
    function GetNumero_Usuario_PDV: string;
    function GetCOO_PDV: string;
    function GetCCF_PDV: string;
    function GetN_Item_PDV: string;
    function GetCodigo_Produto_Inteiro_PDV: integer;
    function GetCodigo_Produto_PDV: string;
    function GetDescricao_PDV: string;
    function GetQuantidade_PDV: string;
    function GetUnidade_PDV: string;
    function GetValor_Unitario_PDV: string;
    function GetDesconto_PDV: string;
    function GetAcrecimo_PDV: string;
    function GetValor_Total_PDV: string;
    function GetTotalizador_Parcial_PDV: string;
    function GetCancelamento_PDV: string;
    function GetQuantidade_Cancelada_PDV: string;
    function GetValor_Cancelado_PDV: string;
    function GetValor_Cancelamento_Acrecimo_PDV: string;
    function GetIAT_PDV: string;
    function GetIPPT_PDV: string;
    function GetCasas_Decimais_Qtde_PDV: string;
    function GetCasas_Decimais_Valor_Unitario_PDV: string;
    function GetData_Movimento_PDV: Tdate;
    function GetCaixa_PDV: string;

    property Tip: string read GetTipo;
    property N_Ped: string read GetN_Pedido;
    property N_Serie: string read GetNumero_Serie;
    property MF_Ad: string read GetMF_Adicional;
    property Mode: string read GetModelo;
    property N_Usu: string read GetNumero_Usuario;
    property COOO: string read GetCOO;
    property CCFF: string read GetCCF;
    property Nu_Item: string read GetN_Item;
    property Cod_Prod_Int: integer read GetCodigo_Produto_Inteiro;
    property Cod_Prod: string read GetCodigo_Produto;
    property Desc: string read GetDescricao;
    property Qtde: string read GetQuantidade;
    property Un: string read GetUnidade;
    property Valor_Un: string read GetValor_Unitario;
    property Descon: string read GetDesconto;
    property Acre: string read GetAcrecimo;
    property Valor_Tot: string read GetValor_Total;
    property Tot_Par: string read GetTotalizador_Parcial;
    property Canc: string read GetCancelamento;
    property Qtde_Canc: string read GetQuantidade_Cancelada;
    property Valor_Canc: string read GetValor_Cancelado;
    property Valor_Canc_Acre: string read GetValor_Cancelamento_Acrecimo;
    property IATT: string read GetIAT;
    property IPPTT: string read GetIPPT;
    property Casas_Dec_Qtde: string read GetCasas_Decimais_Qtde;
    property Casas_Dec_Val_Un: string read GetCasas_Decimais_Valor_Unitario;
    property Data_Mov: Tdate read GetData_Movimento;
    property Caix: string read GetCaixa;

    property Tip_PDV: string read GetTipo_PDV;
    property N_Ped_PDV: string read GetN_Pedido_PDV;
    property N_Serie_PDV: string read GetNumero_Serie_PDV;
    property MF_Ad_PDV: string read GetMF_Adicional_PDV;
    property Mode_PDV: string read GetModelo_PDV;
    property N_Usu_PDV: string read GetNumero_Usuario_PDV;
    property COOO_PDV: string read GetCOO_PDV;
    property CCFF_PDV: string read GetCCF_PDV;
    property Nu_Item_PDV: string read GetN_Item_PDV;
    property Cod_Prod_Int_PDV: integer read GetCodigo_Produto_Inteiro_PDV;
    property Cod_Prod_PDV: string read GetCodigo_Produto_PDV;
    property Desc_PDV: string read GetDescricao_PDV;
    property Qtde_PDV: string read GetQuantidade_PDV;
    property UN_PDV: string read GetUnidade_PDV;
    property Valor_Un_PDV: string read GetValor_Unitario_PDV;
    property Descon_PDV: string read GetDesconto_PDV;
    property Acre_PDV: string read GetAcrecimo_PDV;
    property Valor_Tot_PDV: string read GetValor_Total_PDV;
    property Tot_Par_PDV: string read GetTotalizador_Parcial_PDV;
    property Canc_PDV: string read GetCancelamento_PDV;
    property Qtde_Canc_PDV: string read GetQuantidade_Cancelada_PDV;
    property Valor_Canc_PDV: string read GetValor_Cancelado_PDV;
    property Valor_Canc_Acre_PDV: string
      read GetValor_Cancelamento_Acrecimo_PDV;
    property IATT_PDV: string read GetIAT_PDV;
    property IPPTT_PDV: string read GetIPPT_PDV;
    property Casas_Dec_Qtde_PDV: string read GetCasas_Decimais_Qtde_PDV;
    property Casas_Dec_Val_Un_PDV: string
      read GetCasas_Decimais_Valor_Unitario_PDV;
    property Data_Mov_PDV: Tdate read GetData_Movimento_PDV;
    property Caix_PDV: string read GetCaixa_PDV;

    procedure Inserir(var Registro: TR05);

    procedure Inserir_PDV(var Registro: TR05);

    procedure Salva_Banco(var Registro: TR05);
    procedure Salva_Banco_Aux(var Registro: TR05);

    procedure Salva_Banco_PDV(var Registro: TR05);
    procedure Salva_Banco_PDV_Aux(var Registro: TR05);

    procedure Excluir(var Registro: TR05);
    procedure ExcluirLocal(var Registro: TR05);

    procedure Alterar(var Registro: TR05);
    procedure Alterar_Aux(var Registro: TR05);

    procedure Alterar_Item(var Registro: TR05);
    procedure Alterar_Item_Aux(var Registro: TR05);
  end;

  TR07 = class
    Tipo: string;
    Numero_Serie: string;
    MF_Adicional: string;
    Modelo: string;
    Numero_Usuario: string;
    COO: string;
    CCF: string;
    GNF: string;
    Meio_Pagamento: string;
    Valor_Pago: string;
    Estorno: string;
    Valor_Estornado: string;
    Data_Movimento: Tdate;
    Caixa: string;

  public
    function GetTipo: string;
    function GetNumero_Serie: string;
    function GetMF_Adicional: string;
    function GetModelo: string;
    function GetNumero_Usuario: string;
    function GetCOO: string;
    function GetCCF: string;
    function GetGNF: string;
    function GetMeio_Pagamento: string;
    function GetValor_Pago: string;
    function GetEstorno: string;
    function GetValor_Estornado: string;
    function GetData_Movimento: Tdate;
    function GetCaixa: string;

    property Tip: string read GetTipo;
    property N_Serie: string read GetNumero_Serie;
    property MF_Ad: string read GetMF_Adicional;
    property Mode: string read GetModelo;
    property N_Usu: string read GetNumero_Usuario;
    property COOO: string read GetCOO;
    property CCFF: string read GetCCF;
    property GNFF: string read GetGNF;
    property Meio_Pag: string read GetMeio_Pagamento;
    property Valor_PG: string read GetValor_Pago;
    property Estor: string read GetEstorno;
    property Valor_Estor: string read GetValor_Estornado;
    property Data_Mov: Tdate read GetData_Movimento;
    property Caix: string read GetCaixa;

    procedure Inserir(var Registro: TR07);

    procedure Inserir_Outros(var Registro: TR07);
    procedure Inserir_Outros_Aux(var Registro: TR07);

    procedure Salva_Banco(var Registro: TR07);
    procedure Salva_Banco_Aux(var Registro: TR07);
    procedure Excluir(var Registro: TR07);
  end;

  TR06 = class
    Tipo: string;
    Numero_Serie: string;
    MF_Adicional: string;
    Modelo: string;
    Numero_Usuario: string;
    COO: string;
    GNF: string;
    GRG: string;
    CDC: string;
    Denominacao: string;
    Data_Final_Emissao: string;
    Hora_Final_Emissao: string;
    Data_Movimento: Tdate;
    Caixa: string;

  public
    function GetTipo: string;
    function GetNumero_Serie: string;
    function GetMF_Adicional: string;
    function GetModelo: string;
    function GetNumero_Usuario: string;
    function GetCOO: string;
    function GetGNF: string;
    function GetGRG: string;
    function GetCDC: string;
    function GetDenominacao: string;
    function GetData_Final_Emissao: string;
    function GetHora_Final_Emissao: string;
    function GetData_Movimento: Tdate;
    function GetCaixa: string;

    property Tip: string read GetTipo;
    property N_Serie: string read GetNumero_Serie;
    property MF_Ad: string read GetMF_Adicional;
    property Mode: string read GetModelo;
    property N_Usu: string read GetNumero_Usuario;
    property COOO: string read GetCOO;
    property GNFF: string read GetGNF;
    property GRGG: string read GetGRG;
    property CDCC: string read GetCDC;
    property Denom: string read GetDenominacao;
    property Data_Final_Emis: string read GetData_Final_Emissao;
    property Hora_Final_Emis: string read GetHora_Final_Emissao;
    property Data_Mov: Tdate read GetData_Movimento;
    property Caix: string read GetCaixa;

    procedure Inserir(var Registro: TR06);
    procedure Inserir_Outros(var Registro: TR06);
    procedure Inserir_Outros_Aux(var Registro: TR06);

    procedure Salva_Banco(var Registro: TR06);
    procedure Salva_Banco_Aux(var Registro: TR06);
    procedure Excluir(var Registro: TR06);
  end;

  TPedido = class
    Codigo: integer;
    N_Pedido: string;
    N_Pre_Venda: string;
    COO: string;
    COO_Vinculado: string;
    CCF: string;
    Codigo_Cliente: integer;
    Codigo_Empresa: integer;
    Codigo_Veiculo: integer;
    Codigo_Funcionario: integer;
    Codigo_Tabela_Preco: integer;
    Codigo_Cond_Pag: integer;
    Data_Venda: Tdate;
    Data_Previsao_Entrega: Tdate;
    Data_Vencimento: Tdate;
    Hora_Entrega: string;
    Qtde_Itens: integer;
    Qtde_Servicos: integer;
    Total_Produtos: double;
    Total_Servicos: double;
    Total_Desc_Acr: double;
    Desc_Acr: double;
    Tipo_Desc_Acr: string;
    Total_Pedido: double;
    Valor_Recebido: double;
    Troco: double;
    Observacoes: string;
    Mesclada: integer;
    Problema_Reclamado: string;
    Problema_Constatado: string;
    Solucao: string;
    DAVC: string;
    DAVAnt: String;
    Status: String;
    Observacao: string;
    Hora_Venda: string;

  public
    function GetCodigo: integer; //
    function GetN_Pedido: string; //
    function GetN_Pre_Venda: string; //
    function GetCOO: string; //
    function GetCOO_Vinculado: string; //
    function GetCCF: string; //
    function GetCodigo_Cliente: integer; //
    function GetCodigo_Empresa: integer; //
    function GetCodigo_Veiculo: integer; //
    function GetCodigo_Funcionario: integer; //
    function GetCodigo_Tabela_Preco: integer; //
    function GetCodigo_Forma_Pag: integer; //
    function GetData_Venda: Tdate; //
    function GetHora_Venda: string; //
    function GetData_Vencimento: Tdate; //
    function GetQtde_Itens: integer; //
    function GetQtde_Servicos: integer; //
    function GetTotal_Produtos: double; //
    function GetTotal_Servicos: double; //
    function GetTotal_Desc_Acr: double; //
    function GetDesc_Acr: double; //
    function GetTipo_Desc_Acr: string; //
    function GetTotal_Pedido: double; //
    function GetValor_Recebido: double; //
    function GetTroco: double; //
    function GetMesclada: integer; //
    function GetProblema_Reclamado: string; //
    function GetProblema_Constatado: string; //
    function GetSolucao: string; //
    function GetDAVC: string; //
    function GetDAVAnt: string; //
    function GetStatus: string; //
    function GetObservacao: string; //

    function GetCodigo_PDV: integer;
    function GetN_Pedido_PDV: string;
    function GetCOO_PDV: string;
    function GetCOO_Vinculado_PDV: string;
    function GetCodigo_Cliente_PDV: integer;
    function GetCodigo_Empresa_PDV: integer;
    function GetCodigo_Funcionario_PDV: integer;
    function GetCodigo_Tabela_Preco_PDV: integer;
    function GetData_Venda_PDV: Tdate;
    function GetQtde_Itens_PDV: integer;
    function GetTotal_Produtos_PDV: double;
    function GetDesc_Acr_PDV: double;
    function GetTipo_Desc_Acr_PDV: string;
    function GetTotal_Pedido_PDV: double;
    function GetValor_Recebido_PDV: double;
    function GetTroco_PDV: double;
    function GetMesclada_PDV: integer;
    function GetProblema_Reclamado_PDV: string;
    function GetProblema_Constatado_PDV: string;
    function GetSolucao_PDV: string;
    function GetDAVC_PDV: string;
    function GetDAVAnt_PDV: string;

    property Cod: integer read GetCodigo;
    property N_Ped: string read GetN_Pedido;
    property N_Pre_Ven: string read GetN_Pre_Venda;
    property COOO: string read GetCOO;
    property COOO_Vin: string read GetCOO_Vinculado;
    property CCFF: string read GetCCF;
    property Cod_Cli: integer read GetCodigo_Cliente;
    property Cod_Empresa: integer read GetCodigo_Empresa;
    property Cod_Veiculo: integer read GetCodigo_Veiculo;
    property Cod_Funcionario: integer read GetCodigo_Funcionario;
    property Cod_Tabela_Preco: integer read GetCodigo_Tabela_Preco;
    property Cod_Forma_Pag: integer read GetCodigo_Forma_Pag;
    property Data_Ve: Tdate read GetData_Venda;
    property Data_Venc: Tdate read GetData_Vencimento;
    property Qtde_It: integer read GetQtde_Itens;
    property Qtde_Serv: integer read GetQtde_Servicos;
    property Tot_Prod: double read GetTotal_Produtos;
    property Tot_Serv: double read GetTotal_Servicos;
    property Tot_Desc_Acr: double read GetTotal_Desc_Acr;
    property Desc_Acr_Pedido: double read GetDesc_Acr;
    property Tipo_Desc_Acr_Pedido: string read GetTipo_Desc_Acr;
    property Tot_Ped: double read GetTotal_Pedido;
    property Val_Rec: double read GetValor_Recebido;
    property Troc: double read GetTroco;
    property Mesc: integer read GetMesclada;
    property Problema_Rec: string read GetProblema_Reclamado;
    property Problema_Const: string read GetProblema_Constatado;
    property Soluc: string read GetSolucao;
    property DAVCC: string read GetDAVC;
    property DAVAntt: string read GetDAVAnt;
    property Stat: string read GetStatus;
    property Obss: string read GetObservacao;
    property Hora_Ven: string read GetHora_Venda;

    property Cod_PDV: integer read GetCodigo_PDV;
    property N_Ped_PDV: string read GetN_Pedido_PDV;
    property COOO_PDV: string read GetCOO_PDV;
    property COOO_Vin_PDV: string read GetCOO_Vinculado_PDV;
    property Cod_Cli_PDV: integer read GetCodigo_Cliente_PDV;
    property Cod_Empresa_PDV: integer read GetCodigo_Empresa_PDV;
    property Cod_Funcionario_PDV: integer read GetCodigo_Funcionario_PDV;
    property Cod_Tabela_Preco_PDV: integer read GetCodigo_Tabela_Preco_PDV;
    property Data_Ve_PDV: Tdate read GetData_Venda_PDV;
    property Qtde_It_PDV: integer read GetQtde_Itens_PDV;
    property Tot_Prod_PDV: double read GetTotal_Produtos_PDV;
    property Desc_Acr_PDV: double read GetDesc_Acr_PDV;
    property Tipo_Desc_Acr_PDV: string read GetTipo_Desc_Acr_PDV;
    property Tot_Ped_PDV: double read GetTotal_Pedido_PDV;
    property Val_Rec_PDV: double read GetValor_Recebido_PDV;
    property Troc_PDV: double read GetTroco_PDV;
    property Mesc_PDV: integer read GetMesclada_PDV;
    property Problema_Rec_PDV: string read GetProblema_Reclamado_PDV;
    property Problema_Const_PDV: string read GetProblema_Constatado_PDV;
    property Soluc_PDV: string read GetSolucao_PDV;
    property DAVCC_PDV: string read GetDAVC_PDV;
    property DAVAntt_PDV: string read GetDAVAnt_PDV;

    procedure Alterar(var Registro: TPedido);
    procedure Salva_Banco(lOUs: Ansistring; Tipo_Op: Ansistring;
      Codigo: integer; N_Pedido: Ansistring; N_Pre_Venda: Ansistring;
      COO: Ansistring; COO_Vin: Ansistring; CCF: Ansistring;
      Codigo_Cliente: integer; Codigo_Empresa: integer; Codigo_Veiculo: integer;
      Codigo_Funcionario: integer; Codigo_Tabela_Preco: integer;
      Codigo_Forma_Pag: integer; Data_Venda: Tdate; Data_Vencimento: Tdate;
      Qtde_Itens: integer; Qtde_Servicos: integer; Total_Produtos: double;
      Total_Servicos: double; Total_Desc_Acr: double; Desc_Acr: double;
      Tipo_Desc_Acr: Ansistring; Total_Pedido: double; Tipo: Ansistring;
      Status: Ansistring; Status_OS: Ansistring; Valor_Recebido: double;
      Troco: double; Mesclada: integer; Problema_Reclamado: Ansistring;
      Problema_Constatado: Ansistring; Solucao: Ansistring; DAVC: Ansistring;
      DAVAnt: Ansistring; Chave_NFe: Ansistring; Protocolo_NFe: Ansistring;
      N_Nota_Fiscal: integer; Observacao: Ansistring; Hora_Venda: Ansistring;
      Atualizou_Orcamento_Vencido: integer; Data_Previsao_Entrega: Tdate;
      Data_Entrega: Tdate; Kilometragem: double; ECF: Ansistring;
      Codigo_CFOP: integer; Total_Impostos: double; DataEmissaoNFe: TDateTime;
      var Conexao: TADOConnection);

    procedure Excluir(var Registro: TPedido; var Conexao: TADOConnection);
    procedure ExcluirLocal(var Registro: TPedido);
    procedure Inserir(var Registro: TPedido);
    procedure Alterar_Pedido(COO, COO_Vin, CCF: Ansistring);

    procedure Alterar_PDV(var Registro: TPedido);
    procedure Salva_Banco_PDV(var Registro: TPedido);
    procedure Excluir_PDV(var Registro: TPedido);
    procedure Inserir_PDV(var Registro: TPedido);
  end;

  TItens_Pedido = class

    procedure Atualiza_Itens(var Registro: TItens_Pedido;
      Conexao: TADOConnection);

    procedure Salva_Banco(var Conexao: TADOConnection; lOUs: Ansistring;
      Tipo_Op: Ansistring; Codigo: integer; N_Item: Ansistring;
      Codigo_Produto: integer; Codigo_Venda: Ansistring; Descricao: Ansistring;
      NCM: Ansistring; Origem: Ansistring; CFOP: Ansistring; Un: Ansistring;
      Tipo_Calculo_BC_ICMS: Ansistring; Tipo_Recolhimento: Ansistring;
      ICMS: Ansistring; CST: Ansistring; CSOSN: Ansistring;
      Base_Reduzida: Ansistring; BC: Ansistring; Valor_ICMS: Ansistring;
      Tipo_Calculo_BC_ICMS_ST: Ansistring; MVAST: Ansistring;
      ICMST_ST: Ansistring; CST_ST: Ansistring; Base_Reduzida_ST: Ansistring;
      Base_Acrescida_ST: Ansistring; BC_ST: Ansistring; Valor_ICMS_ST: double;
      Aliquota_Calculo_Credito: Ansistring; Credito_ICMS: Ansistring;
      Tipo_Calculo_IPI: Ansistring; IPI: Ansistring; CST_IPI: Ansistring;
      Base_Reduzida_IPI: Ansistring; Base_Acrescida_IPI: Ansistring;
      BC_IPI: Ansistring; Valor_IPI: double; Tipo_Calculo_PIS: Ansistring;
      PIS: Ansistring; CST_PIS: Ansistring; Base_Reduzida_PIS: Ansistring;
      Base_Acrescida_PIS: Ansistring; BC_PIS: Ansistring; Valor_PIS: double;
      Tipo_Calculo_COFINS: Ansistring; COFINS: Ansistring;
      CST_COFINS: Ansistring; Base_Reduzida_COFINS: Ansistring;
      Base_Acrescida_COFINS: Ansistring; BC_COFINS: Ansistring;
      Valor_COFINS: double; Qtde: double; Qtde_Entregue: double;
      Qtde_Restante: double; Qtde_S_Previsao: double; Valor_Compra: double;
      Valor_Original: double; Valor_Unitario: double; Desc_Acr: double;
      Desc_Acr_P: double; Tipo_Desc_Acr: Ansistring; dOUa: Ansistring;
      Valor_Frete: double; Valor_Seguro: double; Outras_Despesas: double;
      Sub_Total: double; Sub_Total_Liquido: double; Cancelado: Ansistring;
      Indica_Valor_Total: Ansistring; Data_Entrega: Tdate;
      Hora_Entrega: Ansistring; Tipo_Venda: Ansistring;
      Tipo_Entrega: Ansistring; Comissao: double; Perc_Desc_Vista: double;
      Perc_Desc_Prazo: double; Permite_Credito: integer;
      Codigo_Obs_Fiscal: integer; Qtde_Estoque_Atual: double;
      Valor_Compra_Nota: double);

    procedure Salva_Banco_PDV(var Registro: TItens_Pedido);
    procedure Excluir(Codigo: integer; var Conexao: TADOConnection);
    procedure ExcluirLocal(var Registro: TItens_Pedido);
  end;

  TItens_OS = class
    Codigo: integer;
    Codigo_Servico: integer;
    Valor_Unitario: double;
    Desconto: double;
    Tipo_Desconto: string;
    Sub_Total: double;
  private
    function GetN_Pedido: string;

  public
    function GetCodigo: integer;
    function GetCodigo_Servico: integer;
    function GetValor_Unitario: double;
    function GetDesconto: double;
    function GetTipo_Desconto: string;
    function GetSub_Total: double;

    property Cod: integer read GetCodigo;
    property Cod_Serv: integer read GetCodigo_Servico;
    property Valor_Un: double read GetValor_Unitario;
    property Desc: double read GetDesconto;
    property Tipo_Desc: string read GetTipo_Desconto;
    property Sub_Tot: double read GetSub_Total;

    procedure Inserir(var Registro: TItens_OS);
    procedure Salva_Banco(var Registro: TItens_OS);
    procedure Excluir(var Registro: TItens_OS; var Conexao: TADOConnection);
  end;

  TMovimentacao_Manual = class
    Codigo: integer;
    Codigo_Empresa: integer;
    Codigo_Funcionario: integer;
    Codigo_Cliente: integer;
    Data_Emissao: Tdate;
    N_Ordem: string;
    Modelo: string;
    N_Serie: string;
    Caixa: string;
    Total_Produtos: double;
    Desconto: double;
    Tipo_Desconto: string;
    Total_Pedido: double;
    Observacao: string;

  public
    function GetCodigo: integer;
    function GetCodigo_Empresa: integer;
    function GetCodigo_Funcionario: integer;
    function GetCodigo_Cliente: integer;
    function GetData_Emissao: Tdate;
    function GetN_Ordem: string;
    function GetModelo: string;
    function GetN_Serie: string;
    function GetCaixa: string;
    function GetTotal_Produtos: double;
    function GetDesconto: double;
    function GetTipo_Desconto: string;
    function GetTotal_Pedido: double;
    function GetObservacao: string;

    property Cod: integer read GetCodigo;
    property Cod_Empresa: integer read GetCodigo_Empresa;
    property Cod_Funcionario: integer read GetCodigo_Funcionario;
    property Cod_Cliente: integer read GetCodigo_Cliente;
    property Data_Emis: Tdate read GetData_Emissao;
    property N_Ord: string read GetN_Ordem;
    property Model: string read GetModelo;
    property N_Ser: string read GetN_Serie;
    property Cai: string read GetCaixa;
    property Total_Prod: double read GetTotal_Produtos;
    property Desc: double read GetDesconto;
    property Tipo_Desc: string read GetTipo_Desconto;
    property Total_Ped: double read GetTotal_Pedido;
    property Obs: string read GetObservacao;

    procedure Alterar(var Registro: TMovimentacao_Manual);
    procedure Excluir(var Registro: TMovimentacao_Manual);
    procedure Inserir(var Registro: TMovimentacao_Manual);
  end;

  TItens_Movimentacao_Manual = class
    Codigo: integer;
    Sequencia: string;
    Codigo_Produto: integer;
    Un: string;

    ICMS: string;
    CST: string;
    Base_Reduzida: string;
    Base_Acrescida: string;
    BC: string;
    Valor_ICMS: double;

    IPI: string;
    CST_IPI: string;
    Base_Reduzida_IPI: string;
    Base_Acrescida_IPI: string;
    BC_IPI: string;
    Valor_IPI: double;

    PIS: string;
    CST_PIS: string;
    Base_Reduzida_PIS: string;
    Base_Acrescida_PIS: string;
    BC_PIS: string;
    Valor_PIS: double;

    COFINS: string;
    CST_COFINS: string;
    Base_Reduzida_COFINS: string;
    Base_Acrescida_COFINS: string;
    BC_COFINS: string;
    Valor_COFINS: double;

    Valor_Unitario: double;
    Quantidade: double;
    Desconto: double;
    Tipo_Desconto: string;
    Sub_Total: double;
    Sub_Total_Liquido: double;

  public
    function GetCodigo: integer;
    function GetSequencia: string;
    function GetCodigo_Produto: integer;
    function GetUN: string;

    function GetICMS: string;
    function GetCST: string;
    function GetBase_Reduzida: string;
    function GetBase_Acrescida: string;
    function GetBC: string;
    function GetValor_ICMS: double;

    function GetIPI: string;
    function GetCST_IPI: string;
    function GetBase_Reduzida_IPI: string;
    function GetBase_Acrescida_IPI: string;
    function GetBC_IPI: string;
    function GetValor_IPI: double;

    function GetPIS: string;
    function GetCST_PIS: string;
    function GetBase_Reduzida_PIS: string;
    function GetBase_Acrescida_PIS: string;
    function GetBC_PIS: string;
    function GetValor_PIS: double;

    function GetCOFINS: string;
    function GetCST_COFINS: string;
    function GetBase_Reduzida_COFINS: string;
    function GetBase_Acrescida_COFINS: string;
    function GetBC_COFINS: string;
    function GetValor_COFINS: double;

    function GetValor_Unitario: double;
    function GetQuantidade: double;
    function GetDesconto: double;
    function GetTipo_Desconto: string;
    function GetSub_Total: double;
    function GetSub_Total_Liquido: double;

    property Cod: integer read GetCodigo;
    property Seq: string read GetSequencia;
    property Cod_Prod: integer read GetCodigo_Produto;
    property UNN: string read GetUN;

    property ICMSS: string read GetICMS;
    property CSTT: string read GetCST;
    property Bas_Reduzida: string read GetBase_Reduzida;
    property Bas_Acrescida: string read GetBase_Acrescida;
    property BCC: string read GetBC;
    property Val_ICMS: double read GetValor_ICMS;

    property IPII: string read GetIPI;
    property CSTT_IPI: string read GetCST_IPI;
    property Bas_Reduzida_IPI: string read GetBase_Reduzida_IPI;
    property Bas_Acrescida_IPI: string read GetBase_Acrescida_IPI;
    property BCC_IPI: string read GetBC_IPI;
    property Val_IPI: double read GetValor_IPI;

    property PISS: string read GetPIS;
    property CSTT_PIS: string read GetCST_PIS;
    property Bas_Reduzida_PIS: string read GetBase_Reduzida_PIS;
    property Bas_Acrescida_PIS: string read GetBase_Acrescida_PIS;
    property BCC_PIS: string read GetBC_PIS;
    property Val_PIS: double read GetValor_PIS;

    property COFINSS: string read GetCOFINS;
    property CSTT_COFINS: string read GetCST_COFINS;
    property Bas_Reduzida_COFINS: string read GetBase_Reduzida_COFINS;
    property Bas_Acrescida_COFINS: string read GetBase_Acrescida_COFINS;
    property BCC_COFINS: string read GetBC_COFINS;
    property Val_COFINS: double read GetValor_COFINS;

    property Valor_Un: double read GetValor_Unitario;
    property Qtde: double read GetQuantidade;
    property Desc: double read GetDesconto;
    property Tipo_Desc: string read GetTipo_Desconto;
    property Sub_Tot: double read GetSub_Total;
    property Sub_Tot_Liquido: double read GetSub_Total_Liquido;

    procedure Inserir(var Registro: TItens_Movimentacao_Manual);
    procedure Alterar(var Registro: TItens_Movimentacao_Manual);
    procedure Excluir(var Registro: TItens_Movimentacao_Manual);
    procedure Excluir_Item(var Registro: TItens_Movimentacao_Manual);
  end;

  TCadastro_CFOP = class
    Codigo: integer;
    CFOP: string;
    Descricao: string;
    Data_Cadastro: Tdate;

  public
    function GetCodigo: integer;
    function GetCFOP: string;
    function GetDescricao: string;
    function GetData_Cadastro: Tdate;

    property Cod: integer read GetCodigo;
    property CFO: string read GetCFOP;
    property Desc: string read GetDescricao;
    property Data_Cad: Tdate read GetData_Cadastro;

    procedure Inserir(var Registro: TCadastro_CFOP);
    procedure Alterar(var Registro: TCadastro_CFOP);
    procedure Excluir(var Registro: TCadastro_CFOP);
  end;

  TCadastro_Situacao_Tributaria = class
    Codigo: integer;
    Origem: integer;
    Codigo_Situacao: string;
    Descricao: string;
    Data_Cadastro: Tdate;

  public
    function GetCodigo: integer;
    function GetOrigem: integer;
    function GetCodigo_Situacao: string;
    function GetDescricao: string;
    function GetData_Cadastro: Tdate;

    property Cod: integer read GetCodigo;
    property Orig: integer read GetOrigem;
    property Codigo_Sit: string read GetCodigo_Situacao;
    property Desc: string read GetDescricao;
    property Data_Cad: Tdate read GetData_Cadastro;

    procedure Inserir(var Registro: TCadastro_Situacao_Tributaria);
    procedure Alterar(var Registro: TCadastro_Situacao_Tributaria);
    procedure Excluir(var Registro: TCadastro_Situacao_Tributaria);
  end;

  TControla_Codigo = class
    Codigo: integer;

    function GetCodigo: integer;

    property Cod: integer read GetCodigo;

    procedure Inserir(var Registro: TControla_Codigo);
    procedure Excluir_Local;

  end;

  TCompra = class
    Codigo: integer;
    N_Pedido: integer;
    Data_Pedido: Tdate;
    Hora_Pedido: string;
    Data_Previsao_Entrega: Tdate;
    Codigo_Fornecedor: integer;
    Codigo_Condicao_Pagamento: integer;
    Codigo_Funcionario: integer;
    Codigo_Empresa: integer;
    Tipo_Frete: string;
    Valor_Frete: double;
    Outras_Despesas: double;
    Qtde_Itens: integer;
    Total_Produtos: double;
    Peso_Total: double;
    Desconto: double;
    Tipo_Desconto: string;
    Total_Pedido: double;
    Status: string;
    Observacoes: string;

  public
    function GetCodigo: integer;
    function GetN_Pedido: integer;
    function GetData_Pedido: Tdate;
    function GetHora_Pedido: string;
    function GetData_Previsao_Entrega: Tdate;
    function GetCodigo_Fornecedor: integer;
    function GetCodigo_Condicao_Pagamento: integer;
    function GetCodigo_Funcionario: integer;
    function GetCodigo_Empresa: integer;
    function GetTipo_Frete: string;
    function GetValor_Frete: double;
    function GetOutras_Despesas: double;
    function GetQtde_Itens: integer;
    function GetTotal_Produtos: double;
    function GetPeso_Total: double;
    function GetDesconto: double;
    function GetTipo_Desconto: string;
    function GetTotal_Pedido: double;
    function GetStatus: string;
    function GetObservacoes: string;

    property Cod: integer read GetCodigo;
    property N_Ped: integer read GetN_Pedido;
    property Data_Ped: Tdate read GetData_Pedido;
    property Hora_Ped: string read GetHora_Pedido;
    property Data_Prev_Entrega: Tdate read GetData_Previsao_Entrega;
    property Cod_Forn: integer read GetCodigo_Fornecedor;
    property Cod_Cond_Pag: integer read GetCodigo_Condicao_Pagamento;
    property Cod_Fun: integer read GetCodigo_Funcionario;
    property Cod_Empresa: integer read GetCodigo_Empresa;
    property Tipo_Fre: string read GetTipo_Frete;
    property Valor_Fre: double read GetValor_Frete;
    property Outras_Desp: double read GetOutras_Despesas;
    property Qtde_It: integer read GetQtde_Itens;
    property Total_Prod: double read GetTotal_Produtos;
    property Peso_Tot: double read GetPeso_Total;
    property Desc: double read GetDesconto;
    property Tipo_Desc: string read GetTipo_Desconto;
    property Total_Ped: double read GetTotal_Pedido;
    property Stat: string read GetStatus;
    property Obs: string read GetObservacoes;

    procedure Inserir(var Registro: TCompra);
    procedure Alterar(var Registro: TCompra);
    procedure Excluir(var Registro: TCompra);
  end;

  TItens_Compra = class
    Codigo: integer;
    N_Pedido: integer;
    Codigo_Produto: integer;
    Qtde: double;
    Qtde_Recebida: double;
    Qtde_Restante: double;
    Valor_Unitario: double;
    Desconto: double;
    Tipo_Desconto: string;
    Sub_Total: double;
    Status: string;

  public
    function GetCodigo: integer;
    function GetN_Pedido: integer;
    function GetCodigo_Produto: integer;
    function GetCodigo_Produto_Selecionado: integer;
    function GetQtde: double;
    function GetQtde_Recebida: double;
    function GetQtde_Restante: double;
    function GetValor_Unitario: double;
    function GetDesconto: double;
    function GetTipo_Desconto: string;
    function GetSub_Total: double;
    function GetStatus: string;

    property Cod: integer read GetCodigo;
    property N_Ped: integer read GetN_Pedido;
    property Cod_Prod: integer read GetCodigo_Produto;
    property Cod_Prod_Selecionado: integer read GetCodigo_Produto_Selecionado;
    property Qtd: double read GetQtde;
    property Qtd_Rec: double read GetQtde_Recebida;
    property Qtd_Res: double read GetQtde_Restante;
    property Valor_Un: double read GetValor_Unitario;
    property Desc: double read GetDesconto;
    property Tipo_Desc: string read GetTipo_Desconto;
    property Sub_Tot: double read GetSub_Total;
    property Stat: string read GetStatus;

    procedure Inserir(var Registro: TItens_Compra);
    procedure Excluir(var Registro: TItens_Compra);
    procedure Excluir_Selecionado(var Registro: TItens_Compra);
  end;

  TRetorno_Cotacao = class
    Codigo: integer;
    N_Cotacao: integer;
    Data_Cotacao: Tdate;
    Data_Retorno: Tdate;
    Prazo_Entrega: integer;
    Codigo_Fornecedor: integer;
    Codigo_Condicao_Pagamento: integer;
    Codigo_Funcionario: integer;
    Codigo_Empresa: integer;
    Tipo_Frete: string;
    Valor_Frete: double;
    Outras_Despesas: double;
    Qtde_Itens: integer;
    Total_Produtos: double;
    Peso_Total: double;
    Desconto: double;
    Tipo_Desconto: string;
    Total_Pedido: double;
    Observacoes: string;

  public
    function GetCodigo: integer;
    function GetN_Cotacao: integer;
    function GetData_Cotacao: Tdate;
    function GetData_Retorno: Tdate;
    function GetPrazo_Entrega: integer;
    function GetCodigo_Fornecedor: integer;
    function GetCodigo_Condicao_Pagamento: integer;
    function GetCodigo_Funcionario: integer;
    function GetCodigo_Empresa: integer;
    function GetTipo_Frete: string;
    function GetValor_Frete: double;
    function GetOutras_Despesas: double;
    function GetQtde_Itens: integer;
    function GetTotal_Produtos: double;
    function GetPeso_Total: double;
    function GetDesconto: double;
    function GetTipo_Desconto: string;
    function GetTotal_Pedido: double;
    function GetObservacoes: string;

    property Cod: integer read GetCodigo;
    property N_Cot: integer read GetN_Cotacao;
    property Data_Cot: Tdate read GetData_Cotacao;
    property Data_Ret: Tdate read GetData_Retorno;
    property Pr_Entrega: integer read GetPrazo_Entrega;
    property Cod_Forn: integer read GetCodigo_Fornecedor;
    property Cod_Cond_Pag: integer read GetCodigo_Condicao_Pagamento;
    property Cod_Fun: integer read GetCodigo_Funcionario;
    property Cod_Empresa: integer read GetCodigo_Empresa;
    property Tipo_Fre: string read GetTipo_Frete;
    property Valor_Fre: double read GetValor_Frete;
    property Outras_Desp: double read GetOutras_Despesas;
    property Qtde_It: integer read GetQtde_Itens;
    property Total_Prod: double read GetTotal_Produtos;
    property Peso_Tot: double read GetPeso_Total;
    property Desc: double read GetDesconto;
    property Tipo_Desc: string read GetTipo_Desconto;
    property Total_Ped: double read GetTotal_Pedido;
    property Obs: string read GetObservacoes;

    procedure Inserir(var Registro: TRetorno_Cotacao);
    procedure Alterar(var Registro: TRetorno_Cotacao);
    procedure Excluir(var Registro: TRetorno_Cotacao);
  end;

  TItens_Retorno_Cotacao = class
    Codigo: integer;
    N_Cotacao: integer;
    Codigo_Produto: integer;
    Qtde: double;
    Valor_Unitario: double;
    Desconto: double;
    Tipo_Desconto: string;
    Sub_Total: double;

  public
    function GetCodigo: integer;
    function GetN_Cotacao: integer;
    function GetCodigo_Produto: integer;
    function GetQtde: double;
    function GetValor_Unitario: double;
    function GetDesconto: double;
    function GetTipo_Desconto: string;
    function GetSub_Total: double;

    property Cod: integer read GetCodigo;
    property N_Cot: integer read GetN_Cotacao;
    property Cod_Prod: integer read GetCodigo_Produto;
    property Qtd: double read GetQtde;
    property Valor_Un: double read GetValor_Unitario;
    property Desc: double read GetDesconto;
    property Tipo_Desc: string read GetTipo_Desconto;
    property Sub_Tot: double read GetSub_Total;

    procedure Inserir(var Registro: TItens_Retorno_Cotacao);
    procedure Excluir(var Registro: TItens_Retorno_Cotacao);
    procedure Excluir_Selecionado(var Registro: TItens_Retorno_Cotacao);
  end;

  TCotacao = class
    N_Cotacao: integer;
    Codigo_Empresa: integer;
    Codigo_Funcionario: integer;
    Data_Cotacao: Tdate;
    Hora_Cotacao: string;
    Data_Vencimento: Tdate;
    Qtde_Itens: double;

  public
    function GetN_Cotacao: integer;
    function GetCodigo_Empresa: integer;
    function GetCodigo_Funcionario: integer;
    function GetData_Cotacao: Tdate;
    function GetHora_Cotacao: string;
    function GetData_Vencimento: Tdate;
    function GetQtde_Itens: double;

    property N_Cot: integer read GetN_Cotacao;
    property Cod_Empresa: integer read GetCodigo_Empresa;
    property Cod_Funcionario: integer read GetCodigo_Funcionario;
    property Data_Cot: Tdate read GetData_Cotacao;
    property Hora_Cot: string read GetHora_Cotacao;
    property Data_Venc: Tdate read GetData_Vencimento;
    property Qtde: double read GetQtde_Itens;

    procedure Inserir(var Registro: TCotacao);
    procedure Alterar(var Registro: TCotacao);
    procedure Excluir(var Registro: TCotacao);
  end;

  TItens_Cotacao = class
    N_Cotacao: integer;
    Codigo_Produto: integer;
    Qtde: double;

  public
    function GetN_Cotacao: integer;
    function GetCodigo_Produto: integer;
    function GetCodigo_Produto_Selecionado: integer;
    function GetQtde: double;

    property N_Cot: integer read GetN_Cotacao;
    property Cod_Prod: integer read GetCodigo_Produto;
    property Cod_Prod_Sel: integer read GetCodigo_Produto_Selecionado;
    property Qtd: double read GetQtde;

    procedure Inserir(var Registro: TItens_Cotacao);
    procedure Excluir(var Registro: TItens_Cotacao);
    procedure Excluir_Selecionado(var Registro: TItens_Cotacao);
  end;

  TConciliacao_Compra = class
    N_Pedido: integer;
    Codigo_Produto: integer;
    Qtde_Solicitada: double;
    Qtde_Recebida: double;
    Qtde_Restante: double;
    Valor_Unitario: double;
    Valor_Total_Recebido: double;
    Valor_Total_Restante: double;

  public
    function GetN_Pedido: integer;
    function GetCodigo_Produto: integer;
    function GetQtde_Solicitada: double;
    function GetQtde_Recebida: double;
    function GetQtde_Restante: double;
    function GetValor_Unitario: double;
    function GetValor_Total_Recebido: double;
    function GetValor_Total_Restante: double;

    property N_Ped: integer read GetN_Pedido;
    property Cod_Prod: integer read GetCodigo_Produto;
    property Qtde_Sol: double read GetQtde_Solicitada;
    property Qtde_Rec: double read GetQtde_Recebida;
    property Qtde_Res: double read GetQtde_Restante;
    property Valor_Un: double read GetValor_Unitario;
    property Valor_Total_Rec: double read GetValor_Total_Recebido;
    property Valor_Total_Res: double read GetValor_Total_Restante;

    procedure Inserir(var Registro: TConciliacao_Compra);
    procedure Excluir(var Registro: TConciliacao_Compra);
  end;

  TConfiguracao_Sistema = class
    Codigo_Empresa: integer;
    Caminho_ECF: string;
    Mensagem_Cupom: string;
    Porta_Comunicacao: string;
    Perfil_Arquivo_Fiscal: string;
    Codigo_Tipo_Atividade: string;
    Tipo_Atividade: string;
    Versao_EFD: string;
    Ambiente: string;
    Tipo_Impressao: string;
    Finalidade: string;
    Tipo_Emissao: string;
    Logomarca: string;
    Salvar_XML: string;
    WebService_UF_1_Producao: string;
    WebService_UF_1_Homologacao: string;
    WebService_UF_2_Producao: string;
    WebService_UF_2_Homologacao: string;
    Codigo_Tabela_Preco_Padrao: integer;
    Avisa_Tabela_Preco: string;
    Avisa_Lancamento_Financeiro: string;
    Avisa_Cheque: string;
    Avisa_Pedido_Compra_Pendente: string;
    Avisa_Aniversario_Cliente: string;
    Avisa_Aniversario_Funcionario: string;
    Avisa_Produto_Vencido: string;
    Fazer_Backup: string;
    Avisa_Conta_Fixa: string;
    Cotacao_Preco: string;
    Dias_Aviso: integer;
    Tempo_Atualizacao: integer;
    CFOP_V_D: string;
    CFOP_V_F: string;
    ISSQN: string;
    Codigo_Tipo_Documento: integer;
    Codigo_Departamento: integer;
    Codigo_Plano_Financeiro: integer;
    Historico: String;
  private
    function GetCodigo_Departamento_Pagar: integer;
    function GetCodigo_Plano_Financeiro_Pagar: integer;
    function GetCodigo_Tipo_Documento_Pagar: integer;
    function GetHistorico_Pagar: string;
  published

  public
    function GetCodigo_Empresa: integer;
    function GetCaminho_ECF: string;
    function GetMensagem_Cupom: string;
    function GetPorta_Comunicacao: string;
    function GetPerfil_Arquivo_Fiscal: string;
    function GetCodigo_Tipo_Atividade: string;
    function GetTipo_Atividade: string;
    function GetVersao_EFD: string;
    function GetAmbiente: string;
    function GetTipo_Impressao: string;
    function GetTipo_Emissao: string;
    function GetLogomarca: string;
    function GetSalvar_XML: string;
    function GetWebService_UF_1_Producao: string;
    function GetWebService_UF_1_Homologacao: string;
    function GetWebService_UF_2_Producao: string;
    function GetWebService_UF_2_Homologacao: string;
    function GetCodigo_Tabela_Preco_Padrao: integer;
    function GetAvisa_Tabela_Preco: string;
    function GetAvisa_Lancamento_Financeiro: string;
    function GetAvisa_Cheque: string;
    function GetAvisa_Pedido_Compra_Pendente: string;
    function GetAvisa_Aniversario_Cliente: string;
    function GetAvisa_Aniversario_Funcionario: string;
    function GetAvisa_Produto_Vencido: string;
    function GetFazer_Backup: string;
    function GetAvisa_Conta_Fixa: string;
    function GetCotacao_Preco: string;
    function GetDias_Aviso: integer;
    function GetTempo_Atualizacao: integer;
    function GetISSQN: string;
    function GetCodigo_Tipo_Documento: integer;
    function GetCodigo_Departamento: integer;
    function GetCodigo_Plano_Financeiro: integer;
    function GetHistorico: string;

    property Cod_Empresa: integer read GetCodigo_Empresa;
    property Caminho_EC: string read GetCaminho_ECF;
    property Men_Cupom: string read GetMensagem_Cupom;
    property Porta_Com: string read GetPorta_Comunicacao;
    property Perfil_Arq: string read GetPerfil_Arquivo_Fiscal;
    property Codigo_Tipo_At: string read GetCodigo_Tipo_Atividade;
    property Tipo_At: string read GetTipo_Atividade;
    property Ver_EFD: string read GetVersao_EFD;
    property Amb: string read GetAmbiente;
    property Tipo_Imp: string read GetTipo_Impressao;
    property Tipo_Emis: string read GetTipo_Emissao;
    property Logo: string read GetLogomarca;
    property Sa_XML: string read GetSalvar_XML;
    property WebServ_UF_1_Prod: string read GetWebService_UF_1_Producao;
    property WebServ_UF_1_Homolog: string read GetWebService_UF_1_Homologacao;
    property WebServ_UF_2_Prod: string read GetWebService_UF_2_Producao;
    property WebServ_UF_2_Homolog: string read GetWebService_UF_2_Homologacao;
    property Cod_Tabela_Preco_Padrao: integer
      read GetCodigo_Tabela_Preco_Padrao;
    property Av_Tabela_Preco: string read GetAvisa_Tabela_Preco;
    property Av_Lancamento_Financeiro: string
      read GetAvisa_Lancamento_Financeiro;
    property Av_Cheque: string read GetAvisa_Cheque;
    property Av_Pedido_Compra_Pendente: string
      read GetAvisa_Pedido_Compra_Pendente;
    property Av_Aniversario_Cliente: string read GetAvisa_Aniversario_Cliente;
    property Av_Aniversario_Funcionario: string
      read GetAvisa_Aniversario_Funcionario;
    property Av_Produto_Vencido: string read GetAvisa_Produto_Vencido;
    property Faz_Backup: string read GetFazer_Backup;
    property Av_Conta_Fixa: string read GetAvisa_Conta_Fixa;
    property Cot_Preco: string read GetCotacao_Preco;
    property Dias_Avis: integer read GetDias_Aviso;
    property Tempo_At: integer read GetTempo_Atualizacao;
    property ISSQNN: string read GetISSQN;

    property Cod_Tipo_Documento: integer read GetCodigo_Tipo_Documento;
    property Cod_Departamento: integer read GetCodigo_Departamento;
    property Cod_Plano_Financeiro: integer read GetCodigo_Plano_Financeiro;
    property Hist: string read GetHistorico;

    property Cod_Tipo_Documento_Pagar: integer
      read GetCodigo_Tipo_Documento_Pagar;
    property Cod_Departamento_Pagar: integer read GetCodigo_Departamento_Pagar;
    property Cod_Plano_Financeiro_Pagar: integer
      read GetCodigo_Plano_Financeiro_Pagar;
    property Hist_Pagar: string read GetHistorico_Pagar;

    procedure Inserir(var Registro: TConfiguracao_Sistema);
    procedure Alterar(var Registro: TConfiguracao_Sistema);
    procedure Excluir(var Registro: TConfiguracao_Sistema);
  end;

  TWebService_1_Producao = class
    Codigo: integer;
    WebService_UF: string;
    Recepcao: string;
    Retorno: string;
    Status: string;
    Cancelamento: string;
    Inutilizacao: string;
    Consulta: string;
    Consulta_Cadastro: string;

  public
    function GetCodigo: integer;
    function GetWebService_UF: string;
    function GetRecepcao: string;
    function GetRetorno: string;
    function GetStatus: string;
    function GetCancelamento: string;
    function GetInutilizacao: string;
    function GetConsulta: string;
    function GetConsulta_Cadastro: string;

    property Cod: integer read GetCodigo;
    property WebServ_UF: string read GetWebService_UF;
    property Recep: string read GetRecepcao;
    property Ret: string read GetRetorno;
    property Stat: string read GetStatus;
    property Canc: string read GetCancelamento;
    property Inut: string read GetInutilizacao;
    property Cons: string read GetConsulta;
    property Cons_Cadastro: string read GetConsulta_Cadastro;

    procedure Inserir(var Registro: TWebService_1_Producao);
    procedure Alterar(var Registro: TWebService_1_Producao);
    procedure Excluir(var Registro: TWebService_1_Producao);
    procedure Excluir_Item(var Registro: TWebService_1_Producao);
  end;

  TWebService_1_Homologacao = class
    Codigo: integer;
    WebService_UF: string;
    Recepcao: string;
    Retorno: string;
    Status: string;
    Cancelamento: string;
    Inutilizacao: string;
    Consulta: string;
    Consulta_Cadastro: string;

  public
    function GetCodigo: integer;
    function GetWebService_UF: string;
    function GetRecepcao: string;
    function GetRetorno: string;
    function GetStatus: string;
    function GetCancelamento: string;
    function GetInutilizacao: string;
    function GetConsulta: string;
    function GetConsulta_Cadastro: string;

    property Cod: integer read GetCodigo;
    property WebServ_UF: string read GetWebService_UF;
    property Recep: string read GetRecepcao;
    property Ret: string read GetRetorno;
    property Stat: string read GetStatus;
    property Canc: string read GetCancelamento;
    property Inut: string read GetInutilizacao;
    property Cons: string read GetConsulta;
    property Cons_Cadastro: string read GetConsulta_Cadastro;

    procedure Inserir(var Registro: TWebService_1_Homologacao);
    procedure Alterar(var Registro: TWebService_1_Homologacao);
    procedure Excluir(var Registro: TWebService_1_Homologacao);
    procedure Excluir_Item(var Registro: TWebService_1_Homologacao);
  end;

  TWebService_2_Producao = class
    Codigo: integer;
    WebService_UF: string;
    Recepcao: string;
    Retorno: string;
    Status: string;
    Cancelamento: string;
    Inutilizacao: string;
    Consulta: string;
    Consulta_Cadastro: string;

  public
    function GetCodigo: integer;
    function GetWebService_UF: string;
    function GetRecepcao: string;
    function GetRetorno: string;
    function GetStatus: string;
    function GetCancelamento: string;
    function GetInutilizacao: string;
    function GetConsulta: string;
    function GetConsulta_Cadastro: string;

    property Cod: integer read GetCodigo;
    property WebServ_UF: string read GetWebService_UF;
    property Recep: string read GetRecepcao;
    property Ret: string read GetRetorno;
    property Stat: string read GetStatus;
    property Canc: string read GetCancelamento;
    property Inut: string read GetInutilizacao;
    property Cons: string read GetConsulta;
    property Cons_Cadastro: string read GetConsulta_Cadastro;

    procedure Inserir(var Registro: TWebService_2_Producao);
    procedure Alterar(var Registro: TWebService_2_Producao);
    procedure Excluir(var Registro: TWebService_2_Producao);
    procedure Excluir_Item(var Registro: TWebService_2_Producao);
  end;

  TWebService_2_Homologacao = class
    Codigo: integer;
    WebService_UF: string;
    Recepcao: string;
    Retorno: string;
    Status: string;
    Cancelamento: string;
    Inutilizacao: string;
    Consulta: string;
    Consulta_Cadastro: string;

  public
    function GetCodigo: integer;
    function GetWebService_UF: string;
    function GetRecepcao: string;
    function GetRetorno: string;
    function GetStatus: string;
    function GetCancelamento: string;
    function GetInutilizacao: string;
    function GetConsulta: string;
    function GetConsulta_Cadastro: string;

    property Cod: integer read GetCodigo;
    property WebServ_UF: string read GetWebService_UF;
    property Recep: string read GetRecepcao;
    property Ret: string read GetRetorno;
    property Stat: string read GetStatus;
    property Canc: string read GetCancelamento;
    property Inut: string read GetInutilizacao;
    property Cons: string read GetConsulta;
    property Cons_Cadastro: string read GetConsulta_Cadastro;

    procedure Inserir(var Registro: TWebService_2_Homologacao);
    procedure Alterar(var Registro: TWebService_2_Homologacao);
    procedure Excluir(var Registro: TWebService_2_Homologacao);
    procedure Excluir_Item(var Registro: TWebService_2_Homologacao);
  end;

  TConta_Fixa = class
    Codigo: integer;
    Codigo_Empresa: integer;
    Data_Cadastro: Tdate;
    Descricao: string;
    Codigo_Plano: integer;
    Valor: double;
    Dia_Vencimento: integer;
    Tipo: string;
    Observacao: string;

  public
    function GetCodigo: integer;
    function GetCodigo_Empresa: integer;
    function GetData_Cadastro: Tdate;
    function GetDescricao: string;
    function GetCodigo_Plano: integer;
    function GetValor: double;
    function GetDia_Vencimento: integer;
    function GetTipo: string;
    function GetObservacao: string;

    property Codi: integer read GetCodigo;
    property Cod_Empresa: integer read GetCodigo_Empresa;
    property Data_Cad: Tdate read GetData_Cadastro;
    property Desc: string read GetDescricao;
    property Cod_Plan: integer read GetCodigo_Plano;
    property Val: double read GetValor;
    property Dia_Venc: integer read GetDia_Vencimento;
    property Tip: string read GetTipo;
    property Obs: string read GetObservacao;

    procedure Inserir(var Registro: TConta_Fixa);
    procedure Alterar(var Registro: TConta_Fixa);
    procedure Excluir(var Registro: TConta_Fixa);
  end;

  TEntrada_Produtos = class

    Codigo: integer;
    N_Nota_Fiscal: string;
    Modelo: string;
    Serie: string;
    Data_Emissao: Tdate;
    Hora_Emissao: string;
    Data_Entrada: Tdate;
    Hora_Entrada: string;
    Tipo_Frete: string;
    Tipo_Pagamento: string;
    Codigo_Fornecedor: integer;
    Codigo_CFOP: integer;
    Codigo_Empresa: integer;
    Quantidade_Itens: integer;
    Observacao: string;
    Status: string;
    FCaixaECF: string;

    function GetCodigo: integer;
    function GetN_Nota_Fiscal: string;
    function GetModelo: string;
    function GetSerie: string;
    function GetData_Emissao: Tdate;
    function GetHora_Emissao: string;
    function GetData_Entrada: Tdate;
    function GetHora_Entrada: string;
    function GetTipo_Frete: string;
    function GetTipo_Pagamento: string;
    function GetCodigo_Fornecedor: integer;
    function GetCodigo_CFOP: integer;
    function GetCodigo_Empresa: integer;
    function GetQuantidade_Itens: integer;
    function GetObservacao: string;
    function GetStatus: string;
    function GetCaixaECF: string;

    property Cod: integer read GetCodigo;
    property N_Nota_Fis: string read GetN_Nota_Fiscal;
    property Model: string read GetModelo;
    property Seri: string read GetSerie;
    property Data_Emis: Tdate read GetData_Emissao;
    property Hora_Emis: string read GetHora_Emissao;
    property Data_Ent: Tdate read GetData_Entrada;
    property Hora_Ent: string read GetHora_Entrada;
    property Tipo_Fre: string read GetTipo_Frete;
    property Tipo_Pag: string read GetTipo_Pagamento;
    property Cod_Fornecedor: integer read GetCodigo_Fornecedor;
    property Cod_CFOP: integer read GetCodigo_CFOP;
    property Cod_Empresa: integer read GetCodigo_Empresa;
    property Quant_Itens: integer read GetQuantidade_Itens;
    property Obs: string read GetObservacao;
    property St: string read GetStatus;
    property CaixaECF: string read GetCaixaECF;

    procedure Alterar(var Registro: TEntrada_Produtos);
    procedure Inserir(var Registro: TEntrada_Produtos);
    procedure Inserir_Copia(var Registro: TEntrada_Produtos);
    procedure Excluir(var Registro: TEntrada_Produtos);
  end;

  TItens_Entrada = class
    Codigo: integer;
    N_Item: string;
    N_Nota_Fiscal: string;
    Codigo_Produto: integer;
    Unidade: string;
    St: string;
    Valor_Ultima_Compra: double;
    Valor_Unitario: double;
    Quantidade: double;
    Quantidade_Restante: double;
    Valor_Total: double;
    Valor_Unitario_Frete: double;
    Valor_ST_Unitario: double;
    Quantidade_Volume: double;
    BC_ICMS: double;
    Aliquota_ICMS: string;
    Aliquota_IPI: string;
    CFOP: string;
    Valor_ICMS_Unitario: double;
    Valor_IPI: double;
    Custo_Unitario: double;
    Ficha_Estoque_Codigo: integer;

  public
    function GetCodigo: integer;
    function GetN_Item: string;
    function GetN_Nota_Fiscal: string;
    function GetCodigo_Produto: integer;
    function GetNCM: string;
    function GetUnidade: string;
    function GetST: string;
    function GetCodigo_Produto_Selecionado: integer;
    function GetValor_Ultima_Compra: double;
    function GetValor_Unitario: double;
    function GetQuantidade: double;
    function GetQuantidade_Restante: double;
    function GetValor_Total: double;
    function GetValor_Unitario_Frete: double;
    function GetQuantidade_Volume: double;
    function GetBC_ICMS: double;
    function GetAliquota_ICMS: string;
    function GetAliquota_IPI: string;
    function GetCFOP: string;
    function GetValor_ICMS_Unitario: double;
    function GetValor_IPI: double;
    function GetCusto_Unitario: double;
    function GetPercentual_Lucro: double;
    function GetValor_Venda: double;
    function GetPercentual_Lucro_Prazo: double;
    function GetValor_Prazo: double;

    property Cod: integer read GetCodigo;
    property N_It: string read GetN_Item;
    property N_Nota_Fis: string read GetN_Nota_Fiscal;
    property Cod_Prod: integer read GetCodigo_Produto;
    property NCMM: string read GetNCM;
    property Un: string read GetUnidade;
    property STT: string read GetST;
    property Cod_Prod_Sel: integer read GetCodigo_Produto_Selecionado;
    property Valor_Ult_Comp: double read GetValor_Ultima_Compra;
    property Valor_Un: double read GetValor_Unitario;
    property Quant: double read GetQuantidade;
    property Quant_Res: double read GetQuantidade_Restante;
    property Quant_Volume: double read GetQuantidade_Volume;
    property Valor_Tot: double read GetValor_Total;
    property BC_ICMSS: double read GetBC_ICMS;
    property Valor_Frete_Un: double read GetValor_Unitario_Frete;
    property Ali_ICMS: string read GetAliquota_ICMS;
    property Ali_IPI: string read GetAliquota_IPI;
    property CFOPP: string read GetCFOP;
    property Val_ICMS_Un: double read GetValor_ICMS_Unitario;
    property Val_IPI: double read GetValor_IPI;
    property Custo_Un: double read GetCusto_Unitario;
    property Perc_Lucro: double read GetPercentual_Lucro;
    property Val_Venda: double read GetValor_Venda;
    property Perc_Lucro_Prazo: double read GetPercentual_Lucro_Prazo;
    property Val_Prazo: double read GetValor_Prazo;

    procedure Inserir(var Registro: TItens_Entrada);
    procedure Inserir_Copia(var Registro: TItens_Entrada);
    procedure Excluir(var Registro: TItens_Entrada);
    procedure Excluir_Tudo(var Registro: TItens_Entrada);
  end;

  TImpostos_Entrada = class
    Codigo: integer;
    N_Nota_Fiscal: string;
    Total_Produtos: double;
    Base_ICMS: double;
    Valor_ICMS: double;
    Isento_ICMS: double;
    Outros_ICMS: double;
    Base_ICMS_Subs: double;
    Valor_ICMS_Subs: double;
    Aliquota: double;
    Valor_Frete: double;
    Valor_Seguro: double;
    Outras_Despesas: double;
    Total_IPI: double;
    Isento_IPI: double;
    Outros_IPI: double;
    Desconto: double;
    Total_Nota: double;
  public
    function GetCodigo: integer;
    function GetN_Nota_Fiscal: string;
    function GetTotal_Produtos: double;
    function GetBase_ICMS: double;
    function GetValor_ICMS: double;
    function GetIsento_ICMS: double;
    function GetOutros_ICMS: double;
    function GetBase_ICMS_Subs: double;
    function GetValor_ICMS_Subs: double;
    function GetAliquota: double;
    function GetValor_Frete: double;
    function GetValor_Seguro: double;
    function GetOutras_Despesas: double;
    function GetTotal_IPI: double;
    function GetIsento_IPI: double;
    function GetOutros_IPI: double;
    function GetDesconto: double;
    function GetTotal_Nota: double;

    property Cod: integer read GetCodigo;
    property N_Nota_Fis: string read GetN_Nota_Fiscal;
    property Total_Prod: double read GetTotal_Produtos;
    property Bas_ICMS: double read GetBase_ICMS;
    property Val_ICMS: double read GetValor_ICMS;
    property Is_ICMS: double read GetIsento_ICMS;
    property Outr_ICMS: double read GetOutros_ICMS;
    property Bas_ICMS_Subs: double read GetBase_ICMS_Subs;
    property Val_ICMS_Subs: double read GetValor_ICMS_Subs;
    property Ali: double read GetAliquota;
    property Val_Frete: double read GetValor_Frete;
    property Val_Seguro: double read GetValor_Seguro;
    property Outr_Despesas: double read GetOutras_Despesas;
    property Tot_IPI: double read GetTotal_IPI;
    property Is_IPI: double read GetIsento_IPI;
    property Outr_IPI: double read GetOutros_IPI;
    property Desc: double read GetDesconto;
    property Tot_Nota: double read GetTotal_Nota;

    procedure Alterar(var Registro: TImpostos_Entrada);
    procedure Inserir(var Registro: TImpostos_Entrada);
    procedure Inserir_Copia(var Registro: TImpostos_Entrada);
    procedure Excluir(var Registro: TImpostos_Entrada);
  end;

  TEndereco_Cliente = class
    Codigo_Cliente: integer;
    Codigo_Endereco: integer;
    Codigo_Setor: integer;
    Numero: string;
    Complemento: string;
    Tipo_Endereco: string;

  public
    function GetCodigo_Cliente: integer;
    function GetCodigo_Endereco: integer;
    function GetCodigo_Endereco_Excluir: integer;
    function GetCodigo_Setor: integer;
    function GetNumero: string;
    function GetComplemento: string;
    function GetTipo_Endereco: string;

    property Cod_Cliente: integer read GetCodigo_Cliente;
    property Cod_Endereco: integer read GetCodigo_Endereco;
    property Cod_Endereco_Excluir: integer read GetCodigo_Endereco_Excluir;
    property Cod_Setor: integer read GetCodigo_Setor;
    property Numer: string read GetNumero;
    property Comple: string read GetComplemento;
    property Tipo_Ender: string read GetTipo_Endereco;

    procedure Alterar(var Registro: TEndereco_Cliente;
      var Conexao: TADOConnection);
    procedure Inserir(var Registro: TEndereco_Cliente;
      var Conexao: TADOConnection);
    procedure Excluir(var Registro: TEndereco_Cliente;
      var Conexao: TADOConnection);
    procedure Excluir_Tudo(var Registro: TEndereco_Cliente;
      var Conexao: TADOConnection);
  end;

  TTelefone_Cliente = class
    procedure Alterar(var Conexao: TADOConnection);
    procedure Inserir(var Conexao: TADOConnection);
    procedure Excluir(var Conexao: TADOConnection);
    procedure Excluir_Tudo(var Conexao: TADOConnection);
  end;

  TDados_Adicionais_Cliente = class
    Codigo_Cliente: integer;
    Empresa: string;
    Inscricao: string;

  public
    function GetCodigo_Cliente: integer;
    function GetEmpresa: string;
    function GetInscricao: string;

    function GetCodigo_Cliente_Selecionado: integer;
    function GetEmpresa_Selecionado: string;
    function GetInscricao_Selecionado: string;

    property Cod_Cliente: integer read GetCodigo_Cliente;
    property Empres: string read GetEmpresa;
    property Insc: string read GetInscricao;

    property Cod_Cliente_Selecionado: integer
      read GetCodigo_Cliente_Selecionado;
    property Empres_Selecionado: string read GetEmpresa_Selecionado;
    property Insc_Selecionado: string read GetInscricao_Selecionado;

    procedure Inserir(var Registro: TDados_Adicionais_Cliente;
      var Conexao: TADOConnection);
    procedure Excluir(var Registro: TDados_Adicionais_Cliente;
      var Conexao: TADOConnection);
    procedure Excluir_Tudo(var Registro: TDados_Adicionais_Cliente;
      var Conexao: TADOConnection);

  end;

  TCliente_Autorizados = class
    procedure Inserir(var Conexao: TADOConnection);
    procedure Excluir_Tudo(var Conexao: TADOConnection);
    procedure Excluir(var Conexao: TADOConnection);
  end;

  TRegra_ICMS = class
    Codigo: integer;
    Data_Cadastro: Tdate;
    Descricao: string;
    Aliquota: string;
    Tipo_Recolhimento: string;
    Base_Reduzida: string;
    Percentual_BC_Reduzida: string;
    Base_Acrescida: string;
    Percentual_BC_Acrescida: string;
    Codigo_Situacao_Tributaria: string;
    CFOP_V_D: string;
    CFOP_V_F: string;

  public
    function GetCodigo: integer;
    function GetData_Cadastro: Tdate;
    function GetDescricao: string;
    function GetAliquota: string;
    function GetTipo_Recolhimento: string;
    function GetBase_Reduzida: string;
    function GetPercentual_BC_Reduzida: string;
    function GetBase_Acrescida: string;
    function GetPercentual_BC_Acrescida: string;
    function GetCodigo_Situacao_Tributaria: integer;
    function GetCFOP_V_D: string;
    function GetCFOP_V_F: string;

    property Cod: integer read GetCodigo;
    property Data_Cad: Tdate read GetData_Cadastro;
    property Desc: string read GetDescricao;
    property Aliq: string read GetAliquota;
    property Tipo_Rec: string read GetTipo_Recolhimento;
    property Base_Red: string read GetBase_Reduzida;
    property Perc_Base_Red: string read GetPercentual_BC_Reduzida;
    property Base_Acre: string read GetBase_Acrescida;
    property Perc_Base_Acre: string read GetPercentual_BC_Acrescida;
    property Cod_Situacao_Tributaria: integer
      read GetCodigo_Situacao_Tributaria;
    property CFOP_V_DD: string read GetCFOP_V_D;
    property CFOP_V_FF: string read GetCFOP_V_F;

    procedure Alterar(var Registro: TRegra_ICMS);
    procedure Inserir(var Registro: TRegra_ICMS);
    procedure Excluir(var Registro: TRegra_ICMS);
  end;

  TRegra_PIS = class
    Codigo: integer;
    Data_Cadastro: Tdate;
    Descricao: string;
    Aliquota: string;
    Tipo_Recolhimento: string;
    Base_Reduzida: string;
    Percentual_BC_Reduzida: string;
    Base_Acrescida: string;
    Percentual_BC_Acrescida: string;
    Codigo_Situacao_Tributaria: integer;

  public
    function GetCodigo: integer;
    function GetData_Cadastro: Tdate;
    function GetDescricao: string;
    function GetAliquota: string;
    function GetTipo_Recolhimento: string;
    function GetBase_Reduzida: string;
    function GetPercentual_BC_Reduzida: string;
    function GetBase_Acrescida: string;
    function GetPercentual_BC_Acrescida: string;
    function GetCodigo_Situacao_Tributaria: integer;

    property Cod: integer read GetCodigo;
    property Data_Cad: Tdate read GetData_Cadastro;
    property Desc: string read GetDescricao;
    property Aliq: string read GetAliquota;
    property Tipo_Rec: string read GetTipo_Recolhimento;
    property Base_Red: string read GetBase_Reduzida;
    property Perc_Base_Red: string read GetPercentual_BC_Reduzida;
    property Base_Acre: string read GetBase_Acrescida;
    property Perc_Base_Acre: string read GetPercentual_BC_Acrescida;
    property Cod_Situacao_Tributaria: integer
      read GetCodigo_Situacao_Tributaria;

    procedure Alterar(var Registro: TRegra_PIS);
    procedure Inserir(var Registro: TRegra_PIS);
    procedure Excluir(var Registro: TRegra_PIS);
  end;

  TRegra_ISSQN = class
    Codigo: integer;
    Data_Cadastro: Tdate;
    Descricao: string;
    Aliquota: string;
    Tributacao: string;
    Base_Reduzida: string;
    Percentual_BC_Reduzida: string;
    Base_Acrescida: string;
    Percentual_BC_Acrescida: string;

  public
    function GetCodigo: integer;
    function GetData_Cadastro: Tdate;
    function GetDescricao: string;
    function GetAliquota: string;
    function GetTributacao: string;
    function GetBase_Reduzida: string;
    function GetPercentual_BC_Reduzida: string;
    function GetBase_Acrescida: string;
    function GetPercentual_BC_Acrescida: string;

    property Cod: integer read GetCodigo;
    property Data_Cad: Tdate read GetData_Cadastro;
    property Desc: string read GetDescricao;
    property Aliq: string read GetAliquota;
    property Trib: string read GetTributacao;
    property Base_Red: string read GetBase_Reduzida;
    property Perc_Base_Red: string read GetPercentual_BC_Reduzida;
    property Base_Acre: string read GetBase_Acrescida;
    property Perc_Base_Acre: string read GetPercentual_BC_Acrescida;

    procedure Alterar(var Registro: TRegra_ISSQN);
    procedure Inserir(var Registro: TRegra_ISSQN);
    procedure Excluir(var Registro: TRegra_ISSQN);
  end;

  TRegra_IPI = class
    Codigo: integer;
    Data_Cadastro: Tdate;
    Descricao: string;
    Aliquota: string;
    Codigo_NCM: integer;
    Tipo_Recolhimento: string;
    Base_Reduzida: string;
    Percentual_BC_Reduzida: string;
    Base_Acrescida: string;
    Percentual_BC_Acrescida: string;
    Codigo_Situacao_Tributaria: integer;

  public
    function GetCodigo: integer;
    function GetData_Cadastro: Tdate;
    function GetDescricao: string;
    function GetAliquota: string;
    function GetTipo_Recolhimento: string;
    function GetBase_Reduzida: string;
    function GetPercentual_BC_Reduzida: string;
    function GetBase_Acrescida: string;
    function GetPercentual_BC_Acrescida: string;
    function GetCodigo_Situacao_Tributaria: integer;

    property Cod: integer read GetCodigo;
    property Data_Cad: Tdate read GetData_Cadastro;
    property Desc: string read GetDescricao;
    property Aliq: string read GetAliquota;
    property Tipo_Rec: string read GetTipo_Recolhimento;
    property Base_Red: string read GetBase_Reduzida;
    property Perc_Base_Red: string read GetPercentual_BC_Reduzida;
    property Base_Acre: string read GetBase_Acrescida;
    property Perc_Base_Acre: string read GetPercentual_BC_Acrescida;
    property Cod_Situacao_Tributaria: integer
      read GetCodigo_Situacao_Tributaria;

    procedure Alterar(var Registro: TRegra_IPI);
    procedure Inserir(var Registro: TRegra_IPI);
    procedure Excluir(var Registro: TRegra_IPI);
  end;

  TRegra_COFINS = class
    Codigo: integer;
    Data_Cadastro: Tdate;
    Descricao: string;
    Aliquota: string;
    Tipo_Recolhimento: string;
    Base_Reduzida: string;
    Percentual_BC_Reduzida: string;
    Base_Acrescida: string;
    Percentual_BC_Acrescida: string;
    Codigo_Situacao_Tributaria: integer;

  public
    function GetCodigo: integer;
    function GetData_Cadastro: Tdate;
    function GetDescricao: string;
    function GetAliquota: string;
    function GetTipo_Recolhimento: string;
    function GetBase_Reduzida: string;
    function GetPercentual_BC_Reduzida: string;
    function GetBase_Acrescida: string;
    function GetPercentual_BC_Acrescida: string;
    function GetCodigo_Situacao_Tributaria: integer;

    property Cod: integer read GetCodigo;
    property Data_Cad: Tdate read GetData_Cadastro;
    property Desc: string read GetDescricao;
    property Aliq: string read GetAliquota;
    property Tipo_Rec: string read GetTipo_Recolhimento;
    property Base_Red: string read GetBase_Reduzida;
    property Perc_Base_Red: string read GetPercentual_BC_Reduzida;
    property Base_Acre: string read GetBase_Acrescida;
    property Perc_Base_Acre: string read GetPercentual_BC_Acrescida;
    property Cod_Situacao_Tributaria: integer
      read GetCodigo_Situacao_Tributaria;

    procedure Alterar(var Registro: TRegra_COFINS);
    procedure Inserir(var Registro: TRegra_COFINS);
    procedure Excluir(var Registro: TRegra_COFINS);
  end;

  TTratamento_ICMS = class
    Codigo: integer;
    Descricao: string;
    Data_Cadastro: Tdate;

  public
    function GetCodigo: integer;
    function GetDescricao: string;
    function GetData_Cadastro: Tdate;

    property Cod: integer read GetCodigo;
    property Desc: string read GetDescricao;
    property Data_Cad: Tdate read GetData_Cadastro;

    procedure Alterar(var Registro: TTratamento_ICMS; Conexao: TADOConnection);
    procedure Inserir(var Registro: TTratamento_ICMS; Conexao: TADOConnection);
    procedure Excluir(var Registro: TTratamento_ICMS; Conexao: TADOConnection);
  end;

  TItens_Tratamento_ICMS = class
    Codigo: integer;
    Origem: string;
    Destino: string;
    Entrada_Regra_EN: integer;
    Entrada_Regra_EPP: integer;
    Entrada_Regra_ME: integer;
    Saida_Regra_EN: integer;
    Saida_Regra_EPP: integer;
    Saida_Regra_ME: integer;
    Regra_Nao_Contribuinte: integer;

  public
    function GetCodigo: integer;
    function GetOrigem: string;
    function GetDestino: string;
    function GetEntrada_Regra_EN: integer;
    function GetEntrada_Regra_EPP: integer;
    function GetEntrada_Regra_ME: integer;
    function GetSaida_Regra_EN: integer;
    function GetSaida_Regra_EPP: integer;
    function GetSaida_Regra_ME: integer;
    function GetRegra_Nao_Contribuinte: integer;

    property Cod: integer read GetCodigo;
    property Orig: string read GetOrigem;
    property Dest: string read GetDestino;
    property Entrada_Reg_EN: integer read GetEntrada_Regra_EN;
    property Entrada_Reg_EPP: integer read GetEntrada_Regra_EPP;
    property Entrada_Reg_ME: integer read GetEntrada_Regra_ME;
    property Saida_Reg_EN: integer read GetSaida_Regra_EN;
    property Saida_Reg_EPP: integer read GetSaida_Regra_EPP;
    property Saida_Reg_ME: integer read GetSaida_Regra_ME;
    property Reg_Nao_Contribuinte: integer read GetRegra_Nao_Contribuinte;

    procedure Alterar(var Registro: TItens_Tratamento_ICMS;
      Conexao: TADOConnection);
    procedure Inserir(var Registro: TItens_Tratamento_ICMS;
      Conexao: TADOConnection);
    procedure Excluir(var Registro: TItens_Tratamento_ICMS;
      Conexao: TADOConnection);
    procedure Excluir_Item(var Registro: TItens_Tratamento_ICMS;
      Conexao: TADOConnection);
  end;

  TTratamento_PIS = class
    Codigo: integer;
    Descricao: string;
    Data_Cadastro: Tdate;

  public
    function GetCodigo: integer;
    function GetDescricao: string;
    function GetData_Cadastro: Tdate;

    property Cod: integer read GetCodigo;
    property Desc: string read GetDescricao;
    property Data_Cad: Tdate read GetData_Cadastro;

    procedure Alterar(var Registro: TTratamento_PIS);
    procedure Inserir(var Registro: TTratamento_PIS);
    procedure Excluir(var Registro: TTratamento_PIS);
  end;

  TItens_Tratamento_PIS = class
    Codigo: integer;
    Origem: string;
    Destino: string;
    Entrada_Regra_EN: integer;
    Entrada_Regra_EPP: integer;
    Entrada_Regra_ME: integer;
    Saida_Regra_EN: integer;
    Saida_Regra_EPP: integer;
    Saida_Regra_ME: integer;
    Regra_Nao_Contribuinte: integer;

  public
    function GetCodigo: integer;
    function GetOrigem: string;
    function GetDestino: string;
    function GetEntrada_Regra_EN: integer;
    function GetEntrada_Regra_EPP: integer;
    function GetEntrada_Regra_ME: integer;
    function GetSaida_Regra_EN: integer;
    function GetSaida_Regra_EPP: integer;
    function GetSaida_Regra_ME: integer;
    function GetRegra_Nao_Contribuinte: integer;

    property Cod: integer read GetCodigo;
    property Orig: string read GetOrigem;
    property Dest: string read GetDestino;
    property Entrada_Reg_EN: integer read GetEntrada_Regra_EN;
    property Entrada_Reg_EPP: integer read GetEntrada_Regra_EPP;
    property Entrada_Reg_ME: integer read GetEntrada_Regra_ME;
    property Saida_Reg_EN: integer read GetSaida_Regra_EN;
    property Saida_Reg_EPP: integer read GetSaida_Regra_EPP;
    property Saida_Reg_ME: integer read GetSaida_Regra_ME;
    property Reg_Nao_Contribuinte: integer read GetRegra_Nao_Contribuinte;

    procedure Alterar(var Registro: TItens_Tratamento_PIS);
    procedure Inserir(var Registro: TItens_Tratamento_PIS);
    procedure Excluir(var Registro: TItens_Tratamento_PIS);
    procedure Excluir_Item(var Registro: TItens_Tratamento_PIS);
  end;

  TTratamento_ISSQN = class
    Codigo: integer;
    Descricao: string;
    Origem: string;
    Destino: string;
    Entrada_Regra_EN: integer;
    Entrada_Regra_EPP: integer;
    Entrada_Regra_ME: integer;
    Saida_Regra_EN: integer;
    Saida_Regra_EPP: integer;
    Saida_Regra_ME: integer;
    Regra_Nao_Contribuinte: integer;
    Data_Cadastro: Tdate;

  public
    function GetCodigo: integer;
    function GetDescricao: string;
    function GetOrigem: string;
    function GetDestino: string;
    function GetEntrada_Regra_EN: integer;
    function GetEntrada_Regra_EPP: integer;
    function GetEntrada_Regra_ME: integer;
    function GetSaida_Regra_EN: integer;
    function GetSaida_Regra_EPP: integer;
    function GetSaida_Regra_ME: integer;
    function GetRegra_Nao_Contribuinte: integer;
    function GetData_Cadastro: Tdate;

    property Cod: integer read GetCodigo;
    property Desc: string read GetDescricao;
    property Orig: string read GetOrigem;
    property Dest: string read GetDestino;
    property Entrada_Reg_EN: integer read GetEntrada_Regra_EN;
    property Entrada_Reg_EPP: integer read GetEntrada_Regra_EPP;
    property Entrada_Reg_ME: integer read GetEntrada_Regra_ME;
    property Saida_Reg_EN: integer read GetSaida_Regra_EN;
    property Saida_Reg_EPP: integer read GetSaida_Regra_EPP;
    property Saida_Reg_ME: integer read GetSaida_Regra_ME;
    property Reg_Nao_Contribuinte: integer read GetRegra_Nao_Contribuinte;
    property Data_Cad: Tdate read GetData_Cadastro;

    procedure Alterar(var Registro: TTratamento_ISSQN);
    procedure Inserir(var Registro: TTratamento_ISSQN);
    procedure Excluir(var Registro: TTratamento_ISSQN);
  end;

  TTratamento_IPI = class
    Codigo: integer;
    Descricao: string;
    Data_Cadastro: Tdate;

  public
    function GetCodigo: integer;
    function GetDescricao: string;
    function GetData_Cadastro: Tdate;

    property Cod: integer read GetCodigo;
    property Desc: string read GetDescricao;
    property Data_Cad: Tdate read GetData_Cadastro;

    procedure Alterar(var Registro: TTratamento_IPI);
    procedure Inserir(var Registro: TTratamento_IPI);
    procedure Excluir(var Registro: TTratamento_IPI);
  end;

  TItens_Tratamento_IPI = class
    Codigo: integer;
    Origem: string;
    Destino: string;
    Entrada_Regra_EN: integer;
    Entrada_Regra_EPP: integer;
    Entrada_Regra_ME: integer;
    Saida_Regra_EN: integer;
    Saida_Regra_EPP: integer;
    Saida_Regra_ME: integer;
    Regra_Nao_Contribuinte: integer;

  public
    function GetCodigo: integer;
    function GetOrigem: string;
    function GetDestino: string;
    function GetEntrada_Regra_EN: integer;
    function GetEntrada_Regra_EPP: integer;
    function GetEntrada_Regra_ME: integer;
    function GetSaida_Regra_EN: integer;
    function GetSaida_Regra_EPP: integer;
    function GetSaida_Regra_ME: integer;
    function GetRegra_Nao_Contribuinte: integer;

    property Cod: integer read GetCodigo;
    property Orig: string read GetOrigem;
    property Dest: string read GetDestino;
    property Entrada_Reg_EN: integer read GetEntrada_Regra_EN;
    property Entrada_Reg_EPP: integer read GetEntrada_Regra_EPP;
    property Entrada_Reg_ME: integer read GetEntrada_Regra_ME;
    property Saida_Reg_EN: integer read GetSaida_Regra_EN;
    property Saida_Reg_EPP: integer read GetSaida_Regra_EPP;
    property Saida_Reg_ME: integer read GetSaida_Regra_ME;
    property Reg_Nao_Contribuinte: integer read GetRegra_Nao_Contribuinte;

    procedure Alterar(var Registro: TItens_Tratamento_IPI);
    procedure Inserir(var Registro: TItens_Tratamento_IPI);
    procedure Excluir(var Registro: TItens_Tratamento_IPI);
    procedure Excluir_Item(var Registro: TItens_Tratamento_IPI);
  end;

  TTratamento_COFINS = class
    Codigo: integer;
    Descricao: string;
    Data_Cadastro: Tdate;

  public
    function GetCodigo: integer;
    function GetDescricao: string;
    function GetData_Cadastro: Tdate;

    property Cod: integer read GetCodigo;
    property Desc: string read GetDescricao;
    property Data_Cad: Tdate read GetData_Cadastro;

    procedure Alterar(var Registro: TTratamento_COFINS);
    procedure Inserir(var Registro: TTratamento_COFINS);
    procedure Excluir(var Registro: TTratamento_COFINS);
  end;

  TItens_Tratamento_COFINS = class
    Codigo: integer;
    Origem: string;
    Destino: string;
    Entrada_Regra_EN: integer;
    Entrada_Regra_EPP: integer;
    Entrada_Regra_ME: integer;
    Saida_Regra_EN: integer;
    Saida_Regra_EPP: integer;
    Saida_Regra_ME: integer;
    Regra_Nao_Contribuinte: integer;

  public
    function GetCodigo: integer;
    function GetOrigem: string;
    function GetDestino: string;
    function GetEntrada_Regra_EN: integer;
    function GetEntrada_Regra_EPP: integer;
    function GetEntrada_Regra_ME: integer;
    function GetSaida_Regra_EN: integer;
    function GetSaida_Regra_EPP: integer;
    function GetSaida_Regra_ME: integer;
    function GetRegra_Nao_Contribuinte: integer;

    property Cod: integer read GetCodigo;
    property Orig: string read GetOrigem;
    property Dest: string read GetDestino;
    property Entrada_Reg_EN: integer read GetEntrada_Regra_EN;
    property Entrada_Reg_EPP: integer read GetEntrada_Regra_EPP;
    property Entrada_Reg_ME: integer read GetEntrada_Regra_ME;
    property Saida_Reg_EN: integer read GetSaida_Regra_EN;
    property Saida_Reg_EPP: integer read GetSaida_Regra_EPP;
    property Saida_Reg_ME: integer read GetSaida_Regra_ME;
    property Reg_Nao_Contribuinte: integer read GetRegra_Nao_Contribuinte;

    procedure Alterar(var Registro: TItens_Tratamento_COFINS);
    procedure Inserir(var Registro: TItens_Tratamento_COFINS);
    procedure Excluir(var Registro: TItens_Tratamento_COFINS);
    procedure Excluir_Item(var Registro: TItens_Tratamento_COFINS);
  end;

  TPerfil_Usuario = class
    procedure Inserir;
    procedure Alterar;
    procedure Excluir;
  end;

  TTransporte_Entrada = class
    procedure Inserir;
    procedure Inserir_Copia;
    procedure Alterar;
    procedure Excluir;
  end;

  TCadastro_Etiqueta = class
    procedure Inserir(tipoEtiqueta: integer);
    procedure Alterar(Tipo: integer);
    procedure Excluir;
    procedure Excluir_Etiquetadora;
  end;

  TNFE = class
    procedure Inserir;
  end;

  TLocal_Entrega_NFE = class
    procedure Inserir;
  end;

  TLocal_Retirada_NFE = class
    procedure Inserir;
  end;

  TImpostos_NFE = class
    procedure Inserir;
  end;

  TTransporte_NFE = class
    procedure Inserir;
  end;

  TEmitente_NFE = class
    procedure Inserir;
  end;

  TDestinatario_NFE = class
    procedure Inserir;
  end;

  TCadastro_Status = class
    procedure Inserir;
    procedure Alterar;
    procedure Excluir;
  end;

  TCadastro_Tipo_Ocorrencia = class
    procedure Inserir;
    procedure Alterar;
    procedure Excluir;
  end;

  TRegistro_Ocorrencia = class
    procedure Inserir;
    procedure Alterar;
    procedure Excluir;
  end;

  TFuncionario_Outros = class
    procedure Excluir(var Conexao: TADOConnection);
  end;

  TFuncionario_Alteracao_Salarial = class
    procedure Excluir(var Conexao: TADOConnection);
  end;

  TFuncionario_Alteracao_Cargo = class
    procedure Excluir(var Conexao: TADOConnection);
  end;

  TFuncionario_Ferias = class
    procedure Excluir(var Conexao: TADOConnection);
  end;

  TFuncionario_Ocorrencia = class
    procedure Excluir(var Conexao: TADOConnection);
  end;

  TCadastro_Tipo_Bem_Patrimonial = class
    procedure Inserir;
    procedure Alterar;
    procedure Excluir;
  end;

  TPatrimonio = class
    procedure Inserir;
    procedure Alterar;
    procedure Excluir;
  end;

  TLancamento_Financeiro_Ocorrencia_Cobranca = class
    procedure Inserir;
    procedure Alterar;
    procedure Excluir;
  end;

var
  Codigo, i, doc: integer;
  Cargo: TCargo;
  Parcela: TParcelas;
  Movimento_Banco: TMovimento_Banco;
  data_vencim: Tdate;

implementation

uses UGeral, UDM, UCadastro_Logradouro, UCadastro_Unidade_Medida,
  UCadastro_Cidade, UCadastro_Setor, UCadastro_Cargo, UCadastro_Departamento,
  UCadastro_Grupo_Cliente, UCadastro_Cliente, UCadastro_Funcionarios,
  UCadastro_Grupo_Produto, UCadastro_Marca, UCadastro_Forn_Fab,
  UCadastro_Produto, UCadastro_Tipo_Documento, UCadastro_Condicao_Pagamento,
  UCadastro_Plano_Financeiro, UCadastro_Empresa, ULancamento_Financeiro,
  UCadastro_Caixa, UCadastro_Banco, UCadastro_Operacao_Bancaria,
  UCadastro_Conta_Corrente, UCadastro_Itens_Folha_Pagamento, UCadastro_Cheque,
  UCadastro_Local_Produto, UBaixar_Titulo, UChama_Lancamentos_Financeiros,
  ULancamento_Banco, UPDV, UFechamento_Venda_PDV, UMenu_Geral, UDeclaracao,
  UPedido_Venda, UCarrega_Pedido_Caixa, UCadastro_CFOP,
  UCadastro_Situacao_Tributaria, UCompra, UConciliacao_Compra,
  UConfiguracao_Sistema, UCadastro_NCM, UCadastro_Pais, UMovimentacao_Manual,
  UCadastro_Veiculo, UFechamento_Inventario, UOS, UPre_Venda, UFolha_Pagamento,
  UConta_Fixa, UEntrada_Produtos, UCadastro_Transportadora,
  UCadastro_Observacao_Fiscal, URegra_ICMS, UTratamento_ICMS,
  UCadastro_Grupo_Produto_Tributacao, URegra_PIS, UTratamento_PIS,
  UCadastro_Grupo_Produto_Tributacao_PIS, URegra_COFINS, UTratamento_COFINS,
  UCadastro_Grupo_Produto_Tributacao_COFINS, URegra_IPI, UTratamento_IPI,
  UCadastro_Grupo_Produto_Tributacao_IPI, URegra_ISSQN, UTratamento_ISSQN,
  UCadastro_Usuario, UAbertura_Caixa, UFechamento_Caixa, UCadastro_Tabela_Preco,
  UCotacao_Preco_Produto, URetorno_Cotacao, UFabricacao, UReceita,
  UCadastro_Perfil_Usuario, UAcerto_Caixa, UAltera_Caixa, UCadastro_Etiqueta,
  UInforma_NNF, UNFE, UAgenda_Telefonica, UCadastro_Status,
  UCadastro_Tipo_Ocorrencia, UOcorrencia, UCadastro_Tipo_Bem_Patrimonial,
  UCadastro_Patrimonio, UMensagem_Erro_Gerenciador_TEF, Util.Mensagens,
  Util.TLog, UCadastro_Ocorrencia_Cobranca;

{ TCargo }

procedure TCargo.Alterar(var Registro: TCargo);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Update Cargo set Descricao = :Descricao, Data_Cadastro = :Data_Cadastro');
        add('where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        Parameters.ParamByName('Descricao').Value := Registro.Desc;
        Parameters.ParamByName('Data_Cadastro').Value := Registro.Data;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Altera;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TCargo.Excluir(var Registro: TCargo);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Delete from Cargo where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Exclui;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

function TCargo.GetCodigo: integer;
begin
  GetCodigo := StrToInt(FrmCadastro_Cargo.EdtCodigo.Text);
end;

function TCargo.GetData_Cadastro: Tdate;
begin
  GetData_Cadastro := StrToDateTime(FrmCadastro_Cargo.MEdtData_Cadastro.Text);
end;

function TCargo.GetDesc: string;
begin
  GetDesc := FrmCadastro_Cargo.EdtDescricao.Text;
end;

procedure TCargo.Inserir(var Registro: TCargo);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('insert into Cargo (Descricao, Data_Cadastro)');
        add('values (:Descricao, :Data_Cadastro)');
        Parameters.ParamByName('Descricao').Value := Registro.Desc;
        Parameters.ParamByName('Data_Cadastro').Value := Registro.Data;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Insere;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TSetor }

procedure TSetor.Alterar(var Registro: TSetor);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Update Setor set Descricao = :Descricao, Data_Cadastro = :Data_Cadastro');
        add('where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        Parameters.ParamByName('Descricao').Value := Registro.Desc;
        Parameters.ParamByName('Data_Cadastro').Value := Registro.Data;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Altera;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TSetor.Excluir(var Registro: TSetor);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Delete from Setor where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Exclui;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

function TSetor.GetCodigo: integer;
begin
  GetCodigo := StrToInt(FrmCadastro_Setor.EdtCodigo.Text);
end;

function TSetor.GetData_Cadastro: Tdate;
begin
  GetData_Cadastro := StrToDateTime(FrmCadastro_Setor.MEdtData_Cadastro.Text);
end;

function TSetor.GetDesc: string;
begin
  GetDesc := FrmCadastro_Setor.EdtDescricao.Text;
end;

procedure TSetor.Inserir(var Registro: TSetor);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('insert into Setor (Descricao, Data_Cadastro)');
        add('values (:Descricao, :Data_Cadastro)');
        Parameters.ParamByName('Descricao').Value := Registro.Desc;
        Parameters.ParamByName('Data_Cadastro').Value := Registro.Data;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Insere;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TCidade }

procedure TCidade.Alterar(var Registro: TCidade);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Update Cidade set Descricao = :Descricao, UF = :UF, DDD = :DDD, Data_Cadastro = :Data_Cadastro,');
        add('Codigo_Municipio = :Codigo_Municipio, Codigo_Pais = :Codigo_Pais where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        Parameters.ParamByName('Descricao').Value := Registro.Desc;
        Parameters.ParamByName('UF').Value := Registro.UFF;
        Parameters.ParamByName('DDD').Value := Registro.DD;
        Parameters.ParamByName('Data_Cadastro').Value := Registro.Data;
        Parameters.ParamByName('Codigo_Municipio').Value := Registro.Cod_Mun;
        Parameters.ParamByName('Codigo_Pais').Value :=
          StrToInt(FrmCadastro_Cidade.EdtCodigo_Pais.Text);
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Altera;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TCidade.Excluir(var Registro: TCidade);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Delete from Cidade where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Exclui;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

function TCidade.GetCodigo: integer;
begin
  GetCodigo := StrToInt(FrmCadastro_Cidade.EdtCodigo.Text);
end;

function TCidade.GetCodigo_Municipio: string;
begin
  GetCodigo_Municipio := FrmCadastro_Cidade.EdtCodigo_Cidade.Text;
end;

function TCidade.GetData_Cadastro: Tdate;
begin
  GetData_Cadastro := StrToDateTime(FrmCadastro_Cidade.MEdtData_Cadastro.Text);
end;

function TCidade.GetDDD: string;
begin
  GetDDD := FrmCadastro_Cidade.EdtDDD.Text;
end;

function TCidade.GetDesc: string;
begin
  GetDesc := FrmCadastro_Cidade.EdtCidade.Text;
end;

function TCidade.GetUF: string;
begin
  GetUF := FrmCadastro_Cidade.CmbUF.Text;
end;

procedure TCidade.Inserir(var Registro: TCidade);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('insert into Cidade (Descricao, UF, DDD, Data_Cadastro, Codigo_Municipio, Codigo_Pais)');
        add('values (:Descricao, :UF, :DDD, :Data_Cadastro, :Codigo_Municipio, :Codigo_Pais)');
        Parameters.ParamByName('Descricao').Value := Registro.Desc;
        Parameters.ParamByName('UF').Value := Registro.UFF;
        Parameters.ParamByName('DDD').Value := Registro.DD;
        Parameters.ParamByName('Data_Cadastro').Value := Registro.Data;
        Parameters.ParamByName('Codigo_Municipio').Value := Registro.Cod_Mun;
        Parameters.ParamByName('Codigo_Pais').Value :=
          StrToInt(FrmCadastro_Cidade.EdtCodigo_Pais.Text);
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Insere;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TUnidade_Medida }

procedure TUnidade_Medida.Alterar(var Registro: TUnidade_Medida);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Update Unidade_Medida set Sigla = :Sigla, Descricao = :Descricao, Data_Cadastro = :Data_Cadastro');
        add('where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        Parameters.ParamByName('Sigla').Value := Registro.Sig;
        Parameters.ParamByName('Descricao').Value := Registro.Desc;
        Parameters.ParamByName('Data_Cadastro').Value := Registro.Data;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Altera;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TUnidade_Medida.Excluir(var Registro: TUnidade_Medida);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Delete from Unidade_Medida where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Exclui;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

function TUnidade_Medida.GetCodigo: integer;
begin
  GetCodigo := StrToInt(FrmCadastro_Unidade_Medida.EdtCodigo.Text);
end;

function TUnidade_Medida.GetData_Cadastro: Tdate;
begin
  GetData_Cadastro := StrToDateTime
    (FrmCadastro_Unidade_Medida.MEdtData_Cadastro.Text);
end;

function TUnidade_Medida.GetDesc: string;
begin
  GetDesc := FrmCadastro_Unidade_Medida.EdtDescricao.Text;
end;

function TUnidade_Medida.GetSigla: string;
begin
  GetSigla := FrmCadastro_Unidade_Medida.EdtSigla.Text;
end;

procedure TUnidade_Medida.Inserir(var Registro: TUnidade_Medida);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('insert into Unidade_Medida (Sigla, Descricao, Data_Cadastro)');
        add('values (:Sigla, :Descricao, :Data_Cadastro)');
        Parameters.ParamByName('Sigla').Value := Registro.Sig;
        Parameters.ParamByName('Descricao').Value := Registro.Desc;
        Parameters.ParamByName('Data_Cadastro').Value := Registro.Data;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Insere;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TLogradouro }

procedure TLogradouro.Alterar(var Registro: TLogradouro);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Update Logradouro set Descricao = :Descricao, Tipo_Logradouro = :Tipo_Logradouro, CEP = :CEP, ');
        add('Data_Cadastro = :Data_Cadastro where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        Parameters.ParamByName('Descricao').Value := Registro.Desc;
        Parameters.ParamByName('Tipo_Logradouro').Value := Registro.Tip;
        Parameters.ParamByName('CEP').Value := Registro.CE;
        Parameters.ParamByName('Data_Cadastro').Value := Registro.Data;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Altera;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TLogradouro.Excluir(var Registro: TLogradouro);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Delete from Logradouro where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Exclui;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

function TLogradouro.GetCEP: string;
begin
  GetCEP := FrmCadastro_Logradouro.EdtCEP.Text;
end;

function TLogradouro.GetCodigo: integer;
begin
  GetCodigo := StrToInt(FrmCadastro_Logradouro.EdtCodigo.Text);
end;

function TLogradouro.GetData_Cadastro: Tdate;
begin
  GetData_Cadastro := StrToDateTime
    (FrmCadastro_Logradouro.MEdtData_Cadastro.Text);
end;

function TLogradouro.GetDesc: string;
begin
  GetDesc := FrmCadastro_Logradouro.EdtLogradouro.Text;
end;

function TLogradouro.GetTipo_Log: string;
begin
  GetTipo_Log := FrmCadastro_Logradouro.CmbTipo.Text;
end;

procedure TLogradouro.Inserir(var Registro: TLogradouro);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('insert into Logradouro (Descricao, Tipo_Logradouro, CEP, Data_Cadastro)');
        add('values (:Descricao, :Tipo_Logradouro, :CEP, :Data_Cadastro)');
        Parameters.ParamByName('Descricao').Value := Registro.Desc;
        Parameters.ParamByName('Tipo_Logradouro').Value := Registro.Tip;
        Parameters.ParamByName('CEP').Value := Registro.CE;
        Parameters.ParamByName('Data_Cadastro').Value := Registro.Data;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Insere;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TDepartamento }

procedure TDepartamento.Alterar(var Registro: TDepartamento);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Update Departamento set Descricao = :Descricao, Data_Cadastro = :Data_Cadastro where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        Parameters.ParamByName('Descricao').Value := Registro.Desc;
        Parameters.ParamByName('Data_Cadastro').Value := Registro.Data;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Altera;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TDepartamento.Excluir(var Registro: TDepartamento);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Delete from Departamento where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Exclui;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

function TDepartamento.GetCodigo: integer;
begin
  GetCodigo := StrToInt(FrmCadastro_Departamento.EdtCodigo.Text);
end;

function TDepartamento.GetData_Cadastro: Tdate;
begin
  GetData_Cadastro := StrToDateTime
    (FrmCadastro_Departamento.MEdtData_Cadastro.Text);
end;

function TDepartamento.GetDesc: string;
begin
  GetDesc := FrmCadastro_Departamento.EdtDescricao.Text;
end;

procedure TDepartamento.Inserir(var Registro: TDepartamento);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('insert into Departamento (Descricao, Data_Cadastro)');
        add('values (:Descricao, :Data_Cadastro)');
        Parameters.ParamByName('Descricao').Value := Registro.Desc;
        Parameters.ParamByName('Data_Cadastro').Value := Registro.Data;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Insere;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TGrupo_Cliente }

procedure TGrupo_Cliente.Alterar(var Registro: TGrupo_Cliente);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Update Grupo_Cliente set Descricao = :Descricao, Data_Cadastro = :Data_Cadastro where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        Parameters.ParamByName('Descricao').Value := Registro.Desc;
        Parameters.ParamByName('Data_Cadastro').Value := Registro.Data;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Altera;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TGrupo_Cliente.Excluir(var Registro: TGrupo_Cliente);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Delete from Grupo_Cliente where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Exclui;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

function TGrupo_Cliente.GetCodigo: integer;
begin
  GetCodigo := StrToInt(FrmCadastro_Grupo_Cliente.EdtCodigo.Text);
end;

function TGrupo_Cliente.GetData_Cadastro: Tdate;
begin
  GetData_Cadastro := StrToDateTime
    (FrmCadastro_Grupo_Cliente.MEdtData_Cadastro.Text);
end;

function TGrupo_Cliente.GetDesc: string;
begin
  GetDesc := FrmCadastro_Grupo_Cliente.EdtDescricao.Text;
end;

procedure TGrupo_Cliente.Inserir(var Registro: TGrupo_Cliente);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('insert into Grupo_Cliente (Descricao, Data_Cadastro)');
        add('values (:Descricao, :Data_Cadastro)');
        Parameters.ParamByName('Descricao').Value := Registro.Desc;
        Parameters.ParamByName('Data_Cadastro').Value := Registro.Data;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Insere;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TCliente }

procedure TCliente.Alterar(var Registro: TCliente; var Conexao: TADOConnection);
var
  qAux, qaux2: TADOQuery;
begin
  // try
  // DM.ADOConnection1.BeginTrans;
  try
    qAux := TADOQuery.Create(nil);
    qaux2 := TADOQuery.Create(nil);
    with qAux, SQL do
    begin
      close;
      clear;
      Connection := Conexao;
      add('Update Cliente set Codigo_Empresa = :Codigo_Empresa, Tipo = :Tipo, Enquadramento = :Enquadramento, Nome_Nome_Fantasia = :Nome_Nome_Fantasia, ');
      add('Razao_Social = :Razao_Social, CPF = :CPF, RG = :RG, Orgao_Expedidor = :Orgao, ');
      add('Data_Emissao_RG = :Data_Emissao, CNPJ = :CNPJ, Insc_Estadual = :Inscricao, Insc_Municipal = :Insc_Municipal,');
      add('Numero = :Numero, Complemento = :Complemento, Referencia = :Referencia, ');
      add('Codigo_Setor = :Setor, Codigo_Cidade = :Cidade, Codigo_Grupo = :Grupo, Suframa = :Suframa,');
      add('Telefone = :Telefone, Celular = :Celular, Contato = :Contato, Telefone_Contato = :Tel_Contato, Email = :Email, ');
      add('Site = :Site, Profissao = :Profissao, Data_Nascimento = :Data_Nasc, Estado_Civil = :Estado_Civil,');
      add('Data_Cadastro = :Data_Cad, Credito = :Credito, Limite_Credito = :Limite_Cred, Acima_Limite_Credito = :Acima_Limite_Cred,');
      add('Limite_Desconto = :Limite_Desc, Acima_Limite_Desconto = :Acima_Limite_Desc, Observacoes = :Obs, ');
      add('Codigo_Tabela_Preco = :Codigo_Tabela_Preco, Bloqueado = :Bloqueado, Codigo_Usuario = :Codigo_Usuario,');
      add('Endereco = :Endereco, CEP = :CEP');
      add('where Codigo = :Codigo');
      Parameters.ParamByName('Codigo').Value := Registro.Cod;
      Parameters.ParamByName('Codigo_Empresa').Value := Registro.Cod_Empresa;
      Parameters.ParamByName('Tipo').Value := Registro.Tip;
      Parameters.ParamByName('Enquadramento').Value := Registro.Enquad;
      Parameters.ParamByName('Nome_Nome_Fantasia').Value := Registro.Nom;
      Parameters.ParamByName('Razao_Social').Value := Registro.Raz;
      Parameters.ParamByName('CPF').Value := Registro.CP;
      Parameters.ParamByName('RG').Value := Registro.Ident;
      Parameters.ParamByName('Orgao').Value := Registro.Orgao;
      Parameters.ParamByName('Data_Emissao').Value := Registro.Data_Emis;
      Parameters.ParamByName('CNPJ').Value := Registro.CNP;
      Parameters.ParamByName('Inscricao').Value := Registro.Inscr_Estadual;
      Parameters.ParamByName('Insc_Municipal').Value :=
        Registro.Inscr_Municipal;
      Parameters.ParamByName('Numero').Value := Registro.Num;
      Parameters.ParamByName('Complemento').Value := Registro.Comp;
      Parameters.ParamByName('Referencia').Value := Registro.Refer;
      Parameters.ParamByName('Setor').Value := Registro.Seto;
      Parameters.ParamByName('Cidade').Value := Registro.Cid;
      Parameters.ParamByName('Grupo').Value := Registro.Grup;
      Parameters.ParamByName('Suframa').Value := Registro.Sufr;
      Parameters.ParamByName('Telefone').Value := Registro.Tel;
      Parameters.ParamByName('Celular').Value := Registro.Cel;
      Parameters.ParamByName('Contato').Value := Registro.Cont;
      Parameters.ParamByName('Tel_Contato').Value := Registro.Tel_Cont;
      Parameters.ParamByName('Email').Value := Registro.Ema;
      Parameters.ParamByName('Site').Value := Registro.Sit;
      Parameters.ParamByName('Profissao').Value := Registro.Prof;
      Parameters.ParamByName('Data_Nasc').Value := Registro.Data_Nasc;
      Parameters.ParamByName('Estado_Civil').Value := Registro.Est_Civil;
      Parameters.ParamByName('Data_Cad').Value := Registro.Data_Cad;
      Parameters.ParamByName('Credito').Value :=
        StrToFloat(FrmCadastro_Cliente.EdtCredito.Text);
      Parameters.ParamByName('Limite_Cred').Value := Registro.Limite_Cred;
      Parameters.ParamByName('Acima_Limite_Cred').Value :=
        Registro.Acima_Limite_Cred;
      Parameters.ParamByName('Limite_Desc').Value := Registro.Limite_Desc;
      Parameters.ParamByName('Acima_Limite_Desc').Value :=
        Registro.Acima_Limite_Desc;
      Parameters.ParamByName('Obs').Value := Registro.Obs;
      Parameters.ParamByName('Codigo_Tabela_Preco').Value :=
        Registro.Cod_Tabela_Preco;

      if (FrmCadastro_Cliente.CBBloqueado.Checked) then
        Parameters.ParamByName('Bloqueado').Value := 'SIM'
      else
        Parameters.ParamByName('Bloqueado').Value := 'NO';

      Parameters.ParamByName('Codigo_Usuario').Value := codigo_usu;
      Parameters.ParamByName('Endereco').Value :=
        FrmCadastro_Cliente.EdtEndereco.Text;
      Parameters.ParamByName('CEP').Value := FrmCadastro_Cliente.EdtCEP.Text;

      ExecSQL;
      // DM.ADOConnection1.CommitTrans;
      lrControle := Altera;
      UGeral.Mensagem_Padrao(lrControle);
    end;
  finally
    qAux.close;
    FreeAndNil(qAux);
  end;

  { except
    on E: Exception do
    begin
    //DM.ADOConnection1.RollbackTrans;
    Operacao_Nao_Completada(E.Message);
    end;
    end; }
end;

constructor TCliente.cria(var Registro: TCliente);
begin
  // Registro.Cod:= '';
  // Registro.CP:= '';
  { Registro.Tip;
    Registro.Raz;
    Registro.Ident;
    Registro.Orgao;
    Registro.Data_Emis;
    Registro.CNP;
    Registro.Inscr;
    Registro.Lograd;
    Registro.Num;
    Registro.Refer;
    Registro.Seto;
    Registro.Cid;
    Registro.Grup;
    Registro.Tel;
    Registro.Cel;
    Registro.Cont;
    Registro.Tel_Cont;
    Registro.Ema;
    Registro.Sit;
    Registro.Prof;
    Registro.Data_Nasc;
    Registro.Est_Civil;
    Registro.Data_Cad;
    Registro.Limite_Cred;
    Registro.Acima_Limite_Cred;
    Registro.Limite_Desc;
    Registro.Acima_Limite_Desc;
    Registro.Obs; }
end;

procedure TCliente.Excluir(var Registro: TCliente; var Conexao: TADOConnection);
var
  qAux, qaux2: TADOQuery;
begin
  // try
  // DM.ADOConnection1.BeginTrans;
  try
    qAux := TADOQuery.Create(nil);
    qaux2 := TADOQuery.Create(nil);
    with qAux, SQL do
    begin
      close;
      clear;
      Connection := Conexao;
      add('Delete from Cliente where Codigo = :Codigo');
      Parameters.ParamByName('Codigo').Value := Registro.Cod;
      ExecSQL;
      // DM.ADOConnection1.CommitTrans;
      lrControle := Exclui;
      UGeral.Mensagem_Padrao(lrControle);
    end;
  finally
    qAux.close;
    FreeAndNil(qAux);
  end;

  { except
    on E: Exception do
    begin
    //DM.ADOConnection1.RollbackTrans;
    Operacao_Nao_Completada(E.Message);
    end;
    end; }
end;

function TCliente.GetAcima_Limite_Credito: string;
begin
  GetAcima_Limite_Credito := (FrmCadastro_Cliente.CmbAcima_Limite_Credito.Text);
end;

function TCliente.GetAcima_Limite_Desconto: string;
begin
  GetAcima_Limite_Desconto :=
    (FrmCadastro_Cliente.CmbAcima_Limite_Desconto.Text);
end;

function TCliente.GetCelular: string;
begin
  GetCelular := FrmCadastro_Cliente.MEdtCelular.Text;
end;

function TCliente.GetCNPJ: string;
begin
  GetCNPJ := FrmCadastro_Cliente.EdtCNPJ.Text;
end;

function TCliente.GetCodigo: integer;
begin
  GetCodigo := StrToInt(FrmCadastro_Cliente.EdtCodigo.Text);
end;

function TCliente.GetCodigo_Cidade: integer;
begin
  if (FrmCadastro_Cliente.EdtCodigo_Cidade.Text = '') then
    GetCodigo_Cidade := 0
  else
    GetCodigo_Cidade := StrToInt(FrmCadastro_Cliente.EdtCodigo_Cidade.Text);
end;

function TCliente.GetCodigo_Empresa: integer;
begin
  GetCodigo_Empresa := UDeclaracao.Codigo_Empresa;
end;

function TCliente.GetCodigo_Grupo: integer;
begin
  if (FrmCadastro_Cliente.EdtCodigo_Grupo.Text = '') then
    GetCodigo_Grupo := 0
  else
    GetCodigo_Grupo := StrToInt(FrmCadastro_Cliente.EdtCodigo_Grupo.Text);
end;

function TCliente.GetCodigo_Logradouro: integer;
begin
  { if (FrmCadastro_Cliente.EdtCodigo_Endereco.Text = '') then
    GetCodigo_Logradouro := 0
    else
    GetCodigo_Logradouro := StrToInt
    (FrmCadastro_Cliente.EdtCodigo_Endereco.Text); }
end;

function TCliente.GetCodigo_Setor: integer;
begin
  if (FrmCadastro_Cliente.EdtCodigo_Setor.Text = '') then
    GetCodigo_Setor := 0
  else
    GetCodigo_Setor := StrToInt(FrmCadastro_Cliente.EdtCodigo_Setor.Text);
end;

function TCliente.GetCodigo_Tabela_Preco: integer;
begin
  if (FrmCadastro_Cliente.EdtCodigo_Tabela_Preco.Text = '') then
    GetCodigo_Tabela_Preco := 0
  else
    GetCodigo_Tabela_Preco :=
      StrToInt(FrmCadastro_Cliente.EdtCodigo_Tabela_Preco.Text);
end;

function TCliente.GetComplemento: string;
begin
  GetComplemento := FrmCadastro_Cliente.EdtComplemento.Text;
end;

function TCliente.GetContato: string;
begin
  GetContato := FrmCadastro_Cliente.EdtContato.Text;
end;

function TCliente.GetCPF: string;
begin
  GetCPF := FrmCadastro_Cliente.EdtCPF.Text;
end;

function TCliente.GetData_Cadastro: Tdate;
begin
  if (FrmCadastro_Cliente.MEdtData_Cadastro.Text = '  /  /    ') then
    GetData_Cadastro := 0
  else
    GetData_Cadastro := StrToDateTime
      (FrmCadastro_Cliente.MEdtData_Cadastro.Text);
end;

function TCliente.GetData_Emissao_RG: Tdate;
begin
  if (FrmCadastro_Cliente.EdtData_Emissao.Text = '  /  /    ') then
    GetData_Emissao_RG := 0
  else
    GetData_Emissao_RG :=
      StrToDateTime(FrmCadastro_Cliente.EdtData_Emissao.Text);
end;

function TCliente.GetData_Nascimento: Tdate;
begin
  if (FrmCadastro_Cliente.MEdtData_Nascimento.Text = '  /  /    ') then
    GetData_Nascimento := 0
  else
    GetData_Nascimento :=
      StrToDateTime(FrmCadastro_Cliente.MEdtData_Nascimento.Text);
end;

function TCliente.GetEmail: string;
begin
  GetEmail := FrmCadastro_Cliente.EdtEmail.Text;
end;

function TCliente.GetEnquadramento: string;
begin
  if (FrmCadastro_Cliente.RGEnquadramento.ItemIndex = 0) then
    GetEnquadramento := '0'
  else
    GetEnquadramento := '1';
end;

function TCliente.GetEstado_Civil: string;
begin
  GetEstado_Civil := FrmCadastro_Cliente.CmbEstado_Civil.Text;
end;

function TCliente.GetInsc_Estadual: string;
begin
  GetInsc_Estadual := FrmCadastro_Cliente.EdtInsc_Estadual.Text;
end;

function TCliente.GetInsc_Municipal: string;
begin
  GetInsc_Municipal := FrmCadastro_Cliente.EdtInsc_Municipal.Text;
end;

function TCliente.GetLimite_Credito: double;
begin
  if (FrmCadastro_Cliente.EdtLimite_Credito.Text = '') then
    GetLimite_Credito := 0
  else
    GetLimite_Credito := StrToFloat(FrmCadastro_Cliente.EdtLimite_Credito.Text);
end;

function TCliente.GetLimite_Desconto: double;
begin
  if (FrmCadastro_Cliente.EdtLimite_Desconto.Text = '') then
    GetLimite_Desconto := 0
  else
    GetLimite_Desconto :=
      StrToFloat(FrmCadastro_Cliente.EdtLimite_Desconto.Text);
end;

function TCliente.GetNome_Nome_Fantasia: string;
begin
  GetNome_Nome_Fantasia := FrmCadastro_Cliente.EdtNome.Text;
end;

function TCliente.GetNumero: string;
begin
  GetNumero := FrmCadastro_Cliente.EdtNumero.Text;
end;

function TCliente.GetObservacoes: string;
begin
  GetObservacoes := FrmCadastro_Cliente.MmoObservacoes.Text;
end;

function TCliente.GetOrgao_Expedidor: string;
begin
  GetOrgao_Expedidor := FrmCadastro_Cliente.EdtOrgao_Expedidor.Text;
end;

function TCliente.GetProfissao: string;
begin
  GetProfissao := FrmCadastro_Cliente.EdtProfissao.Text;
end;

function TCliente.GetRazao_Social: string;
begin
  GetRazao_Social := FrmCadastro_Cliente.EdtRazao_Social.Text;
end;

function TCliente.GetReferencia: string;
begin
  GetReferencia := FrmCadastro_Cliente.EdtReferencia.Text;
end;

function TCliente.GetRG: string;
begin
  GetRG := FrmCadastro_Cliente.EdtRG.Text;
end;

function TCliente.GetSite: string;
begin
  GetSite := FrmCadastro_Cliente.EdtSite.Text;
end;

function TCliente.GetSuframa: string;
begin
  GetSuframa := FrmCadastro_Cliente.EdtSuframa.Text;
end;

function TCliente.GetTelefone: string;
begin
  GetTelefone := FrmCadastro_Cliente.MEdtTelefone.Text;
end;

function TCliente.GetTelefone_Contato: string;
begin
  GetTelefone_Contato := FrmCadastro_Cliente.MEdtTelefone_Contato.Text;
end;

function TCliente.GetTipo: string;
begin
  if (FrmCadastro_Cliente.CBTipo.Checked = true) then
    GetTipo := 'FSICO'
  else
    GetTipo := 'JURDICO'
end;

procedure TCliente.Inserir(var Registro: TCliente; var Conexao: TADOConnection);
var
  qAux, qaux2: TADOQuery;
begin
  // try
  // DM.ADOConnection1.BeginTrans;
  try
    qAux := TADOQuery.Create(nil);
    qaux2 := TADOQuery.Create(nil);
    with qAux, SQL do
    begin
      close;
      clear;
      Connection := Conexao;
      add('Insert into Cliente (Codigo, Codigo_Empresa, Tipo, Enquadramento, Nome_Nome_Fantasia, Razao_Social, CPF, RG, Orgao_Expedidor, ');
      add('Data_Emissao_RG, CNPJ, Insc_Estadual, Insc_Municipal, Numero, Complemento, Referencia, ');
      add('Codigo_Setor, Codigo_Cidade, Codigo_Grupo, Suframa, Telefone, Celular, Contato, Telefone_Contato, ');
      add('Email, Site, Profissao, Data_Nascimento, Estado_Civil, Data_Cadastro, Credito, Limite_Credito, ');
      add('Acima_Limite_Credito, Limite_Desconto, Acima_Limite_Desconto, Observacoes, Codigo_Tabela_Preco, Bloqueado, Codigo_Usuario, Endereco, CEP) values( ');

      add(':Codigo, :Codigo_Empresa, :Tipo, :Enquadramento, :Nome_Nome_Fantasia, :Razao_Social, :CPF, :RG, :Orgao, :Data_Emissao, :CNPJ, :Inscricao, :Insc_Municipal, ');
      add(':Numero, :Complemento, :Referencia, :Setor, :Cidade, :Grupo, :Suframa, :Telefone, :Celular, :Contato, :Tel_Contato, ');
      add(':Email, :Site, :Profissao, :Data_Nasc,  :Estado_Civil, :Data_Cad, :Credito, :Limite_Cred, :Acima_Limite_Cred, ');
      add(':Limite_Desc, :Acima_Limite_Desc, :Obs, :Codigo_Tabela_Preco, :Bloqueado, :Codigo_Usuario, :Endereco, :CEP)');
      Parameters.ParamByName('Codigo').Value := Registro.Cod;
      Parameters.ParamByName('Codigo_Empresa').Value := Registro.Cod_Empresa;
      Parameters.ParamByName('Tipo').Value := Registro.Tip;
      Parameters.ParamByName('Enquadramento').Value := Registro.Enquad;
      Parameters.ParamByName('Nome_Nome_Fantasia').Value := Registro.Nom;
      Parameters.ParamByName('Razao_Social').Value := Registro.Raz;
      Parameters.ParamByName('CPF').Value := Registro.CP;
      Parameters.ParamByName('RG').Value := Registro.Ident;
      Parameters.ParamByName('Orgao').Value := Registro.Orgao;
      Parameters.ParamByName('Data_Emissao').Value := Registro.Data_Emis;
      Parameters.ParamByName('CNPJ').Value := Registro.CNP;
      Parameters.ParamByName('Inscricao').Value := Registro.Inscr_Estadual;
      Parameters.ParamByName('Insc_Municipal').Value :=
        Registro.Inscr_Municipal;
      Parameters.ParamByName('Numero').Value := Registro.Num;
      Parameters.ParamByName('Complemento').Value := Registro.Comp;
      Parameters.ParamByName('Referencia').Value := Registro.Refer;
      Parameters.ParamByName('Setor').Value := Registro.Seto;
      Parameters.ParamByName('Cidade').Value := Registro.Cid;
      Parameters.ParamByName('Grupo').Value := Registro.Grup;
      Parameters.ParamByName('Suframa').Value := Registro.Sufr;
      Parameters.ParamByName('Telefone').Value := Registro.Tel;
      Parameters.ParamByName('Celular').Value := Registro.Cel;
      Parameters.ParamByName('Contato').Value := Registro.Cont;
      Parameters.ParamByName('Tel_Contato').Value := Registro.Tel_Cont;
      Parameters.ParamByName('Email').Value := Registro.Ema;
      Parameters.ParamByName('Site').Value := Registro.Sit;
      Parameters.ParamByName('Profissao').Value := Registro.Prof;
      Parameters.ParamByName('Data_Nasc').Value := Registro.Data_Nasc;
      Parameters.ParamByName('Estado_Civil').Value := Registro.Est_Civil;
      Parameters.ParamByName('Data_Cad').Value := Registro.Data_Cad;
      Parameters.ParamByName('Credito').Value :=
        StrToFloat(FrmCadastro_Cliente.EdtCredito.Text);
      Parameters.ParamByName('Limite_Cred').Value := Registro.Limite_Cred;
      Parameters.ParamByName('Acima_Limite_Cred').Value :=
        Registro.Acima_Limite_Cred;
      Parameters.ParamByName('Limite_Desc').Value := Registro.Limite_Desc;
      Parameters.ParamByName('Acima_Limite_Desc').Value :=
        Registro.Acima_Limite_Desc;
      Parameters.ParamByName('Obs').Value := Registro.Obs;
      Parameters.ParamByName('Codigo_Tabela_Preco').Value :=
        Registro.Cod_Tabela_Preco;

      if (FrmCadastro_Cliente.CBBloqueado.Checked) then
        Parameters.ParamByName('Bloqueado').Value := 'SIM'
      else
        Parameters.ParamByName('Bloqueado').Value := 'NO';

      Parameters.ParamByName('Codigo_Usuario').Value := codigo_usu;
      Parameters.ParamByName('Endereco').Value :=
        FrmCadastro_Cliente.EdtEndereco.Text;
      Parameters.ParamByName('CEP').Value := FrmCadastro_Cliente.EdtCEP.Text;
      ExecSQL;
      // DM.ADOConnection1.CommitTrans;
      lrControle := Insere;
      UGeral.Mensagem_Padrao(lrControle);
    end;
  finally
    qAux.close;
    FreeAndNil(qAux);
  end;

  { except
    on E: Exception do
    begin
    //DM.ADOConnection1.RollbackTrans;
    ShowMessage(E.Message);
    end;
    end; }
end;

{ TFuncionario }

procedure TFuncionario.Alterar(var Registro: TFuncionario;
  var Conexao: TADOConnection);
var
  qAux, qaux2: TADOQuery;
begin
  // try
  // DM.ADOConnection1.BeginTrans;
  try
    qAux := TADOQuery.Create(nil);
    qaux2 := TADOQuery.Create(nil);
    with qAux, SQL do
    begin
      close;
      clear;
      Connection := Conexao;
      add('Update Funcionario set Codigo_Empresa = :Codigo_Empresa, Nome = :Nome, ');
      add('CPF = :CPF, RG = :RG, Orgao_Expedidor = :Orgao, ');
      add('Data_Emissao_RG = :Data_Emissao, Salario = :Salario, Comissao = :Comissao, Desconto = :Desconto,');
      add('Numero = :Numero, Referencia = :Referencia, ');
      add('Codigo_Setor = :Setor, Codigo_Cidade = :Cidade, Codigo_Cargo = :Codigo_Cargo, ');
      add('Codigo_Departamento = :Codigo_Departamento, Telefone = :Telefone, ');
      add('Celular = :Celular, Contato = :Contato, Telefone_Contato = :Tel_Contato, Email = :Email, ');
      add('Data_Nascimento = :Data_Nasc, Estado_Civil = :Estado_Civil, Data_Cadastro = :Data_Cad, Observacoes = :Obs, ');
      add('Comissao_Servico = :Comissao_Servico, Endereco = :Endereco, CEP = :CEP');
      add('where Codigo = :Codigo');
      Parameters.ParamByName('Codigo').Value := Registro.Cod;
      Parameters.ParamByName('Codigo_Empresa').Value := Registro.Cod_Empresa;
      Parameters.ParamByName('Nome').Value := Registro.Nom;
      Parameters.ParamByName('CPF').Value := Registro.CP;
      Parameters.ParamByName('RG').Value := Registro.Ident;
      Parameters.ParamByName('Orgao').Value := Registro.Orgao;
      Parameters.ParamByName('Data_Emissao').Value := Registro.Data_Emis;
      Parameters.ParamByName('Salario').Value := Registro.Salar;
      Parameters.ParamByName('Comissao').Value := Registro.Com;
      Parameters.ParamByName('Desconto').Value := Registro.Des;
      Parameters.ParamByName('Numero').Value := Registro.Num;
      Parameters.ParamByName('Referencia').Value := Registro.Refer;
      Parameters.ParamByName('Setor').Value := Registro.Seto;
      Parameters.ParamByName('Cidade').Value := Registro.Cid;
      Parameters.ParamByName('Codigo_Cargo').Value := Registro.Car;
      Parameters.ParamByName('Codigo_Departamento').Value := Registro.Depart;
      Parameters.ParamByName('Telefone').Value := Registro.Tel;
      Parameters.ParamByName('Celular').Value := Registro.Cel;
      Parameters.ParamByName('Contato').Value := Registro.Cont;
      Parameters.ParamByName('Tel_Contato').Value := Registro.Tel_Cont;
      Parameters.ParamByName('Email').Value := Registro.Ema;
      Parameters.ParamByName('Data_Nasc').Value := Registro.Data_Nasc;
      Parameters.ParamByName('Estado_Civil').Value := Registro.Est_Civil;
      Parameters.ParamByName('Data_Cad').Value := Registro.Data_Cad;
      Parameters.ParamByName('Obs').Value := Registro.Obs;
      Parameters.ParamByName('Comissao_Servico').Value :=
        StrToFloat(FrmCadastro_Funcionarios.EdtComissao_Servico.Text);
      Parameters.ParamByName('Endereco').Value :=
        FrmCadastro_Funcionarios.EdtEndereco.Text;
      Parameters.ParamByName('CEP').Value :=
        FrmCadastro_Funcionarios.EdtCEP.Text;
      ExecSQL;
      // DM.ADOConnection1.CommitTrans;
      // lrControle:= Altera;
      // UGeral.Mensagem_Padrao(lrControle);
    end;
  finally
    qAux.close;
    FreeAndNil(qAux);
  end;

  { except
    on E: Exception do
    begin
    //DM.ADOConnection1.RollbackTrans;
    ShowMessage('Erro: '+E.Message);
    end;
    end; }
end;

procedure TFuncionario.Alterar_Outros(var Conexao: TADOConnection);
var
  qAux: TADOQuery;
begin
  // try
  try
    qAux := TADOQuery.Create(nil);
    with qAux, SQL do
    begin
      close;
      Connection := Conexao;
      clear;
      add('UPDATE Funcionario_Outros');
      add('   SET Data_Admissao = :Data_Admissao');
      add('      ,Data_Demissao = :Data_Demissao');
      add('      ,CTPS_N = :CTPS_N');
      add('      ,CTPS_Serie = :CTPS_Serie');
      add('      ,Titulo_N = :Titulo_N');
      add('      ,Titulo_Cidade = :Titulo_Cidade');
      add('      ,Titulo_Zona = :Titulo_Zona');
      add('      ,Titulo_Secao = :Titulo_Secao');
      add('      ,Certificado_Militar_N = :Certificado_Militar_N');
      add('      ,Certificado_Militar_Serie = :Certificado_Militar_Serie');
      add('      ,Certificado_Militar_Categoria = :Certificado_Militar_Categoria');
      add('      ,Nome_Pai = :Nome_Pai');
      add('      ,Nome_Mae = :Nome_Mae');
      add('      ,Nacionalidade = :Nacionalidade');
      add('      ,Naturalidade = :Naturalidade');
      add('      ,Conjuge = :Conjuge');
      add('      ,Grau_Instrucao = :Grau_Instrucao');
      add('      ,CNH_N = :CNH_N');
      add('      ,CNH_Categoria = :CNH_Categoria');
      add('      ,CNH_Cidade = :CNH_Cidade');
      add('      ,PIS_N = :PIS_N');
      add('      ,PIS_Data_Cadastro = :PIS_Data_Cadastro');
      add('      ,PIS_Banco = :PIS_Banco');
      add('      ,PIS_Codigo_Banco = :PIS_Codigo_Banco');
      add('      ,PIS_Codigo_Agencia = :PIS_Codigo_Agencia');
      add('      ,PIS_Endereco_Agencia = :PIS_Endereco_Agencia');

      add('where Codigo = :Codigo');
      Parameters.ParamByName('Codigo').Value :=
        StrToInt(FrmCadastro_Funcionarios.EdtCodigo.Text);

      if (FrmCadastro_Funcionarios.MEdtData_Admissao.Text <> '  /  /    ') then
        Parameters.ParamByName('Data_Admissao').Value :=
          StrToDateTime(FrmCadastro_Funcionarios.MEdtData_Admissao.Text)
      else
        Parameters.ParamByName('Data_Admissao').Value := NULL;

      if (FrmCadastro_Funcionarios.MEdtData_Demissao.Text <> '  /  /    ') then
        Parameters.ParamByName('Data_Demissao').Value :=
          StrToDateTime(FrmCadastro_Funcionarios.MEdtData_Demissao.Text)
      else
        Parameters.ParamByName('Data_Demissao').Value := NULL;

      Parameters.ParamByName('CTPS_N').Value :=
        FrmCadastro_Funcionarios.EdtCTPS_N.Text;
      Parameters.ParamByName('CTPS_Serie').Value :=
        FrmCadastro_Funcionarios.EdtCTPS_Serie.Text;
      Parameters.ParamByName('Titulo_N').Value :=
        FrmCadastro_Funcionarios.EdtTitulo_N.Text;
      Parameters.ParamByName('Titulo_Cidade').Value :=
        FrmCadastro_Funcionarios.EdtTitulo_Cidade.Text;
      Parameters.ParamByName('Titulo_Zona').Value :=
        FrmCadastro_Funcionarios.EdtTitulo_Zona.Text;
      Parameters.ParamByName('Titulo_Secao').Value :=
        FrmCadastro_Funcionarios.EdtTitulo_Secao.Text;
      Parameters.ParamByName('Certificado_Militar_N').Value :=
        FrmCadastro_Funcionarios.EdtCertificado_Militar_N.Text;
      Parameters.ParamByName('Certificado_Militar_Serie').Value :=
        FrmCadastro_Funcionarios.EdtCertificado_Militar_Serie.Text;
      Parameters.ParamByName('Certificado_Militar_Categoria').Value :=
        FrmCadastro_Funcionarios.EdtCertificado_Militar_Categoria.Text;
      Parameters.ParamByName('Nome_Pai').Value :=
        FrmCadastro_Funcionarios.EdtNome_Pai.Text;
      Parameters.ParamByName('Nome_Mae').Value :=
        FrmCadastro_Funcionarios.EdtNome_Mae.Text;
      Parameters.ParamByName('Nacionalidade').Value :=
        FrmCadastro_Funcionarios.EdtNacionalidade.Text;
      Parameters.ParamByName('Naturalidade').Value :=
        FrmCadastro_Funcionarios.EdtNaturalidade.Text;
      Parameters.ParamByName('Conjuge').Value :=
        FrmCadastro_Funcionarios.EdtNome_Conjuge.Text;
      Parameters.ParamByName('Grau_Instrucao').Value :=
        FrmCadastro_Funcionarios.EdtGrau_Instrucao.Text;
      Parameters.ParamByName('CNH_N').Value :=
        FrmCadastro_Funcionarios.EdtCNH_N.Text;
      Parameters.ParamByName('CNH_Categoria').Value :=
        FrmCadastro_Funcionarios.EdtCNH_Categoria.Text;
      Parameters.ParamByName('CNH_Cidade').Value :=
        FrmCadastro_Funcionarios.EdtCNH_Cidade.Text;
      Parameters.ParamByName('PIS_N').Value :=
        FrmCadastro_Funcionarios.EdtPIS_N.Text;

      if (FrmCadastro_Funcionarios.MEdtPIS_Cadastro.Text <> '  /  /    ') then
        Parameters.ParamByName('PIS_Data_Cadastro').Value :=
          StrToDateTime(FrmCadastro_Funcionarios.MEdtPIS_Cadastro.Text)
      else
        Parameters.ParamByName('PIS_Data_Cadastro').Value := NULL;

      Parameters.ParamByName('PIS_Banco').Value :=
        FrmCadastro_Funcionarios.EdtPIS_Banco.Text;
      Parameters.ParamByName('PIS_Codigo_Banco').Value :=
        FrmCadastro_Funcionarios.EdtPIS_Codigo_Banco.Text;
      Parameters.ParamByName('PIS_Codigo_Agencia').Value :=
        FrmCadastro_Funcionarios.EdtPIS_Codigo_Agencia.Text;
      Parameters.ParamByName('PIS_Endereco_Agencia').Value :=
        FrmCadastro_Funcionarios.EdtPIS_Endereco_Agencia.Text;
      ExecSQL;
      // DM.ADOConnection1.CommitTrans;
      // lrControle := Altera;
      // UGeral.Mensagem_Padrao(lrControle);
    end;
  finally
    qAux.close;
    FreeAndNil(qAux);
  end;

  { except
    on E: Exception do
    begin
    //DM.ADOConnection1.RollbackTrans;
    ShowMessage('Erro: '+E.Message);
    //Operacao_Nao_Completada(E.Message);
    end;
    end; }
end;

procedure TFuncionario.Excluir(var Registro: TFuncionario;
  var Conexao: TADOConnection);
var
  qAux, qaux2: TADOQuery;
begin
  // try
  // DM.ADOConnection1.BeginTrans;
  try
    qAux := TADOQuery.Create(nil);
    qaux2 := TADOQuery.Create(nil);
    with qAux, SQL do
    begin
      close;
      clear;
      Connection := Conexao;
      add('Delete from Funcionario where Codigo = :Codigo');
      Parameters.ParamByName('Codigo').Value := Registro.Cod;
      ExecSQL;
      // DM.ADOConnection1.CommitTrans;
      lrControle := Exclui;
      UGeral.Mensagem_Padrao(lrControle);
    end;
  finally
    qAux.close;
    FreeAndNil(qAux);
  end;

  { except
    on E: Exception do
    begin
    //DM.ADOConnection1.RollbackTrans;
    Operacao_Nao_Completada(E.Message);
    end;
    end; }
end;

function TFuncionario.GetCelular: string;
begin
  GetCelular := FrmCadastro_Funcionarios.MEdtCelular.Text;
end;

function TFuncionario.GetCodigo: integer;
begin
  GetCodigo := StrToInt(FrmCadastro_Funcionarios.EdtCodigo.Text);
end;

function TFuncionario.GetCodigo_Cidade: integer;
begin
  if (FrmCadastro_Funcionarios.EdtCodigo_Cidade.Text = '') then
    GetCodigo_Cidade := 0
  else
    GetCodigo_Cidade :=
      StrToInt(FrmCadastro_Funcionarios.EdtCodigo_Cidade.Text);
end;

function TFuncionario.GetCodigo_Departamento: integer;
begin
  if (FrmCadastro_Funcionarios.EdtCodigo_Departamento.Text = '') then
    GetCodigo_Departamento := 0
  else
    GetCodigo_Departamento :=
      StrToInt(FrmCadastro_Funcionarios.EdtCodigo_Departamento.Text);
end;

function TFuncionario.GetCodigo_Empresa: integer;
begin
  GetCodigo_Empresa := UDeclaracao.Codigo_Empresa;
end;

function TFuncionario.GetCodigo_Cargo: integer;
begin
  if (FrmCadastro_Funcionarios.EdtCodigo_Cargo.Text = '') then
    GetCodigo_Cargo := 0
  else
    GetCodigo_Cargo := StrToInt(FrmCadastro_Funcionarios.EdtCodigo_Cargo.Text);
end;

function TFuncionario.GetCodigo_Logradouro: integer;
begin
  { if (FrmCadastro_Funcionarios.EdtCodigo_Endereco.Text = '') then
    GetCodigo_Logradouro := 0
    else
    GetCodigo_Logradouro := StrToInt
    (FrmCadastro_Funcionarios.EdtCodigo_Endereco.Text); }
end;

function TFuncionario.GetCodigo_Setor: integer;
begin
  if (FrmCadastro_Funcionarios.EdtCodigo_Setor.Text = '') then
    GetCodigo_Setor := 0
  else
    GetCodigo_Setor := StrToInt(FrmCadastro_Funcionarios.EdtCodigo_Setor.Text);
end;

function TFuncionario.GetContato: string;
begin
  GetContato := FrmCadastro_Funcionarios.EdtContato.Text;
end;

function TFuncionario.GetCPF: string;
begin
  GetCPF := FrmCadastro_Funcionarios.EdtCPF.Text;
end;

function TFuncionario.GetData_Cadastro: Tdate;
begin
  if (FrmCadastro_Funcionarios.MEdtData_Cadastro.Text = '  /  /    ') then
    GetData_Cadastro := 0
  else
    GetData_Cadastro := StrToDateTime
      (FrmCadastro_Funcionarios.MEdtData_Cadastro.Text);
end;

function TFuncionario.GetData_Emissao_RG: Tdate;
begin
  if (FrmCadastro_Funcionarios.EdtData_Emissao.Text = '  /  /    ') then
    GetData_Emissao_RG := 0
  else
    GetData_Emissao_RG :=
      StrToDateTime(FrmCadastro_Funcionarios.EdtData_Emissao.Text);
end;

function TFuncionario.GetData_Nascimento: Tdate;
begin
  if (FrmCadastro_Funcionarios.MEdtData_Nascimento.Text = '  /  /    ') then
    GetData_Nascimento := 0
  else
    GetData_Nascimento :=
      StrToDateTime(FrmCadastro_Funcionarios.MEdtData_Nascimento.Text);
end;

function TFuncionario.GetDesconto: double;
begin
  GetDesconto := StrToFloat(FrmCadastro_Funcionarios.EdtDesconto.Text);
end;

function TFuncionario.GetEmail: string;
begin
  GetEmail := FrmCadastro_Funcionarios.EdtEmail.Text;
end;

function TFuncionario.GetEstado_Civil: string;
begin
  GetEstado_Civil := FrmCadastro_Funcionarios.CmbEstado_Civil.Text;
end;

function TFuncionario.GetSalario: double;
begin
  GetSalario := StrToFloat(FrmCadastro_Funcionarios.EdtSalario.Text);
end;

function TFuncionario.GetComissao: double;
begin
  GetComissao := StrToFloat(FrmCadastro_Funcionarios.EdtComissao_Produto.Text);
end;

function TFuncionario.GetNome: string;
begin
  GetNome := FrmCadastro_Funcionarios.EdtNome.Text;
end;

function TFuncionario.GetNumero: string;
begin
  GetNumero := FrmCadastro_Funcionarios.EdtNumero.Text;
end;

function TFuncionario.GetObservacoes: string;
begin
  GetObservacoes := FrmCadastro_Funcionarios.MmoObservacoes.Text;
end;

function TFuncionario.GetOrgao_Expedidor: string;
begin
  GetOrgao_Expedidor := FrmCadastro_Funcionarios.EdtOrgao_Expedidor.Text;
end;

function TFuncionario.GetReferencia: string;
begin
  GetReferencia := FrmCadastro_Funcionarios.EdtReferencia.Text;
end;

function TFuncionario.GetRG: string;
begin
  GetRG := FrmCadastro_Funcionarios.EdtRG.Text;
end;

function TFuncionario.GetTelefone: string;
begin
  GetTelefone := FrmCadastro_Funcionarios.MEdtTelefone.Text;
end;

function TFuncionario.GetTelefone_Contato: string;
begin
  GetTelefone_Contato := FrmCadastro_Funcionarios.MEdtTelefone_Contato.Text;
end;

procedure TFuncionario.Inserir(var Registro: TFuncionario;
  var Conexao: TADOConnection);
var
  qAux, qaux2: TADOQuery;
begin
  // try
  // DM.ADOConnection1.BeginTrans;
  try
    qAux := TADOQuery.Create(nil);
    qaux2 := TADOQuery.Create(nil);
    with qAux, SQL do
    begin
      close;
      clear;
      Connection := Conexao;
      add('Insert into Funcionario (Codigo, Codigo_Empresa, Nome, CPF, RG, Orgao_Expedidor, ');
      add('Data_Emissao_RG, Salario, Comissao, Desconto, Numero, Referencia, ');
      add('Codigo_Setor, Codigo_Cidade, Codigo_Cargo, Codigo_Departamento, Telefone, ');
      add('Celular, Contato, Telefone_Contato, Email, Data_Nascimento, Estado_Civil,');
      add('Data_Cadastro, Observacoes, Comissao_Servico, Endereco, CEP) values(:Codigo, :Codigo_Empresa, :Nome, :CPF, :RG, :Orgao, :Data_Emissao,');
      add(':Salario, :Comissao, :Desconto, :Numero, :Referencia, :Setor, :Cidade, :Cargo, :Departamento,');
      add(':Telefone, :Celular, :Contato, :Tel_Contato, :Email, :Data_Nasc, :Estado_Civil, :Data_Cad, :Obs, :Comissao_Servico, :Endereco, :CEP)');

      Parameters.ParamByName('Codigo').Value := Registro.Cod;
      Parameters.ParamByName('Codigo_Empresa').Value := Registro.Cod_Empresa;
      Parameters.ParamByName('Nome').Value := Registro.Nom;
      Parameters.ParamByName('CPF').Value := Registro.CP;
      Parameters.ParamByName('RG').Value := Registro.Ident;
      Parameters.ParamByName('Orgao').Value := Registro.Orgao;
      Parameters.ParamByName('Data_Emissao').Value := Registro.Data_Emis;
      Parameters.ParamByName('Salario').Value := Registro.Salar;
      Parameters.ParamByName('Comissao').Value := Registro.Com;
      Parameters.ParamByName('Desconto').Value := Registro.Des;
      Parameters.ParamByName('Numero').Value := Registro.Num;
      Parameters.ParamByName('Referencia').Value := Registro.Refer;
      Parameters.ParamByName('Setor').Value := Registro.Seto;
      Parameters.ParamByName('Cidade').Value := Registro.Cid;
      Parameters.ParamByName('Cargo').Value := Registro.Car;
      Parameters.ParamByName('Departamento').Value := Registro.Depart;
      Parameters.ParamByName('Telefone').Value := Registro.Tel;
      Parameters.ParamByName('Celular').Value := Registro.Cel;
      Parameters.ParamByName('Contato').Value := Registro.Cont;
      Parameters.ParamByName('Tel_Contato').Value := Registro.Tel_Cont;
      Parameters.ParamByName('Email').Value := Registro.Ema;
      Parameters.ParamByName('Data_Nasc').Value := Registro.Data_Nasc;
      Parameters.ParamByName('Estado_Civil').Value := Registro.Est_Civil;
      Parameters.ParamByName('Data_Cad').Value := Registro.Data_Cad;
      Parameters.ParamByName('Obs').Value := Registro.Obs;
      Parameters.ParamByName('Comissao_Servico').Value :=
        StrToFloat(FrmCadastro_Funcionarios.EdtComissao_Servico.Text);
      Parameters.ParamByName('Endereco').Value :=
        FrmCadastro_Funcionarios.EdtEndereco.Text;
      Parameters.ParamByName('CEP').Value :=
        FrmCadastro_Funcionarios.EdtCEP.Text;
      ExecSQL;
      // DM.ADOConnection1.CommitTrans;
      // lrControle:= Insere;
      // UGeral.Mensagem_Padrao(lrControle);
    end;
  finally
    qAux.close;
    FreeAndNil(qAux);
  end;

  { except
    on E: Exception do
    begin
    //DM.ADOConnection1.RollbackTrans;
    //Operacao_Nao_Completada(E.Message);
    ShowMessage('Erro: '+E.Message);
    end;
    end; }
end;

procedure TFuncionario.Inserir_Outros(var Conexao: TADOConnection);
var
  qAux: TADOQuery;
begin
  // try
  try
    qAux := TADOQuery.Create(nil);
    with qAux, SQL do
    begin
      close;
      Connection := Conexao;
      clear;
      add('INSERT INTO Funcionario_Outros');
      add('           (Codigo');
      add('           ,Data_Admissao');
      add('           ,Data_Demissao');
      add('           ,CTPS_N');
      add('           ,CTPS_Serie');
      add('           ,Titulo_N');
      add('           ,Titulo_Cidade');
      add('           ,Titulo_Zona');
      add('           ,Titulo_Secao');
      add('           ,Certificado_Militar_N');
      add('           ,Certificado_Militar_Serie');
      add('           ,Certificado_Militar_Categoria');
      add('           ,Nome_Pai');
      add('           ,Nome_Mae');
      add('           ,Nacionalidade');
      add('           ,Naturalidade');
      add('           ,Conjuge');
      add('           ,Grau_Instrucao');
      add('           ,CNH_N');
      add('           ,CNH_Categoria');
      add('           ,CNH_Cidade');
      add('           ,PIS_N');
      add('           ,PIS_Data_Cadastro');
      add('           ,PIS_Banco');
      add('           ,PIS_Codigo_Banco');
      add('           ,PIS_Codigo_Agencia');
      add('           ,PIS_Endereco_Agencia)');
      add('     VALUES');
      add('           (:Codigo,');
      add('           :Data_Admissao,');
      add('           :Data_Demissao,');
      add('           :CTPS_N,');
      add('           :CTPS_Serie,');
      add('           :Titulo_N,');
      add('           :Titulo_Cidade,');
      add('           :Titulo_Zona,');
      add('           :Titulo_Secao,');
      add('           :Certificado_Militar_N,');
      add('           :Certificado_Militar_Serie,');
      add('           :Certificado_Militar_Categoria,');
      add('           :Nome_Pai,');
      add('           :Nome_Mae,');
      add('           :Nacionalidade,');
      add('           :Naturalidade,');
      add('           :Conjuge,');
      add('           :Grau_Instrucao,');
      add('           :CNH_N,');
      add('           :CNH_Categoria,');
      add('           :CNH_Cidade,');
      add('           :PIS_N,');
      add('           :PIS_Data_Cadastro,');
      add('           :PIS_Banco,');
      add('           :PIS_Codigo_Banco,');
      add('           :PIS_Codigo_Agencia,');
      add('           :PIS_Endereco_Agencia)');

      Parameters.ParamByName('Codigo').Value :=
        StrToInt(FrmCadastro_Funcionarios.EdtCodigo.Text);

      if (FrmCadastro_Funcionarios.MEdtData_Admissao.Text <> '  /  /    ') then
        Parameters.ParamByName('Data_Admissao').Value :=
          StrToDateTime(FrmCadastro_Funcionarios.MEdtData_Admissao.Text)
      else
        Parameters.ParamByName('Data_Admissao').Value := NULL;

      if (FrmCadastro_Funcionarios.MEdtData_Demissao.Text <> '  /  /    ') then
        Parameters.ParamByName('Data_Demissao').Value :=
          StrToDateTime(FrmCadastro_Funcionarios.MEdtData_Demissao.Text)
      else
        Parameters.ParamByName('Data_Demissao').Value := NULL;

      Parameters.ParamByName('CTPS_N').Value :=
        FrmCadastro_Funcionarios.EdtCTPS_N.Text;
      Parameters.ParamByName('CTPS_Serie').Value :=
        FrmCadastro_Funcionarios.EdtCTPS_Serie.Text;
      Parameters.ParamByName('Titulo_N').Value :=
        FrmCadastro_Funcionarios.EdtTitulo_N.Text;
      Parameters.ParamByName('Titulo_Cidade').Value :=
        FrmCadastro_Funcionarios.EdtTitulo_Cidade.Text;
      Parameters.ParamByName('Titulo_Zona').Value :=
        FrmCadastro_Funcionarios.EdtTitulo_Zona.Text;
      Parameters.ParamByName('Titulo_Secao').Value :=
        FrmCadastro_Funcionarios.EdtTitulo_Secao.Text;
      Parameters.ParamByName('Certificado_Militar_N').Value :=
        FrmCadastro_Funcionarios.EdtCertificado_Militar_N.Text;
      Parameters.ParamByName('Certificado_Militar_Serie').Value :=
        FrmCadastro_Funcionarios.EdtCertificado_Militar_Serie.Text;
      Parameters.ParamByName('Certificado_Militar_Categoria').Value :=
        FrmCadastro_Funcionarios.EdtCertificado_Militar_Categoria.Text;
      Parameters.ParamByName('Nome_Pai').Value :=
        FrmCadastro_Funcionarios.EdtNome_Pai.Text;
      Parameters.ParamByName('Nome_Mae').Value :=
        FrmCadastro_Funcionarios.EdtNome_Mae.Text;
      Parameters.ParamByName('Nacionalidade').Value :=
        FrmCadastro_Funcionarios.EdtNacionalidade.Text;
      Parameters.ParamByName('Naturalidade').Value :=
        FrmCadastro_Funcionarios.EdtNaturalidade.Text;
      Parameters.ParamByName('Conjuge').Value :=
        FrmCadastro_Funcionarios.EdtNome_Conjuge.Text;
      Parameters.ParamByName('Grau_Instrucao').Value :=
        FrmCadastro_Funcionarios.EdtGrau_Instrucao.Text;
      Parameters.ParamByName('CNH_N').Value :=
        FrmCadastro_Funcionarios.EdtCNH_N.Text;
      Parameters.ParamByName('CNH_Categoria').Value :=
        FrmCadastro_Funcionarios.EdtCNH_Categoria.Text;
      Parameters.ParamByName('CNH_Cidade').Value :=
        FrmCadastro_Funcionarios.EdtCNH_Cidade.Text;
      Parameters.ParamByName('PIS_N').Value :=
        FrmCadastro_Funcionarios.EdtPIS_N.Text;

      if (FrmCadastro_Funcionarios.MEdtPIS_Cadastro.Text <> '  /  /    ') then
        Parameters.ParamByName('PIS_Data_Cadastro').Value :=
          StrToDateTime(FrmCadastro_Funcionarios.MEdtPIS_Cadastro.Text)
      else
        Parameters.ParamByName('PIS_Data_Cadastro').Value := NULL;

      Parameters.ParamByName('PIS_Banco').Value :=
        FrmCadastro_Funcionarios.EdtPIS_Banco.Text;
      Parameters.ParamByName('PIS_Codigo_Banco').Value :=
        FrmCadastro_Funcionarios.EdtPIS_Codigo_Banco.Text;
      Parameters.ParamByName('PIS_Codigo_Agencia').Value :=
        FrmCadastro_Funcionarios.EdtPIS_Codigo_Agencia.Text;
      Parameters.ParamByName('PIS_Endereco_Agencia').Value :=
        FrmCadastro_Funcionarios.EdtPIS_Endereco_Agencia.Text;
      ExecSQL;
      // DM.ADOConnection1.CommitTrans;
      // lrControle := Altera;
      // UGeral.Mensagem_Padrao(lrControle);
    end;
  finally
    qAux.close;
    FreeAndNil(qAux);
  end;

  { except
    on E: Exception do
    begin
    //DM.ADOConnection1.RollbackTrans;
    ShowMessage('Erro: '+E.Message);
    //Operacao_Nao_Completada(E.Message);
    end;
    end; }
end;

{ TFornecedor }

procedure TFornecedor.Alterar(var Registro: TFornecedor);
var
  qAux, qaux2: TADOQuery;
begin
  // try
  // DM.ADOConnection1.BeginTrans;
  try
    qAux := TADOQuery.Create(nil);
    qaux2 := TADOQuery.Create(nil);
    with qAux, SQL do
    begin
      close;
      Connection := DM.ADOConnection1;
      clear;
      add('Update Fornecedor set Codigo_Empresa = :Codigo_Empresa, Tipo = :Tipo, Nome_Fantasia = :Nome_Fantasia, ');
      add('Razao_Social = :Razao_Social, CPF = :CPF, RG = :RG, Orgao_Expedidor = :Orgao_Expedidor, ');
      add('Data_Emissao_RG = :Data_Emissao, CNPJ = :CNPJ, Insc_Estadual_Municipal = :Inscricao,');
      add('Numero = :Numero, Referencia = :Referencia, ');
      add('Codigo_Setor = :Setor, Codigo_Cidade = :Cidade, Telefone = :Telefone, ');
      add('Celular = :Celular, Email = :Email, Site = :Site, Data_Cadastro = :Data_Cad, Observacoes = :Obs, ');
      add('Endereco = :Endereco, CEP = :CEP');
      add('where Codigo = :Codigo');
      Parameters.ParamByName('Codigo').Value := Registro.Cod;
      Parameters.ParamByName('Codigo_Empresa').Value := Registro.Cod_Empresa;
      Parameters.ParamByName('Tipo').Value := Registro.Tip;
      Parameters.ParamByName('Nome_Fantasia').Value := Registro.Nome_Fan;
      Parameters.ParamByName('Razao_Social').Value := Registro.Raz;
      Parameters.ParamByName('CPF').Value := Registro.CP;
      Parameters.ParamByName('RG').Value := Registro.Ident;
      Parameters.ParamByName('Orgao_Expedidor').Value := Registro.Orgao;
      Parameters.ParamByName('Data_Emissao').Value := Registro.Data_Emis;
      Parameters.ParamByName('CNPJ').Value := Registro.CNP;
      Parameters.ParamByName('Inscricao').Value := Registro.Inscr;
      Parameters.ParamByName('Numero').Value := Registro.Num;
      Parameters.ParamByName('Referencia').Value := Registro.Refer;
      Parameters.ParamByName('Setor').Value := Registro.Seto;
      Parameters.ParamByName('Cidade').Value := Registro.Cid;
      Parameters.ParamByName('Telefone').Value := Registro.Tel;
      Parameters.ParamByName('Celular').Value := Registro.Cel;
      Parameters.ParamByName('Email').Value := Registro.Ema;
      Parameters.ParamByName('Site').Value := Registro.Sit;
      Parameters.ParamByName('Data_Cad').Value := Registro.Data_Cad;
      Parameters.ParamByName('Obs').Value := Registro.Obs;
      Parameters.ParamByName('Endereco').Value :=
        FrmCadastro_Forn_Fab.EdtEndereco.Text;
      Parameters.ParamByName('CEP').Value := FrmCadastro_Forn_Fab.EdtCEP.Text;
      ExecSQL;
      // DM.ADOConnection1.CommitTrans;
      lrControle := Altera;
      UGeral.Mensagem_Padrao(lrControle);
    end;
  finally
    qAux.close;
    FreeAndNil(qAux);
  end;

  { except
    on E: Exception do
    begin
    //DM.ADOConnection1.RollbackTrans;
    Operacao_Nao_Completada(E.Message);
    end;
    end; }
end;

procedure TFornecedor.Excluir(var Registro: TFornecedor);
var
  qAux, qaux2: TADOQuery;
begin
  // try
  // DM.ADOConnection1.BeginTrans;
  try
    qAux := TADOQuery.Create(nil);
    qaux2 := TADOQuery.Create(nil);
    with qAux, SQL do
    begin
      close;
      clear;
      Connection := DM.ADOConnection1;
      add('Delete from Fornecedor where Codigo = :Codigo');
      Parameters.ParamByName('Codigo').Value := Registro.Cod;
      ExecSQL;
      // DM.ADOConnection1.CommitTrans;
      lrControle := Exclui;
      UGeral.Mensagem_Padrao(lrControle);
    end;
  finally
    qAux.close;
    FreeAndNil(qAux);
  end;

  { except
    on E: Exception do
    begin
    //DM.ADOConnection1.RollbackTrans;
    Operacao_Nao_Completada(E.Message);
    end;
    end; }
end;

function TFornecedor.GetCelular: string;
begin
  GetCelular := FrmCadastro_Forn_Fab.MEdtCelular.Text;
end;

function TFornecedor.GetCNPJ: string;
begin
  GetCNPJ := FrmCadastro_Forn_Fab.EdtCNPJ.Text;
end;

function TFornecedor.GetCodigo: integer;
begin
  GetCodigo := StrToInt(FrmCadastro_Forn_Fab.EdtCodigo.Text);
end;

function TFornecedor.GetCodigo_Cidade: integer;
begin
  if (FrmCadastro_Forn_Fab.EdtCodigo_Cidade.Text = '') then
    GetCodigo_Cidade := 0
  else
    GetCodigo_Cidade := StrToInt(FrmCadastro_Forn_Fab.EdtCodigo_Cidade.Text);
end;

function TFornecedor.GetCodigo_Empresa: integer;
begin
  GetCodigo_Empresa := UDeclaracao.Codigo_Empresa;
end;

function TFornecedor.GetCodigo_Logradouro: integer;
begin
  { if (FrmCadastro_Forn_Fab.EdtCodigo_Endereco.Text = '') then
    GetCodigo_Logradouro := 0
    else
    GetCodigo_Logradouro := StrToInt
    (FrmCadastro_Forn_Fab.EdtCodigo_Endereco.Text); }
end;

function TFornecedor.GetCodigo_Setor: integer;
begin
  if (FrmCadastro_Forn_Fab.EdtCodigo_Setor.Text = '') then
    GetCodigo_Setor := 0
  else
    GetCodigo_Setor := StrToInt(FrmCadastro_Forn_Fab.EdtCodigo_Setor.Text);
end;

function TFornecedor.GetCPF: string;
begin
  GetCPF := FrmCadastro_Forn_Fab.EdtCPF.Text;
end;

function TFornecedor.GetData_Cadastro: Tdate;
begin
  if (FrmCadastro_Forn_Fab.MEdtData_Cadastro.Text = '  /  /    ') then
    GetData_Cadastro := 0
  else
    GetData_Cadastro := StrToDateTime
      (FrmCadastro_Forn_Fab.MEdtData_Cadastro.Text);
end;

function TFornecedor.GetData_Emissao_RG: Tdate;
begin
  if (FrmCadastro_Forn_Fab.EdtData_Emissao.Text = '  /  /    ') then
    GetData_Emissao_RG := 0
  else
    GetData_Emissao_RG :=
      StrToDateTime(FrmCadastro_Forn_Fab.EdtData_Emissao.Text);
end;

function TFornecedor.GetEmail: string;
begin
  GetEmail := FrmCadastro_Forn_Fab.EdtEmail.Text;
end;

function TFornecedor.GetInsc_Estadual_Municipal: string;
begin
  GetInsc_Estadual_Municipal :=
    FrmCadastro_Forn_Fab.EdtInsc_Estadual_Municipal.Text;
end;

function TFornecedor.GetNome_Fantasia: string;
begin
  GetNome_Fantasia := FrmCadastro_Forn_Fab.EdtNome.Text;
end;

function TFornecedor.GetNumero: string;
begin
  GetNumero := FrmCadastro_Forn_Fab.EdtNumero.Text;
end;

function TFornecedor.GetObservacoes: string;
begin
  GetObservacoes := FrmCadastro_Forn_Fab.MmoObservacoes.Text;
end;

function TFornecedor.GetOrgao_Expedidor: string;
begin
  GetOrgao_Expedidor := FrmCadastro_Forn_Fab.EdtOrgao_Expedidor.Text;
end;

function TFornecedor.GetRazao_Social: string;
begin
  GetRazao_Social := FrmCadastro_Forn_Fab.EdtRazao_Social.Text;
end;

function TFornecedor.GetReferencia: string;
begin
  GetReferencia := FrmCadastro_Forn_Fab.EdtReferencia.Text;
end;

function TFornecedor.GetRG: string;
begin
  GetRG := FrmCadastro_Forn_Fab.EdtRG.Text;
end;

function TFornecedor.GetSite: string;
begin
  GetSite := FrmCadastro_Forn_Fab.EdtSite.Text;
end;

function TFornecedor.GetTelefone: string;
begin
  GetTelefone := FrmCadastro_Forn_Fab.MEdtTelefone.Text;
end;

function TFornecedor.GetTipo: string;
begin
  if (FrmCadastro_Forn_Fab.RGOpcao.ItemIndex = 0) then
    GetTipo := 'FORNECEDOR'
  else
    GetTipo := 'FABRICANTE';
end;

procedure TFornecedor.Inserir(var Registro: TFornecedor);
var
  qAux, qaux2: TADOQuery;
begin
  // try
  // DM.ADOConnection1.BeginTrans;
  try
    qAux := TADOQuery.Create(nil);
    qaux2 := TADOQuery.Create(nil);
    with qAux, SQL do
    begin
      close;
      clear;
      Connection := DM.ADOConnection1;
      add('Insert into Fornecedor (Codigo_Empresa, Tipo, Nome_Fantasia, Razao_Social, CPF, RG, Orgao_Expedidor, ');
      add('Data_Emissao_RG, CNPJ, Insc_Estadual_Municipal, ');
      add('Numero, Referencia, Codigo_Setor, Codigo_Cidade, Telefone, Celular, ');
      add('Email, Site, Data_Cadastro, Observacoes, Endereco, CEP) values(:Codigo_Empresa, :Tipo, ');
      add(':Nome_Fantasia, :Razao_Social, :CPF, :RG, :Orgao_Expedidor, :Data_Emissao,');
      add(':CNPJ, :Inscricao, :Numero, :Referencia, ');
      add(':Setor, :Cidade, :Telefone, :Celular, :Email, :Site, :Data_Cad, :Obs, :Endereco, :CEP)');
      Parameters.ParamByName('Codigo_Empresa').Value := Registro.Cod_Empresa;
      Parameters.ParamByName('Tipo').Value := Registro.Tip;
      Parameters.ParamByName('Nome_Fantasia').Value := Registro.Nome_Fan;
      Parameters.ParamByName('Razao_Social').Value := Registro.Raz;
      Parameters.ParamByName('CPF').Value := Registro.CP;
      Parameters.ParamByName('RG').Value := Registro.Ident;
      Parameters.ParamByName('Orgao_Expedidor').Value := Registro.Orgao;
      Parameters.ParamByName('Data_Emissao').Value := Registro.Data_Emis;
      Parameters.ParamByName('CNPJ').Value := Registro.CNP;
      Parameters.ParamByName('Inscricao').Value := Registro.Inscr;
      Parameters.ParamByName('Numero').Value := Registro.Num;
      Parameters.ParamByName('Referencia').Value := Registro.Refer;
      Parameters.ParamByName('Setor').Value := Registro.Seto;
      Parameters.ParamByName('Cidade').Value := Registro.Cid;
      Parameters.ParamByName('Telefone').Value := Registro.Tel;
      Parameters.ParamByName('Celular').Value := Registro.Cel;
      Parameters.ParamByName('Email').Value := Registro.Ema;
      Parameters.ParamByName('Site').Value := Registro.Sit;
      Parameters.ParamByName('Data_Cad').Value := Registro.Data_Cad;
      Parameters.ParamByName('Obs').Value := Registro.Obs;
      Parameters.ParamByName('Endereco').Value :=
        FrmCadastro_Forn_Fab.EdtEndereco.Text;
      Parameters.ParamByName('CEP').Value := FrmCadastro_Forn_Fab.EdtCEP.Text;
      ExecSQL;
      // DM.ADOConnection1.CommitTrans;
      lrControle := Insere;
      UGeral.Mensagem_Padrao(lrControle);
    end;
  finally
    qAux.close;
    FreeAndNil(qAux);
  end;

  { except
    on E: Exception do
    begin
    //DM.ADOConnection1.RollbackTrans;
    Operacao_Nao_Completada(E.Message);
    end;
    end; }
end;

{ TGrupo_Produto }

procedure TGrupo_Produto.Alterar(var Registro: TGrupo_Produto);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Update Grupo_Produto set Descricao = :Descricao, Codigo_Grupo_ICMS = :Codigo_Grupo_ICMS,');
        add('Codigo_Grupo_IPI = :Codigo_Grupo_IPI, Codigo_Grupo_PIS = :Codigo_Grupo_PIS, ');
        add('Codigo_Grupo_COFINS = :Codigo_Grupo_COFINS, Percentual_Vista = :Percentual_Vista, ');
        add('Percentual_Prazo = :Percentual_Prazo, Percentual_Desconto_Vista = :Percentual_Desconto_Vista,');
        add('Percentual_Desconto_Prazo = :Percentual_Desconto_Prazo, Data_Cadastro = :Data_Cadastro,');
        add('Codigo_Sub_Grupo = :Codigo_Sub_Grupo, Sub_Grupo = :Sub_Grupo, Codigo_Pai = :Codigo_Pai,');
        add('Percentual_Comissao_Vista = :Percentual_Comissao_Vista, Percentual_Comissao_Prazo = :Percentual_Comissao_Prazo');
        add('where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        Parameters.ParamByName('Descricao').Value := Registro.Desc;
        Parameters.ParamByName('Codigo_Grupo_ICMS').Value := Registro.Cod_ICMS;
        Parameters.ParamByName('Codigo_Grupo_IPI').Value := Registro.Cod_IPI;
        Parameters.ParamByName('Codigo_Grupo_PIS').Value := Registro.Cod_PIS;
        Parameters.ParamByName('Codigo_Grupo_COFINS').Value :=
          Registro.Cod_COFINS;
        Parameters.ParamByName('Percentual_Vista').Value :=
          StrToFloat(FrmCadastro_Grupo_Produto.EdtPercentual_Vista.Text);
        Parameters.ParamByName('Percentual_Prazo').Value :=
          StrToFloat(FrmCadastro_Grupo_Produto.EdtPercentual_Prazo.Text);
        Parameters.ParamByName('Percentual_Desconto_Vista').Value :=
          StrToFloat
          (FrmCadastro_Grupo_Produto.EdtPercentual_Desconto_Vista.Text);
        Parameters.ParamByName('Percentual_Desconto_Prazo').Value :=
          StrToFloat
          (FrmCadastro_Grupo_Produto.EdtPercentual_Desconto_Prazo.Text);
        Parameters.ParamByName('Data_Cadastro').Value := Registro.Data;

        if (FrmCadastro_Grupo_Produto.EdtCodigo_Sub_Grupo.Text = '') then
          Parameters.ParamByName('Codigo_Sub_Grupo').Value :=
            StrToInt(FrmCadastro_Grupo_Produto.EdtCodigo.Text)
        else
          Parameters.ParamByName('Codigo_Sub_Grupo').Value :=
            StrToInt(FrmCadastro_Grupo_Produto.EdtCodigo_Sub_Grupo.Text);

        Parameters.ParamByName('Sub_Grupo').Value :=
          FrmCadastro_Grupo_Produto.EdtSub_Grupo.Text;

        if (FrmCadastro_Grupo_Produto.EdtCodigo_Sub_Grupo.Text = '') then
          Parameters.ParamByName('Codigo_Pai').Value :=
            StrToInt(FrmCadastro_Grupo_Produto.EdtCodigo.Text)
        else
          Parameters.ParamByName('Codigo_Pai').Value :=
            FrmCadastro_Grupo_Produto.codigo_pai;

        Parameters.ParamByName('Percentual_Comissao_Vista').Value :=
          StrToFloat
          (FrmCadastro_Grupo_Produto.EdtPercentual_Comissao_Vista.Text);
        Parameters.ParamByName('Percentual_Comissao_Prazo').Value :=
          StrToFloat
          (FrmCadastro_Grupo_Produto.EdtPercentual_Comissao_Prazo.Text);
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Altera;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TGrupo_Produto.Excluir(var Registro: TGrupo_Produto);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Delete from Grupo_Produto where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Exclui;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

function TGrupo_Produto.GetCodigo: integer;
begin
  GetCodigo := StrToInt(FrmCadastro_Grupo_Produto.EdtCodigo.Text);
end;

function TGrupo_Produto.GetCodigo_Grupo_COFINS: integer;
begin
  if (FrmCadastro_Grupo_Produto.EdtCodigo_Grupo_COFINS.Text = '') then
    GetCodigo_Grupo_COFINS := 0
  else
    GetCodigo_Grupo_COFINS :=
      StrToInt(FrmCadastro_Grupo_Produto.EdtCodigo_Grupo_COFINS.Text);
end;

function TGrupo_Produto.GetCodigo_Grupo_ICMS: integer;
begin
  if (FrmCadastro_Grupo_Produto.EdtCodigo_Grupo_ICMS.Text = '') then
    GetCodigo_Grupo_ICMS := 0
  else
    GetCodigo_Grupo_ICMS :=
      StrToInt(FrmCadastro_Grupo_Produto.EdtCodigo_Grupo_ICMS.Text);

end;

function TGrupo_Produto.GetCodigo_Grupo_IPI: integer;
begin
  if (FrmCadastro_Grupo_Produto.EdtCodigo_Grupo_IPI.Text = '') then
    GetCodigo_Grupo_IPI := 0
  else
    GetCodigo_Grupo_IPI :=
      StrToInt(FrmCadastro_Grupo_Produto.EdtCodigo_Grupo_IPI.Text);
end;

function TGrupo_Produto.GetCodigo_Grupo_PIS: integer;
begin
  if (FrmCadastro_Grupo_Produto.EdtCodigo_Grupo_PIS.Text = '') then
    GetCodigo_Grupo_PIS := 0
  else
    GetCodigo_Grupo_PIS :=
      StrToInt(FrmCadastro_Grupo_Produto.EdtCodigo_Grupo_PIS.Text);
end;

function TGrupo_Produto.GetData_Cadastro: Tdate;
begin
  GetData_Cadastro := StrToDateTime
    (FrmCadastro_Grupo_Produto.MEdtData_Cadastro.Text);
end;

function TGrupo_Produto.GetDesc: string;
begin
  GetDesc := FrmCadastro_Grupo_Produto.EdtDescricao.Text;
end;

procedure TGrupo_Produto.Inserir(var Registro: TGrupo_Produto);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('insert into Grupo_Produto (Descricao, Codigo_Grupo_ICMS, Codigo_Grupo_IPI, Codigo_Grupo_PIS, Codigo_Grupo_COFINS, ');
        add('Percentual_Vista, Percentual_Prazo, Percentual_Desconto_Vista, Percentual_Desconto_Prazo, Data_Cadastro, ');
        add('Codigo_Sub_Grupo, Sub_Grupo, Codigo_Pai, Percentual_Comissao_Vista, Percentual_Comissao_Prazo)');
        add('values (:Descricao, :Codigo_Grupo_ICMS, :Codigo_Grupo_IPI, :Codigo_Grupo_PIS, :Codigo_Grupo_COFINS, ');
        add(':Percentual_Vista, :Percentual_Prazo, :Percentual_Desconto_Vista, :Percentual_Desconto_Prazo, :Data_Cadastro, ');
        add(':Codigo_Sub_Grupo, :Sub_Grupo, :Codigo_Pai, :Percentual_Comissao_Vista, :Percentual_Comissao_Prazo)');
        Parameters.ParamByName('Descricao').Value := Registro.Desc;
        Parameters.ParamByName('Codigo_Grupo_ICMS').Value := Registro.Cod_ICMS;
        Parameters.ParamByName('Codigo_Grupo_IPI').Value := Registro.Cod_IPI;
        Parameters.ParamByName('Codigo_Grupo_PIS').Value := Registro.Cod_PIS;
        Parameters.ParamByName('Codigo_Grupo_COFINS').Value :=
          Registro.Cod_COFINS;
        Parameters.ParamByName('Percentual_Vista').Value :=
          StrToFloat(FrmCadastro_Grupo_Produto.EdtPercentual_Vista.Text);
        Parameters.ParamByName('Percentual_Prazo').Value :=
          StrToFloat(FrmCadastro_Grupo_Produto.EdtPercentual_Prazo.Text);
        Parameters.ParamByName('Percentual_Desconto_Vista').Value :=
          StrToFloat
          (FrmCadastro_Grupo_Produto.EdtPercentual_Desconto_Vista.Text);
        Parameters.ParamByName('Percentual_Desconto_Prazo').Value :=
          StrToFloat
          (FrmCadastro_Grupo_Produto.EdtPercentual_Desconto_Prazo.Text);
        Parameters.ParamByName('Data_Cadastro').Value := Registro.Data;

        if (FrmCadastro_Grupo_Produto.EdtCodigo_Sub_Grupo.Text = '') then
          Parameters.ParamByName('Codigo_Sub_Grupo').Value :=
            StrToInt(FrmCadastro_Grupo_Produto.EdtCodigo.Text)
        else
          Parameters.ParamByName('Codigo_Sub_Grupo').Value :=
            StrToInt(FrmCadastro_Grupo_Produto.EdtCodigo_Sub_Grupo.Text);

        Parameters.ParamByName('Sub_Grupo').Value :=
          FrmCadastro_Grupo_Produto.EdtSub_Grupo.Text;

        if (FrmCadastro_Grupo_Produto.EdtCodigo_Sub_Grupo.Text = '') then
          Parameters.ParamByName('Codigo_Pai').Value :=
            StrToInt(FrmCadastro_Grupo_Produto.EdtCodigo.Text)
        else
          Parameters.ParamByName('Codigo_Pai').Value :=
            FrmCadastro_Grupo_Produto.codigo_pai;

        Parameters.ParamByName('Percentual_Comissao_Vista').Value :=
          StrToFloat
          (FrmCadastro_Grupo_Produto.EdtPercentual_Comissao_Vista.Text);
        Parameters.ParamByName('Percentual_Comissao_Prazo').Value :=
          StrToFloat
          (FrmCadastro_Grupo_Produto.EdtPercentual_Comissao_Prazo.Text);

        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Insere;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TMarca }

procedure TMarca.Alterar(var Registro: TMarca);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Update Marca set Descricao = :Descricao, Data_Cadastro = :Data_Cadastro');
        add('where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        Parameters.ParamByName('Descricao').Value := Registro.Desc;
        Parameters.ParamByName('Data_Cadastro').Value := Registro.Data;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Altera;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TMarca.Excluir(var Registro: TMarca);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Delete from Marca where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Exclui;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

function TMarca.GetCodigo: integer;
begin
  GetCodigo := StrToInt(FrmCadastro_Marca.EdtCodigo.Text);
end;

function TMarca.GetData_Cadastro: Tdate;
begin
  GetData_Cadastro := StrToDateTime(FrmCadastro_Marca.MEdtData_Cadastro.Text);
end;

function TMarca.GetDesc: string;
begin
  GetDesc := FrmCadastro_Marca.EdtDescricao.Text;
end;

procedure TMarca.Inserir(var Registro: TMarca);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('insert into Marca (Descricao, Data_Cadastro)');
        add('values (:Descricao, :Data_Cadastro)');
        Parameters.ParamByName('Descricao').Value := Registro.Desc;
        Parameters.ParamByName('Data_Cadastro').Value := Registro.Data;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Insere;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TProduto }

procedure TProduto.Alterar(var Registro: TProduto);
var
  qAux, qaux2: TADOQuery;
begin
  // try
  /// /DM.ADOConnection1.BeginTrans;
  try
    qAux := TADOQuery.Create(nil);
    qaux2 := TADOQuery.Create(nil);
    with qAux, SQL do
    begin
      close;
      clear;
      Connection := DM.ADOConnection1;
      add('Update Produto set Tipo = :Tipo, Codigo_Empresa = :Codigo_Empresa, Status = :Status, ');
      add('Gera_Comissao = :Gera_Comissao, Aceita_Devolucao = :Aceita_Devolucao, Arred_Trunc = :Arred_Trunc, Producao_Propria = :Producao_Propria, ');
      add('Codigo_Original = :Codigo_Original, Codigo_Venda = :Codigo_Venda, Descricao = :Descricao, Codigo_Barra = :Codigo_Barra, ');
      add('Codigo_Fornecedor = :Codigo_Fornecedor, Codigo_Fabricante = :Codigo_Fabricante, Codigo_Marca = :Codigo_Marca, ');
      add('Codigo_Unidade_Medida = :Codigo_Unidade_Medida, Codigo_Unidade_Volume = :Codigo_Unidade_Volume,');
      add('Codigo_Grupo = :Codigo_Grupo, Codigo_Grupo_Tributacao = :Codigo_Grupo_Tributacao, ');
      add('Codigo_Grupo_Tributacao_IPI = :Codigo_Grupo_Tributacao_IPI,');
      add('Codigo_Grupo_Tributacao_PIS = :Codigo_Grupo_Tributacao_PIS,');
      add('Codigo_Grupo_Tributacao_COFINS = :Codigo_Grupo_Tributacao_COFINS,');
      add('Codigo_Grupo_Tributacao_ISSQN = :Codigo_Grupo_Tributacao_ISSQN,');
      add('Codigo_Local = :Codigo_Local, Data_Fabricacao = :Data_Fabricacao,');
      add('Data_Validade = :Data_Validade, Ultima_Compra = :Ultima_Compra, Ultima_Venda = :Ultima_Venda,');
      add('Valor_Compra = :Valor_Compra, Valor_Medio = :Valor_Medio, Saldo_Estoque = :Saldo_Estoque, ');
      add('Valor_Ultima_Compra = :Valor_Ultima_Compra, ');
      add('Estoque_Maximo = :Estoque_Maximo, Estoque_Minimo = :Estoque_Minimo, Estoque = :Estoque, Estoque_Reservado = :Estoque_Reservado, Volume = :Volume, Volume_Total = :Volume_Total, ');
      add('Em_Estoque_Maximo = :Em_Estoque_Maximo, Em_Estoque_Minimo = :Em_Estoque_Minimo, Data_Cadastro = :Data_Cadastro, Data_Atualizacao_Estoque = :Data_Atualizacao_Estoque,');
      add('Status_Estoque_Data = :Status_Estoque_Data, NCM = :NCM, Aplicacao = :Aplicacao, Codigo_Similar = :Codigo_Similar, Valor_Compra_Unitario = :Valor_Compra_Unitario, ');
      add('Valor_Ultima_Compra_Unitario = :Valor_Ultima_Compra_Unitario');
      add('where Codigo = :Codigo');
      Parameters.ParamByName('Codigo').Value := Registro.Cod;
      Parameters.ParamByName('Tipo').Value := Registro.Tip;
      Parameters.ParamByName('Codigo_Empresa').Value := Registro.Cod_Empresa;
      Parameters.ParamByName('Status').Value := Registro.Stat;
      Parameters.ParamByName('Gera_Comissao').Value := Registro.Ger_Com;
      Parameters.ParamByName('Aceita_Devolucao').Value := Registro.Ac_Dev;
      Parameters.ParamByName('Arred_Trunc').Value := Registro.Ar_Tru;
      Parameters.ParamByName('Producao_Propria').Value := Registro.Prod_Propria;
      Parameters.ParamByName('Codigo_Original').Value := Registro.Cod_Original;
      Parameters.ParamByName('Codigo_Venda').Value := Registro.Cod_Venda;
      Parameters.ParamByName('Descricao').Value := Registro.Desc;
      Parameters.ParamByName('Codigo_Barra').Value := Registro.Cod_Barra;
      Parameters.ParamByName('Codigo_Fornecedor').Value :=
        Registro.Cod_Fornecedor;
      Parameters.ParamByName('Codigo_Fabricante').Value :=
        Registro.Cod_Fabricante;
      Parameters.ParamByName('Codigo_Marca').Value := Registro.Cod_Marca;
      Parameters.ParamByName('Codigo_Unidade_Medida').Value :=
        Registro.Cod_Un_Medida;
      Parameters.ParamByName('Codigo_Unidade_Volume').Value :=
        Registro.Cod_Un_Volume;
      Parameters.ParamByName('Codigo_Grupo').Value := Registro.Cod_Grupo;
      Parameters.ParamByName('Codigo_Grupo_Tributacao').Value :=
        Registro.Cod_Grupo_Tributacao;
      Parameters.ParamByName('Codigo_Grupo_Tributacao_IPI').Value :=
        Registro.Cod_Grupo_Tributacao_IPI;
      Parameters.ParamByName('Codigo_Grupo_Tributacao_PIS').Value :=
        Registro.Cod_Grupo_Tributacao_PIS;
      Parameters.ParamByName('Codigo_Grupo_Tributacao_COFINS').Value :=
        Registro.Cod_Grupo_Tributacao_COFINS;
      Parameters.ParamByName('Codigo_Grupo_Tributacao_ISSQN').Value :=
        Registro.Cod_Grupo_Tributacao_ISSQN;
      Parameters.ParamByName('Codigo_Local').Value := Registro.Cod_Local;
      Parameters.ParamByName('Data_Fabricacao').Value :=
        Registro.Dat_Fabricacao;
      Parameters.ParamByName('Data_Validade').Value := Registro.Dat_Validade;
      Parameters.ParamByName('Ultima_Compra').Value := Registro.Ult_Compra;
      Parameters.ParamByName('Ultima_Venda').Value := Registro.Ult_Venda;
      Parameters.ParamByName('Valor_Compra').Value := Registro.Valor_Com;
      Parameters.ParamByName('Valor_Medio').Value := Registro.Valor_Med;
      Parameters.ParamByName('Saldo_Estoque').Value := Registro.Sal_Estoque;
      Parameters.ParamByName('Valor_Ultima_Compra').Value :=
        Registro.Valor_Ult_Compra;
      // Parameters.ParamByName('Tipo_Tributacao').Value:= Registro.Tip_Tribut;
      Parameters.ParamByName('Estoque_Maximo').Value := Registro.Estoque_Max;
      Parameters.ParamByName('Estoque_Minimo').Value := Registro.Estoque_Min;
      Parameters.ParamByName('Estoque').Value := Registro.Esto;
      Parameters.ParamByName('Estoque_Reservado').Value := Registro.Esto_Res;
      Parameters.ParamByName('Volume').Value := Registro.Volum;
      Parameters.ParamByName('Volume_Total').Value := Registro.Volum_Total;
      Parameters.ParamByName('Em_Estoque_Maximo').Value :=
        Registro.Em_Est_Maximo;
      Parameters.ParamByName('Em_Estoque_Minimo').Value :=
        Registro.Em_Est_Minimo;
      Parameters.ParamByName('Data_Cadastro').Value := Registro.Dat_Cadastro;
      Parameters.ParamByName('Data_Atualizacao_Estoque').Value :=
        Registro.Dat_At_Est;
      Parameters.ParamByName('Status_Estoque_Data').Value :=
        Registro.Status_Estoque_Dat;
      Parameters.ParamByName('NCM').Value := Registro.NCMM;
      Parameters.ParamByName('Aplicacao').Value :=
        FrmCadastro_Produto.MMOAplicacao.Text;
      Parameters.ParamByName('Codigo_Similar').Value :=
        FrmCadastro_Produto.EdtCodigo_Similar.Text;
      Parameters.ParamByName('Valor_Compra_Unitario').Value :=
        StrToFloat(FrmCadastro_Produto.EdtValor_Compra_Unitario.Text);
      Parameters.ParamByName('Valor_Ultima_Compra_Unitario').Value :=
        StrToFloat(FrmCadastro_Produto.EdtValor_Ultima_Compra_Unitario.Text);
      ExecSQL;
      /// /DM.ADOConnection1.CommitTrans;
      // lrControle:= Altera;
      // UGeral.Mensagem_Padrao(lrControle);
    end;
  finally
    qAux.close;
    FreeAndNil(qAux);
  end;

  // except
  // on E: Exception do
  // begin
  // ////DM.ADOConnection1.RollbackTrans;
  // //Operacao_Nao_Completada(E.Message);
  // ShowMessage('Erro:'+E.Message);
  // abort;
  // end;
  // end;
end;

procedure TProduto.Excluir(var Registro: TProduto);
var
  qAux, qaux2: TADOQuery;
begin
  // try
  /// /DM.ADOConnection1.BeginTrans;
  try
    qAux := TADOQuery.Create(nil);
    qaux2 := TADOQuery.Create(nil);
    with qAux, SQL do
    begin
      close;
      clear;
      Connection := DM.ADOConnection1;
      add('Delete from Produto where Codigo = :Codigo');
      Parameters.ParamByName('Codigo').Value := Registro.Cod;
      ExecSQL;
      /// /DM.ADOConnection1.CommitTrans;
      // lrControle := Exclui;
      // UGeral.Mensagem_Padrao(lrControle);
    end;
  finally
    qAux.close;
    FreeAndNil(qAux);
  end;

  { except
    on E: Exception do
    begin
    Operacao_Nao_Completada(E.Message);
    end;
    end; }
end;

function TProduto.GetAceita_Devolucao: string;
begin
  if (FrmCadastro_Produto.CBAceita_Devolucao.Checked = true) then
    GetAceita_Devolucao := 'SIM'
  else
    GetAceita_Devolucao := 'NO';
end;

function TProduto.GetArred_Trunc: string;
begin
  if (FrmCadastro_Produto.CBTrun_Ar.Checked = true) then
    GetArred_Trunc := 'A'
  else
    GetArred_Trunc := 'T';
end;

function TProduto.GetCodigo: integer;
begin
  GetCodigo := StrToInt(FrmCadastro_Produto.EdtCodigo.Text);
end;

function TProduto.GetCodigo_Barra: string;
begin
  GetCodigo_Barra := '';
end;

function TProduto.GetCodigo_Empresa: integer;
begin
  GetCodigo_Empresa := UDeclaracao.Codigo_Empresa;
end;

function TProduto.GetCodigo_Fabricante: integer;
begin
  if (FrmCadastro_Produto.EdtCodigo_Fabricante.Text = '') then
    GetCodigo_Fabricante := 0
  else
    GetCodigo_Fabricante :=
      StrToInt(FrmCadastro_Produto.EdtCodigo_Fabricante.Text);
end;

function TProduto.GetCodigo_Fornecedor: integer;
begin
  if (FrmCadastro_Produto.EdtCodigo_Fornecedor.Text = '') then
    GetCodigo_Fornecedor := 0
  else
    GetCodigo_Fornecedor :=
      StrToInt(FrmCadastro_Produto.EdtCodigo_Fornecedor.Text);
end;

function TProduto.GetCodigo_Grupo: integer;
begin
  if (FrmCadastro_Produto.EdtCodigo_Grupo.Text = '') then
    GetCodigo_Grupo := 0
  else
    GetCodigo_Grupo := StrToInt(FrmCadastro_Produto.EdtCodigo_Grupo.Text);
end;

function TProduto.GetCodigo_Grupo_Tributacao: integer;
begin
  if (FrmCadastro_Produto.EdtCodigo_Grupo_Tributacao.Text = '') then
    GetCodigo_Grupo_Tributacao := 0
  else
    GetCodigo_Grupo_Tributacao :=
      StrToInt(FrmCadastro_Produto.EdtCodigo_Grupo_Tributacao.Text);
end;

function TProduto.GetCodigo_Grupo_Tributacao_COFINS: integer;
begin
  if (FrmCadastro_Produto.EdtCodigo_Grupo_Tributacao_COFINS.Text = '') then
    GetCodigo_Grupo_Tributacao_COFINS := 0
  else
    GetCodigo_Grupo_Tributacao_COFINS :=
      StrToInt(FrmCadastro_Produto.EdtCodigo_Grupo_Tributacao_COFINS.Text);
end;

function TProduto.GetCodigo_Grupo_Tributacao_IPI: integer;
begin
  if (FrmCadastro_Produto.EdtCodigo_Grupo_Tributacao_IPI.Text = '') then
    GetCodigo_Grupo_Tributacao_IPI := 0
  else
    GetCodigo_Grupo_Tributacao_IPI :=
      StrToInt(FrmCadastro_Produto.EdtCodigo_Grupo_Tributacao_IPI.Text);
end;

function TProduto.GetCodigo_Grupo_Tributacao_ISSQN: integer;
begin
  if (FrmCadastro_Produto.EdtCodigo_Grupo_Tributacao_ISSQN.Text = '') then
    GetCodigo_Grupo_Tributacao_ISSQN := 0
  else
    GetCodigo_Grupo_Tributacao_ISSQN :=
      StrToInt(FrmCadastro_Produto.EdtCodigo_Grupo_Tributacao_ISSQN.Text);
end;

function TProduto.GetCodigo_Grupo_Tributacao_PIS: integer;
begin
  if (FrmCadastro_Produto.EdtCodigo_Grupo_Tributacao_PIS.Text = '') then
    GetCodigo_Grupo_Tributacao_PIS := 0
  else
    GetCodigo_Grupo_Tributacao_PIS :=
      StrToInt(FrmCadastro_Produto.EdtCodigo_Grupo_Tributacao_PIS.Text);
end;

function TProduto.GetCodigo_Local: integer;
begin
  if (FrmCadastro_Produto.EdtCodigo_Local.Text = '') then
    GetCodigo_Local := 0
  else
    GetCodigo_Local := StrToInt(FrmCadastro_Produto.EdtCodigo_Local.Text);
end;

function TProduto.GetCodigo_Marca: integer;
begin
  if (FrmCadastro_Produto.EdtCodigo_Marca.Text = '') then
    GetCodigo_Marca := 0
  else
    GetCodigo_Marca := StrToInt(FrmCadastro_Produto.EdtCodigo_Marca.Text);
end;

function TProduto.GetCodigo_Original: string;
begin
  GetCodigo_Original := FrmCadastro_Produto.EdtCodigo_Original.Text;
end;

function TProduto.GetCodigo_Unidade_Medida: integer;
begin
  if (FrmCadastro_Produto.EdtCodigo_Unidade.Text = '') then
    GetCodigo_Unidade_Medida := 0
  else
    GetCodigo_Unidade_Medida :=
      StrToInt(FrmCadastro_Produto.EdtCodigo_Unidade.Text);
end;

function TProduto.GetCodigo_Unidade_Volume: integer;
begin
  if (FrmCadastro_Produto.EdtCodigo_Unidade_Volume.Text = '') then
    GetCodigo_Unidade_Volume := 0
  else
    GetCodigo_Unidade_Volume :=
      StrToInt(FrmCadastro_Produto.EdtCodigo_Unidade_Volume.Text);
end;

function TProduto.GetCodigo_Venda: string;
begin
  GetCodigo_Venda := FrmCadastro_Produto.EdtCodigo_Produto.Text;
end;

function TProduto.GetData_Atualizacao_Estoque: Tdate;
begin
  if (FrmCadastro_Produto.MEdtData_Atualizacao_Estoque.Text = '  /  /    ') then
    GetData_Atualizacao_Estoque := 0
  else
    GetData_Atualizacao_Estoque :=
      StrToDateTime(FrmCadastro_Produto.MEdtData_Atualizacao_Estoque.Text);
end;

function TProduto.GetData_Cadastro: Tdate;
begin
  GetData_Cadastro := StrToDateTime(FrmCadastro_Produto.MEdtData_Cadastro.Text);
end;

function TProduto.GetData_Fabricacao: Tdate;
begin
  if (FrmCadastro_Produto.MEdtData_Fabricacao.Text = '  /  /    ') then
    GetData_Fabricacao := 0
  else
    GetData_Fabricacao :=
      StrToDateTime(FrmCadastro_Produto.MEdtData_Fabricacao.Text);
end;

function TProduto.GetData_Validade: Tdate;
begin
  if (FrmCadastro_Produto.MEdtData_Validade.Text = '  /  /    ') then
    GetData_Validade := 0
  else
    GetData_Validade := StrToDateTime
      (FrmCadastro_Produto.MEdtData_Validade.Text);
end;

function TProduto.GetDescricao: string;
begin
  GetDescricao := FrmCadastro_Produto.EdtDescricao.Text;
end;

function TProduto.GetEm_Estoque_Maximo: string;
begin
  GetEm_Estoque_Maximo := FrmCadastro_Produto.CmbEstoque_Maximo.Text;
end;

function TProduto.GetEm_Estoque_Minimo: string;
begin
  GetEm_Estoque_Minimo := FrmCadastro_Produto.CmbEstoque_Minimo.Text;
end;

function TProduto.GetEstoque: double;
begin
  GetEstoque := StrToFloat(FrmCadastro_Produto.EdtEstoque.Text);
end;

function TProduto.GetEstoque_Maximo: double;
begin
  GetEstoque_Maximo := StrToFloat(FrmCadastro_Produto.EdtEstoque_Maximo.Text);
end;

function TProduto.GetEstoque_Minimo: double;
begin
  GetEstoque_Minimo := StrToFloat(FrmCadastro_Produto.EdtEstoque_Minimo.Text);
end;

function TProduto.GetEstoque_Reservado: double;
begin
  GetEstoque_Reservado :=
    StrToFloat(FrmCadastro_Produto.EdtEstoque_Reservado.Text);
end;

function TProduto.GetGera_Comissao: string;
begin
  if (FrmCadastro_Produto.CBGera_Comissao.Checked = true) then
    GetGera_Comissao := 'SIM'
  else
    GetGera_Comissao := 'NO';
end;

function TProduto.GetNCM: string;
begin
  GetNCM := FrmCadastro_Produto.EdtNCM.Text;
end;

function TProduto.GetProducao_Propria: string;
begin
  if (FrmCadastro_Produto.CBProducao_Propria.Checked = true) then
    GetProducao_Propria := 'P'
  else
    GetProducao_Propria := 'T';
end;

function TProduto.GetSaldo_Estoque: double;
begin
  GetSaldo_Estoque := StrToFloat(FrmCadastro_Produto.EdtSaldo_Estoque.Text);
end;

function TProduto.GetStatus: string;
begin
  if (FrmCadastro_Produto.CBAtivo.Checked = true) then
    GetStatus := 'ATIVO'
  else
    GetStatus := 'INATIVO';
end;

function TProduto.GetStatus_Estoque_Data: string;
begin
  if StrToFloat(FrmCadastro_Produto.EdtEstoque.Text) >= 0 then
    GetStatus_Estoque_Data := '+'
  else
    GetStatus_Estoque_Data := '-';
end;

function TProduto.GetTipo: integer;
begin
  if (FrmCadastro_Produto.CBServico.Checked = true) then
    GetTipo := 1
  else
    GetTipo := 0;
end;

function TProduto.GetTipo_Tributacao: string;
begin
  { if (FrmCadastro_Produto.RGTipo_Tributacao.ItemIndex = 0) then
    GetTipo_Tributacao:= 'I'
    else if (FrmCadastro_Produto.RGTipo_Tributacao.ItemIndex = 1) then
    GetTipo_Tributacao:= 'N'
    else if (FrmCadastro_Produto.RGTipo_Tributacao.ItemIndex = 2) then
    GetTipo_Tributacao:= 'F'
    else if (FrmCadastro_Produto.RGTipo_Tributacao.ItemIndex = 3) then
    GetTipo_Tributacao:= 'T'
    else if (FrmCadastro_Produto.RGTipo_Tributacao.ItemIndex = 4) then
    GetTipo_Tributacao:= 'S'; }
  GetTipo_Tributacao := '';
end;

function TProduto.GetUltima_Compra: Tdate;
begin
  if (FrmCadastro_Produto.MEdtUltima_Compra.Text = '  /  /    ') then
    GetUltima_Compra := 0
  else
    GetUltima_Compra := StrToDateTime
      (FrmCadastro_Produto.MEdtUltima_Compra.Text);
end;

function TProduto.GetUltima_Venda: Tdate;
begin
  if (FrmCadastro_Produto.MEdtUltima_Venda.Text = '  /  /    ') then
    GetUltima_Venda := 0
  else
    GetUltima_Venda := StrToDateTime(FrmCadastro_Produto.MEdtUltima_Venda.Text);
end;

function TProduto.GetValor_Compra: double;
begin
  GetValor_Compra := StrToFloat(FrmCadastro_Produto.EdtValor_Compra.Text);
end;

function TProduto.GetValor_Medio: double;
begin
  GetValor_Medio := StrToFloat(FrmCadastro_Produto.EdtValor_Medio.Text);
end;

function TProduto.GetValor_Ultima_Compra: double;
begin
  GetValor_Ultima_Compra :=
    StrToFloat(FrmCadastro_Produto.EdtValor_Ultima_Compra.Text);
end;

function TProduto.GetVolume: double;
begin
  GetVolume := StrToFloat(FrmCadastro_Produto.EdtVolume.Text);
end;

function TProduto.GetVolume_Total: double;
begin
  GetVolume_Total := StrToFloat(FrmCadastro_Produto.EdtVolume_Total.Text);
end;

procedure TProduto.Inserir(var Registro: TProduto);
var
  qAux, qaux2: TADOQuery;
begin
  // try
  /// /DM.ADOConnection1.BeginTrans;
  try
    qAux := TADOQuery.Create(nil);
    qaux2 := TADOQuery.Create(nil);
    with qAux, SQL do
    begin
      close;
      clear;
      Connection := DM.ADOConnection1;
      add('Insert into Produto (Tipo, Codigo_Empresa, Status, Gera_Comissao, Aceita_Devolucao, Arred_Trunc, Producao_Propria,');
      add('Codigo_Original, Codigo_Venda, Descricao, Codigo_Barra, Codigo_Fornecedor,');
      add('Codigo_Fabricante, Codigo_Marca, Codigo_Unidade_Medida, Codigo_Unidade_Volume, Codigo_Grupo, Codigo_Grupo_Tributacao,');
      add('Codigo_Grupo_Tributacao_IPI, Codigo_Grupo_Tributacao_PIS, Codigo_Grupo_Tributacao_COFINS, Codigo_Grupo_Tributacao_ISSQN,');
      add('Codigo_Local, Data_Fabricacao, Data_Validade, Ultima_Compra, Ultima_Venda, Valor_Compra, ');
      add('Valor_Medio, Saldo_Estoque, Valor_Ultima_Compra, ');
      add('Estoque_Maximo, Estoque_Minimo, Estoque, Estoque_Reservado, Volume, Volume_Total, Em_Estoque_Maximo, Em_Estoque_Minimo, ');
      add('Data_Cadastro, Data_Atualizacao_Estoque, Status_Estoque_Data, NCM, Aplicacao, Codigo_Similar, Valor_Compra_Unitario,');
      add('Valor_Ultima_Compra_Unitario) values (:Tipo, :Codigo_Empresa, ');
      add(':Status, :Gera_Comissao, :Aceita_Devolucao, :Arred_Trunc, :Producao_Propria, :Codigo_Original, :Codigo_Venda,');
      add(':Descricao, :Codigo_Barra, :Codigo_Fornecedor, :Codigo_Fabricante, :Codigo_Marca, :Codigo_Unidade_Medida,');
      add(':Codigo_Unidade_Volume, :Codigo_Grupo, :Codigo_Grupo_Tributacao, :Codigo_Grupo_Tributacao_IPI, :Codigo_Grupo_Tributacao_PIS, ');
      add(':Codigo_Grupo_Tributacao_COFINS, :Codigo_Grupo_Tributacao_ISSQN, :Codigo_Local, :Data_Fabricacao, :Data_Validade, :Ultima_Compra,');
      add(':Ultima_Venda, :Valor_Compra, :Valor_Medio, :Saldo_Estoque, :Valor_Ultima_Compra,');
      add(':Estoque_Maximo, :Estoque_Minimo, :Estoque, :Estoque_Reservado, :Volume, :Volume_Total, :Em_Estoque_Maximo, :Em_Estoque_Minimo, ');
      add(':Data_Cadastro, :Data_Atualizacao_Estoque, :Status_Estoque_Data, :NCM, :Aplicacao, :Codigo_Similar, :Valor_Compra_Unitario,');
      add(':Valor_Ultima_Compra_Unitario)');
      // Parameters.ParamByName('Codigo').Value:= Registro.Cod;
      Parameters.ParamByName('Tipo').Value := Registro.Tip;
      Parameters.ParamByName('Codigo_Empresa').Value := Registro.Cod_Empresa;
      Parameters.ParamByName('Status').Value := Registro.Stat;
      Parameters.ParamByName('Gera_Comissao').Value := Registro.Ger_Com;
      Parameters.ParamByName('Aceita_Devolucao').Value := Registro.Ac_Dev;
      Parameters.ParamByName('Arred_Trunc').Value := Registro.Ar_Tru;
      Parameters.ParamByName('Producao_Propria').Value := Registro.Prod_Propria;
      Parameters.ParamByName('Codigo_Original').Value := Registro.Cod_Original;
      Parameters.ParamByName('Codigo_Venda').Value := Registro.Cod_Venda;
      Parameters.ParamByName('Descricao').Value := Registro.Desc;
      Parameters.ParamByName('Codigo_Barra').Value := Registro.Cod_Barra;
      Parameters.ParamByName('Codigo_Fornecedor').Value :=
        Registro.Cod_Fornecedor;
      Parameters.ParamByName('Codigo_Fabricante').Value :=
        Registro.Cod_Fabricante;
      Parameters.ParamByName('Codigo_Marca').Value := Registro.Cod_Marca;
      Parameters.ParamByName('Codigo_Unidade_Medida').Value :=
        Registro.Cod_Un_Medida;
      Parameters.ParamByName('Codigo_Unidade_Volume').Value :=
        Registro.Cod_Un_Volume;
      Parameters.ParamByName('Codigo_Grupo').Value := Registro.Cod_Grupo;
      Parameters.ParamByName('Codigo_Grupo_Tributacao').Value :=
        Registro.Cod_Grupo_Tributacao;
      Parameters.ParamByName('Codigo_Grupo_Tributacao_IPI').Value :=
        Registro.Cod_Grupo_Tributacao_IPI;
      Parameters.ParamByName('Codigo_Grupo_Tributacao_PIS').Value :=
        Registro.Cod_Grupo_Tributacao_PIS;
      Parameters.ParamByName('Codigo_Grupo_Tributacao_COFINS').Value :=
        Registro.Cod_Grupo_Tributacao_COFINS;
      Parameters.ParamByName('Codigo_Grupo_Tributacao_ISSQN').Value :=
        Registro.Cod_Grupo_Tributacao_ISSQN;
      Parameters.ParamByName('Codigo_Local').Value := Registro.Cod_Local;
      Parameters.ParamByName('Data_Fabricacao').Value :=
        Registro.Dat_Fabricacao;
      Parameters.ParamByName('Data_Validade').Value := Registro.Dat_Validade;
      Parameters.ParamByName('Ultima_Compra').Value := Registro.Ult_Compra;
      Parameters.ParamByName('Ultima_Venda').Value := Registro.Ult_Venda;
      Parameters.ParamByName('Valor_Compra').Value := Registro.Valor_Com;
      Parameters.ParamByName('Valor_Medio').Value := Registro.Valor_Med;
      Parameters.ParamByName('Saldo_Estoque').Value := Registro.Sal_Estoque;
      Parameters.ParamByName('Valor_Ultima_Compra').Value :=
        Registro.Valor_Ult_Compra;
      // Parameters.ParamByName('Tipo_Tributacao').Value:= Registro.Tip_Tribut;
      Parameters.ParamByName('Estoque_Maximo').Value := Registro.Estoque_Max;
      Parameters.ParamByName('Estoque_Minimo').Value := Registro.Estoque_Min;
      Parameters.ParamByName('Estoque').Value := Registro.Esto;
      Parameters.ParamByName('Estoque_Reservado').Value := Registro.Esto_Res;
      Parameters.ParamByName('Volume').Value := Registro.Volum;
      Parameters.ParamByName('Volume_Total').Value := Registro.Volum_Total;
      Parameters.ParamByName('Em_Estoque_Maximo').Value :=
        Registro.Em_Est_Maximo;
      Parameters.ParamByName('Em_Estoque_Minimo').Value :=
        Registro.Em_Est_Minimo;
      Parameters.ParamByName('Data_Cadastro').Value := Registro.Dat_Cadastro;
      Parameters.ParamByName('Data_Atualizacao_Estoque').Value :=
        Registro.Dat_At_Est;
      Parameters.ParamByName('Status_Estoque_Data').Value :=
        Registro.Status_Estoque_Dat;
      Parameters.ParamByName('NCM').Value := Registro.NCMM;
      Parameters.ParamByName('Aplicacao').Value :=
        FrmCadastro_Produto.MMOAplicacao.Text;
      Parameters.ParamByName('Codigo_Similar').Value :=
        FrmCadastro_Produto.EdtCodigo_Similar.Text;
      Parameters.ParamByName('Valor_Compra_Unitario').Value :=
        StrToFloat(FrmCadastro_Produto.EdtValor_Compra_Unitario.Text);
      Parameters.ParamByName('Valor_Ultima_Compra_Unitario').Value :=
        StrToFloat(FrmCadastro_Produto.EdtValor_Ultima_Compra_Unitario.Text);
      ExecSQL;
      /// /DM.ADOConnection1.CommitTrans;
      // lrControle:= Insere;
      // UGeral.Mensagem_Padrao(lrControle);
    end;
  finally
    qAux.close;
    FreeAndNil(qAux);
  end;

  // except
  // on E: Exception do
  // begin
  // ////DM.ADOConnection1.RollbackTrans;
  // //Operacao_Nao_Completada(E.Message);
  // ShowMessage('Erro:'+E.Message);
  // abort;
  // end;
  // end;
end;

{ TTipo_Documento }

procedure TTipo_Documento.Alterar(var Registro: TTipo_Documento);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Update Tipo_Documento set Descricao = :Descricao, Data_Cadastro = :Data_Cadastro');
        add('where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        Parameters.ParamByName('Descricao').Value := Registro.Desc;
        Parameters.ParamByName('Data_Cadastro').Value := Registro.Data;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Altera;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TTipo_Documento.Excluir(var Registro: TTipo_Documento);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Delete from Tipo_Documento where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Exclui;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

function TTipo_Documento.GetCodigo: integer;
begin
  GetCodigo := StrToInt(FrmCadastro_Tipo_Documento.EdtCodigo.Text);
end;

function TTipo_Documento.GetData_Cadastro: Tdate;
begin
  GetData_Cadastro := StrToDateTime
    (FrmCadastro_Tipo_Documento.MEdtData_Cadastro.Text);
end;

function TTipo_Documento.GetDesc: string;
begin
  GetDesc := FrmCadastro_Tipo_Documento.EdtDescricao.Text;
end;

procedure TTipo_Documento.Inserir(var Registro: TTipo_Documento);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('insert into Tipo_Documento (Descricao, Data_Cadastro)');
        add('values (:Descricao, :Data_Cadastro)');
        Parameters.ParamByName('Descricao').Value := Registro.Desc;
        Parameters.ParamByName('Data_Cadastro').Value := Registro.Data;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Insere;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TCondicao_Pagamento }

procedure TCondicao_Pagamento.Alterar(var Registro: TCondicao_Pagamento);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Update Condicao_Pagamento set Status = :Status, Descricao = :Descricao, Parcela = :Parcela, Prazo = :Prazo, ');
        add('Taxa = :Taxa, Indice = :Indice, Tipo_Pagamento = :Tipo_Pagamento, Forma_Negociacao = :Forma_Negociacao, ');
        add('TEF = :TEF, Cheque = :Cheque, Bandeira = :Bandeira, Tipo_Juro = :Tipo_Juro, Data_Cadastro = :Data_Cadastro, ');
        Add('Programa_Impressora = :Programa_Impressora, CNPJ_Operadora = :CNPJ_Operadora ');
        add('where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        Parameters.ParamByName('Status').Value := Registro.Stat;
        Parameters.ParamByName('Descricao').Value := Registro.Desc;
        Parameters.ParamByName('Parcela').Value := Registro.Par;
        Parameters.ParamByName('Prazo').Value := Registro.Pr;
        Parameters.ParamByName('Taxa').Value := Registro.Tax;
        Parameters.ParamByName('Indice').Value :=
          FrmCadastro_Condicao_Pagamento.EdtIndice.Text;
        Parameters.ParamByName('Tipo_Pagamento').Value := Registro.Tipo_Pag;
        Parameters.ParamByName('Forma_Negociacao').Value := Registro.Forma_Neg;
        Parameters.ParamByName('TEF').Value := Registro.TEFF;
        Parameters.ParamByName('Cheque').Value := Registro.Che;
        Parameters.ParamByName('Bandeira').Value := Registro.Band;
        Parameters.ParamByName('Tipo_Juro').Value := Registro.Tipo_Ju;
        Parameters.ParamByName('Data_Cadastro').Value := Registro.Data;
        if (FrmCadastro_Condicao_Pagamento.CBPrograma.Checked) then
          Parameters.ParamByName('Programa_Impressora').Value := 'SIM'
        else
          Parameters.ParamByName('Programa_Impressora').Value := 'NO';
        Parameters.ParamByName('CNPJ_Operadora').Value := FrmCadastro_Condicao_Pagamento.EdtCNPJ_Operadora.Text;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Altera;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TCondicao_Pagamento.Excluir(var Registro: TCondicao_Pagamento);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Delete from Condicao_Pagamento where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Exclui;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

function TCondicao_Pagamento.GETBandeira: string;
begin
end;

function TCondicao_Pagamento.GETCheque: string;
begin
  if (FrmCadastro_Condicao_Pagamento.RGCheque.ItemIndex = 0) then
    GETCheque := 'DINHEIRO'
  else if (FrmCadastro_Condicao_Pagamento.RGCheque.ItemIndex = 1) then
    GETCheque := 'CARTO CREDITO'
  else if (FrmCadastro_Condicao_Pagamento.RGCheque.ItemIndex = 2) then
    GETCheque := 'CARTO DEBITO'
  else if (FrmCadastro_Condicao_Pagamento.RGCheque.ItemIndex = 3) then
    GETCheque := 'CHEQUE'
  else if (FrmCadastro_Condicao_Pagamento.RGCheque.ItemIndex = 4) then
    GETCheque := 'CREDITO LOJA'
  else if (FrmCadastro_Condicao_Pagamento.RGCheque.ItemIndex = 5) then
    GETCheque := 'OUTROS';
end;

function TCondicao_Pagamento.GetCodigo: integer;
begin
  GetCodigo := StrToInt(FrmCadastro_Condicao_Pagamento.EdtCodigo.Text);
end;

function TCondicao_Pagamento.GetData_Cadastro: Tdate;
begin
  GetData_Cadastro := StrToDateTime
    (FrmCadastro_Condicao_Pagamento.MEdtData_Cadastro.Text);
end;

function TCondicao_Pagamento.GetDesc: string;
begin
  GetDesc := FrmCadastro_Condicao_Pagamento.EdtDescricao.Text;
end;

function TCondicao_Pagamento.GetForma_Negociacao: string;
begin
end;

function TCondicao_Pagamento.GetParcela: integer;
begin
  GetParcela := StrToInt(FrmCadastro_Condicao_Pagamento.EdtParcela.Text);
end;

function TCondicao_Pagamento.GetPrazo: integer;
begin
  GetPrazo := StrToInt(FrmCadastro_Condicao_Pagamento.EdtPrazo.Text);
end;

function TCondicao_Pagamento.GetStatus: string;
begin
  if (FrmCadastro_Condicao_Pagamento.CBStatus.Checked = true) then
    GetStatus := 'ATIVO'
  else
    GetStatus := 'INATIVO';
end;

function TCondicao_Pagamento.GetTaxa: double;
begin
  GetTaxa := StrToFloat(FrmCadastro_Condicao_Pagamento.EdtTaxa_Juros.Text);
end;

function TCondicao_Pagamento.GETTEF: string;
begin
  if (FrmCadastro_Condicao_Pagamento.RGTEF.ItemIndex = 0) then
    GETTEF := 'SIM'
  else
    GETTEF := 'NO';
end;

function TCondicao_Pagamento.GetTipo_Juro: string;
begin
  if (FrmCadastro_Condicao_Pagamento.RGTipo_Juro.ItemIndex = 0) then
    GetTipo_Juro := 'S'
  else
    GetTipo_Juro := 'C';
end;

function TCondicao_Pagamento.GetTipo_Pagamento: string;
begin
  if (FrmCadastro_Condicao_Pagamento.RBA_Vista.Checked = true) then
    GetTipo_Pagamento := 'A VISTA'
  else if (FrmCadastro_Condicao_Pagamento.RBA_PRazo.Checked = true) then
    GetTipo_Pagamento := 'A PRAZO';
end;

procedure TCondicao_Pagamento.Inserir(var Registro: TCondicao_Pagamento);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Insert Into Condicao_Pagamento (Codigo, Status, Descricao, Parcela, Prazo, Taxa, Indice, Tipo_Pagamento, Forma_Negociacao, TEF, Cheque, Bandeira, Tipo_Juro, Data_Cadastro, Programa_Impressora, CNPJ_Operadora) values (');
        add(':Codigo, :Status, :Descricao, :Parcela, :Prazo, :Taxa, :Indice, :Tipo_Pagamento, :Forma_Negociacao, :TEF, :Cheque, :Bandeira, :Tipo_Juro, :Data_Cadastro, :Programa_Impressora, :CNPJ_Operadora)');
        // add('where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        Parameters.ParamByName('Status').Value := Registro.Stat;
        Parameters.ParamByName('Descricao').Value := Registro.Desc;
        Parameters.ParamByName('Parcela').Value := Registro.Par;
        Parameters.ParamByName('Prazo').Value := Registro.Pr;
        Parameters.ParamByName('Taxa').Value := Registro.Tax;
        Parameters.ParamByName('Indice').Value :=
          FrmCadastro_Condicao_Pagamento.EdtIndice.Text;
        Parameters.ParamByName('Tipo_Pagamento').Value := Registro.Tipo_Pag;
        Parameters.ParamByName('Forma_Negociacao').Value := Registro.Forma_Neg;
        Parameters.ParamByName('TEF').Value := Registro.TEFF;
        Parameters.ParamByName('Cheque').Value := Registro.Che;
        Parameters.ParamByName('Bandeira').Value := Registro.Band;
        Parameters.ParamByName('Tipo_Juro').Value := Registro.Tipo_Ju;
        Parameters.ParamByName('Data_Cadastro').Value := Registro.Data;
        if (FrmCadastro_Condicao_Pagamento.CBPrograma.Checked) then
          Parameters.ParamByName('Programa_Impressora').Value := 'SIM'
        else
          Parameters.ParamByName('Programa_Impressora').Value := 'NO';
        Parameters.ParamByName('CNPJ_Operadora').Value := FrmCadastro_Condicao_Pagamento.EdtCNPJ_Operadora.Text;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Insere;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TPlano_Financeiro }

procedure TPlano_Financeiro.Alterar(var Registro: TPlano_Financeiro);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Update Plano_Financeiro set Codigo_Empresa = :Codigo_Empresa, Tipo = :Tipo, Descricao = :Descricao, Codigo_SubNivel = :SubNivel, ');
        add('Data_Cadastro = :Data_Cadastro, Sub_Nivel = :Sub_Nivel, Codigo_Pai = :Codigo_Pai ');
        add('where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        Parameters.ParamByName('Codigo_Empresa').Value := Registro.Cod_Empresa;
        Parameters.ParamByName('Tipo').Value := Registro.Tip;
        Parameters.ParamByName('Descricao').Value := Registro.Desc;
        Parameters.ParamByName('SubNivel').Value := Registro.SubN;
        Parameters.ParamByName('Data_Cadastro').Value := Registro.Data;

        Parameters.ParamByName('Sub_Nivel').Value :=
          FrmCadastro_Plano_Financeiro.EdtSub_Grupo.Text;

        if (FrmCadastro_Plano_Financeiro.EdtCodigo_SubNivel.Text = '') then
          Parameters.ParamByName('Codigo_Pai').Value :=
            StrToInt(FrmCadastro_Plano_Financeiro.EdtCodigo.Text)
        else
          Parameters.ParamByName('Codigo_Pai').Value :=
            FrmCadastro_Plano_Financeiro.codigo_pai;

        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Altera;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TPlano_Financeiro.Excluir(var Registro: TPlano_Financeiro);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Delete from Plano_Financeiro where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Exclui;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

function TPlano_Financeiro.GetCodigo: integer;
begin
  GetCodigo := StrToInt(FrmCadastro_Plano_Financeiro.EdtCodigo.Text);
end;

function TPlano_Financeiro.GetCodigo_Empresa: integer;
begin
  GetCodigo_Empresa := UDeclaracao.Codigo_Empresa;
end;

function TPlano_Financeiro.GetData_Cadastro: Tdate;
begin
  GetData_Cadastro := StrToDateTime
    (FrmCadastro_Plano_Financeiro.MEdtData_Cadastro.Text);
end;

function TPlano_Financeiro.GetDesc: string;
begin
  GetDesc := FrmCadastro_Plano_Financeiro.EdtDescricao.Text;
end;

function TPlano_Financeiro.GetSubnivel: integer;
begin
  if (FrmCadastro_Plano_Financeiro.EdtCodigo_SubNivel.Text = '') then
    GetSubnivel := StrToInt(FrmCadastro_Plano_Financeiro.EdtCodigo.Text)
  else
    GetSubnivel :=
      StrToInt(FrmCadastro_Plano_Financeiro.EdtCodigo_SubNivel.Text);
end;

function TPlano_Financeiro.GetTipo: string;
begin
  if (FrmCadastro_Plano_Financeiro.RGTipo.ItemIndex = 0) then
    GetTipo := 'RECEITA'
  else
    GetTipo := 'DESPESA';
end;

procedure TPlano_Financeiro.Inserir(var Registro: TPlano_Financeiro);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Insert Into Plano_Financeiro (Codigo_Empresa, Tipo, Descricao, Codigo_Subnivel, Data_Cadastro, Sub_Nivel, Codigo_Pai) values (');
        add(':Codigo_Empresa, :Tipo, :Descricao, :Subnivel, :Data_Cadastro, :Sub_Nivel, :Codigo_Pai)');
        Parameters.ParamByName('Codigo_Empresa').Value := Registro.Cod_Empresa;
        Parameters.ParamByName('Tipo').Value := Registro.Tip;
        Parameters.ParamByName('Descricao').Value := Registro.Desc;
        Parameters.ParamByName('Subnivel').Value := Registro.SubN;
        Parameters.ParamByName('Data_Cadastro').Value := Registro.Data;

        Parameters.ParamByName('Sub_Nivel').Value :=
          FrmCadastro_Plano_Financeiro.EdtSub_Grupo.Text;

        if (FrmCadastro_Plano_Financeiro.EdtCodigo_SubNivel.Text = '') then
          Parameters.ParamByName('Codigo_Pai').Value :=
            StrToInt(FrmCadastro_Plano_Financeiro.EdtCodigo.Text)
        else
          Parameters.ParamByName('Codigo_Pai').Value :=
            FrmCadastro_Plano_Financeiro.codigo_pai;

        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Insere;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TEmpresa }

procedure TEmpresa.Alterar(var Registro: TEmpresa);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Update Empresa set Nome_Fantasia = :Nome_Fantasia, Razao_Social = :Razao_Social, ');
        add('Proprietario = :Proprietario, CNPJ = :CNPJ, Insc_Estadual = :Insc_Estadual, Insc_Municipal = :Insc_Municipal, ');
        add('Suframa = :Suframa, CNAE = :CNAE, Regime_Tributario = :Regime_Tributario, Enquadramento = :Enquadramento, Aliquota = :Aliquota, Custo_OP = :Custo_OP,');
        add('Numero = :Numero, Complemento = :Complemento, Codigo_Setor = :Setor, ');
        add('Codigo_Cidade = :Cidade, Telefone = :Telefone, Fax = :Fax, Email = :Email, Senha = :Senha, SMTP = :SMTP, Porta = :Porta, ');
        add('Site = :Site, Data_Cadastro = :Data_Cad, Observacoes = :Obs, Contato = :Contato, Telefone_Contato = :Telefone_Contato,');
        add('Endereco = :Endereco, CEP = :CEP');
        add('where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        Parameters.ParamByName('Nome_Fantasia').Value := Registro.Nome_Fan;
        Parameters.ParamByName('Razao_Social').Value := Registro.Raz;
        Parameters.ParamByName('Proprietario').Value := Registro.Prop;
        Parameters.ParamByName('CNPJ').Value := Registro.CNP;
        Parameters.ParamByName('Insc_Estadual').Value := Registro.Inscr_Est;
        Parameters.ParamByName('Insc_Municipal').Value := Registro.Inscr_Mun;
        Parameters.ParamByName('Suframa').Value := Registro.Sufram;
        Parameters.ParamByName('CNAE').Value := Registro.CNAEE;
        Parameters.ParamByName('Regime_Tributario').Value :=
          Registro.Regime_Trib;
        Parameters.ParamByName('Enquadramento').Value := Registro.Enquad;
        Parameters.ParamByName('Aliquota').Value := Registro.Ali;
        Parameters.ParamByName('Custo_OP').Value := Registro.Custo_OPP;
        Parameters.ParamByName('Numero').Value := Registro.Num;
        Parameters.ParamByName('Complemento').Value := Registro.Comp;
        Parameters.ParamByName('Setor').Value := Registro.Seto;
        Parameters.ParamByName('Cidade').Value := Registro.Cid;
        Parameters.ParamByName('Telefone').Value := Registro.Tel;
        Parameters.ParamByName('Fax').Value := Registro.FA;
        Parameters.ParamByName('Email').Value := Registro.Ema;
        Parameters.ParamByName('Senha').Value := Registro.Sen;
        Parameters.ParamByName('SMTP').Value :=
          FrmCadastro_Empresa.EdtSMTP.Text;
        Parameters.ParamByName('Porta').Value :=
          FrmCadastro_Empresa.EdtPorta.Text;
        Parameters.ParamByName('Site').Value := Registro.Sit;
        Parameters.ParamByName('Data_Cad').Value := Registro.Data_Cad;
        Parameters.ParamByName('Obs').Value := Registro.Obs;
        Parameters.ParamByName('Contato').Value := Registro.Cont;
        Parameters.ParamByName('Telefone_Contato').Value := Registro.Tel_Cont;
        Parameters.ParamByName('Endereco').Value :=
          FrmCadastro_Empresa.EdtEndereco.Text;
        Parameters.ParamByName('CEP').Value := FrmCadastro_Empresa.EdtCEP.Text;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Altera;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TEmpresa.Excluir(var Registro: TEmpresa);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Delete from Empresa where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Exclui;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

function TEmpresa.GetFax: string;
begin
  GetFax := FrmCadastro_Empresa.MEdtFax.Text;
end;

function TEmpresa.GetAliquota: string;
begin
  GetAliquota := FrmCadastro_Empresa.EdtAliquota.Text;
end;

function TEmpresa.GetCNAE: string;
begin
  GetCNAE := FrmCadastro_Empresa.EdtCNAE.Text;
end;

function TEmpresa.GetCNPJ: string;
begin
  GetCNPJ := FrmCadastro_Empresa.EdtCNPJ.Text;
end;

function TEmpresa.GetCodigo: integer;
begin
  GetCodigo := StrToInt(FrmCadastro_Empresa.EdtCodigo.Text);
end;

function TEmpresa.GetCodigo_Cidade: integer;
begin
  if (FrmCadastro_Empresa.EdtCodigo_Cidade.Text = '') then
    GetCodigo_Cidade := 0
  else
    GetCodigo_Cidade := StrToInt(FrmCadastro_Empresa.EdtCodigo_Cidade.Text);
end;

function TEmpresa.GetCodigo_Logradouro: integer;
begin
  { if (FrmCadastro_Empresa.EdtCodigo_Endereco.Text = '') then
    GetCodigo_Logradouro := 0
    else
    GetCodigo_Logradouro := StrToInt
    (FrmCadastro_Empresa.EdtCodigo_Endereco.Text); }
end;

function TEmpresa.GetCodigo_Setor: integer;
begin
  if (FrmCadastro_Empresa.EdtCodigo_Setor.Text = '') then
    GetCodigo_Setor := 0
  else
    GetCodigo_Setor := StrToInt(FrmCadastro_Empresa.EdtCodigo_Setor.Text);
end;

function TEmpresa.GetComplemento: string;
begin
  GetComplemento := FrmCadastro_Empresa.EdtComplemento.Text;
end;

function TEmpresa.GetContato: string;
begin
  GetContato := FrmCadastro_Empresa.EdtContato.Text;
end;

function TEmpresa.GetCusto_OP: double;
begin
  GetCusto_OP := StrToFloat(FrmCadastro_Empresa.EdtCusto_OP.Text);
end;

function TEmpresa.GetData_Cadastro: Tdate;
begin
  if (FrmCadastro_Empresa.MEdtData_Cadastro.Text = '  /  /    ') then
    GetData_Cadastro := 0
  else
    GetData_Cadastro := StrToDateTime
      (FrmCadastro_Empresa.MEdtData_Cadastro.Text);
end;

function TEmpresa.GetEmail: string;
begin
  GetEmail := FrmCadastro_Empresa.EdtEmail.Text;
end;

function TEmpresa.GetEnquadramento: string;
begin
  if (FrmCadastro_Empresa.RGEnquadramento.ItemIndex = 0) then
    GetEnquadramento := 'EN'
  else if (FrmCadastro_Empresa.RGEnquadramento.ItemIndex = 1) then
    GetEnquadramento := 'EPP'
  else if (FrmCadastro_Empresa.RGEnquadramento.ItemIndex = 2) then
    GetEnquadramento := 'ME';
end;

function TEmpresa.GetInsc_Estadual: string;
begin
  GetInsc_Estadual := FrmCadastro_Empresa.EdtInsc_Estadual.Text;
end;

function TEmpresa.GetInsc_Municipal: string;
begin
  GetInsc_Municipal := FrmCadastro_Empresa.EdtInsc_Municipal.Text;
end;

function TEmpresa.GetNome_Fantasia: string;
begin
  GetNome_Fantasia := FrmCadastro_Empresa.EdtNome.Text;
end;

function TEmpresa.GetNumero: string;
begin
  GetNumero := FrmCadastro_Empresa.EdtNumero.Text;
end;

function TEmpresa.GetObservacoes: string;
begin
  GetObservacoes := FrmCadastro_Empresa.MmoObservacoes.Text;
end;

function TEmpresa.GetProprietario: string;
begin
  GetProprietario := FrmCadastro_Empresa.EdtProprietario.Text;
end;

function TEmpresa.GetRazao_Social: string;
begin
  GetRazao_Social := FrmCadastro_Empresa.EdtRazao_Social.Text;
end;

function TEmpresa.GetRegime_Tributario: integer;
begin
  if (FrmCadastro_Empresa.RGRegime_Tributario.ItemIndex = 0) then
    GetRegime_Tributario := 0
  else if (FrmCadastro_Empresa.RGRegime_Tributario.ItemIndex = 1) then
    GetRegime_Tributario := 1
  else if (FrmCadastro_Empresa.RGRegime_Tributario.ItemIndex = 2) then
    GetRegime_Tributario := 2;
end;

function TEmpresa.GetSenha: string;
begin
  GetSenha := FrmCadastro_Empresa.EdtSenha.Text;
end;

function TEmpresa.GetSite: string;
begin
  GetSite := FrmCadastro_Empresa.EdtSite.Text;
end;

function TEmpresa.GetSuframa: string;
begin
  GetSuframa := FrmCadastro_Empresa.EdtSuframa.Text;
end;

function TEmpresa.GetTelefone: string;
begin
  GetTelefone := FrmCadastro_Empresa.MEdtTelefone.Text;
end;

function TEmpresa.GetTelefone_Contato: string;
begin
  GetTelefone_Contato := FrmCadastro_Empresa.MEdtTelefone_Contato.Text;
end;

procedure TEmpresa.Inserir(var Registro: TEmpresa);
var
  qAux: TADOQuery;
begin
  try
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Insert into Empresa (Codigo, Nome_Fantasia, Razao_Social, Proprietario, CNPJ, Insc_Estadual, Insc_Municipal, Suframa,');
        add('CNAE, Regime_Tributario, Enquadramento, Aliquota, Custo_OP, Numero, Complemento, Codigo_Setor, Codigo_Cidade, Telefone, Fax, ');
        add('Email, Senha, SMTP, Porta, Site, Data_Cadastro, Observacoes, Contato, Telefone_Contato, Endereco, CEP) values(');
        add(':Codigo, :Nome_Fantasia, :Razao_Social, :Proprietario, :CNPJ, :Insc_Estadual, :Insc_Municipal, :Suframa, ');
        add(':CNAE, :Regime_Tributario, :Enquadramento, :Aliquota, :Custo_OP, :Numero, :Complemento,');
        add(':Setor, :Cidade, :Telefone, :Fax, :Email, :Senha, :SMTP, :Porta, :Site, :Data_Cad, :Obs, :Contato, :Telefone_Contato, :Endereco, :CEP)');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        Parameters.ParamByName('Nome_Fantasia').Value := Registro.Nome_Fan;
        Parameters.ParamByName('Razao_Social').Value := Registro.Raz;
        Parameters.ParamByName('Proprietario').Value := Registro.Prop;
        Parameters.ParamByName('CNPJ').Value := Registro.CNP;
        Parameters.ParamByName('Insc_Estadual').Value := Registro.Inscr_Est;
        Parameters.ParamByName('Insc_Municipal').Value := Registro.Inscr_Mun;
        Parameters.ParamByName('Suframa').Value := Registro.Sufram;
        Parameters.ParamByName('CNAE').Value := Registro.CNAEE;
        Parameters.ParamByName('Regime_Tributario').Value :=
          Registro.Regime_Trib;
        Parameters.ParamByName('Enquadramento').Value := Registro.Enquad;
        Parameters.ParamByName('Aliquota').Value := Registro.Ali;
        Parameters.ParamByName('Custo_OP').Value := Registro.Custo_OPP;
        Parameters.ParamByName('Numero').Value := Registro.Num;
        Parameters.ParamByName('Complemento').Value := Registro.Comp;
        Parameters.ParamByName('Setor').Value := Registro.Seto;
        Parameters.ParamByName('Cidade').Value := Registro.Cid;
        Parameters.ParamByName('Telefone').Value := Registro.Tel;
        Parameters.ParamByName('Fax').Value := Registro.FA;
        Parameters.ParamByName('Email').Value := Registro.Ema;
        Parameters.ParamByName('Senha').Value := Registro.Sen;
        Parameters.ParamByName('SMTP').Value :=
          FrmCadastro_Empresa.EdtSMTP.Text;
        Parameters.ParamByName('Porta').Value :=
          FrmCadastro_Empresa.EdtPorta.Text;
        Parameters.ParamByName('Site').Value := Registro.Sit;
        Parameters.ParamByName('Data_Cad').Value := Registro.Data_Cad;
        Parameters.ParamByName('Obs').Value := Registro.Obs;
        Parameters.ParamByName('Contato').Value := Registro.Cont;
        Parameters.ParamByName('Telefone_Contato').Value := Registro.Tel_Cont;
        Parameters.ParamByName('Endereco').Value :=
          FrmCadastro_Empresa.EdtEndereco.Text;
        Parameters.ParamByName('CEP').Value := FrmCadastro_Empresa.EdtCEP.Text;
        ExecSQL;
        lrControle := Insere;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TLancamento_Financeiro }

procedure TLancamento_Financeiro.Alterar(var Registro: TLancamento_Financeiro);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Update Lancamento_Financeiro set Tipo = :Tipo, N_Documento = :N_Documento, Codigo_Empresa = :Codigo_Empresa, ');
        add('Codigo_Forma_Pagamento = :Codigo_Forma_Pagamento, Codigo_Cli_For = :Codigo_Cli_For,');
        add('Codigo_Tipo_Documento = :Codigo_Tipo_Documento, Historico = :Historico, Codigo_Departamento = :Codigo_Departamento, ');
        add('Codigo_Plano = :Codigo_Plano, Data_Lancamento = :Data_Lancamento, Data_Vencimento = :Data_Vencimento,');
        add('Valor_Documento = :Valor_Documento, Desconto = :Desconto, Multa = :Multa, Valor_Cobrado = :Valor_Cobrado, ');
        add('Observacoes = :Obs, Status = :Status, Conta_Fixa = :Conta_Fixa, Calcula_Juro = :Calcula_Juro');
        add('where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        Parameters.ParamByName('Tipo').Value := Registro.Tip;
        Parameters.ParamByName('N_Documento').Value := Registro.N_Doc;
        Parameters.ParamByName('Codigo_Empresa').Value := Registro.Cod_Empresa;
        Parameters.ParamByName('Codigo_Forma_Pagamento').Value :=
          Registro.Cod_Form_Pag;
        Parameters.ParamByName('Codigo_Cli_For').Value := Registro.Cod_Cli_For;
        Parameters.ParamByName('Codigo_Tipo_Documento').Value :=
          Registro.Cod_Tipo_Doc;
        Parameters.ParamByName('Historico').Value := Registro.Hist;
        Parameters.ParamByName('Codigo_Departamento').Value :=
          Registro.Cod_Depart;
        Parameters.ParamByName('Codigo_Plano').Value := Registro.Cod_Plano;
        Parameters.ParamByName('Data_Lancamento').Value := Registro.Data_Lanc;
        Parameters.ParamByName('Data_Vencimento').Value := Registro.Data_Venc;
        Parameters.ParamByName('Valor_Documento').Value := Registro.Valor_Doc;
        Parameters.ParamByName('Desconto').Value := Registro.Desc;
        Parameters.ParamByName('Multa').Value := Registro.Mult;
        Parameters.ParamByName('Valor_Cobrado').Value := Registro.Valor_Cob;
        Parameters.ParamByName('Obs').Value := Registro.Obs;
        Parameters.ParamByName('Status').Value := Registro.Stat;

        if (FrmLancamento_Financeiro.CBConta_Fixa.Checked) then
          Parameters.ParamByName('Conta_Fixa').Value := 0
        else
          Parameters.ParamByName('Conta_Fixa').Value := 1;

        if (FrmLancamento_Financeiro.CBJuro.Checked) then
          Parameters.ParamByName('Calcula_Juro').Value := 0
        else
          Parameters.ParamByName('Calcula_Juro').Value := 1;

        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Altera;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TLancamento_Financeiro.Excluir(var Registro: TLancamento_Financeiro);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Delete from Lancamento_Financeiro where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        // lrControle:= Exclui;
        // UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

function TLancamento_Financeiro.GetCodigo: integer;
begin
  GetCodigo := StrToInt(FrmLancamento_Financeiro.EdtCodigo.Text);
end;

function TLancamento_Financeiro.GetCodigo_Cli_For: integer;
begin
  if (FrmLancamento_Financeiro.EdtCodigo_Cli_Forn.Text = '') then
    GetCodigo_Cli_For := 0
  else
    GetCodigo_Cli_For :=
      StrToInt(FrmLancamento_Financeiro.EdtCodigo_Cli_Forn.Text);
end;

function TLancamento_Financeiro.GetCodigo_Departamento: integer;
begin
  if (FrmLancamento_Financeiro.EdtCodigo_Departamento.Text = '') then
    GetCodigo_Departamento := 0
  else
    GetCodigo_Departamento :=
      StrToInt(FrmLancamento_Financeiro.EdtCodigo_Departamento.Text);
end;

function TLancamento_Financeiro.GetCodigo_Empresa: integer;
begin
  GetCodigo_Empresa := UDeclaracao.Codigo_Empresa;
end;

function TLancamento_Financeiro.GetCodigo_Forma_Pagamento: integer;
begin
  if FrmLancamento_Financeiro.EdtCodigo_Condicao_Pagamento.Text = '' then
    GetCodigo_Forma_Pagamento := 0
  else
    GetCodigo_Forma_Pagamento :=
      StrToInt(FrmLancamento_Financeiro.EdtCodigo_Condicao_Pagamento.Text);
end;

function TLancamento_Financeiro.GetCodigo_Plano: integer;
begin
  if (FrmLancamento_Financeiro.EdtCodigo_Plano.Text = '') then
    GetCodigo_Plano := 0
  else
    GetCodigo_Plano := StrToInt(FrmLancamento_Financeiro.EdtCodigo_Plano.Text);
end;

function TLancamento_Financeiro.GetCodigo_Tipo_Documento: integer;
begin
  if (FrmLancamento_Financeiro.EdtCodigo_Tipo_Documento.Text = '') then
    GetCodigo_Tipo_Documento := 0
  else
    GetCodigo_Tipo_Documento :=
      StrToInt(FrmLancamento_Financeiro.EdtCodigo_Tipo_Documento.Text);
end;

function TLancamento_Financeiro.GetData_Lancamento: Tdate;
begin
  GetData_Lancamento := StrToDateTime
    (FrmLancamento_Financeiro.MEdtData_Lancamento.Text);
end;

function TLancamento_Financeiro.GetData_Vencimento: Tdate;
begin
  GetData_Vencimento := StrToDateTime
    (FrmLancamento_Financeiro.MEdtData_Vencimento.Text);
end;

function TLancamento_Financeiro.GetDesconto: double;
begin
  GetDesconto := StrToFloat(FrmLancamento_Financeiro.EdtDesconto.Text);
end;

function TLancamento_Financeiro.GetHistorico: string;
begin
  GetHistorico := FrmLancamento_Financeiro.EdtHistorico.Text;
end;

function TLancamento_Financeiro.GetMulta: double;
begin
  GetMulta := StrToFloat(FrmLancamento_Financeiro.EdtMulta.Text);
end;

function TLancamento_Financeiro.GetN_Documento: integer;
begin
  GetN_Documento := StrToInt(FrmLancamento_Financeiro.EdtDocumento.Text);
end;

function TLancamento_Financeiro.GetObservacao: string;
begin
  GetObservacao := FrmLancamento_Financeiro.MmoObservacoes.Text;
end;

function TLancamento_Financeiro.GetStatus: string;
begin
  GetStatus := 'PENDENTE';
end;

function TLancamento_Financeiro.GetTipo: string;
begin
  if (FrmLancamento_Financeiro.RGTipo.ItemIndex = 0) then
    GetTipo := 'RECEBER'
  else
    GetTipo := 'PAGAR';
end;

function TLancamento_Financeiro.GetValor_Cobrado: double;
begin
  GetValor_Cobrado :=
    StrToFloat(FrmLancamento_Financeiro.EdtValor_Cobrado.Text);
end;

function TLancamento_Financeiro.GetValor_Documento: double;
begin
  GetValor_Documento :=
    StrToFloat(FrmLancamento_Financeiro.EdtValor_Documento.Text);
end;

procedure TLancamento_Financeiro.Inserir(var Registro: TLancamento_Financeiro);
var
  qAux, qaux2, qaux3: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      qaux3 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Insert into Lancamento_Financeiro (Codigo, Tipo, N_Documento, Codigo_Empresa, Codigo_Forma_Pagamento, ');
        add('Codigo_Cli_For, Codigo_Tipo_Documento, Historico, Codigo_Departamento, Codigo_Plano, Data_Lancamento,');
        add('Data_Vencimento, Valor_Documento, Desconto, Multa, Valor_Cobrado, Observacoes, Status, Conta_Fixa, Calcula_Juro) values (');
        add(':Codigo, :Tipo, :N_Documento, :Codigo_Empresa, :Codigo_Forma_Pagamento, :Codigo_Cli_For, :Codigo_Tipo_Documento, ');
        add(':Historico, :Codigo_Departamento, :Codigo_Plano, :Data_Lancamento, :Data_Vencimento, :Valor_Documento, ');
        add(':Desconto, :Multa, :Valor_Cobrado, :Observacoes, :Status, :Conta_Fixa, :Calcula_Juro)');

        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        Parameters.ParamByName('Tipo').Value := Registro.Tip;
        Parameters.ParamByName('N_Documento').Value := Registro.N_Doc;
        Parameters.ParamByName('Codigo_Empresa').Value := Registro.Cod_Empresa;
        Parameters.ParamByName('Codigo_Forma_Pagamento').Value :=
          Registro.Cod_Form_Pag;
        Parameters.ParamByName('Codigo_Cli_For').Value := Registro.Cod_Cli_For;
        Parameters.ParamByName('Codigo_Tipo_Documento').Value :=
          Registro.Cod_Tipo_Doc;
        Parameters.ParamByName('Historico').Value := Registro.Hist;
        Parameters.ParamByName('Codigo_Departamento').Value :=
          Registro.Cod_Depart;
        Parameters.ParamByName('Codigo_Plano').Value := Registro.Cod_Plano;
        Parameters.ParamByName('Data_Lancamento').Value := Registro.Data_Lanc;
        Parameters.ParamByName('Data_Vencimento').Value := Registro.Data_Venc;
        Parameters.ParamByName('Valor_Documento').Value := Registro.Valor_Doc;
        Parameters.ParamByName('Desconto').Value := Registro.Desc;
        Parameters.ParamByName('Multa').Value := Registro.Mult;
        Parameters.ParamByName('Valor_Cobrado').Value := Registro.Valor_Cob;
        Parameters.ParamByName('Observacoes').Value := Registro.Obs;
        Parameters.ParamByName('Status').Value := Registro.Stat;

        if (FrmLancamento_Financeiro.CBConta_Fixa.Checked) then
          Parameters.ParamByName('Conta_Fixa').Value := 0
        else
          Parameters.ParamByName('Conta_Fixa').Value := 1;

        if (FrmLancamento_Financeiro.CBJuro.Checked) then
          Parameters.ParamByName('Calcula_Juro').Value := 0
        else
          Parameters.ParamByName('Calcula_Juro').Value := 1;

        ExecSQL;
        Parcela.Inserir(Parcela);
        // DM.ADOConnection1.CommitTrans;
        lrControle := Insere;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TParcelas }

procedure TParcelas.Alterar(var Regis: TParcelas);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Update Parcelas_Lancamentos set Codigo = :Codigo, N_Documento = :N_Documento, ');
        add('Data_Vencimento = :Data_Vencimento, Data_Pagamento = :Data_Pagamento, Parcela = :Parcela, ');
        add('Status = :Status, Valor = :Valor where N_Documento = :N_Documento');
        Parameters.ParamByName('Codigo').Value := Regis.Codi;
        Parameters.ParamByName('N_Documento').Value := Regis.N_Doc;
        Parameters.ParamByName('Data_Vencimento').Value := Regis.Data_Venc;
        Parameters.ParamByName('Data_Pagamento').Value := Regis.Data_Pag;
        Parameters.ParamByName('Parcela').Value := Regis.Parc;
        Parameters.ParamByName('Status').Value := Regis.Stat;
        // Parameters.ParamByName('Valor').Value:= Registro.Val / qaux3.FieldByName('Parcela').AsInteger;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Altera;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TParcelas.Excluir(var Regis: TParcelas);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Delete from Parcelas_Lancamentos where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Regis.Codi_Selecionado;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Exclui;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TParcelas.Excluir_Historico(var Regis: TParcelas);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Delete from Parcelas_Lancamentos_Historico where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Regis.Codi_Selecionado;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        // lrControle := Exclui;
        // UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

function TParcelas.GetCodigo: integer;
var
  qAux4: TADOQuery;
begin
  { qAux4:= TADOQuery.Create(nil);
    with qaux4, sql do
    begin
    close;
    clear;
    Connection:= dm.ADOConnection1;
    add('select IDENT_CURRENT(''Lancamento_Financeiro'') as cod');
    open;
    end; }
  // Gera_Codigo_Lancamento_Financeiro;
  GetCodigo := StrToInt(FrmLancamento_Financeiro.EdtCodigo.Text);
  // codigo_lancamento_financeiro;//qaux4.FieldByName('cod').AsInteger;
  // FreeAndNil(qAux4);
end;

function TParcelas.GetCodigo_Selecionado: integer;
begin
  GetCodigo_Selecionado := StrToInt(FrmLancamento_Financeiro.EdtCodigo.Text);
end;

function TParcelas.GetData_Pagamento: Tdate;
begin
  GetData_Pagamento := 0;
end;

function TParcelas.GetData_Vencimento: Tdate;
begin
  GetData_Vencimento := data_vencim;
end;

function TParcelas.GetN_Documento: integer;
begin
  GetN_Documento := doc;
end;

function TParcelas.GetParcela: integer;
begin
  GetParcela := i;
end;

function TParcelas.GetStatus: string;
begin
  GetStatus := 'PENDENTE';
end;

function TParcelas.GetValor: double;
begin
  GetValor := StrToFloat(FrmLancamento_Financeiro.EdtValor_Cobrado.Text);
end;

procedure TParcelas.Inserir(var Regis: TParcelas);
var
  qAux, qaux2, qaux3: TADOQuery;
  valaux, valaux2, Taxa: double;
  dias_venc, dia, Mes: integer;
begin
  try
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      qaux3 := TADOQuery.Create(nil);
      with qaux3 do
      begin
        close;
        SQL.clear;
        Connection := DM.ADOConnection1;
        SQL.add('select * from Condicao_Pagamento where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value :=
          StrToInt(FrmLancamento_Financeiro.EdtCodigo_Condicao_Pagamento.Text);
        open;
      end;

      data_vencim := StrToDateTime
        (FrmLancamento_Financeiro.MEdtData_Vencimento.Text);
      doc := StrToInt(FrmLancamento_Financeiro.EdtDocumento.Text + '1');
      for i := 1 to qaux3.FieldByName('Parcela').AsInteger do
      begin
        with qAux, SQL do
        begin
          close;
          clear;
          Connection := DM.ADOConnection1;
          add('Insert into Parcelas_Lancamentos (Codigo, N_Documento, Data_Vencimento, Data_Pagamento, ');
          add('Parcela, Status, Valor, Valor_Pagar, Codigo_Forma_Pagamento_Parcela, Valor_Restante, Desconto, Acrescimo, Valor_Pago) values (:Codigo, :N_Documento, :Data_Vencimento, :Data_Pagamento, ');
          add(':Parcela, :Status, :Valor, :Valor_Pagar, :Codigo_Forma_Pagamento_Parcela, :Valor_Restante, :Desconto, :Acrescimo, :Valor_Pago)');
          Parameters.ParamByName('Codigo').Value := Regis.Codi;
          Parameters.ParamByName('N_Documento').Value := Regis.N_Doc;
          Parameters.ParamByName('Data_Vencimento').Value := Regis.Data_Venc;
          Parameters.ParamByName('Data_Pagamento').Value := Regis.Data_Pag;

          data_vencim := IncDay(data_vencim, qaux3.FieldByName('Prazo')
            .AsInteger);
          Parameters.ParamByName('Parcela').Value := Regis.Parc;
          Parameters.ParamByName('Status').Value := Regis.Stat;

          dias_venc :=
            DaysBetween
            (StrToDateTime(FrmLancamento_Financeiro.MEdtData_Vencimento.Text),
            StrToDateTime(FrmLancamento_Financeiro.MEdtData_Lancamento.Text));

          if (FrmLancamento_Financeiro.CBJuro.Checked) then
          begin
            if (qaux3.FieldByName('Tipo_Juro').AsString = 'C') then
            begin
              valaux := Calcula_Juro_Composto(Regis.Val,
                qaux3.FieldByName('Taxa').AsFloat / 100,
                qaux3.FieldByName('Parcela').AsInteger);
              Parameters.ParamByName('Valor').Value :=
                (valaux / qaux3.FieldByName('Parcela').AsInteger);
              Parameters.ParamByName('Valor_Pagar').Value :=
                (valaux / qaux3.FieldByName('Parcela').AsInteger);
              Parameters.ParamByName('Codigo_Forma_Pagamento_Parcela').Value :=
                StrToInt(FrmLancamento_Financeiro.
                EdtCodigo_Condicao_Pagamento.Text);
              Parameters.ParamByName('Valor_Restante').Value :=
                (valaux / qaux3.FieldByName('Parcela').AsInteger);
            end
            else
            begin
              valaux := Regis.Val +
                (Regis.Val * (qaux3.FieldByName('Taxa').AsFloat / 100));
              valaux := (valaux / qaux3.FieldByName('Parcela').AsInteger);

              Parameters.ParamByName('Valor').Value := valaux;
              Parameters.ParamByName('Valor_Pagar').Value := valaux;
              Parameters.ParamByName('Codigo_Forma_Pagamento_Parcela').Value :=
                StrToInt(FrmLancamento_Financeiro.
                EdtCodigo_Condicao_Pagamento.Text);
              Parameters.ParamByName('Valor_Restante').Value := valaux;
            end;
          end
          else
          begin
            Taxa := ((qaux3.FieldByName('Taxa').AsFloat / 100));
            valaux2 := (Regis.Val / qaux3.FieldByName('Parcela').AsInteger);

            if (qaux3.FieldByName('Tipo_Juro').AsString = 'C') then
            begin
              if (StrToDateTime(FrmLancamento_Financeiro.MEdtData_Vencimento.
                Text) < StrToDateTime
                (FrmLancamento_Financeiro.MEdtData_Lancamento.Text)) and (i = 1)
              then
                valaux := (Retorna_Juro_Composto(Regis.Val, Taxa, 1) / 30)
              else
                valaux := 0;

              Parameters.ParamByName('Valor').Value := valaux2;
              Parameters.ParamByName('Valor_Pagar').Value := valaux2 +
                (valaux * dias_venc);
              Parameters.ParamByName('Codigo_Forma_Pagamento_Parcela').Value :=
                StrToInt(FrmLancamento_Financeiro.
                EdtCodigo_Condicao_Pagamento.Text);
              Parameters.ParamByName('Valor_Restante').Value := valaux2 +
                (valaux * dias_venc);
            end
            else
            begin
              if (StrToDateTime(FrmLancamento_Financeiro.MEdtData_Vencimento.
                Text) < StrToDateTime
                (FrmLancamento_Financeiro.MEdtData_Lancamento.Text)) and (i = 1)
              then
                valaux := (valaux2 * Taxa) / 30
              else
                valaux := 0;

              valaux := valaux2 + (valaux * dias_venc);

              Parameters.ParamByName('Valor').Value := valaux2;
              Parameters.ParamByName('Valor_Pagar').Value := valaux;
              Parameters.ParamByName('Codigo_Forma_Pagamento_Parcela').Value :=
                StrToInt(FrmLancamento_Financeiro.
                EdtCodigo_Condicao_Pagamento.Text);
              Parameters.ParamByName('Valor_Restante').Value := valaux;
            end;
          end;

          Parameters.ParamByName('Desconto').Value := 0;
          Parameters.ParamByName('Acrescimo').Value := 0;
          Parameters.ParamByName('Valor_Pago').Value := 0;

          ExecSQL;
          if (FrmLancamento_Financeiro.CBReplicar.Checked = true) then
            doc := doc + 1
        end;
      end;
    except
      on E: Exception do
      begin
        TMensagens.MensagemErro('Erro ao gravar parcelas: ' + E.Message);
        abort;
      end;
    end;
  finally
    qAux.close;
    qaux2.close;
    qaux3.close;
    FreeAndNil(qAux);
    FreeAndNil(qaux2);
    FreeAndNil(qaux3);
  end;
end;

{ TCaixa }

procedure TCaixa.Alterar(var Registro: TCaixa);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Update Caixa set Codigo_Empresa = :Codigo_Empresa, Descricao = :Descricao, Codigo_SubNivel = :SubNivel, ');
        add('Caixa = :Caixa, Data_Cadastro = :Data_Cadastro ');
        add('where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        Parameters.ParamByName('Codigo_Empresa').Value := Registro.Cod_Empresa;
        Parameters.ParamByName('Descricao').Value := Registro.Desc;
        Parameters.ParamByName('SubNivel').Value := Registro.SubN;
        Parameters.ParamByName('Caixa').Value := Registro.Cai;
        Parameters.ParamByName('Data_Cadastro').Value := Registro.Data;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Altera;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TCaixa.Excluir(var Registro: TCaixa);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Delete from Caixa where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Exclui;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

function TCaixa.GetCodigo: integer;
begin
  GetCodigo := StrToInt(FrmCadastro_Caixa.EdtCodigo.Text);
end;

function TCaixa.GetCodigo_Empresa: integer;
begin
  GetCodigo_Empresa := UDeclaracao.Codigo_Empresa;
end;

function TCaixa.GetData_Cadastro: Tdate;
begin
  GetData_Cadastro := StrToDateTime(FrmCadastro_Caixa.MEdtData_Cadastro.Text);
end;

function TCaixa.GetDesc: string;
begin
  GetDesc := FrmCadastro_Caixa.EdtDescricao.Text;
end;

function TCaixa.GetCaixa: string;
begin
  GetCaixa := FrmCadastro_Caixa.EdtCaixa.Text;
end;

function TCaixa.GetSubnivel: integer;
begin
  if (FrmCadastro_Caixa.EdtCodigo_SubNivel.Text = '') then
    GetSubnivel := 0
  else
    GetSubnivel := StrToInt(FrmCadastro_Caixa.EdtCodigo_SubNivel.Text);
end;

procedure TCaixa.Inserir(var Registro: TCaixa);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        Connection := DM.ADOConnection1;
        clear;
        add('Insert Into Caixa (Codigo_Empresa, Descricao, Codigo_Subnivel, Caixa, Data_Cadastro) values ');
        add('(:Codigo_Empresa, :Descricao, :Subnivel, :Caixa, :Data_Cadastro)');
        Parameters.ParamByName('Codigo_Empresa').Value := Registro.Cod_Empresa;
        Parameters.ParamByName('Descricao').Value := Registro.Desc;
        Parameters.ParamByName('Subnivel').Value := Registro.SubN;
        Parameters.ParamByName('Caixa').Value := Registro.Cai;
        Parameters.ParamByName('Data_Cadastro').Value := Registro.Data;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Insere;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TBanco }

procedure TBanco.Alterar(var Registro: TBanco);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Update Banco set Numero = :Numero, Nome = :Nome, ');
        add('Telefone = :Telefone, Contato = :Contato, Data_Cadastro = :Data_Cadastro ');
        add('where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        // Parameters.ParamByName('Codigo_Empresa').Value:= Registro.Cod_Empresa;
        Parameters.ParamByName('Numero').Value := Registro.Num;
        Parameters.ParamByName('Nome').Value := Registro.Nom;
        Parameters.ParamByName('Telefone').Value := Registro.Tel;
        Parameters.ParamByName('Contato').Value := Registro.Cont;
        Parameters.ParamByName('Data_Cadastro').Value := Registro.Data;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Altera;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TBanco.Excluir(var Registro: TBanco);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Delete from Banco where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Exclui;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

function TBanco.GetCodigo: integer;
begin
  GetCodigo := StrToInt(FrmCadastro_Banco.EdtCodigo.Text);
end;

function TBanco.GetCodigo_Empresa: integer;
begin
  GetCodigo_Empresa := UDeclaracao.Codigo_Empresa;
end;

function TBanco.GetContato: string;
begin
  GetContato := FrmCadastro_Banco.EdtContato.Text;
end;

function TBanco.GetData_Cadastro: Tdate;
begin
  GetData_Cadastro := StrToDateTime(FrmCadastro_Banco.MEdtData_Cadastro.Text);
end;

function TBanco.GetNome: string;
begin
  GetNome := FrmCadastro_Banco.EdtNome.Text;
end;

function TBanco.GetNumero: string;
begin
  GetNumero := FrmCadastro_Banco.EdtNumero.Text;
end;

function TBanco.GetTelefone: string;
begin
  GetTelefone := FrmCadastro_Banco.MEdtTelefone.Text;
end;

procedure TBanco.Inserir(var Registro: TBanco);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Insert Into Banco (Numero, Nome, Telefone, Contato, Data_Cadastro) values ');
        add('(:Numero, :Nome, :Telefone, :Contato, :Data_Cadastro)');
        // Parameters.ParamByName('Codigo').Value:= Registro.Cod;
        // Parameters.ParamByName('Codigo_Empresa').Value:= Registro.Cod_Empresa;
        Parameters.ParamByName('Numero').Value := Registro.Num;
        Parameters.ParamByName('Nome').Value := Registro.Nom;
        Parameters.ParamByName('Telefone').Value := Registro.Tel;
        Parameters.ParamByName('Contato').Value := Registro.Cont;
        Parameters.ParamByName('Data_Cadastro').Value := Registro.Data;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Insere;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TOperacao_Bancaria }

procedure TOperacao_Bancaria.Alterar(var Registro: TOperacao_Bancaria);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Update Operacao_Bancaria set Operacao = :Operacao, Tipo = :Tipo, Data_Cadastro = :Data_Cadastro');
        add('where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        Parameters.ParamByName('Operacao').Value := Registro.Op;
        Parameters.ParamByName('Tipo').Value := Registro.Tip;
        Parameters.ParamByName('Data_Cadastro').Value := Registro.Data;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Altera;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TOperacao_Bancaria.Excluir(var Registro: TOperacao_Bancaria);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Delete from Operacao_Bancaria where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Exclui;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

function TOperacao_Bancaria.GetCodigo: integer;
begin
  GetCodigo := StrToInt(FrmCadastro_Operacao_Bancaria.EdtCodigo.Text);
end;

function TOperacao_Bancaria.GetData_Cadastro: Tdate;
begin
  GetData_Cadastro := StrToDateTime
    (FrmCadastro_Operacao_Bancaria.MEdtData_Cadastro.Text);
end;

function TOperacao_Bancaria.GetOperacao: string;
begin
  GetOperacao := FrmCadastro_Operacao_Bancaria.EdtOperacao.Text;
end;

function TOperacao_Bancaria.GetTipo: string;
begin
  if (FrmCadastro_Operacao_Bancaria.RGTipo.ItemIndex = 0) then
    GetTipo := 'CRDITO'
  else
    GetTipo := 'DBITO';
end;

procedure TOperacao_Bancaria.Inserir(var Registro: TOperacao_Bancaria);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Insert Into Operacao_Bancaria (Operacao, Tipo, Data_Cadastro) values (');
        add(':Operacao, :Tipo, :Data_Cadastro)');
        // Parameters.ParamByName('Codigo').Value:= Registro.Cod;
        Parameters.ParamByName('Operacao').Value := Registro.Op;
        Parameters.ParamByName('Tipo').Value := Registro.Tip;
        Parameters.ParamByName('Data_Cadastro').Value := Registro.Data;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Insere;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TConta_Corrente }

procedure TConta_Corrente.Alterar(var Registro: TConta_Corrente);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Update Conta_Corrente set Codigo_Empresa = :Codigo_Empresa, Data_Abertura = :Data_Abertura, Data_Cadastro = :Data_Cadastro,');
        add('Conta = :Conta, Agencia = :Agencia, Codigo_Banco = :Codigo_Banco, Nome_Agencia = :Nome_Agencia,');
        add('Nome_Correntista = :Nome_Correntista, Saldo_Inicial = :Saldo_Inicial, Limite = :Limite, Saldo_Atual = :Saldo_Atual ');
        add('where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        Parameters.ParamByName('Codigo_Empresa').Value := Registro.Cod_Empresa;
        Parameters.ParamByName('Data_Abertura').Value := Registro.Dat_Ab;
        Parameters.ParamByName('Data_Cadastro').Value := Registro.Dat_Cad;
        Parameters.ParamByName('Conta').Value := Registro.Cont;
        Parameters.ParamByName('Agencia').Value := Registro.Ag;
        Parameters.ParamByName('Codigo_Banco').Value := Registro.Cod_Banco;
        Parameters.ParamByName('Nome_Agencia').Value := Registro.Nome_Ag;
        Parameters.ParamByName('Nome_Correntista').Value := Registro.Nome_Cor;
        Parameters.ParamByName('Saldo_Inicial').Value := Registro.Saldo_Ini;
        Parameters.ParamByName('Limite').Value := Registro.Lim;
        Parameters.ParamByName('Saldo_Atual').Value := Registro.Saldo_At;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Altera;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TConta_Corrente.Excluir(var Registro: TConta_Corrente);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Delete from Conta_Corrente where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Exclui;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

function TConta_Corrente.GetAgencia: string;
begin
  GetAgencia := FrmCadastro_Conta_Corrente.EdtAgencia.Text;
end;

function TConta_Corrente.GetCodigo: integer;
begin
  GetCodigo := StrToInt(FrmCadastro_Conta_Corrente.EdtCodigo.Text);
end;

function TConta_Corrente.GetCodigo_Banco: integer;
begin
  GetCodigo_Banco := StrToInt(FrmCadastro_Conta_Corrente.EdtCodigo_Banco.Text);
end;

function TConta_Corrente.GetCodigo_Empresa: integer;
begin
  GetCodigo_Empresa := UDeclaracao.Codigo_Empresa;
end;

function TConta_Corrente.GetConta: string;
begin
  GetConta := FrmCadastro_Conta_Corrente.EdtConta_Corrente.Text;
end;

function TConta_Corrente.GetData_Abertura: Tdate;
begin
  if (FrmCadastro_Conta_Corrente.MEdtData_Abertura.Text = '  /  /    ') then
    GetData_Abertura := 0
  else
    GetData_Abertura := StrToDateTime
      (FrmCadastro_Conta_Corrente.MEdtData_Abertura.Text);
end;

function TConta_Corrente.GetData_Cadastro: Tdate;
begin
  GetData_Cadastro := StrToDateTime
    (FrmCadastro_Conta_Corrente.MEdtData_Cadastro.Text);
end;

function TConta_Corrente.GetLimite: double;
begin
  GetLimite := StrToFloat(FrmCadastro_Conta_Corrente.EdtLimite.Text);
end;

function TConta_Corrente.GetNome_Agencia: string;
begin
  GetNome_Agencia := FrmCadastro_Conta_Corrente.EdtNome_Agencia.Text;
end;

function TConta_Corrente.GetNome_Correntista: string;
begin
  GetNome_Correntista := FrmCadastro_Conta_Corrente.EdtNome_Correntista.Text;
end;

function TConta_Corrente.GetSaldo_Atual: double;
begin
  GetSaldo_Atual := StrToFloat(FrmCadastro_Conta_Corrente.EdtSaldo_Atual.Text);
end;

function TConta_Corrente.GetSaldo_Inicial: double;
begin
  GetSaldo_Inicial :=
    StrToFloat(FrmCadastro_Conta_Corrente.EdtSaldo_Inicial.Text);
end;

procedure TConta_Corrente.Inserir(var Registro: TConta_Corrente);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Insert Into Conta_Corrente (Codigo_Empresa, Data_Abertura, Data_Cadastro, Conta, Agencia, Codigo_Banco,');
        add('Nome_Agencia, Nome_Correntista, Saldo_Inicial, Limite, Saldo_Atual)  values(:Codigo_Empresa, :Data_Abertura, ');
        add(':Data_Cadastro, :Conta, :Agencia, :Codigo_Banco, :Nome_Agencia, :Nome_Correntista, :Saldo_Inicial,');
        add(':Limite, :Saldo_Atual)');
        // Parameters.ParamByName('Codigo').Value:= Registro.Cod;
        Parameters.ParamByName('Codigo_Empresa').Value := Registro.Cod_Empresa;
        Parameters.ParamByName('Data_Abertura').Value := Registro.Dat_Ab;
        Parameters.ParamByName('Data_Cadastro').Value := Registro.Dat_Cad;
        Parameters.ParamByName('Conta').Value := Registro.Cont;
        Parameters.ParamByName('Agencia').Value := Registro.Ag;
        Parameters.ParamByName('Codigo_Banco').Value := Registro.Cod_Banco;
        Parameters.ParamByName('Nome_Agencia').Value := Registro.Nome_Ag;
        Parameters.ParamByName('Nome_Correntista').Value := Registro.Nome_Cor;
        Parameters.ParamByName('Saldo_Inicial').Value := Registro.Saldo_Ini;
        Parameters.ParamByName('Limite').Value := Registro.Lim;
        Parameters.ParamByName('Saldo_Atual').Value := Registro.Saldo_At;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Insere;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TItens_Folha }

procedure TItens_Folha.Alterar(var Registro: TItens_Folha);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Update Itens_Folha set Descricao = :Descricao, Natureza = :Natureza, Data_Cadastro = :Data_Cadastro');
        add('where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        Parameters.ParamByName('Descricao').Value := Registro.Desc;
        Parameters.ParamByName('Natureza').Value := Registro.Nat;
        Parameters.ParamByName('Data_Cadastro').Value := Registro.Data;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Altera;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TItens_Folha.Excluir(var Registro: TItens_Folha);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Delete from Itens_Folha where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Exclui;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

function TItens_Folha.GetCodigo: integer;
begin
  GetCodigo := StrToInt(FrmCadastro_Itens_Folha_Pagamento.EdtCodigo.Text);
end;

function TItens_Folha.GetData_Cadastro: Tdate;
begin
  GetData_Cadastro := StrToDateTime
    (FrmCadastro_Itens_Folha_Pagamento.MEdtData_Cadastro.Text);
end;

function TItens_Folha.GetDesc: string;
begin
  GetDesc := FrmCadastro_Itens_Folha_Pagamento.EdtDescricao.Text;
end;

function TItens_Folha.GetNatureza: string;
begin
  GetNatureza := FrmCadastro_Itens_Folha_Pagamento.CmbNatureza.Text;
end;

procedure TItens_Folha.Inserir(var Registro: TItens_Folha);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Insert Into Itens_Folha (Descricao, Natureza, Data_Cadastro) values (');
        add(':Descricao, :Natureza, :Data_Cadastro)');
        // Parameters.ParamByName('Codigo').Value:= Registro.Cod;
        Parameters.ParamByName('Descricao').Value := Registro.Desc;
        Parameters.ParamByName('Natureza').Value := Registro.Nat;
        Parameters.ParamByName('Data_Cadastro').Value := Registro.Data;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Insere;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TCheque }

procedure TCheque.Alterar(var Registro: TCheque);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Update Cheque set Codigo_Empresa = :Codigo_Empresa, Tipo = :Tipo, Emitente = :Emitente, Favorecido = :Favorecido, Origem = :Origem, ');
        add('Codigo_Banco = :Codigo_Banco, Agencia = :Agencia, Titular = :Titular, N_Cheque = :N_Cheque,');
        add('Valor = :Valor, Data_Cadastro = :Data_Cadastro, Data_Vencimento = :Data_Vencimento, ');
        add('Data_Saida = :Data_Saida, Observacoes = :Observacao, Status = :Status');
        add('where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        Parameters.ParamByName('Codigo_Empresa').Value := Registro.Cod_Empresa;
        Parameters.ParamByName('Tipo').Value := Registro.Tip;
        Parameters.ParamByName('Emitente').Value := Registro.Emit;
        Parameters.ParamByName('Favorecido').Value := Registro.Fav;
        Parameters.ParamByName('Origem').Value := Registro.Ori;
        Parameters.ParamByName('Codigo_Banco').Value := Registro.Cod_Banco;
        Parameters.ParamByName('Agencia').Value := Registro.Ag;
        Parameters.ParamByName('Titular').Value := Registro.Tit;
        Parameters.ParamByName('N_Cheque').Value := Registro.N_Che;
        Parameters.ParamByName('Valor').Value := Registro.Val;
        Parameters.ParamByName('Data_Cadastro').Value := Registro.Data_Cad;
        Parameters.ParamByName('Data_Vencimento').Value := Registro.Data_Venc;
        Parameters.ParamByName('Data_Saida').Value := Registro.Data_Sai;
        Parameters.ParamByName('Observacao').Value := Registro.Obs;
        Parameters.ParamByName('Status').Value := Registro.Stat;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Altera;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TCheque.Excluir(var Registro: TCheque);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Delete from Cheque where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Exclui;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

function TCheque.GetAgencia: string;
begin
  GetAgencia := FrmCadastro_Cheque.EdtAgencia.Text;
end;

function TCheque.GetCodigo: integer;
begin
  GetCodigo := StrToInt(FrmCadastro_Cheque.EdtCodigo.Text);
end;

function TCheque.GetCodigo_Banco: integer;
begin
  GetCodigo_Banco := StrToInt(FrmCadastro_Cheque.EdtCodigo_Banco.Text);
end;

function TCheque.GetCodigo_Empresa: integer;
begin
  GetCodigo_Empresa := UDeclaracao.Codigo_Empresa;
end;

function TCheque.GetData_Cadastro: Tdate;
begin
  GetData_Cadastro := StrToDateTime(FrmCadastro_Cheque.MEdtData_Cadastro.Text);
end;

function TCheque.GetData_Saida: Tdate;
begin
  if (FrmCadastro_Cheque.MEdtData_Saida.Text = '  /  /    ') then
    GetData_Saida := 0
  else
    GetData_Saida := StrToDateTime(FrmCadastro_Cheque.MEdtData_Saida.Text);
end;

function TCheque.GetData_Vencimento: Tdate;
begin
  if (FrmCadastro_Cheque.MEdtData_Vencimento.Text = '  /  /    ') then
    GetData_Vencimento := 0
  else
    GetData_Vencimento :=
      StrToDateTime(FrmCadastro_Cheque.MEdtData_Vencimento.Text);
end;

function TCheque.GetEmitente: string;
begin
  GetEmitente := FrmCadastro_Cheque.EdtEmitente.Text;
end;

function TCheque.GetFavorecido: string;
begin
  GetFavorecido := FrmCadastro_Cheque.EdtFavorecido.Text;
end;

function TCheque.GetN_Cheque: string;
begin
  GetN_Cheque := FrmCadastro_Cheque.EdtN_Cheque.Text;
end;

function TCheque.GetObservacao: string;
begin
  GetObservacao := FrmCadastro_Cheque.MmoObservacoes.Text;
end;

function TCheque.GetOrigem: string;
begin
  GetOrigem := FrmCadastro_Cheque.EdtOrigem.Text;
end;

function TCheque.GetStatus: string;
begin
  if (FrmCadastro_Cheque.MEdtData_Saida.Text = '  /  /    ') then
    GetStatus := 'PENDENTE'
  else
    GetStatus := 'BAIXADO';
end;

function TCheque.GetTipo: string;
begin
  if (FrmCadastro_Cheque.RadioGroup1.ItemIndex = 0) then
    GetTipo := 'EMITIDO'
  else
    GetTipo := 'RECEBIDO';
end;

function TCheque.GetTitular: string;
begin
  GetTitular := FrmCadastro_Cheque.EdtTitular.Text;
end;

function TCheque.GetValor: double;
begin
  GetValor := StrToFloat(FrmCadastro_Cheque.EdtValor.Text);
end;

procedure TCheque.Inserir(var Registro: TCheque);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Insert Into Cheque (Codigo_Empresa, Tipo, Emitente, Favorecido, Origem, Codigo_Banco, Agencia, Titular, N_Cheque,');
        add('Valor, Data_Cadastro, Data_Vencimento, Data_Saida, Observacoes, Status) values (:Codigo_Empresa, :Tipo, :Emitente, :Favorecido, ');
        add(':Origem, :Codigo_Banco, :Agencia, :Titular, :N_Cheque, :Valor, :Data_Cadastro, :Data_Vencimento, ');
        add(':Data_Saida, :Observacao, :Status)');
        // Parameters.ParamByName('Codigo').Value:= Registro.Cod;
        Parameters.ParamByName('Codigo_Empresa').Value := Registro.Cod_Empresa;
        Parameters.ParamByName('Tipo').Value := Registro.Tip;
        Parameters.ParamByName('Emitente').Value := Registro.Emit;
        Parameters.ParamByName('Favorecido').Value := Registro.Fav;
        Parameters.ParamByName('Origem').Value := Registro.Ori;
        Parameters.ParamByName('Codigo_Banco').Value := Registro.Cod_Banco;
        Parameters.ParamByName('Agencia').Value := Registro.Ag;
        Parameters.ParamByName('Titular').Value := Registro.Tit;
        Parameters.ParamByName('N_Cheque').Value := Registro.N_Che;
        Parameters.ParamByName('Valor').Value := Registro.Val;
        Parameters.ParamByName('Data_Cadastro').Value := Registro.Data_Cad;
        Parameters.ParamByName('Data_Vencimento').Value := Registro.Data_Venc;
        Parameters.ParamByName('Data_Saida').Value := Registro.Data_Sai;
        Parameters.ParamByName('Observacao').Value := Registro.Obs;
        Parameters.ParamByName('Status').Value := Registro.Stat;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Insere;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TLocalidade_Produto }

procedure TLocalidade_Produto.Alterar(var Registro: TLocalidade_Produto);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Update Localidade_Produto set Codigo_Empresa = :Codigo_Empresa, Local = :Local, ');
        add('Data_Cadastro = :Data_Cadastro');
        add('where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        Parameters.ParamByName('Codigo_Empresa').Value := Registro.Cod_Empresa;
        Parameters.ParamByName('Local').Value := Registro.Loc;
        // Parameters.ParamByName('Detalhe').Value := Registro.Det;
        Parameters.ParamByName('Data_Cadastro').Value := Registro.Dat;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Altera;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TLocalidade_Produto.Excluir(var Registro: TLocalidade_Produto);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Delete from Localidade_Produto where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Exclui;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

function TLocalidade_Produto.GetCodigo: integer;
begin
  GetCodigo := StrToInt(FrmCadastro_Local_Produto.EdtCodigo.Text);
end;

function TLocalidade_Produto.GetCodigo_Empresa: integer;
begin
  GetCodigo_Empresa := UDeclaracao.Codigo_Empresa;
end;

function TLocalidade_Produto.GetData_Cadastro: Tdate;
begin
  GetData_Cadastro := StrToDateTime
    (FrmCadastro_Local_Produto.MEdtData_Cadastro.Text);
end;

// function TLocalidade_Produto.GetDetalhe: string;
// begin
// GetDetalhe := FrmCadastro_Local_Produto.EdtDetalhe.Text;
// end;

function TLocalidade_Produto.GetLocal: string;
begin
  GetLocal := FrmCadastro_Local_Produto.EdtLocal.Text;
end;

procedure TLocalidade_Produto.Inserir(var Registro: TLocalidade_Produto);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Insert Into Localidade_Produto (Codigo_Empresa, Local, Data_Cadastro) values ');
        add('(:Codigo_Empresa, :Local, :Data_Cadastro)');
        // Parameters.ParamByName('Codigo').Value:= Registro.Cod;
        Parameters.ParamByName('Codigo_Empresa').Value := Registro.Cod_Empresa;
        Parameters.ParamByName('Local').Value := Registro.Loc;
        // Parameters.ParamByName('Detalhe').Value := Registro.Det;
        Parameters.ParamByName('Data_Cadastro').Value := Registro.Dat;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Insere;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TMovimento_Caixa }

procedure TMovimento_Caixa.Alterar(var Registro: TMovimento_Caixa);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Update Movimento_Caixa set Codigo_Empresa = :Codigo_Empresa, Codigo_Caixa = :Codigo_Caixa, ');
        add('Codigo_Plano = :Codigo_Plano, N_Documento, :N_Documento, Data_Movimentacao = :Data_Movimentacao, Descricao = :Descricao, Dinheiro = :Dinheiro, ');
        add('Cheque_Vista = :Cheque_Vista, Cheque_Prazo = :Cheque_Prazo, Cartao = :Cartao, Juros = :Juros,');
        add('Desconto = :Desconto ');
        add('where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        Parameters.ParamByName('Codigo_Empresa').Value := Registro.Cod_Empresa;
        Parameters.ParamByName('Codigo_Caixa').Value := Registro.Cod_Caixa;
        Parameters.ParamByName('Codigo_Plano').Value := Registro.Cod_Plano;
        Parameters.ParamByName('N_Documento').Value := Registro.N_Doc;
        Parameters.ParamByName('Data_Movimentacao').Value := Registro.Data_Mov;
        Parameters.ParamByName('Descricao').Value := Registro.Desc;
        Parameters.ParamByName('Dinheiro').Value := Registro.Din;
        Parameters.ParamByName('Cheque_Vista').Value := Registro.Che_Vis;
        Parameters.ParamByName('Cheque_Prazo').Value := Registro.Che_Pr;
        Parameters.ParamByName('Cartao').Value := Registro.Car;
        Parameters.ParamByName('Juros').Value := Registro.Ju;
        Parameters.ParamByName('Desconto').Value := Registro.Des;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Altera;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TMovimento_Caixa.Excluir(var Registro: TMovimento_Caixa);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Delete from Movimento_Caixa where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Exclui;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

function TMovimento_Caixa.GetCartao: double;
begin
  // GetCartao := StrToFloat(FrmBaixar_Titulo.EdtCartao.Text);
end;

function TMovimento_Caixa.GetCheque_Prazo: double;
begin
  // GetCheque_Prazo := StrToFloat(FrmBaixar_Titulo.EdtCheque_a_Prazo.Text);
end;

function TMovimento_Caixa.GetCheque_Vista: double;
begin
  // GetCheque_Vista := StrToFloat(FrmBaixar_Titulo.EdtCheque_a_Vista.Text);
end;

function TMovimento_Caixa.GetCodigo: integer;
begin
  // GetCheque_Vista:= StrToFloat(FrmBaixar_Titulo.EdtCheque_a_Vista.Text);
end;

function TMovimento_Caixa.GetCodigo_Caixa: integer;
begin
  GetCodigo_Caixa := UDeclaracao.Codigo_Caixa;
end;

function TMovimento_Caixa.GetCodigo_Empresa: integer;
begin
  GetCodigo_Empresa := UDeclaracao.Codigo_Empresa;
end;

function TMovimento_Caixa.GetCodigo_Plano: integer;
begin
  GetCodigo_Plano := FrmChama_Lancamentos_Financeiros.
    qrychama_lancamentoCodigo_Plano.AsInteger;
end;

function TMovimento_Caixa.GetData_Movimentacao: Tdate;
begin
  GetData_Movimentacao :=
    StrToDateTime(FrmBaixar_Titulo.MEdtData_Pagamento.Text);
end;

function TMovimento_Caixa.GetDesconto: double;
begin
  // GetDesconto := StrToFloat(FrmBaixar_Titulo.EdtDesconto.Text);
end;

function TMovimento_Caixa.GetDescricao: string;
begin
  // GetDescricao := FrmBaixar_Titulo.EdtDescricao.Text;
end;

function TMovimento_Caixa.GetDinheiro: double;
begin
  { if (FrmChama_Lancamentos_Financeiros.CBBaixa.Checked = false) then
    GetDinheiro := StrToFloat(FrmBaixar_Titulo.EdtDinheiro.Text)
    else
    GetDinheiro :=
    FrmChama_Lancamentos_Financeiros.qrychama_lancamentoValor.AsFloat; }
end;

function TMovimento_Caixa.GetJuros: double;
begin
  // GetJuros := StrToFloat(FrmBaixar_Titulo.EdtJuros.Text);
end;

function TMovimento_Caixa.GetN_Documento: integer;
begin
  GetN_Documento := FrmChama_Lancamentos_Financeiros.
    qrychama_lancamentoN_Documento.AsInteger;
end;

procedure TMovimento_Caixa.Inserir(var Registro: TMovimento_Caixa);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Insert Into Movimento_Caixa (Codigo_Empresa, Codigo_Caixa, Codigo_Plano, N_Documento, Data_Movimentacao, Descricao, Dinheiro,');
        add('Cheque_Vista, Cheque_Prazo, Cartao, Juros, Desconto) values (:Codigo_Empresa, :Codigo_Caixa, :Codigo_Plano,');
        add(':N_Documento, :Data_Movimentacao, :Descricao, :Dinheiro, :Cheque_Vista, :Cheque_Prazo, :Cartao, :Juros, :Desconto)');
        Parameters.ParamByName('Codigo_Empresa').Value := Registro.Cod_Empresa;
        Parameters.ParamByName('Codigo_Caixa').Value := Registro.Cod_Caixa;
        Parameters.ParamByName('Codigo_Plano').Value := Registro.Cod_Plano;
        Parameters.ParamByName('N_Documento').Value := Registro.N_Doc;
        Parameters.ParamByName('Data_Movimentacao').Value := Registro.Data_Mov;
        Parameters.ParamByName('Descricao').Value := Registro.Desc;
        Parameters.ParamByName('Dinheiro').Value := Registro.Din;
        Parameters.ParamByName('Cheque_Vista').Value := Registro.Che_Vis;
        Parameters.ParamByName('Cheque_Prazo').Value := Registro.Che_Pr;
        Parameters.ParamByName('Cartao').Value := Registro.Car;
        Parameters.ParamByName('Juros').Value := Registro.Ju;
        Parameters.ParamByName('Desconto').Value := Registro.Des;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TLancamento_Banco }

procedure TLancamento_Banco.Alterar(var Registro: TLancamento_Banco);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Update Lancamento_Banco set Codigo_Empresa = :Codigo_Empresa, N_Documento = :N_Documento, Data_Lancamento = :Data_Lancamento, ');
        add('Codigo_Conta = :Codigo_Conta, Codigo_Operacao = :Codigo_Operacao, Codigo_Plano = :Codigo_Plano, ');
        add('Descricao = :Descricao, Valor = :Valor, Status = :Status');
        add('where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        Parameters.ParamByName('Codigo_Empresa').Value := Registro.Cod_Empresa;
        Parameters.ParamByName('N_Documento').Value := Registro.N_Doc;
        Parameters.ParamByName('Data_Lancamento').Value := Registro.Data_Lanc;
        Parameters.ParamByName('Codigo_Conta').Value := Registro.Cod_Conta;
        Parameters.ParamByName('Codigo_Operacao').Value := Registro.Cod_Op;
        Parameters.ParamByName('Codigo_Plano').Value := Registro.Cod_Plan;
        Parameters.ParamByName('Descricao').Value := Registro.Desc;
        Parameters.ParamByName('Valor').Value := Registro.Val;
        Parameters.ParamByName('Status').Value := Registro.Stat;
        ExecSQL;
        if (FrmLancamento_Banco.RGStatus.ItemIndex = 1) then
        begin
          with qaux2, SQL do
          begin
            close;
            clear;
            Connection := DM.ADOConnection1;
            add('select CC.* from Conta_Corrente CC where Codigo = :Codigo');
            Parameters.ParamByName('Codigo').Value :=
              StrToInt(FrmLancamento_Banco.EdtCodigo_Conta.Text);
            open;
          end;

          { with FrmLancamento_Banco.SPAtualiza_Saldo_Bancario do
            begin
            Parameters.ParamByName('@Codigo').Value :=
            FrmLancamento_Banco.EdtCodigo_Conta.Text;
            if (FrmLancamento_Banco.EdtTipo_Operacao.Text = 'DBITO') then
            Parameters.ParamByName('@Saldo_Atual').Value := qaux2.FieldByName
            ('Saldo_Atual').AsFloat - StrToFloat
            (FrmLancamento_Banco.EdtValor.Text)
            else if (FrmLancamento_Banco.EdtTipo_Operacao.Text = 'CRDITO') then
            Parameters.ParamByName('@Saldo_Atual').Value := qaux2.FieldByName
            ('Saldo_Atual').AsFloat + StrToFloat
            (FrmLancamento_Banco.EdtValor.Text);
            ExecProc;
            end; }
        end;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Altera;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TLancamento_Banco.Excluir(var Registro: TLancamento_Banco);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Delete from Lancamento_Banco where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        // lrControle := Exclui;
        // UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

function TLancamento_Banco.GetCodigo: integer;
begin
  GetCodigo := StrToInt(FrmLancamento_Banco.EdtCodigo.Text);
end;

function TLancamento_Banco.GetCodigo_Conta: integer;
begin
  if (FrmLancamento_Banco <> nil) and (FrmLancamento_Banco.ativo = true) then
    GetCodigo_Conta := StrToInt(FrmLancamento_Banco.EdtCodigo_Conta.Text)
  else if (FrmBaixar_Titulo <> nil) and (FrmBaixar_Titulo.ativo = true) then
    GetCodigo_Conta := StrToInt(FrmBaixar_Titulo.EdtCodigo_Conta.Text);
end;

function TLancamento_Banco.GetCodigo_Empresa: integer;
begin
  GetCodigo_Empresa := UDeclaracao.Codigo_Empresa;
end;

function TLancamento_Banco.GetCodigo_Operacao: integer;
begin
  if (FrmLancamento_Banco <> nil) and (FrmLancamento_Banco.ativo = true) then
    GetCodigo_Operacao := StrToInt(FrmLancamento_Banco.EdtCodigo_Operacao.Text)
  else if (FrmBaixar_Titulo <> nil) and (FrmBaixar_Titulo.ativo = true) then
    GetCodigo_Operacao := StrToInt(FrmBaixar_Titulo.EdtCodigo_Operacao.Text);
end;

function TLancamento_Banco.GetCodigo_Plano: integer;
begin
  if (FrmLancamento_Banco <> nil) and (FrmLancamento_Banco.ativo = true) then
  begin
    if (FrmLancamento_Banco.EdtCodigo_Plano.Text = '') then
      GetCodigo_Plano := 0
    else
      GetCodigo_Plano := StrToInt(FrmLancamento_Banco.EdtCodigo_Plano.Text)
  end
  else if (FrmBaixar_Titulo <> nil) and (FrmBaixar_Titulo.ativo = true) then
  begin
    GetCodigo_Plano := FrmBaixar_Titulo.LancamentoBancario.Codigo_Plano;
  end;
end;

function TLancamento_Banco.GetData_Lancamento: Tdate;
begin
  if (FrmLancamento_Banco <> nil) and (FrmLancamento_Banco.ativo = true) then
    GetData_Lancamento :=
      StrToDateTime(FrmLancamento_Banco.MEdtData_Lancamento.Text)
  else if (FrmBaixar_Titulo <> nil) and (FrmBaixar_Titulo.ativo = true) then
    GetData_Lancamento :=
      StrToDateTime(FrmBaixar_Titulo.MEdtData_Pagamento.Text);
end;

function TLancamento_Banco.GetDescricao: string;
begin
  if (FrmLancamento_Banco <> nil) and (FrmLancamento_Banco.ativo = true) then
    GetDescricao := FrmLancamento_Banco.EdtDescricao.Text
  else if (FrmBaixar_Titulo <> nil) and (FrmBaixar_Titulo.ativo = true) then
    GetDescricao := FrmBaixar_Titulo.EdtHistorico.Text;
end;

function TLancamento_Banco.GetN_Documento: integer;
begin
  if (FrmLancamento_Banco <> nil) and (FrmLancamento_Banco.ativo = true) then
    GetN_Documento := StrToInt(FrmLancamento_Banco.EdtDocumento.Text)
  else if (FrmBaixar_Titulo <> nil) and (FrmBaixar_Titulo.ativo = true) then
    GetN_Documento := StrToInt(FrmBaixar_Titulo.EdtN_Documento.Text);
end;

function TLancamento_Banco.GetStatus: string;
begin
  if (FrmLancamento_Banco <> nil) and (FrmLancamento_Banco.ativo = true) then
  begin
    if (FrmLancamento_Banco.RGStatus.ItemIndex = 0) then
      GetStatus := 'BLOQUEADO'
    else
      GetStatus := 'LIBERADO';
  end
  else if (FrmBaixar_Titulo <> nil) and (FrmBaixar_Titulo.ativo = true) then
  begin
    if (FrmBaixar_Titulo.RGStatus.ItemIndex = 0) then
      GetStatus := 'BLOQUEADO'
    else
      GetStatus := 'LIBERADO';
  end;
end;

function TLancamento_Banco.GetValor: double;
begin
  if (FrmLancamento_Banco <> nil) and (FrmLancamento_Banco.ativo = true) then
    GetValor := StrToFloat(FrmLancamento_Banco.EdtValor.Text)
  else if (FrmBaixar_Titulo <> nil) and (FrmBaixar_Titulo.ativo = true) then
    GetValor := StrToFloat(FrmBaixar_Titulo.EdtValor_Pagar.Text);
end;

procedure TLancamento_Banco.Inserir(var Registro: TLancamento_Banco);
var
  qAux: TADOQuery;
  Saldo: double;
begin
  try
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Insert Into Lancamento_Banco (Codigo_Empresa, N_Documento, Data_Lancamento, Codigo_Conta,');
        add('Codigo_Operacao, Codigo_Plano, Descricao, Valor, Status) values (:Codigo_Empresa, :N_Documento, :Data_Lancamento,');
        add(':Codigo_Conta, :Codigo_Operacao, :Codigo_Plano, :Descricao, :Valor, :Status)');
        Parameters.ParamByName('Codigo_Empresa').Value := Registro.Cod_Empresa;
        Parameters.ParamByName('N_Documento').Value := Registro.N_Doc;
        Parameters.ParamByName('Data_Lancamento').Value := Registro.Data_Lanc;
        Parameters.ParamByName('Codigo_Conta').Value := Registro.Cod_Conta;
        Parameters.ParamByName('Codigo_Operacao').Value := Registro.Cod_Op;
        Parameters.ParamByName('Codigo_Plano').Value := Registro.Cod_Plan;
        Parameters.ParamByName('Descricao').Value := Registro.Desc;
        Parameters.ParamByName('Valor').Value := Registro.Val;
        Parameters.ParamByName('Status').Value := Registro.Stat;
        ExecSQL;
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TMovimento_Banco }

procedure TMovimento_Banco.Alterar(var Registro: TMovimento_Banco);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Update Movimento_Banco set Codigo_Empresa = :Codigo_Empresa, Codigo_Conta = :Codigo_Conta, ');
        add('Codigo_Operacao = :Codigo_Operacao, Codigo_Plano = :Codigo_Plano, N_Documento = :N_Documento,');
        add('Data_Movimentacao = :Data_Movimentacao, Descricao = :Descricao, Valor = :Valor');
        add('where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        Parameters.ParamByName('Codigo_Empresa').Value := Registro.Cod_Empresa;
        Parameters.ParamByName('Codigo_Conta').Value := Registro.Cod_Conta;
        Parameters.ParamByName('Codigo_Operacao').Value :=
          Registro.Cod_Operacao;
        Parameters.ParamByName('Codigo_Plano').Value := Registro.Cod_Plano;
        Parameters.ParamByName('N_Documento').Value := Registro.N_Doc;
        Parameters.ParamByName('Data_Movimentacao').Value := Registro.Data_Mov;
        Parameters.ParamByName('Descricao').Value := Registro.Desc;
        Parameters.ParamByName('Valor').Value := Registro.Val;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Altera;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TMovimento_Banco.Excluir(var Registro: TMovimento_Banco);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Delete from Movimento_Banco where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Exclui;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

function TMovimento_Banco.GetCodigo: integer;
begin
  // GetCheque_Vista:= StrToFloat(FrmBaixar_Titulo.EdtCheque_a_Vista.Text);
end;

function TMovimento_Banco.GetCodigo_Conta: integer;
begin
  GetCodigo_Conta := StrToInt(FrmLancamento_Banco.EdtCodigo_Conta.Text);
end;

function TMovimento_Banco.GetCodigo_Empresa: integer;
begin
  GetCodigo_Empresa := UDeclaracao.Codigo_Empresa;
end;

function TMovimento_Banco.GetCodigo_Plano: integer;
begin
  GetCodigo_Plano := StrToInt(FrmLancamento_Banco.EdtCodigo_Plano.Text);
end;

function TMovimento_Banco.GetData_Movimentacao: Tdate;
begin
  GetData_Movimentacao :=
    StrToDateTime(FrmLancamento_Banco.MEdtData_Lancamento.Text);
end;

function TMovimento_Banco.GetDescricao: string;
begin
  GetDescricao := FrmLancamento_Banco.EdtDescricao.Text;
end;

function TMovimento_Banco.GetValor: double;
begin
  GetValor := StrToFloat(FrmLancamento_Banco.EdtValor.Text);
end;

function TMovimento_Banco.GetN_Documento: integer;
begin
  GetN_Documento := StrToInt(FrmLancamento_Banco.EdtDocumento.Text);
end;

function TMovimento_Banco.GetCodigo_Operacao: integer;
begin
  GetCodigo_Operacao := StrToInt(FrmLancamento_Banco.EdtCodigo_Operacao.Text);
end;

procedure TMovimento_Banco.Inserir(var Registro: TMovimento_Banco);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Insert Into Movimento_Banco (Codigo_Empresa, Codigo_Conta, Codigo_Operacao, Codigo_Plano, N_Documento, ');
        add('Data_Movimentacao, Descricao, Valor) values (:Codigo_Empresa, :Codigo_Conta, :Codigo_Operacao,');
        add(':Codigo_Plano, :N_Documento, :Data_Movimentacao, :Descricao, :Valor)');
        Parameters.ParamByName('Codigo_Empresa').Value := Registro.Cod_Empresa;
        Parameters.ParamByName('Codigo_Conta').Value := Registro.Cod_Conta;
        Parameters.ParamByName('Codigo_Operacao').Value :=
          Registro.Cod_Operacao;
        Parameters.ParamByName('Codigo_Plano').Value := Registro.Cod_Plano;
        Parameters.ParamByName('N_Documento').Value := Registro.N_Doc;
        Parameters.ParamByName('Data_Movimentacao').Value := Registro.Data_Mov;
        Parameters.ParamByName('Descricao').Value := Registro.Desc;
        Parameters.ParamByName('Valor').Value := Registro.Val;
        ExecSQL;
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TItens_Venda_ECF }

procedure TItens_Venda_ECF.Alterar(var Registro: TItens_Venda_ECF);
var
  qAux: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      // qAux2:= TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Update Itens_Venda_ECF set Codigo = :Codigo, Codigo_Produto = :Codigo_Produto, ');
        add('Quantidade = :Quantidade, Tipo_Desconto = :Tipo_Desconto, Desconto = :Desconto, Sub_Total = :Sub_Total');
        add('where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Codi;
        Parameters.ParamByName('Codigo_Produto').Value := Registro.Codi_Prod;
        Parameters.ParamByName('Quantidade').Value := Registro.Quant;
        Parameters.ParamByName('Tipo_Desconto').Value := Registro.Tip_Desconto;
        Parameters.ParamByName('Desconto').Value := Registro.Desc;
        Parameters.ParamByName('Sub_Total').Value := Registro.Sub_Tot;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Altera;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TItens_Venda_ECF.Excluir(var Registro: TItens_Venda_ECF);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Delete from Itens_Venda_ECF where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Codi;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Exclui;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

function TItens_Venda_ECF.GetCancelado: string;
begin
  GetCancelado := 'N';
end;

function TItens_Venda_ECF.GetCodigo: integer;
begin
  // GetCodigo:= codigo_venda;
end;

function TItens_Venda_ECF.GetCodigo_Produto: integer;
begin
  GetCodigo_Produto := FrmPDV.Cod_Produto;
end;

function TItens_Venda_ECF.GetDesconto: double;
begin
  GetDesconto := FrmPDV.valor_desc;
end;

function TItens_Venda_ECF.GetQuantidade: integer;
begin
  GetQuantidade := StrToInt(FrmPDV.EdtQuantidade.Text);
end;

function TItens_Venda_ECF.GetSub_Total: double;
begin
  GetSub_Total := StrToFloat(FrmPDV.EdtValor_Total.Text);
end;

function TItens_Venda_ECF.GetTipo_Desconto: string;
begin
  GetTipo_Desconto := FrmPDV.Tipo_Desc;
end;

function TItens_Venda_ECF.GetValor_Unitario: double;
begin
  GetValor_Unitario := StrToFloat(FrmPDV.EdtValor_Unitario.Text);
end;

procedure TItens_Venda_ECF.Inserir(var Registro: TItens_Venda_ECF);
begin
  try
    DM.qryitens_venda.Insert;
    DM.qryitens_venda['Codigo'] := Registro.Codi;
    DM.qryitens_venda['Codigo_Produto'] := Registro.Codi_Prod;
    DM.qryitens_venda['Valor_Unitario'] := Registro.Val_Un;
    DM.qryitens_venda['Quantidade'] := Registro.Quant;
    DM.qryitens_venda['Tipo_Desconto'] := Registro.Tip_Desconto;
    DM.qryitens_venda['Desconto'] := Registro.Desc;
    DM.qryitens_venda['Sub_Total'] := Registro.Sub_Tot;
    DM.qryitens_venda['Cancelado'] := Registro.Can;
    DM.qryitens_venda['Codigo_Venda'] := FrmPDV.Codigo_Produto;
    DM.qryitens_venda['Descricao'] := FrmPDV.Descricao;
    // dm.qryitens_venda.SaveToFile(Local_Arquivo(2), dfXML);
  except
    //
  end;
end;

procedure TItens_Venda_ECF.Salva_Banco(var Registro: TItens_Venda_ECF);
var
  qAux, qaux2: TADOQuery;
  sAux: TADOStoredProc;
  CDS: TClientDataSet;
  Estoque: double;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    // dm.qryitens_venda:= TClientDataSet.Create(nil);
    // CDS.LoadFromFile(ExtractFilePath(Application.ExeName) + '\XML\Itens_Venda.xml');
    // CDS.Close;
    // CDS.Open;
    DM.qryitens_venda.First;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      while not DM.qryitens_venda.Eof do
      begin
        with qAux, SQL do
        begin
          close;
          clear;
          Connection := DM.ADOConnection1;
          add('Insert into Itens_Venda_ECF (Codigo, Codigo_Produto, Valor_Unitario, Quantidade, Tipo_Desconto, Desconto, Sub_Total, Cancelado)');
          add('values (:Codigo, :Codigo_Produto, :Valor_Unitario, :Quantidade, :Tipo_Desconto, :Desconto, :Sub_Total, :Cancelado)');
          Parameters.ParamByName('Codigo').Value := DM.qryitens_venda['Codigo'];
          Parameters.ParamByName('Codigo_Produto').Value :=
            DM.qryitens_venda['Codigo_Produto'];
          Parameters.ParamByName('Valor_Unitario').Value :=
            DM.qryitens_venda['Valor_Unitario'];
          Parameters.ParamByName('Quantidade').Value :=
            DM.qryitens_venda['Quantidade'];
          Parameters.ParamByName('Tipo_Desconto').Value :=
            DM.qryitens_venda['Tipo_Desconto'];
          Parameters.ParamByName('Desconto').Value := DM.qryitens_venda
            ['Desconto'];
          Parameters.ParamByName('Sub_Total').Value := DM.qryitens_venda
            ['Sub_Total'];
          Parameters.ParamByName('Cancelado').Value := DM.qryitens_venda
            ['Cancelado'];
          ExecSQL;
        end;

        with qaux2, SQL do
        begin
          close;
          clear;
          Connection := DM.ADOConnection1;
          add('select Pro.Codigo, Pro.Estoque, Pro.Volume from Produto Pro');
          add('where Pro.Codigo = :Codigo');
          Parameters.ParamByName('Codigo').Value := DM.qryitens_venda
            ['Codigo_Produto'];
          open;
        end;

        try
          sAux := TADOStoredProc.Create(nil);
          with sAux do
          begin
            Connection := DM.ADOConnection1;
            ProcedureName := 'Atualiza_Estoque;1';
            Parameters.CreateParameter('@Codigo', ftInteger, pdInput, 0,
              DM.qryitens_venda['Codigo_Produto']);

            Estoque := qaux2.FieldByName('Estoque').AsFloat - DM.qryitens_venda
              ['Quantidade'];

            Parameters.CreateParameter('@Estoque', ftFloat, pdInput, 0,
              Estoque);
            Parameters.CreateParameter('@Volume_Total', ftFloat, pdInput, 0,
              Estoque * qaux2.FieldByName('Volume').AsFloat);
            ExecProc;
          end;
        finally
          FreeAndNil(sAux);
        end;
        DM.qryitens_venda.Next;
      end;
    finally
      // DM.ADOConnection1.CommitTrans;
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TFechamento_Venda }

procedure TFechamento_Venda.Alterar(var Registro: TFechamento_Venda);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Update Fechamento_Venda set Codigo = :Codigo, Dinheiro = :Dinheiro, Cheque_Pre = :Cheque_Pre, ');
        add('Cheque_Vista = :Cheque_Vista, Vale = :Vale, Ticket = :Ticket, Cartao = :Cartao');
        add('where Codigo = :Codigo');
        { Parameters.ParamByName('Codigo').Value:= Registro.Codi;
          Parameters.ParamByName('Dinheiro').Value:= Registro.Din;
          Parameters.ParamByName('Cheque_Pre').Value:= Registro.Che_Pre;
          Parameters.ParamByName('Cheque_Vista').Value:= Registro.Che_Vis;
          Parameters.ParamByName('Vale').Value:= Registro.Val;
          Parameters.ParamByName('Ticket').Value:= Registro.Tic;
          Parameters.ParamByName('Cartao').Value:= Registro.Car; }
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Altera;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TFechamento_Venda.Excluir(var Registro: TFechamento_Venda);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Delete from Fechamento_Venda where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Codi;
        ExecSQL;
        AtualizarQuantidadeRegistro('Fechamento_Venda', 'QtdeMeiosPagamento');
        // DM.ADOConnection1.CommitTrans;
        //lrControle := Exclui;
        //UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TFechamento_Venda.ExcluirLocal(var Registro: TFechamento_Venda);
var
  qAux, qaux2: TADOQuery;
begin
  try
    DM.ADOConnectionLocal.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnectionLocal;
        add('Delete from Fechamento_Venda');
        ExecSQL;
        DM.ADOConnectionLocal.CommitTrans;
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      DM.ADOConnectionLocal.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

function TFechamento_Venda.GetAcerto: integer;
begin
  GetAcerto := 0;
end;

function TFechamento_Venda.GetCodigo: integer;
begin
  {if (FrmPDV <> nil) then
  begin
    GetCodigo := StrToInt(FrmPDV.LblCodigo.Caption)
  end
  else if (FrmCarrega_Pedido_Caixa <> nil) then
  begin
    GetCodigo := FrmCarrega_Pedido_Caixa.qrycarrega_caixaCodigo.AsInteger;
  end;}
  GetCodigo := StrToInt(FrmFechamento_Venda_PDV.LblCodigo.Caption);
end;

function TFechamento_Venda.GetCodigo_Empresa: integer;
begin
  GetCodigo_Empresa := UDeclaracao.Codigo_Empresa;
end;

function TFechamento_Venda.GetCodigo_Pedido: integer;
begin
  GetCodigo_Pedido := UDeclaracao.Codigo;
end;

function TFechamento_Venda.GetCodigo_Usuario: integer;
begin
  GetCodigo_Usuario := UDeclaracao.codigo_usu;
end;

function TFechamento_Venda.GetCodigo_Caixa: integer;
begin
  GetCodigo_Caixa := UDeclaracao.Codigo_Caixa;
end;

function TFechamento_Venda.GetData: Tdate;
begin
  GetData := date;
  // StrToDateTime(FrmFechamento_Venda_PDV.LblData_Pedido.Caption);
end;

function TFechamento_Venda.GetData_Pedido: Tdate;
begin
  GetData_Pedido := StrToDateTime
    (FrmFechamento_Venda_PDV.LblData_Pedido.Caption);
end;

function TFechamento_Venda.GetForma_Pagamento: string;
begin
  GetForma_Pagamento := FrmFechamento_Venda_PDV.cFormaPgto;
end;

function TFechamento_Venda.GetForma_Pagamento_Pedido: string;
begin
  // GetForma_Pagamento_Pedido:= FrmFechamento_Pedido.cFormaPgto;
end;

function TFechamento_Venda.GetMovimenta: integer;
begin
  // if (FrmFechamento_Venda_PDV.tipo_pagamento = 'A VISTA') then
  GetMovimenta := 0;
  // else
  // GetMovimenta:= 1;
end;

function TFechamento_Venda.GetN_Documento: integer;
begin
  GetN_Documento := 0;
end;

function TFechamento_Venda.GetParcela: integer;
begin
  GetParcela := 0;
end;

function TFechamento_Venda.GetStatus: string;
begin
  GetStatus := 'PAGO';
end;

function TFechamento_Venda.GetTipo: string;
begin
  GetTipo := '+';
end;

function TFechamento_Venda.GetTipo_Documento: string;
begin
  GetTipo_Documento := 'CUPOM FISCAL';
end;

function TFechamento_Venda.GetTipo_Documento_Pedido: string;
begin
  // GetTipo_Documento_Pedido:= 'PEDIDO';
end;

function TFechamento_Venda.GetTroco: double;
begin
  GetTroco := StrToFloat(FrmFechamento_Venda_PDV.EdtTroco.Text);
end;

function TFechamento_Venda.GetValor: double;
begin
  GetValor := FrmFechamento_Venda_PDV.ValorRecebidoParcial;
end;

function TFechamento_Venda.GetValor_Pedido: double;
begin
  // GetValor_Pedido:= StrToFloat(FrmFechamento_Venda_PDV.EdtValor.Text);
end;

procedure TFechamento_Venda.Inserir(var Registro: TFechamento_Venda);
begin
  try
    if not(dm.qryfechamento_venda.Active) then
      dm.qryfechamento_venda.open;

    dm.qryfechamento_venda.Insert;
    dm.qryfechamento_venda['Codigo'] := Registro.Codi;
    dm.qryfechamento_venda['Codigo_Empresa'] :=
      Registro.Codi_Empresa;
    dm.qryfechamento_venda['Codigo_Caixa'] :=
      Registro.Codi_Caixa;
    dm.qryfechamento_venda['Codigo_Usuario'] :=
      Registro.Codi_Usuario;
    dm.qryfechamento_venda['Forma_Pagamento'] :=
      Registro.Form_Pag;
    dm.qryfechamento_venda['Valor'] := Registro.Val;
    dm.qryfechamento_venda['Troco'] := Registro.Trocoo;
    dm.qryfechamento_venda['Data'] := Registro.Dat;
    dm.qryfechamento_venda['Tipo_Documento'] :=
      Registro.Tipo_Doc;
    dm.qryfechamento_venda['Status'] := Registro.Statuss;
    dm.qryfechamento_venda['Acerto'] := Registro.Acertoo;
    dm.qryfechamento_venda['Tipo'] := Registro.Tipoo;
    dm.qryfechamento_venda['Movimenta'] :=
      Registro.Moviment;
    dm.qryfechamento_venda['N_Documento'] :=
      Registro.N_Doc;
    dm.qryfechamento_venda['Parcela'] := Registro.Parc;
    dm.qryfechamento_venda['MD5'] := GeraMD5([Registro.Tipo_Doc, FloatToStr(Registro.Val)]);
    dm.qryfechamento_venda.Post;

    // FrmFechamento_Venda_PDV.qryfechamento_venda.SaveToFile(Local_Arquivo(4), dfXMLUTF8);

    { if not (dm.qryfechamento_venda_aux.Active) then
      dm.qryfechamento_venda_aux.open;

      dm.qryfechamento_venda_aux.Insert;
      dm.qryfechamento_venda_aux['Codigo']:= FrmFechamento_Venda_PDV.qryfechamento_venda['Codigo'];
      dm.qryfechamento_venda_aux['Codigo_Empresa']:= FrmFechamento_Venda_PDV.qryfechamento_venda['Codigo_Empresa'];
      dm.qryfechamento_venda_aux['Codigo_Caixa']:= FrmFechamento_Venda_PDV.qryfechamento_venda['Codigo_Caixa'];
      dm.qryfechamento_venda_aux['Codigo_Usuario']:= FrmFechamento_Venda_PDV.qryfechamento_venda['Codigo_Usuario'];
      dm.qryfechamento_venda_aux['Forma_Pagamento']:= FrmFechamento_Venda_PDV.qryfechamento_venda['Forma_Pagamento'];
      dm.qryfechamento_venda_aux['Valor']:= FrmFechamento_Venda_PDV.qryfechamento_venda['Valor'];
      dm.qryfechamento_venda_aux['Troco']:= FrmFechamento_Venda_PDV.qryfechamento_venda['Troco'];
      dm.qryfechamento_venda_aux['Data']:= FrmFechamento_Venda_PDV.qryfechamento_venda['Data'];
      dm.qryfechamento_venda_aux['Tipo_Documento']:= FrmFechamento_Venda_PDV.qryfechamento_venda['Tipo_Documento'];
      dm.qryfechamento_venda_aux['Status']:= FrmFechamento_Venda_PDV.qryfechamento_venda['Status'];
      dm.qryfechamento_venda_aux['Acerto']:= FrmFechamento_Venda_PDV.qryfechamento_venda['Acerto'];
      dm.qryfechamento_venda_aux['Tipo']:= FrmFechamento_Venda_PDV.qryfechamento_venda['Tipo'];
      dm.qryfechamento_venda_aux['Movimenta']:= FrmFechamento_Venda_PDV.qryfechamento_venda['Movimenta'];
      dm.qryfechamento_venda_aux['N_Documento']:= FrmFechamento_Venda_PDV.qryfechamento_venda['N_Documento'];
      dm.qryfechamento_venda_aux['Parcela']:= FrmFechamento_Venda_PDV.qryfechamento_venda['Parcela']; }

    // dm.qryfechamento_venda_aux.SaveToFile(Local_Arquivo(19), dfXMLUTF8);
  except
    //
  end;
end;

procedure TFechamento_Venda.Salva_Banco(var Registro: TFechamento_Venda; var Conexao: TADOConnection);
var
  qAux, qaux2: TADOQuery;
  CDS: TClientDataSet;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    //DM.qryfechamento_venda_aux.close;
    //DM.qryfechamento_venda_aux.open;
    //DM.qryfechamento_venda_aux.First;
    //FrmFechamento_Venda_PDV.qryfechamento_venda.First;
    try
      qAux := TADOQuery.Create(nil);
      //while not FrmFechamento_Venda_PDV.qryfechamento_venda.Eof do
      //begin
        with qAux, SQL do
        begin
          close;
          clear;
          // Connection:= dm.ADOConnection1;
          Connection := Conexao;
          add('Insert into Fechamento_Venda (Codigo, Codigo_Empresa, Codigo_Caixa, Codigo_Usuario, Forma_Pagamento, Valor, Troco, Data, Tipo_Documento, Status, Acerto, Tipo, Movimenta, N_Documento, Parcela, MD5)');
          add('values (:Codigo, :Codigo_Empresa, :Codigo_Caixa, :Codigo_Usuario, :Forma_Pagamento, :Valor, :Troco, :Data, :Tipo_Documento, :Status, :Acerto, :Tipo, :Movimenta, :N_Documento, :Parcela, :MD5)');
          {Parameters.ParamByName('Codigo').Value := FrmFechamento_Venda_PDV.qryfechamento_venda
            ['Codigo'];
          Parameters.ParamByName('Codigo_Empresa').Value :=
            FrmFechamento_Venda_PDV.qryfechamento_venda['Codigo_Empresa'];
          Parameters.ParamByName('Codigo_Caixa').Value :=
            FrmFechamento_Venda_PDV.qryfechamento_venda['Codigo_Caixa'];
          Parameters.ParamByName('Codigo_Usuario').Value :=
            FrmFechamento_Venda_PDV.qryfechamento_venda['Codigo_Usuario'];
          Parameters.ParamByName('Forma_Pagamento').Value :=
            FrmFechamento_Venda_PDV.qryfechamento_venda['Forma_Pagamento'];
          Parameters.ParamByName('Valor').Value :=
            FrmFechamento_Venda_PDV.qryfechamento_venda['Valor'];
          Parameters.ParamByName('Troco').Value :=
            FrmFechamento_Venda_PDV.qryfechamento_venda['Troco'];
          Parameters.ParamByName('Data').Value :=
            FrmFechamento_Venda_PDV.qryfechamento_venda['Data'];
          Parameters.ParamByName('Tipo_Documento').Value :=
            FrmFechamento_Venda_PDV.qryfechamento_venda['Tipo_Documento'];
          Parameters.ParamByName('Status').Value := FrmFechamento_Venda_PDV.qryfechamento_venda
            ['Status'];
          Parameters.ParamByName('Acerto').Value := FrmFechamento_Venda_PDV.qryfechamento_venda
            ['Acerto'];
          Parameters.ParamByName('Tipo').Value :=
            FrmFechamento_Venda_PDV.qryfechamento_venda['Tipo'];
          Parameters.ParamByName('Movimenta').Value :=
            FrmFechamento_Venda_PDV.qryfechamento_venda['Movimenta'];
          Parameters.ParamByName('N_Documento').Value :=
            FrmFechamento_Venda_PDV.qryfechamento_venda['N_Documento'];
          Parameters.ParamByName('Parcela').Value := FrmFechamento_Venda_PDV.qryfechamento_venda
            ['Parcela'];
          Parameters.ParamByName('MD5').Value := FrmFechamento_Venda_PDV.qryfechamento_venda
            ['MD5'];}


          Parameters.ParamByName('Codigo').Value := Registro.Codi;
          Parameters.ParamByName('Codigo_Empresa').Value := Registro.Codi_Empresa;
          Parameters.ParamByName('Codigo_Caixa').Value := Registro.Codi_Caixa;
          Parameters.ParamByName('Codigo_Usuario').Value :=Registro.Codi_Usuario;
          Parameters.ParamByName('Forma_Pagamento').Value :=Registro.Form_Pag;
          Parameters.ParamByName('Valor').Value :=Registro.Val;
          Parameters.ParamByName('Troco').Value :=Registro.Trocoo;
          Parameters.ParamByName('Data').Value :=Registro.Dat;
          Parameters.ParamByName('Tipo_Documento').Value := Registro.Tipo_Doc;
          Parameters.ParamByName('Status').Value := Registro.Statuss;
          Parameters.ParamByName('Acerto').Value := Registro.Acertoo;
          Parameters.ParamByName('Tipo').Value :=Registro.Tipoo;
          Parameters.ParamByName('Movimenta').Value :=Registro.Moviment;
          Parameters.ParamByName('N_Documento').Value :=Registro.N_Doc;
          Parameters.ParamByName('Parcela').Value := Registro.Parc;
          Parameters.ParamByName('MD5').Value := GeraMD5([Registro.Tipo_Doc, FloatToStr(Registro.Val)]);
          ExecSQL;
        end;
        //FrmFechamento_Venda_PDV.qryfechamento_venda.Next;
      //end;
      //AtualizarQuantidadeRegistro('Fechamento_Venda', 'QtdeMeiosPagamento');
    finally
      // DM.ADOConnection1.CommitTrans;
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TFechamento_Venda.Salva_Banco_PDV;
var
  qAux, qaux2: TADOQuery;
  CDS: TClientDataSet;
begin
  try
    qAux := TADOQuery.Create(nil);
    // DM.ADOConnection1.BeginTrans;

    with DM.qryfechamento_venda_aux, SQL do
    begin
      close;
      Connection := DM.ADOConnectionLocal;
      clear;
      add('select * from Fechamento_Venda FV');
      add('where FV.Codigo = :Codigo');
      Parameters.ParamByName('Codigo').Value := DM.qryvendaCodigo.AsInteger;
      open;
      First;
    end;

    try
      while not DM.qryfechamento_venda_aux.Eof do
      begin
        with qAux, SQL do
        begin
          close;
          Connection := DM.ADOConnection1;
          clear;
          add('Insert into Fechamento_Venda (Codigo, Codigo_Empresa, Codigo_Caixa, Codigo_Usuario, Forma_Pagamento, Valor, Troco, Data, Tipo_Documento, Status, Acerto, Tipo, Movimenta, N_Documento, Parcela, MD5)');
          add('values (:Codigo, :Codigo_Empresa, :Codigo_Caixa, :Codigo_Usuario, :Forma_Pagamento, :Valor, :Troco, :Data, :Tipo_Documento, :Status, :Acerto, :Tipo, :Movimenta, :N_Documento, :Parcela, :MD5)');
          Parameters.ParamByName('Codigo').Value := UDeclaracao.Codigo;
          Parameters.ParamByName('Codigo_Empresa').Value :=
            DM.qryfechamento_venda_aux['Codigo_Empresa'];
          Parameters.ParamByName('Codigo_Caixa').Value :=
            DM.qryfechamento_venda_aux['Codigo_Caixa'];
          Parameters.ParamByName('Codigo_Usuario').Value :=
            DM.qryfechamento_venda_aux['Codigo_Usuario'];
          Parameters.ParamByName('Forma_Pagamento').Value :=
            DM.qryfechamento_venda_aux['Forma_Pagamento'];
          Parameters.ParamByName('Valor').Value :=
            DM.qryfechamento_venda_aux['Valor'];
          Parameters.ParamByName('Troco').Value :=
            DM.qryfechamento_venda_aux['Troco'];
          Parameters.ParamByName('Data').Value :=
            DM.qryfechamento_venda_aux['Data'];
          Parameters.ParamByName('Tipo_Documento').Value :=
            DM.qryfechamento_venda_aux['Tipo_Documento'];
          Parameters.ParamByName('Status').Value := DM.qryfechamento_venda_aux
            ['Status'];
          Parameters.ParamByName('Acerto').Value := DM.qryfechamento_venda_aux
            ['Acerto'];
          Parameters.ParamByName('Tipo').Value :=
            DM.qryfechamento_venda_aux['Tipo'];
          Parameters.ParamByName('Movimenta').Value :=
            DM.qryfechamento_venda_aux['Movimenta'];
          Parameters.ParamByName('N_Documento').Value :=
            DM.qryfechamento_venda_aux['N_Documento'];
          Parameters.ParamByName('Parcela').Value := DM.qryfechamento_venda_aux
            ['Parcela'];
          Parameters.ParamByName('MD5').Value := DM.qryfechamento_venda_aux
            ['MD5'];
          ExecSQL;
        end;
        DM.qryfechamento_venda_aux.Next;
      end;
      AtualizarQuantidadeRegistro('Fechamento_Venda', 'QtdeMeiosPagamento');
    finally
      // DM.ADOConnection1.CommitTrans;
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TFechamento_Venda.Salva_Conta(Codigo, Codigo_Empresa, Codigo_Caixa,
  Codigo_Usuario, Acerto, Movimenta, N_Documento, Parcela: integer;
  Forma_Pagamento, Tipo_Documento, Status, Tipo: Ansistring;
  Valor, Troco: double; Data: Tdate);
var
  qAux: TADOQuery;
begin
  qAux := TADOQuery.Create(nil);
  try
    with qAux, SQL do
    begin
      close;
      Connection := DM.ADOConnection1;
      clear;
      add('Insert into Fechamento_Venda (Codigo, Codigo_Empresa, Codigo_Caixa, Codigo_Usuario, Forma_Pagamento, Valor, Troco, Data, Tipo_Documento, Status, Acerto, Tipo, Movimenta, N_Documento, Parcela, MD5)');
      add('values (:Codigo, :Codigo_Empresa, :Codigo_Caixa, :Codigo_Usuario, :Forma_Pagamento, :Valor, :Troco, :Data, :Tipo_Documento, :Status, :Acerto, :Tipo, :Movimenta, :N_Documento, :Parcela, :MD5)');
      Parameters.ParamByName('Codigo').Value := Codigo;
      Parameters.ParamByName('Codigo_Empresa').Value := Codigo_Empresa;
      Parameters.ParamByName('Codigo_Caixa').Value := Codigo_Caixa;
      Parameters.ParamByName('Codigo_Usuario').Value := Codigo_Usuario;
      Parameters.ParamByName('Forma_Pagamento').Value := Forma_Pagamento;
      Parameters.ParamByName('Valor').Value := Valor;
      Parameters.ParamByName('Troco').Value := Troco;
      Parameters.ParamByName('Data').Value := Data;
      Parameters.ParamByName('Tipo_Documento').Value := Tipo_Documento;
      Parameters.ParamByName('Status').Value := Status;
      Parameters.ParamByName('Acerto').Value := Acerto;
      Parameters.ParamByName('Tipo').Value := Tipo;
      Parameters.ParamByName('Movimenta').Value := Movimenta;
      Parameters.ParamByName('N_Documento').Value := N_Documento;
      Parameters.ParamByName('Parcela').Value := Parcela;
      Parameters.ParamByName('MD5').Value := GeraMD5([Tipo_Documento, FloatToStr(Valor)]);
      ExecSQL;
      AtualizarQuantidadeRegistro('Fechamento_Venda', 'QtdeMeiosPagamento');
    end;
  finally
    FreeAndNil(qAux);
  end;
end;

{ TR03 }

function TR03.GetCaixa: string;
begin
  GetCaixa := StringOfChar('0', 4 - Length(UDeclaracao.Sequencia)) +
    UDeclaracao.Sequencia;
end;

function TR03.GetCodigo_Empresa: integer;
begin
  GetCodigo_Empresa := UDeclaracao.Codigo_Empresa;
end;

function TR03.GetCRZ: string;
begin
  GetCRZ := IntToStr(StrToInt(UDeclaracao.CRZ) + 1);
end;

function TR03.GetData_Movimento: Tdate;
begin
  GetData_Movimento := StrToDate(dataf);
end;

function TR03.GetMF_Adicional: string;
begin
  GetMF_Adicional := mf;
end;

function TR03.GetModelo: string;
begin
  GetModelo := UDeclaracao.sModelo;
end;

function TR03.GetNumero_Serie: string;
begin
  GetNumero_Serie := nu_serie;
end;

function TR03.GetNumero_Usuario: string;
begin
  GetNumero_Usuario := n_usuario;
end;

function TR03.GetTipo: string;
begin
  GetTipo := 'R03';
end;

function TR03.GetTotalizador_Parcial: string;
begin
  GetTotalizador_Parcial := cBuffer;
end;

function TR03.GetValor_Acumulado: string;
begin
  GetValor_Acumulado := cTotalizador;
end;

procedure TR03.Inserir(var Registro: TR03);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      begin
        with qAux, SQL do
        begin
          close;
          clear;
          Connection := DM.ADOConnection1;
          add('Insert into R03 (Codigo_Empresa, Data_Movimento, Tipo, N_Fabricacao, MF_Adicional, Modelo_ECF, N_Usuario, CRZ,');
          add('Totalizador_Parcial, Valor_Acumulado, Caixa, MD5) values (:Codigo_Empresa, :Data_Movimento, :Tipo, :N_Fabricacao, :MF_Adicional, :Modelo_ECF,');
          add(':N_Usuario, :CRZ, :Totalizador_Parcial, :Valor_Acumulado, :Caixa, :MD5)');
          Parameters.ParamByName('Codigo_Empresa').Value :=
            Registro.Cod_Empresa;
          Parameters.ParamByName('Data_Movimento').Value := Registro.Data_Mov;
          Parameters.ParamByName('Tipo').Value := Registro.Tip;
          Parameters.ParamByName('N_Fabricacao').Value := Registro.N_Serie;
          Parameters.ParamByName('MF_Adicional').Value := Registro.MF_Ad;
          Parameters.ParamByName('Modelo_ECF').Value := Registro.Mode;
          Parameters.ParamByName('N_Usuario').Value := Registro.N_Usu;
          Parameters.ParamByName('CRZ').Value := Registro.CRZZ;
          Parameters.ParamByName('Totalizador_Parcial').Value :=
            Registro.Tot_Par;
          Parameters.ParamByName('Valor_Acumulado').Value := Registro.Valor_Acu;
          Parameters.ParamByName('Caixa').Value := Registro.Caix;
          Parameters.ParamByName('MD5').Value := GeraMD5([Registro.N_Serie, Registro.CRZZ, Registro.Tot_Par, Registro.Valor_Acu]);
          ExecSQL;
          AtualizarQuantidadeRegistro('R03', 'QtdeR03');
        end;
      end;
    finally
      // DM.ADOConnection1.CommitTrans;
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      // Operacao_Nao_Completada(E.Message);
      Application.MessageBox(PWideChar('Erro ao gravar R03: ' + E.Message),
        'Erro', MB_OK + MB_ICONHAND);
    end;
  end;
end;

procedure TR03.Inserir_Aux(var Registro: TR03);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      begin
        with qAux, SQL do
        begin
          close;
          clear;
          Connection := DM.ADOConnection1;
          add('Insert into R03_Aux (Codigo_Empresa, Data_Movimento, Tipo, N_Fabricacao, MF_Adicional, Modelo_ECF, N_Usuario, CRZ,');
          add('Totalizador_Parcial, Valor_Acumulado, Caixa) values (:Codigo_Empresa, :Data_Movimento, :Tipo, :N_Fabricacao, :MF_Adicional, :Modelo_ECF,');
          add(':N_Usuario, :CRZ, :Totalizador_Parcial, :Valor_Acumulado, :Caixa)');
          Parameters.ParamByName('Codigo_Empresa').Value :=
            Registro.Cod_Empresa;
          Parameters.ParamByName('Data_Movimento').Value := Registro.Data_Mov;
          Parameters.ParamByName('Tipo').Value := Registro.Tip;
          Parameters.ParamByName('N_Fabricacao').Value := Registro.N_Serie;
          Parameters.ParamByName('MF_Adicional').Value := Registro.MF_Ad;
          Parameters.ParamByName('Modelo_ECF').Value := Registro.Mode;
          Parameters.ParamByName('N_Usuario').Value := Registro.N_Usu;
          Parameters.ParamByName('CRZ').Value := Registro.CRZZ;
          Parameters.ParamByName('Totalizador_Parcial').Value :=
            Registro.Tot_Par;
          Parameters.ParamByName('Valor_Acumulado').Value := Registro.Valor_Acu;
          Parameters.ParamByName('Caixa').Value := Registro.Caix;
          ExecSQL;
        end;
      end;
    finally
      // DM.ADOConnection1.CommitTrans;
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TR02 }

function TR02.GetCaixa: string;
begin
  GetCaixa := StringOfChar('0', 4 - Length(UDeclaracao.Sequencia)) +
    UDeclaracao.Sequencia;
end;

function TR02.GetCodigo_Empresa: integer;
begin
  GetCodigo_Empresa := UDeclaracao.Codigo_Empresa;
end;

function TR02.GetCOO: string;
begin
  GetCOO := IntToStr(StrToInt(UDeclaracao.COO) + 1);
end;

function TR02.GetCOO_Final: string;
begin
  GetCOO_Final := UDeclaracao.COOFinal;
end;

function TR02.GetCOO_Inicial: string;
begin
  GetCOO_Inicial := UDeclaracao.COOInicial;
end;

function TR02.GetCRO: string;
begin
  GetCRO := UDeclaracao.CRO;
end;

function TR02.GetCRZ: string;
begin
  GetCRZ := IntToStr(StrToInt(UDeclaracao.CRZ) + 1);
end;

function TR02.GetData_Emissao: string;
begin
  GetData_Emissao := data_reducao;
end;

function TR02.GetData_Movimento: Tdate;
begin
  GetData_Movimento := StrToDate(dataf);
end;

function TR02.GetGrande_Total: string;
begin
  GetGrande_Total := UDeclaracao.GrandeTotal;
end;

function TR02.GetHora_Emissao: string;
begin
  GetHora_Emissao := hora_reducao;
end;

function TR02.GetISSQN: string;
begin
  GetISSQN := UDeclaracao.ISSQN;
end;

function TR02.GetMF_Adicional: string;
begin
  GetMF_Adicional := mf;
end;

function TR02.GetModelo: string;
begin
  GetModelo := UDeclaracao.sModelo;
end;

function TR02.GetNumero_Serie: string;
begin
  GetNumero_Serie := nu_serie_inteiro;
end;

function TR02.GetNumero_Usuario: string;
begin
  GetNumero_Usuario := n_usuario;
end;

function TR02.GetTipo: string;
begin
  GetTipo := 'R02';
end;

function TR02.GetVenda_Bruta_Diaria: string;
begin
  GetVenda_Bruta_Diaria := UDeclaracao.Venda_Bruta_Diaria;
end;

function TR02.Inserir(var Registro: TR02): Boolean;
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    Result := false;
    try
      qAux := TADOQuery.Create(nil);
      begin
        with qAux, SQL do
        begin
          close;
          clear;
          Connection := DM.ADOConnection1;
          add('Insert into R02 (Codigo_Empresa, Tipo, N_Fabricacao, MF_Adicional, Modelo_ECF, N_Usuario,');
          add('CRZ, COO, CRO, Data_Movimento, Data_Emissao, Hora_Emissao, Venda_Bruta_Diaria, ');
          add('Parametro_ECF, Caixa, COO_Inicial, COO_Final, Grande_Total, MD5) values ');
          add('(:Codigo_Empresa, :Tipo, :N_Fabricacao, :MF_Adicional, :Modelo_ECF,');
          add(':N_Usuario, :CRZ, :COO, :CRO, :Data_Movimento, :Data_Emissao, :Hora_Emissao, ');
          add(':Venda_Bruta_Diaria, :Parametro_ECF, :Caixa, :COO_Inicial, :COO_Final, :Grande_Total, :MD5)');

          Parameters.ParamByName('Codigo_Empresa').Value :=
            Registro.Cod_Empresa;
          Parameters.ParamByName('Tipo').Value := Registro.Tip;
          Parameters.ParamByName('N_Fabricacao').Value := Registro.N_Serie;
          Parameters.ParamByName('MF_Adicional').Value := Registro.MF_Ad;
          Parameters.ParamByName('Modelo_ECF').Value := Registro.Mode;
          Parameters.ParamByName('N_Usuario').Value := Registro.N_Usu;
          Parameters.ParamByName('CRZ').Value := Registro.CRZZ;
          Parameters.ParamByName('COO').Value := Registro.COOO;
          Parameters.ParamByName('CRO').Value := Registro.CROO;
          Parameters.ParamByName('Data_Movimento').Value := dataf;
          Parameters.ParamByName('Data_Emissao').Value := Registro.Data_Emis;
          Parameters.ParamByName('Hora_Emissao').Value := Registro.Hora_Emis;
          Parameters.ParamByName('Venda_Bruta_Diaria').Value :=
            Registro.Venda_Br;
          Parameters.ParamByName('Parametro_ECF').Value := Registro.ISSQ;
          Parameters.ParamByName('Caixa').Value := Registro.Caix;
          Parameters.ParamByName('COO_Inicial').Value := Registro.COO_Ini;
          Parameters.ParamByName('COO_Final').Value := Registro.COO_Fin;
          Parameters.ParamByName('Grande_Total').Value := Registro.Grande_Tot;
          Parameters.ParamByName('Caixa').Value := Registro.Caix;
          Parameters.ParamByName('MD5').Value := GeraMD5([Registro.N_Serie, Registro.CRZZ, Registro.CROO,
                                                          Registro.COOO, dataf, Registro.Data_Emis,
                                                          Registro.Hora_Emis, Registro.Venda_Br]);
          ExecSQL;
          AtualizarQuantidadeRegistro('R02', 'QtdeR02');
          Result := true;
        end;
      end;
    finally
      // DM.ADOConnection1.CommitTrans;
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      // Operacao_Nao_Completada(E.Message);
      Result := false;
      Application.MessageBox(PWideChar('Erro ao gravar R02: ' + E.Message),
        'Erro', MB_OK + MB_ICONHAND);
    end;
  end;
end;

procedure TR02.Inserir_Aux(var Registro: TR02);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      begin
        with qAux, SQL do
        begin
          close;
          clear;
          Connection := DM.ADOConnection1;
          add('Insert into R02_Aux (Codigo_Empresa, Tipo, N_Fabricacao, MF_Adicional, Modelo_ECF, N_Usuario,');
          add('CRZ, COO, CRO, Data_Movimento, Data_Emissao, Hora_Emissao, Venda_Bruta_Diaria, ');
          add('Parametro_ECF, Caixa, COO_Inicial, COO_Final, Grande_Total) values ');
          add('(:Codigo_Empresa, :Tipo, :N_Fabricacao, :MF_Adicional, :Modelo_ECF,');
          add(':N_Usuario, :CRZ, :COO, :CRO, :Data_Movimento, :Data_Emissao, :Hora_Emissao, ');
          add(':Venda_Bruta_Diaria, :Parametro_ECF, :Caixa, :COO_Inicial, :COO_Final, :Grande_Total)');
          Parameters.ParamByName('Codigo_Empresa').Value :=
            Registro.Cod_Empresa;
          Parameters.ParamByName('Tipo').Value := Registro.Tip;
          Parameters.ParamByName('N_Fabricacao').Value := Registro.N_Serie;
          Parameters.ParamByName('MF_Adicional').Value := Registro.MF_Ad;
          Parameters.ParamByName('Modelo_ECF').Value := Registro.Mode;
          Parameters.ParamByName('N_Usuario').Value := Registro.N_Usu;
          Parameters.ParamByName('CRZ').Value := Registro.CRZZ;
          Parameters.ParamByName('COO').Value := Registro.COOO;
          Parameters.ParamByName('CRO').Value := Registro.CROO;
          Parameters.ParamByName('Data_Movimento').Value := Registro.Data_Mov;
          Parameters.ParamByName('Data_Emissao').Value := Registro.Data_Emis;
          Parameters.ParamByName('Hora_Emissao').Value := Registro.Hora_Emis;
          Parameters.ParamByName('Venda_Bruta_Diaria').Value :=
            Registro.Venda_Br;
          Parameters.ParamByName('Parametro_ECF').Value := Registro.ISSQ;
          Parameters.ParamByName('Caixa').Value := Registro.Caix;
          Parameters.ParamByName('COO_Inicial').Value := Registro.COO_Ini;
          Parameters.ParamByName('COO_Final').Value := Registro.COO_Fin;
          Parameters.ParamByName('Grande_Total').Value := Registro.Grande_Tot;
          Parameters.ParamByName('Caixa').Value := Registro.Caix;
          ExecSQL;
        end;
      end;
    finally
      // DM.ADOConnection1.CommitTrans;
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TR04 }

procedure TR04.Excluir(var Registro: TR04);
var
  qAux, qaux2: TADOQuery;
begin
  try
    DM.ADOConnectionLocal.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnectionLocal;
        add('Delete from R04');
        ExecSQL;
        DM.ADOConnectionLocal.CommitTrans;
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      DM.ADOConnectionLocal.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

function TR04.GetAcrecimo: string;
begin
  GetAcrecimo := FrmFechamento_Venda_PDV.Acrecimo;
end;

function TR04.GetAdquirente: string;
begin
  GetAdquirente := FrmFechamento_Venda_PDV.Adquirente;
end;

function TR04.GetCaixa: string;
begin
  GetCaixa := StringOfChar('0', 4 - Length(UDeclaracao.Sequencia)) +
    UDeclaracao.Sequencia;
end;

function TR04.GetCancelamento: string;
begin
  GetCancelamento := FrmFechamento_Venda_PDV.indicador_cancelamento;
end;

function TR04.GetCCF: string;
begin
  GetCCF := UDeclaracao.CCF;
end;

function TR04.GetCOO: string;
begin
  GetCOO := UDeclaracao.COO;
end;

function TR04.GetCPF_CNPJ_Adquirente: string;
begin
  GetCPF_CNPJ_Adquirente := FrmFechamento_Venda_PDV.cnpj_adquirente;
end;

function TR04.GetData_Inicio_Emissao: string;
begin
  GetData_Inicio_Emissao := d_ab;
end;

function TR04.GetData_Movimento: Tdate;
begin
  GetData_Movimento := StrToDate(dataf);
end;

function TR04.GetDesconto: string;
begin
  GetDesconto := FrmFechamento_Venda_PDV.desconto_subtotal;
end;

function TR04.GetIndicador_Acre_Desc: string;
begin
  GetIndicador_Acre_Desc := FrmFechamento_Venda_PDV.indicador_desc_acre;
end;

function TR04.GetMF_Adicional: string;
begin
  GetMF_Adicional := mf;
end;

function TR04.GetModelo: string;
begin
  GetModelo := UDeclaracao.sModelo;
end;

function TR04.GetNumero_Serie: string;
begin
  GetNumero_Serie := UDeclaracao.nu_serie;
end;

function TR04.GetNumero_Usuario: string;
begin
  GetNumero_Usuario := n_usuario;
end;

function TR04.GetN_Pedido: integer;
begin
  if (FrmPDV <> nil) then
  begin
    GetN_Pedido := StrToInt(FrmPDV.LblCodigo.Caption)
  end
  else if (FrmCarrega_Pedido_Caixa <> nil) then
    GetN_Pedido := FrmCarrega_Pedido_Caixa.qrycarrega_caixaCodigo.AsInteger;
end;

function TR04.GetSub_Total_Documento: string;
begin
  GetSub_Total_Documento := UDeclaracao.subtotal;
end;

function TR04.GetTipo: string;
begin
  GetTipo := 'R04';
end;

function TR04.GetTipo_Acrecimo: string;
begin
  GetTipo_Acrecimo := FrmFechamento_Venda_PDV.indicador_tipo_acre;
end;

function TR04.GetTipo_Desconto: string;
begin
  GetTipo_Desconto := FrmFechamento_Venda_PDV.indicador_tipo_desc;
end;

function TR04.GetValor_Cancelamento_Acrecimo: string;
begin
  GetValor_Cancelamento_Acrecimo :=
    FrmFechamento_Venda_PDV.cancelamento_acrecimo;
end;

function TR04.GetValor_Total: string;
begin
  GetValor_Total := FrmFechamento_Venda_PDV.Valor_Total;
end;

procedure TR04.Inserir(var Registro: TR04);
begin
  if not(DM.qryr04.Active) then
    DM.qryr04.open;

  DM.qryr04.Insert;
  DM.qryr04['N_Pedido'] := Registro.N_Ped;
  DM.qryr04['Data_Movimento'] := Registro.Data_Mov;
  DM.qryr04['Tipo'] := Registro.Tip;
  DM.qryr04['N_Fabricacao'] := Registro.N_Serie;
  DM.qryr04['MF_Adicional'] := Registro.MF_Ad;
  DM.qryr04['Modelo_ECF'] := Registro.Mode;
  DM.qryr04['N_Usuario'] := Registro.N_Usu;
  DM.qryr04['CCF'] := Registro.CCFF;
  DM.qryr04['COO'] := Registro.COOO;
  DM.qryr04['Data_Inicio_Emissao'] := Registro.Data_Ini_Emis;
  DM.qryr04['Sub_Total_Documento'] := Registro.Sub_Tot_Doc;
  DM.qryr04['Desconto'] := Registro.Desc;
  DM.qryr04['Tipo_Desconto'] := Registro.Tipo_Desc;
  DM.qryr04['Acrecimo'] := Registro.Acre;
  DM.qryr04['Tipo_Acrecimo'] := Registro.Tipo_Acre;
  DM.qryr04['Valor_Total'] := Registro.Valor_Tot;
  DM.qryr04['Cancelamento'] := Registro.Canc;
  DM.qryr04['Valor_Cancelamento_Acrecimo'] := Registro.Valor_Canc_Acre;
  DM.qryr04['Indicador_Acre_Desc'] := Registro.Indic_Acre_Desc;
  DM.qryr04['Adquirente'] := Registro.Adqui;
  DM.qryr04['CPF_CNPJ'] := Registro.CPF_CNPJ_Adqui;
  DM.qryr04['Caixa'] := Registro.Caix;
  DM.qryr04['MD5'] := GeraMD5([Registro.N_Serie, Registro.CCFF,
                                                          Registro.COOO, Registro.Valor_Tot,
                                                          Registro.Canc]);
  DM.qryr04.Post;
  // dm.qryr04.SaveToFile(Local_Arquivo(6));
end;

procedure TR04.Salva_Banco(var Registro: TR04);
var
  qAux, qaux2: TADOQuery;
  CDS: TClientDataSet;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      DM.qryr04.close;
      DM.qryr04.open;
      DM.qryr04.First;
      while not DM.qryr04.Eof do
      begin
        with qAux, SQL do
        begin
          close;
          Connection := DM.ADOConnection1;
          clear;
          add('Insert into R04 (N_Pedido, Data_Movimento, Tipo, N_Fabricacao, MF_Adicional, Modelo_ECF, N_Usuario, CCF, COO, Data_Inicio_Emissao, ');
          add('Sub_Total_Documento, Desconto, Tipo_Desconto, Acrecimo, Tipo_Acrecimo, Valor_Total, Cancelamento, Valor_Cancelamento_Acrecimo,');
          add('Indicador_Acre_Desc, Adquirente, CPF_CNPJ, Caixa, MD5) values (:N_Pedido, :Data_Movimento, :Tipo, :N_Fabricacao, :MF_Adicional, :Modelo_ECF, :N_Usuario, :CCF, :COO, :Data_Inicio_Emissao,');
          add(':Sub_Total_Documento, :Desconto, :Tipo_Desconto, :Acrecimo, :Tipo_Acrecimo, :Valor_Total, :Cancelamento, :Valor_Cancelamento_Acrecimo,');
          add(':Indicador_Acre_Desc, :Adquirente, :CPF_CNPJ, :Caixa, :MD5)');
          Parameters.ParamByName('N_Pedido').Value := DM.qryr04['N_Pedido'];
          Parameters.ParamByName('Data_Movimento').Value :=
            DM.qryr04['Data_Movimento'];
          Parameters.ParamByName('Tipo').Value := DM.qryr04['Tipo'];
          Parameters.ParamByName('N_Fabricacao').Value :=
            DM.qryr04['N_Fabricacao'];
          Parameters.ParamByName('MF_Adicional').Value :=
            DM.qryr04['MF_Adicional'];
          Parameters.ParamByName('Modelo_ECF').Value := DM.qryr04['Modelo_ECF'];
          Parameters.ParamByName('N_Usuario').Value := DM.qryr04['N_Usuario'];
          Parameters.ParamByName('CCF').Value := DM.qryr04['CCF'];
          Parameters.ParamByName('COO').Value := DM.qryr04['COO'];
          Parameters.ParamByName('Data_Inicio_Emissao').Value :=
            DM.qryr04['Data_Inicio_Emissao'];
          Parameters.ParamByName('Sub_Total_Documento').Value :=
            DM.qryr04['Sub_Total_Documento'];
          Parameters.ParamByName('Desconto').Value := DM.qryr04['Desconto'];
          Parameters.ParamByName('Tipo_Desconto').Value :=
            DM.qryr04['Tipo_Desconto'];
          Parameters.ParamByName('Acrecimo').Value := DM.qryr04['Acrecimo'];
          Parameters.ParamByName('Tipo_Acrecimo').Value :=
            DM.qryr04['Tipo_Acrecimo'];
          Parameters.ParamByName('Valor_Total').Value :=
            DM.qryr04['Valor_Total'];
          Parameters.ParamByName('Cancelamento').Value :=
            DM.qryr04['Cancelamento'];
          Parameters.ParamByName('Valor_Cancelamento_Acrecimo').Value :=
            DM.qryr04['Valor_Cancelamento_Acrecimo'];
          Parameters.ParamByName('Indicador_Acre_Desc').Value :=
            DM.qryr04['Indicador_Acre_Desc'];
          Parameters.ParamByName('Adquirente').Value := DM.qryr04['Adquirente'];
          Parameters.ParamByName('CPF_CNPJ').Value := DM.qryr04['CPF_CNPJ'];
          Parameters.ParamByName('Caixa').Value := DM.qryr04['Caixa'];
          Parameters.ParamByName('MD5').Value := DM.qryr04['MD5'];
          ExecSQL;

          AtualizarQuantidadeRegistro('R04', 'QtdeR04');
        end;

        {with qAux, SQL do
        begin
          close;
          Connection := DM.ADOConnection1;
          clear;
          add('Insert into R04_Aux (N_Pedido, Data_Movimento, Tipo, N_Fabricacao, MF_Adicional, Modelo_ECF, N_Usuario, CCF, COO, Data_Inicio_Emissao, ');
          add('Sub_Total_Documento, Desconto, Tipo_Desconto, Acrecimo, Tipo_Acrecimo, Valor_Total, Cancelamento, Valor_Cancelamento_Acrecimo,');
          add('Indicador_Acre_Desc, Adquirente, CPF_CNPJ, Caixa) values (:N_Pedido, :Data_Movimento, :Tipo, :N_Fabricacao, :MF_Adicional, :Modelo_ECF, :N_Usuario, :CCF, :COO, :Data_Inicio_Emissao,');
          add(':Sub_Total_Documento, :Desconto, :Tipo_Desconto, :Acrecimo, :Tipo_Acrecimo, :Valor_Total, :Cancelamento, :Valor_Cancelamento_Acrecimo,');
          add(':Indicador_Acre_Desc, :Adquirente, :CPF_CNPJ, :Caixa)');
          Parameters.ParamByName('N_Pedido').Value := DM.qryr04['N_Pedido'];
          Parameters.ParamByName('Data_Movimento').Value :=
            DM.qryr04['Data_Movimento'];
          Parameters.ParamByName('Tipo').Value := DM.qryr04['Tipo'];
          Parameters.ParamByName('N_Fabricacao').Value :=
            DM.qryr04['N_Fabricacao'];
          Parameters.ParamByName('MF_Adicional').Value :=
            DM.qryr04['MF_Adicional'];
          Parameters.ParamByName('Modelo_ECF').Value := DM.qryr04['Modelo_ECF'];
          Parameters.ParamByName('N_Usuario').Value := DM.qryr04['N_Usuario'];
          Parameters.ParamByName('CCF').Value := DM.qryr04['CCF'];
          Parameters.ParamByName('COO').Value := DM.qryr04['COO'];
          Parameters.ParamByName('Data_Inicio_Emissao').Value :=
            DM.qryr04['Data_Inicio_Emissao'];
          Parameters.ParamByName('Sub_Total_Documento').Value :=
            DM.qryr04['Sub_Total_Documento'];
          Parameters.ParamByName('Desconto').Value := DM.qryr04['Desconto'];
          Parameters.ParamByName('Tipo_Desconto').Value :=
            DM.qryr04['Tipo_Desconto'];
          Parameters.ParamByName('Acrecimo').Value := DM.qryr04['Acrecimo'];
          Parameters.ParamByName('Tipo_Acrecimo').Value :=
            DM.qryr04['Tipo_Acrecimo'];
          Parameters.ParamByName('Valor_Total').Value :=
            DM.qryr04['Valor_Total'];
          Parameters.ParamByName('Cancelamento').Value :=
            DM.qryr04['Cancelamento'];
          Parameters.ParamByName('Valor_Cancelamento_Acrecimo').Value :=
            DM.qryr04['Valor_Cancelamento_Acrecimo'];
          Parameters.ParamByName('Indicador_Acre_Desc').Value :=
            DM.qryr04['Indicador_Acre_Desc'];
          Parameters.ParamByName('Adquirente').Value := DM.qryr04['Adquirente'];
          Parameters.ParamByName('CPF_CNPJ').Value := DM.qryr04['CPF_CNPJ'];
          Parameters.ParamByName('Caixa').Value := DM.qryr04['Caixa'];
          ExecSQL;
        end;
                        }
        DM.qryr04.Next;
      end;
    finally
      // DM.ADOConnection1.CommitTrans;
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TR04.Salva_Banco_Aux(var Registro: TR04);
var
  qAux, qaux2: TADOQuery;
  CDS: TClientDataSet;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      DM.qryr04.close;
      DM.qryr04.open;
      DM.qryr04.First;
      begin
        while not DM.qryr04.Eof do
        begin
          with qAux, SQL do
          begin
            close;
            clear;
            // Connection:= dm.ADOConnection1;
            Connection := DM.ADOConnection1;
            add('Insert into R04_Aux (N_Pedido, Data_Movimento, Tipo, N_Fabricacao, MF_Adicional, Modelo_ECF, N_Usuario, CCF, COO, Data_Inicio_Emissao, ');
            add('Sub_Total_Documento, Desconto, Tipo_Desconto, Acrecimo, Tipo_Acrecimo, Valor_Total, Cancelamento, Valor_Cancelamento_Acrecimo,');
            add('Indicador_Acre_Desc, Adquirente, CPF_CNPJ, Caixa) values (:N_Pedido, :Data_Movimento, :Tipo, :N_Fabricacao, :MF_Adicional, :Modelo_ECF, :N_Usuario, :CCF, :COO, :Data_Inicio_Emissao,');
            add(':Sub_Total_Documento, :Desconto, :Tipo_Desconto, :Acrecimo, :Tipo_Acrecimo, :Valor_Total, :Cancelamento, :Valor_Cancelamento_Acrecimo,');
            add(':Indicador_Acre_Desc, :Adquirente, :CPF_CNPJ, :Caixa)');
            Parameters.ParamByName('N_Pedido').Value := DM.qryr04['N_Pedido'];
            Parameters.ParamByName('Data_Movimento').Value :=
              DM.qryr04['Data_Movimento'];
            Parameters.ParamByName('Tipo').Value := DM.qryr04['Tipo'];
            Parameters.ParamByName('N_Fabricacao').Value :=
              DM.qryr04['N_Fabricacao'];
            Parameters.ParamByName('MF_Adicional').Value :=
              DM.qryr04['MF_Adicional'];
            Parameters.ParamByName('Modelo_ECF').Value :=
              DM.qryr04['Modelo_ECF'];
            Parameters.ParamByName('N_Usuario').Value := DM.qryr04['N_Usuario'];
            Parameters.ParamByName('CCF').Value := DM.qryr04['CCF'];
            Parameters.ParamByName('COO').Value := DM.qryr04['COO'];
            Parameters.ParamByName('Data_Inicio_Emissao').Value :=
              DM.qryr04['Data_Inicio_Emissao'];
            Parameters.ParamByName('Sub_Total_Documento').Value :=
              DM.qryr04['Sub_Total_Documento'];
            Parameters.ParamByName('Desconto').Value := DM.qryr04['Desconto'];
            Parameters.ParamByName('Tipo_Desconto').Value :=
              DM.qryr04['Tipo_Desconto'];
            Parameters.ParamByName('Acrecimo').Value := DM.qryr04['Acrecimo'];
            Parameters.ParamByName('Tipo_Acrecimo').Value :=
              DM.qryr04['Tipo_Acrecimo'];
            Parameters.ParamByName('Valor_Total').Value :=
              DM.qryr04['Valor_Total'];
            Parameters.ParamByName('Cancelamento').Value :=
              DM.qryr04['Cancelamento'];
            Parameters.ParamByName('Valor_Cancelamento_Acrecimo').Value :=
              DM.qryr04['Valor_Cancelamento_Acrecimo'];
            Parameters.ParamByName('Indicador_Acre_Desc').Value :=
              DM.qryr04['Indicador_Acre_Desc'];
            Parameters.ParamByName('Adquirente').Value :=
              DM.qryr04['Adquirente'];
            Parameters.ParamByName('CPF_CNPJ').Value := DM.qryr04['CPF_CNPJ'];
            Parameters.ParamByName('Caixa').Value := DM.qryr04['Caixa'];
            ExecSQL;
          end;
          DM.qryr04.Next;
        end;
      end;
    finally
      // DM.ADOConnection1.CommitTrans;
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TR04.Salva_Banco_PDV;
var
  qAux, qaux2: TADOQuery;
  CDS: TClientDataSet;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);

      with DM.qryr04, SQL do
      begin
        close;
        Connection := DM.ADOConnectionLocal;
        clear;
        add('select * from R04');
        add('where R04.N_Pedido = :N_Pedido');
        Parameters.ParamByName('N_Pedido').Value := DM.qryvendaCodigo.AsInteger;
        open;
        First;
      end;

      while not DM.qryr04.Eof do
      begin
        with qAux, SQL do
        begin
          close;
          Connection := DM.ADOConnection1;
          clear;
          add('Insert into R04 (N_Pedido, Data_Movimento, Tipo, N_Fabricacao, MF_Adicional, Modelo_ECF, N_Usuario, CCF, COO, Data_Inicio_Emissao, ');
          add('Sub_Total_Documento, Desconto, Tipo_Desconto, Acrecimo, Tipo_Acrecimo, Valor_Total, Cancelamento, Valor_Cancelamento_Acrecimo,');
          add('Indicador_Acre_Desc, Adquirente, CPF_CNPJ, Caixa, MD5) values (:N_Pedido, :Data_Movimento, :Tipo, :N_Fabricacao, :MF_Adicional, :Modelo_ECF, :N_Usuario, :CCF, :COO, :Data_Inicio_Emissao,');
          add(':Sub_Total_Documento, :Desconto, :Tipo_Desconto, :Acrecimo, :Tipo_Acrecimo, :Valor_Total, :Cancelamento, :Valor_Cancelamento_Acrecimo,');
          add(':Indicador_Acre_Desc, :Adquirente, :CPF_CNPJ, :Caixa, :MD5)');
          Parameters.ParamByName('N_Pedido').Value := UDeclaracao.Codigo;
          Parameters.ParamByName('Data_Movimento').Value :=
            DM.qryr04['Data_Movimento'];
          Parameters.ParamByName('Tipo').Value := DM.qryr04['Tipo'];
          Parameters.ParamByName('N_Fabricacao').Value :=
            DM.qryr04['N_Fabricacao'];
          Parameters.ParamByName('MF_Adicional').Value :=
            DM.qryr04['MF_Adicional'];
          Parameters.ParamByName('Modelo_ECF').Value := DM.qryr04['Modelo_ECF'];
          Parameters.ParamByName('N_Usuario').Value := DM.qryr04['N_Usuario'];
          Parameters.ParamByName('CCF').Value := DM.qryr04['CCF'];
          Parameters.ParamByName('COO').Value := DM.qryr04['COO'];
          Parameters.ParamByName('Data_Inicio_Emissao').Value :=
            DM.qryr04['Data_Inicio_Emissao'];
          Parameters.ParamByName('Sub_Total_Documento').Value :=
            DM.qryr04['Sub_Total_Documento'];
          Parameters.ParamByName('Desconto').Value := DM.qryr04['Desconto'];
          Parameters.ParamByName('Tipo_Desconto').Value :=
            DM.qryr04['Tipo_Desconto'];
          Parameters.ParamByName('Acrecimo').Value := DM.qryr04['Acrecimo'];
          Parameters.ParamByName('Tipo_Acrecimo').Value :=
            DM.qryr04['Tipo_Acrecimo'];
          Parameters.ParamByName('Valor_Total').Value :=
            DM.qryr04['Valor_Total'];
          Parameters.ParamByName('Cancelamento').Value :=
            DM.qryr04['Cancelamento'];
          Parameters.ParamByName('Valor_Cancelamento_Acrecimo').Value :=
            DM.qryr04['Valor_Cancelamento_Acrecimo'];
          Parameters.ParamByName('Indicador_Acre_Desc').Value :=
            DM.qryr04['Indicador_Acre_Desc'];
          Parameters.ParamByName('Adquirente').Value := DM.qryr04['Adquirente'];
          Parameters.ParamByName('CPF_CNPJ').Value := DM.qryr04['CPF_CNPJ'];
          Parameters.ParamByName('Caixa').Value := DM.qryr04['Caixa'];
          Parameters.ParamByName('MD5').Value := DM.qryr04['MD5'];
          ExecSQL;

          AtualizarQuantidadeRegistro('R04', 'QtdeR04');
        end;

        {with qAux, SQL do
        begin
          close;
          Connection := DM.ADOConnection1;
          clear;
          add('Insert into R04_Aux (N_Pedido, Data_Movimento, Tipo, N_Fabricacao, MF_Adicional, Modelo_ECF, N_Usuario, CCF, COO, Data_Inicio_Emissao, ');
          add('Sub_Total_Documento, Desconto, Tipo_Desconto, Acrecimo, Tipo_Acrecimo, Valor_Total, Cancelamento, Valor_Cancelamento_Acrecimo,');
          add('Indicador_Acre_Desc, Adquirente, CPF_CNPJ, Caixa) values (:N_Pedido, :Data_Movimento, :Tipo, :N_Fabricacao, :MF_Adicional, :Modelo_ECF, :N_Usuario, :CCF, :COO, :Data_Inicio_Emissao,');
          add(':Sub_Total_Documento, :Desconto, :Tipo_Desconto, :Acrecimo, :Tipo_Acrecimo, :Valor_Total, :Cancelamento, :Valor_Cancelamento_Acrecimo,');
          add(':Indicador_Acre_Desc, :Adquirente, :CPF_CNPJ, :Caixa)');
          Parameters.ParamByName('N_Pedido').Value := UDeclaracao.Codigo;
          Parameters.ParamByName('Data_Movimento').Value :=
            DM.qryr04['Data_Movimento'];
          Parameters.ParamByName('Tipo').Value := DM.qryr04['Tipo'];
          Parameters.ParamByName('N_Fabricacao').Value :=
            DM.qryr04['N_Fabricacao'];
          Parameters.ParamByName('MF_Adicional').Value :=
            DM.qryr04['MF_Adicional'];
          Parameters.ParamByName('Modelo_ECF').Value := DM.qryr04['Modelo_ECF'];
          Parameters.ParamByName('N_Usuario').Value := DM.qryr04['N_Usuario'];
          Parameters.ParamByName('CCF').Value := DM.qryr04['CCF'];
          Parameters.ParamByName('COO').Value := DM.qryr04['COO'];
          Parameters.ParamByName('Data_Inicio_Emissao').Value :=
            DM.qryr04['Data_Inicio_Emissao'];
          Parameters.ParamByName('Sub_Total_Documento').Value :=
            DM.qryr04['Sub_Total_Documento'];
          Parameters.ParamByName('Desconto').Value := DM.qryr04['Desconto'];
          Parameters.ParamByName('Tipo_Desconto').Value :=
            DM.qryr04['Tipo_Desconto'];
          Parameters.ParamByName('Acrecimo').Value := DM.qryr04['Acrecimo'];
          Parameters.ParamByName('Tipo_Acrecimo').Value :=
            DM.qryr04['Tipo_Acrecimo'];
          Parameters.ParamByName('Valor_Total').Value :=
            DM.qryr04['Valor_Total'];
          Parameters.ParamByName('Cancelamento').Value :=
            DM.qryr04['Cancelamento'];
          Parameters.ParamByName('Valor_Cancelamento_Acrecimo').Value :=
            DM.qryr04['Valor_Cancelamento_Acrecimo'];
          Parameters.ParamByName('Indicador_Acre_Desc').Value :=
            DM.qryr04['Indicador_Acre_Desc'];
          Parameters.ParamByName('Adquirente').Value := DM.qryr04['Adquirente'];
          Parameters.ParamByName('CPF_CNPJ').Value := DM.qryr04['CPF_CNPJ'];
          Parameters.ParamByName('Caixa').Value := DM.qryr04['Caixa'];
          ExecSQL;
        end;
                        }
        DM.qryr04.Next;
      end;
    finally
      // DM.ADOConnection1.CommitTrans;
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TR05 }

procedure TR05.Alterar(var Registro: TR05);
var
  qAux: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        Connection := DM.ADOConnection1;
        clear;
        add('Update R05 set Data_Movimento = :Data_Movimento, N_Fabricacao = :N_Fabricacao, MF_Adicional = :MF_Adicional, ');
        add('Modelo_ECF = :Modelo_ECF, N_Usuario = :N_Usuario, COO = :COO, CCF = :CCF, Caixa = :Caixa');
        add('where N_Pedido = :N_Pedido');
        if (FrmCarrega_Pedido_Caixa.cancela_pre = true) then
          Parameters.ParamByName('N_Pedido').Value :=
            FrmCarrega_Pedido_Caixa.qTemp3.FieldByName
            ('Codigo_Pre_Venda_Antiga').AsString
        else
          Parameters.ParamByName('N_Pedido').Value :=
            FrmCarrega_Pedido_Caixa.qrycarrega_caixaCodigo.AsString;
        Parameters.ParamByName('Data_Movimento').Value := Registro.Data_Mov;
        Parameters.ParamByName('N_Fabricacao').Value := Registro.N_Serie;
        Parameters.ParamByName('MF_Adicional').Value := Registro.MF_Ad;
        Parameters.ParamByName('Modelo_ECF').Value := Registro.Mode;
        Parameters.ParamByName('N_Usuario').Value := Registro.N_Usu;
        Parameters.ParamByName('COO').Value := Registro.COOO;
        Parameters.ParamByName('CCF').Value := Registro.CCFF;
        Parameters.ParamByName('Caixa').Value := Registro.Caix;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TR05.Alterar_Aux(var Registro: TR05);
var
  qAux: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        Connection := DM.ADOConnection1;
        clear;
        add('Update R05_Aux set Data_Movimento = :Data_Movimento, N_Fabricacao = :N_Fabricacao, MF_Adicional = :MF_Adicional, ');
        add('Modelo_ECF = :Modelo_ECF, N_Usuario = :N_Usuario, COO = :COO, CCF = :CCF, Caixa = :Caixa');
        add('where N_Pedido = :N_Pedido');
        if (FrmCarrega_Pedido_Caixa.cancela_pre = true) then
          Parameters.ParamByName('N_Pedido').Value :=
            FrmCarrega_Pedido_Caixa.qTemp3.FieldByName
            ('Codigo_Pre_Venda_Antiga').AsString
        else
          Parameters.ParamByName('N_Pedido').Value :=
            FrmCarrega_Pedido_Caixa.qrycarrega_caixaCodigo.AsString;
        Parameters.ParamByName('Data_Movimento').Value := Registro.Data_Mov;
        Parameters.ParamByName('N_Fabricacao').Value := Registro.N_Serie;
        Parameters.ParamByName('MF_Adicional').Value := Registro.MF_Ad;
        Parameters.ParamByName('Modelo_ECF').Value := Registro.Mode;
        Parameters.ParamByName('N_Usuario').Value := Registro.N_Usu;
        Parameters.ParamByName('COO').Value := Registro.COOO;
        Parameters.ParamByName('CCF').Value := Registro.CCFF;
        Parameters.ParamByName('Caixa').Value := Registro.Caix;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TR05.Alterar_Item(var Registro: TR05);
var
  qAux: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        Connection := DM.ADOConnection1;
        clear;
        add('Update R05 set N_Item = :N_Item, Totalizador_Parcial = :Totalizador');
        add('where N_Pedido = :N_Pedido and Codigo_Produto_Inteiro = :Codigo');
        if (FrmCarrega_Pedido_Caixa.cancela_pre = true) then
          Parameters.ParamByName('N_Pedido').Value :=
            FrmCarrega_Pedido_Caixa.qTemp3.FieldByName
            ('Codigo_Pre_Venda_Antiga').AsString
        else
          Parameters.ParamByName('N_Pedido').Value :=
            FrmCarrega_Pedido_Caixa.qrycarrega_caixaCodigo.AsString;
        Parameters.ParamByName('N_Item').Value := Registro.Nu_Item;

        if (FrmCarrega_Pedido_Caixa.cancela_pre = true) then
          Parameters.ParamByName('Codigo').Value :=
            FrmCarrega_Pedido_Caixa.qTemp2.FieldByName('Codigo_Produto')
            .AsInteger
        else
          Parameters.ParamByName('Codigo').Value :=
            FrmCarrega_Pedido_Caixa.qAux.FieldByName('Codigo').AsInteger;

        Parameters.ParamByName('Totalizador').Value := Registro.Tot_Par;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TR05.Alterar_Item_Aux(var Registro: TR05);
var
  qAux: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        Connection := DM.ADOConnection1;
        clear;
        add('Update R05_Aux set N_Item = :N_Item, Totalizador_Parcial = :Totalizador');
        add('where N_Pedido = :N_Pedido and Codigo_Produto_Inteiro = :Codigo');
        if (FrmCarrega_Pedido_Caixa.cancela_pre = true) then
          Parameters.ParamByName('N_Pedido').Value :=
            FrmCarrega_Pedido_Caixa.qTemp3.FieldByName
            ('Codigo_Pre_Venda_Antiga').AsString
        else
          Parameters.ParamByName('N_Pedido').Value :=
            FrmCarrega_Pedido_Caixa.qrycarrega_caixaCodigo.AsString;
        Parameters.ParamByName('N_Item').Value := Registro.Nu_Item;

        if (FrmCarrega_Pedido_Caixa.cancela_pre = true) then
          Parameters.ParamByName('Codigo').Value :=
            FrmCarrega_Pedido_Caixa.qTemp2.FieldByName('Codigo_Produto')
            .AsInteger
        else
          Parameters.ParamByName('Codigo').Value :=
            FrmCarrega_Pedido_Caixa.qAux.FieldByName('Codigo').AsInteger;

        Parameters.ParamByName('Totalizador').Value := Registro.Tot_Par;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TR05.Excluir(var Registro: TR05);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Delete from R05 where N_Pedido = :N_Pedido');
        Parameters.ParamByName('N_Pedido').Value := Registro.N_Ped;
        ExecSQL;
        AtualizarQuantidadeRegistro('R05', 'QtdeR05');
        // DM.ADOConnection1.CommitTrans;
        // lrControle:= Exclui;
        // UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TR05.ExcluirLocal(var Registro: TR05);
var
  qAux, qaux2: TADOQuery;
begin
  try
    DM.ADOConnectionLocal.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnectionLocal;
        add('Delete from R05');
        ExecSQL;
        DM.ADOConnectionLocal.CommitTrans;
        // lrControle:= Exclui;
        // UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      DM.ADOConnectionLocal.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

function TR05.GetAcrecimo: string;
begin
  if (FrmPedido_Venda <> nil) then
  begin
    if (FrmPedido_Venda.ativo = true) then
      GetAcrecimo := FrmPedido_Venda.acre_item;
  end;

  if (FrmOS <> nil) then
  begin
    if (FrmOS.ativo = true) then
      GetAcrecimo := FrmOS.acre_item;
  end;

  if (FrmPre_Venda <> nil) then
  begin
    if (FrmPre_Venda.ativo = true) then
      GetAcrecimo := FrmPre_Venda.acre_item;
  end;
end;

function TR05.GetAcrecimo_PDV: string;
begin
  GetAcrecimo_PDV := FrmPDV.acre_item;
end;

function TR05.GetCaixa: string;
begin
  GetCaixa := StringOfChar('0', 4 - Length(UDeclaracao.Sequencia)) +
    UDeclaracao.Sequencia;
end;

function TR05.GetCaixa_PDV: string;
begin
  GetCaixa_PDV := StringOfChar('0', 4 - Length(UDeclaracao.Sequencia)) +
    UDeclaracao.Sequencia;
end;

function TR05.GetCancelamento: string;
begin
  if (FrmPedido_Venda <> Nil) then
  begin
    if (FrmPedido_Venda.ativo = true) then
      GetCancelamento := FrmPedido_Venda.indicador_cancelamento_item;
  end;

  if (FrmOS <> nil) then
  begin
    if (FrmOS.ativo = true) then
      GetCancelamento := FrmOS.indicador_cancelamento_item;
  end;

  if (FrmPre_Venda <> nil) then
  begin
    if (FrmPre_Venda.ativo = true) then
      GetCancelamento := FrmPre_Venda.indicador_cancelamento_item;
  end;
end;

function TR05.GetCancelamento_PDV: string;
begin
  GetCancelamento_PDV := FrmPDV.indicador_cancelamento_item;
end;

function TR05.GetCasas_Decimais_Qtde: string;
begin
  if (FrmPedido_Venda <> NIl) then
  begin
    if (FrmPedido_Venda.ativo = true) then
      GetCasas_Decimais_Qtde := FrmPedido_Venda.casa_decimal_qtde;
  end;

  if (FrmOS <> NIl) then
  begin
    if (FrmOS.ativo = true) then
      GetCasas_Decimais_Qtde := FrmOS.casa_decimal_qtde;
  end;

  if (FrmPre_Venda <> NIl) then
  begin
    if (FrmPre_Venda.ativo = true) then
      GetCasas_Decimais_Qtde := FrmPre_Venda.casa_decimal_qtde;
  end;
end;

function TR05.GetCasas_Decimais_Qtde_PDV: string;
begin
  GetCasas_Decimais_Qtde_PDV := FrmPDV.casa_decimal_qtde;
end;

function TR05.GetCasas_Decimais_Valor_Unitario: string;
begin
  if (FrmPedido_Venda <> NIl) then
  begin
    if (FrmPedido_Venda.ativo = true) then
      GetCasas_Decimais_Valor_Unitario := FrmPedido_Venda.casa_decimal_val_un;
  end;

  if (FrmOS <> NIl) then
  begin
    if (FrmOS.ativo = true) then
      GetCasas_Decimais_Valor_Unitario := FrmOS.casa_decimal_val_un;
  end;

  if (FrmPre_Venda <> NIl) then
  begin
    if (FrmPre_Venda.ativo = true) then
      GetCasas_Decimais_Valor_Unitario := FrmPre_Venda.casa_decimal_val_un;
  end;

end;

function TR05.GetCasas_Decimais_Valor_Unitario_PDV: string;
begin
  GetCasas_Decimais_Valor_Unitario_PDV := FrmPDV.casa_decimal_val_un;
end;

function TR05.GetCCF: string;
begin
  GetCCF := UDeclaracao.CCF;
end;

function TR05.GetCCF_PDV: string;
begin
  GetCCF_PDV := UDeclaracao.CCF;
end;

function TR05.GetCodigo_Produto: string;
begin
  if (FrmPedido_Venda <> NIl) then
  begin
    if (FrmPedido_Venda.ativo = true) then
      GetCodigo_Produto := FrmPedido_Venda.Cod_Pro;
  end;

  if (FrmOS <> Nil) then
  begin
    if (FrmOS.ativo = true) then
      GetCodigo_Produto := FrmOS.Cod_Pro;
  end;

  if (FrmPre_Venda <> Nil) then
  begin
    if (FrmPre_Venda.ativo = true) then
      GetCodigo_Produto := FrmPre_Venda.Cod_Pro;
  end;
end;

function TR05.GetCodigo_Produto_Inteiro: integer;
begin
  if (FrmPedido_Venda <> NIl) then
  begin
    if (FrmPedido_Venda.ativo = true) then
      GetCodigo_Produto_Inteiro := StrToInt(FrmPedido_Venda.LblProduto.Caption);
  end;

  if (FrmOS <> Nil) then
  begin
    if (FrmOS.ativo = true) then
      GetCodigo_Produto_Inteiro := StrToInt(FrmOS.LblProduto.Caption);
  end;

  if (FrmPre_Venda <> Nil) then
  begin
    if (FrmPre_Venda.ativo = true) then
      GetCodigo_Produto_Inteiro := StrToInt(FrmPre_Venda.LblProduto.Caption);
  end;
end;

function TR05.GetCodigo_Produto_Inteiro_PDV: integer;
begin
  GetCodigo_Produto_Inteiro_PDV := FrmPDV.Cod_Produto;
end;

function TR05.GetCodigo_Produto_PDV: string;
begin
  GetCodigo_Produto_PDV := FrmPDV.Cod_Pro;
end;

function TR05.GetCOO: string;
begin
  GetCOO := UDeclaracao.COO;
end;

function TR05.GetCOO_PDV: string;
begin
  GetCOO_PDV := UDeclaracao.COO;
end;

function TR05.GetData_Movimento: Tdate;
begin
  GetData_Movimento := StrToDate(dataf);
end;

function TR05.GetData_Movimento_PDV: Tdate;
begin
  GetData_Movimento_PDV := StrToDate(dataf);
end;

function TR05.GetDesconto: string;
begin
  if (FrmPedido_Venda <> NIl) then
  begin
    if (FrmPedido_Venda.ativo = true) then
      GetDesconto := FrmPedido_Venda.desc_item;
  end;

  if (FrmOS <> Nil) then
  begin
    if (FrmOS.ativo = true) then
      GetDesconto := FrmOS.desc_item;
  end;

  if (FrmPre_Venda <> Nil) then
  begin
    if (FrmPre_Venda.ativo = true) then
      GetDesconto := FrmPre_Venda.desc_item;
  end;

end;

function TR05.GetDesconto_PDV: string;
begin
  GetDesconto_PDV := FrmPDV.desc_item;
end;

function TR05.GetDescricao: string;
begin
  if (FrmPedido_Venda <> Nil) then
  begin
    if (FrmPedido_Venda.ativo = true) then
      GetDescricao := FrmPedido_Venda.descri;
  end;

  if (FrmOS <> Nil) then
  begin
    if (FrmOS.ativo = true) then
      GetDescricao := FrmOS.descri;
  end;

  if (FrmPre_Venda <> Nil) then
  begin
    if (FrmPre_Venda.ativo = true) then
      GetDescricao := FrmPre_Venda.descri;
  end;
end;

function TR05.GetDescricao_PDV: string;
begin
  GetDescricao_PDV := FrmPDV.descri;
end;

function TR05.GetIAT: string;
begin
  if (FrmPedido_Venda <> Nil) then
  begin
    if (FrmPedido_Venda.ativo = true) then
      GetIAT := FrmPedido_Venda.IAT;
  end;

  if (FrmOS <> Nil) then
  begin
    if (FrmOS.ativo = true) then
      GetIAT := FrmOS.IAT;
  end;

  if (FrmPre_Venda <> Nil) then
  begin
    if (FrmPre_Venda.ativo = true) then
      GetIAT := FrmPre_Venda.IAT;
  end;
end;

function TR05.GetIAT_PDV: string;
begin
  GetIAT_PDV := FrmPDV.IAT;
end;

function TR05.GetIPPT: string;
begin
  if (FrmPedido_Venda <> NIl) then
  begin
    if (FrmPedido_Venda.ativo = true) then
      GetIPPT := FrmPedido_Venda.IPPT;
  end;

  if (FrmOS <> NIl) then
  begin
    if (FrmOS.ativo = true) then
      GetIPPT := FrmOS.IPPT;
  end;

  if (FrmPre_Venda <> NIl) then
  begin
    if (FrmPre_Venda.ativo = true) then
      GetIPPT := FrmPre_Venda.IPPT;
  end;
end;

function TR05.GetIPPT_PDV: string;
begin
  GetIPPT_PDV := FrmPDV.IPPT;
end;

function TR05.GetMF_Adicional: string;
begin
  GetMF_Adicional := UDeclaracao.mf;
end;

function TR05.GetMF_Adicional_PDV: string;
begin
  GetMF_Adicional_PDV := UDeclaracao.mf;
end;

function TR05.GetModelo: string;
begin
  GetModelo := UDeclaracao.sModelo;
end;

function TR05.GetModelo_PDV: string;
begin
  GetModelo_PDV := UDeclaracao.sModelo;
end;

function TR05.GetNumero_Serie: string;
begin
  GetNumero_Serie := UDeclaracao.nu_serie;
end;

function TR05.GetNumero_Serie_PDV: string;
begin
  GetNumero_Serie_PDV := nu_serie;
end;

function TR05.GetNumero_Usuario: string;
begin
  GetNumero_Usuario := UDeclaracao.n_usuario;
end;

function TR05.GetNumero_Usuario_PDV: string;
begin
  GetNumero_Usuario_PDV := n_usuario;
end;

function TR05.GetN_Item: string;
begin
  GetN_Item := UDeclaracao.N_Item;
end;

function TR05.GetN_Item_PDV: string;
begin
  GetN_Item_PDV := UDeclaracao.N_Item;
end;

function TR05.GetN_Pedido: string;
begin
  if (FrmPedido_Venda <> NIl) then
  begin
    if (FrmPedido_Venda.ativo = true) then
      GetN_Pedido := FrmPedido_Venda.EdtCodigo.Text;
  end;

  if (FrmOS <> NIl) then
  begin
    if (FrmOS.ativo = true) then
      GetN_Pedido := FrmOS.EdtCodigo.Text;
  end;

  if (FrmPre_Venda <> NIl) then
  begin
    if (FrmPre_Venda.ativo = true) then
      GetN_Pedido := FrmPre_Venda.EdtCodigo.Text;
  end;
end;

function TR05.GetN_Pedido_PDV: string;
begin
  GetN_Pedido_PDV := FrmPDV.LblCodigo.Caption
end;

function TR05.GetQuantidade: string;
begin
  if (FrmPedido_Venda <> Nil) then
  begin
    if (FrmPedido_Venda.ativo) then
      GetQuantidade := FrmPedido_Venda.qtde_vendida;
  end;

  if (FrmOS <> NIl) then
  begin
    if (FrmOS.ativo = true) then
      GetQuantidade := FrmOS.qtde_vendida;
  end;

  if (FrmPre_Venda <> NIl) then
  begin
    if (FrmPre_Venda.ativo = true) then
      GetQuantidade := FrmPre_Venda.qtde_vendida;
  end;
end;

function TR05.GetQuantidade_Cancelada: string;
begin
  if (FrmPedido_Venda <> Nil) then
  begin
    if (FrmPedido_Venda.ativo = true) then
      GetQuantidade_Cancelada := FrmPedido_Venda.qtde_cancelada;
  end;

  if (FrmOS <> Nil) then
  begin
    if (FrmOS.ativo = true) then
      GetQuantidade_Cancelada := FrmOS.qtde_cancelada;
  end;

  if (FrmPre_Venda <> Nil) then
  begin
    if (FrmPre_Venda.ativo = true) then
      GetQuantidade_Cancelada := FrmPre_Venda.qtde_cancelada;
  end;
end;

function TR05.GetQuantidade_Cancelada_PDV: string;
begin
  GetQuantidade_Cancelada_PDV := FrmPDV.qtde_cancelada;
end;

function TR05.GetQuantidade_PDV: string;
begin
  GetQuantidade_PDV := FrmPDV.qtde_vendida;
end;

function TR05.GetTipo: string;
begin
  GetTipo := 'R05';
end;

function TR05.GetTipo_PDV: string;
begin
  GetTipo_PDV := 'R05';
end;

function TR05.GetTotalizador_Parcial: string;
begin
  GetTotalizador_Parcial := FrmCarrega_Pedido_Caixa.totalizador;
end;

function TR05.GetTotalizador_Parcial_PDV: string;
begin
  GetTotalizador_Parcial_PDV := UDeclaracao.Tot_Par;
end;

function TR05.GetUnidade: string;
begin
  if (FrmPedido_Venda <> nIl) then
  begin
    if (FrmPedido_Venda.ativo = true) then
      GetUnidade := FrmPedido_Venda.unid;
  end;

  if (FrmOS <> nil) then
  begin
    if (FrmOS.ativo = true) then
      GetUnidade := FrmOS.unid;
  end;

  if (FrmPre_Venda <> nil) then
  begin
    if (FrmPre_Venda.ativo = true) then
      GetUnidade := FrmPre_Venda.unid;
  end;
end;

function TR05.GetUnidade_PDV: string;
begin
  GetUnidade_PDV := FrmPDV.unid;
end;

function TR05.GetValor_Cancelado: string;
begin
  if (FrmPedido_Venda <> nil) then
  begin
    if (FrmPedido_Venda.ativo = true) then
      GetValor_Cancelado := FrmPedido_Venda.Valor_Cancelado;
  end;

  if (FrmOS <> nil) then
  begin
    if (FrmOS.ativo = true) then
      GetValor_Cancelado := FrmOS.Valor_Cancelado;
  end;

  if (FrmPre_Venda <> nil) then
  begin
    if (FrmPre_Venda.ativo = true) then
      GetValor_Cancelado := FrmPre_Venda.Valor_Cancelado;
  end;
end;

function TR05.GetValor_Cancelado_PDV: string;
begin
  GetValor_Cancelado_PDV := FrmPDV.Valor_Cancelado;
end;

function TR05.GetValor_Cancelamento_Acrecimo: string;
begin
  if (FrmPedido_Venda <> NIl) then
  begin
    if (FrmPedido_Venda.ativo = true) then
      GetValor_Cancelamento_Acrecimo := FrmPedido_Venda.can_acre;
  end;

  if (FrmOS <> nil) then
  begin
    if (FrmOS.ativo = true) then
      GetValor_Cancelamento_Acrecimo := FrmOS.can_acre;
  end;

  if (FrmPre_Venda <> nil) then
  begin
    if (FrmPre_Venda.ativo = true) then
      GetValor_Cancelamento_Acrecimo := FrmPre_Venda.can_acre;
  end;
end;

function TR05.GetValor_Cancelamento_Acrecimo_PDV: string;
begin
  GetValor_Cancelamento_Acrecimo_PDV := FrmPDV.can_acre;
end;

function TR05.GetValor_Total: string;
begin
  if (FrmPedido_Venda <> Nil) then
  begin
    if (FrmPedido_Venda.ativo = true) then
      GetValor_Total := FrmPedido_Venda.valor_total_item;
  end;

  if (FrmOS <> Nil) then
  begin
    if (FrmOS.ativo = true) then
      GetValor_Total := FrmOS.valor_total_item;
  end;

  if (FrmPre_Venda <> Nil) then
  begin
    if (FrmPre_Venda.ativo = true) then
      GetValor_Total := FrmPre_Venda.valor_total_item;
  end;
end;

function TR05.GetValor_Total_PDV: string;
begin
  GetValor_Total_PDV := FrmPDV.valor_total_item;
end;

function TR05.GetValor_Unitario: string;
begin
  if (FrmPedido_Venda <> NIl) then
  begin
    if (FrmPedido_Venda.ativo = true) then
      GetValor_Unitario := FrmPedido_Venda.valor_unit;
  end;

  if (FrmOS <> nil) then
  begin
    if (FrmOS.ativo = true) then
      GetValor_Unitario := FrmOS.valor_unit;
  end;

  if (FrmPre_Venda <> nil) then
  begin
    if (FrmPre_Venda.ativo = true) then
      GetValor_Unitario := FrmPre_Venda.valor_unit;
  end;
end;

function TR05.GetValor_Unitario_PDV: string;
begin
  GetValor_Unitario_PDV := FrmPDV.valor_unit;
end;

procedure TR05.Inserir(var Registro: TR05);
begin
  { FrmPedido_Venda.qryr05.Open;
    FrmPedido_Venda.qryr05.Insert;
    FrmPedido_Venda.qryr05['Data_Movimento']:= Registro.Data_Mov;
    FrmPedido_Venda.qryr05['Tipo']:= Registro.Tip;
    FrmPedido_Venda.qryr05['N_Pedido']:= Registro.N_Ped;
    FrmPedido_Venda.qryr05['N_Fabricacao']:= Registro.N_Serie;
    FrmPedido_Venda.qryr05['MF_Adicional']:= Registro.MF_Ad;
    FrmPedido_Venda.qryr05['Modelo_ECF']:= Registro.Mode;
    FrmPedido_Venda.qryr05['N_Usuario']:= Registro.N_Usu;
    FrmPedido_Venda.qryr05['COO']:= Registro.COOO;
    FrmPedido_Venda.qryr05['CCF']:= Registro.CCFF;
    FrmPedido_Venda.qryr05['N_Item']:= Registro.Nu_Item;
    FrmPedido_Venda.qryr05['Codigo_Produto']:= Registro.Cod_Prod;
    FrmPedido_Venda.qryr05['Descricao']:= Registro.Desc;
    FrmPedido_Venda.qryr05['Quantidade']:= Registro.Qtde;
    FrmPedido_Venda.qryr05['Unidade']:= Registro.UN;
    FrmPedido_Venda.qryr05['Valor_Unitario']:= Registro.Valor_Un;
    FrmPedido_Venda.qryr05['Desconto']:= Registro.Descon;
    FrmPedido_Venda.qryr05['Acrecimo']:= Registro.Acre;
    FrmPedido_Venda.qryr05['Valor_Total']:= Registro.Valor_Tot;
    FrmPedido_Venda.qryr05['Totalizador_Parcial']:= Registro.Tot_Par;
    FrmPedido_Venda.qryr05['Cancelamento']:= Registro.Canc;
    FrmPedido_Venda.qryr05['Quantidade_Cancelada']:= Registro.Qtde_Canc;
    FrmPedido_Venda.qryr05['Valor_Cancelado']:= Registro.Valor_Canc;
    FrmPedido_Venda.qryr05['Valor_Cancelamento_Acrecimo']:= Registro.Valor_Canc_Acre;
    FrmPedido_Venda.qryr05['IAT']:= Registro.IATT;
    FrmPedido_Venda.qryr05['IPPT']:= Registro.IPPTT;
    FrmPedido_Venda.qryr05['Casas_Decimais_Qtde']:= Registro.Casas_Dec_Qtde;
    FrmPedido_Venda.qryr05['Casas_Decimais_Valor_Unitario']:= Registro.Casas_Dec_Val_Un;
    FrmPedido_Venda.qryr05['Caixa']:= Registro.Caix;
    FrmPedido_Venda.qryr05.SaveToFile(Local_Arquivo(8)); }
end;

procedure TR05.Inserir_PDV(var Registro: TR05);
begin
  // if not dm.qryr05.Active then
  // dm.qryr05.open;

  DM.qryr05.Append;
  DM.qryr05['Data_Movimento'] := Registro.Data_Mov_PDV;
  DM.qryr05['Tipo'] := Registro.Tip_PDV;
  DM.qryr05['N_Pedido'] := Registro.N_Ped_PDV;
  DM.qryr05['N_Fabricacao'] := Registro.N_Serie_PDV;
  DM.qryr05['MF_Adicional'] := Registro.MF_Ad_PDV;
  DM.qryr05['Modelo_ECF'] := Registro.Mode_PDV;
  DM.qryr05['N_Usuario'] := Registro.N_Usu_PDV;
  DM.qryr05['COO'] := Registro.COOO_PDV;
  DM.qryr05['CCF'] := Registro.CCFF_PDV;
  DM.qryr05['N_Item'] := Registro.Nu_Item_PDV;
  DM.qryr05['Codigo_Produto_Inteiro'] := Registro.Cod_Prod_Int_PDV;
  DM.qryr05['Codigo_Produto'] := Registro.Cod_Prod_PDV;
  DM.qryr05['Descricao'] := Registro.Desc_PDV;
  DM.qryr05['Quantidade'] := Registro.Qtde_PDV;
  DM.qryr05['Unidade'] := Registro.UN_PDV;
  DM.qryr05['Valor_Unitario'] := Registro.Valor_Un_PDV;
  DM.qryr05['Desconto'] := Registro.Descon_PDV;
  DM.qryr05['Acrecimo'] := Registro.Acre_PDV;
  DM.qryr05['Valor_Total'] := Registro.Valor_Tot_PDV;
  DM.qryr05['Totalizador_Parcial'] := Registro.Tot_Par_PDV;
  DM.qryr05['Cancelamento'] := Registro.Canc_PDV;
  DM.qryr05['Quantidade_Cancelada'] := Registro.Qtde_Canc_PDV;
  DM.qryr05['Valor_Cancelado'] := Registro.Valor_Canc_PDV;
  DM.qryr05['Valor_Cancelamento_Acrecimo'] := Registro.Valor_Canc_Acre_PDV;
  DM.qryr05['IAT'] := Registro.IATT_PDV;
  DM.qryr05['IPPT'] := Registro.IPPTT_PDV;
  DM.qryr05['Casas_Decimais_Qtde'] := Registro.Casas_Dec_Qtde_PDV;
  DM.qryr05['Casas_Decimais_Valor_Unitario'] := Registro.Casas_Dec_Val_Un_PDV;
  DM.qryr05['Caixa'] := Registro.Caix_PDV;
  DM.qryr05['MD5'] := GeraMD5([Registro.N_Serie_PDV, Registro.CCFF_PDV, Registro.COOO_PDV, Registro.Cod_Prod_PDV,
                                Registro.Qtde_PDV, Registro.Valor_Un_PDV, Registro.Valor_Tot_PDV, Registro.Tot_Par_PDV,
                                Registro.Canc_PDV]);
  DM.qryr05.Post;
  // dm.qryr05.SaveToFile(Local_Arquivo(8), dfXMLUTF8);
end;

procedure TR05.Salva_Banco(var Registro: TR05);
var
  qAux, qaux2: TADOQuery;
  CDS: TClientDataSet;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      begin
        with qAux, SQL do
        begin
          close;
          clear;
          Connection := DM.ADOConnection1;
          add('Insert into R05 (Tipo, N_Pedido, ');
          add('Codigo_Produto_Inteiro, Codigo_Produto, Descricao, Quantidade, Unidade, Valor_Unitario, Desconto, Acrecimo, Valor_Total,');
          add('Cancelamento, Quantidade_Cancelada, Valor_Cancelado, Valor_Cancelamento_Acrecimo,');
          add('IAT, IPPT, Casas_Decimais_Qtde, Casas_Decimais_Valor_Unitario) values (:Tipo, :N_Pedido, ');
          add(':Codigo_Produto_Inteiro, :Codigo_Produto, :Descricao, :Quantidade, :Unidade,');
          add(':Valor_Unitario, :Desconto, :Acrecimo, :Valor_Total, :Cancelamento, :Quantidade_Cancelada,');
          add(':Valor_Cancelado, :Valor_Cancelamento_Acrecimo, :IAT, :IPPT, :Casas_Decimais_Qtde, :Casas_Decimais_Valor_Unitario)');

          Parameters.ParamByName('Tipo').Value := Registro.Tip;
          Parameters.ParamByName('N_Pedido').Value := Registro.N_Ped;
          Parameters.ParamByName('Codigo_Produto_Inteiro').Value :=
            Registro.Cod_Prod_Int;
          Parameters.ParamByName('Codigo_Produto').Value := Registro.Cod_Prod;
          Parameters.ParamByName('Descricao').Value := Registro.Desc;
          Parameters.ParamByName('Quantidade').Value := Registro.Qtde;
          Parameters.ParamByName('Unidade').Value := Registro.Un;
          Parameters.ParamByName('Valor_Unitario').Value := Registro.Valor_Un;
          Parameters.ParamByName('Desconto').Value := Registro.Descon;
          Parameters.ParamByName('Acrecimo').Value := Registro.Acre;
          Parameters.ParamByName('Valor_Total').Value := Registro.Valor_Tot;
          Parameters.ParamByName('Cancelamento').Value := Registro.Canc;
          Parameters.ParamByName('Quantidade_Cancelada').Value :=
            Registro.Qtde_Canc;
          Parameters.ParamByName('Valor_Cancelado').Value :=
            Registro.Valor_Canc;
          Parameters.ParamByName('Valor_Cancelamento_Acrecimo').Value :=
            Registro.Valor_Canc_Acre;
          Parameters.ParamByName('IAT').Value := Registro.IATT;
          Parameters.ParamByName('IPPT').Value := Registro.IPPTT;
          Parameters.ParamByName('Casas_Decimais_Qtde').Value :=
            Registro.Casas_Dec_Qtde;
          Parameters.ParamByName('Casas_Decimais_Valor_Unitario').Value :=
            Registro.Casas_Dec_Val_Un;
          {Parameters.ParamByName('MD5').Value := GeraMD5([Registro.N_Serie_PDV, Registro.CCFF_PDV, Registro.COOO_PDV, Registro.Cod_Prod_PDV,
                                Registro.Qtde_PDV, Registro.Valor_Un_PDV, Registro.Valor_Tot_PDV, Registro.Tot_Par_PDV,
                                Registro.Canc_PDV]);}
          ExecSQL;
        end;
        AtualizarQuantidadeRegistro('R05', 'QtdeR05');
      end;
    finally
      // DM.ADOConnection1.CommitTrans;
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TR05.Salva_Banco_Aux(var Registro: TR05);
var
  qAux, qaux2: TADOQuery;
  CDS: TClientDataSet;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      begin
        with qAux, SQL do
        begin
          close;
          clear;
          Connection := DM.ADOConnection1;
          add('Insert into R05_Aux (Tipo, N_Pedido, ');
          add('Codigo_Produto_Inteiro, Codigo_Produto, Descricao, Quantidade, Unidade, Valor_Unitario, Desconto, Acrecimo, Valor_Total,');
          add('Cancelamento, Quantidade_Cancelada, Valor_Cancelado, Valor_Cancelamento_Acrecimo,');
          add('IAT, IPPT, Casas_Decimais_Qtde, Casas_Decimais_Valor_Unitario) values (:Tipo, :N_Pedido, ');
          add(':Codigo_Produto_Inteiro, :Codigo_Produto, :Descricao, :Quantidade, :Unidade,');
          add(':Valor_Unitario, :Desconto, :Acrecimo, :Valor_Total, :Cancelamento, :Quantidade_Cancelada,');
          add(':Valor_Cancelado, :Valor_Cancelamento_Acrecimo, :IAT, :IPPT, :Casas_Decimais_Qtde, :Casas_Decimais_Valor_Unitario)');

          Parameters.ParamByName('Tipo').Value := Registro.Tip;
          Parameters.ParamByName('N_Pedido').Value := Registro.N_Ped;
          Parameters.ParamByName('Codigo_Produto_Inteiro').Value :=
            Registro.Cod_Prod_Int;
          Parameters.ParamByName('Codigo_Produto').Value := Registro.Cod_Prod;
          Parameters.ParamByName('Descricao').Value := Registro.Desc;
          Parameters.ParamByName('Quantidade').Value := Registro.Qtde;
          Parameters.ParamByName('Unidade').Value := Registro.Un;
          Parameters.ParamByName('Valor_Unitario').Value := Registro.Valor_Un;
          Parameters.ParamByName('Desconto').Value := Registro.Descon;
          Parameters.ParamByName('Acrecimo').Value := Registro.Acre;
          Parameters.ParamByName('Valor_Total').Value := Registro.Valor_Tot;
          Parameters.ParamByName('Cancelamento').Value := Registro.Canc;
          Parameters.ParamByName('Quantidade_Cancelada').Value :=
            Registro.Qtde_Canc;
          Parameters.ParamByName('Valor_Cancelado').Value :=
            Registro.Valor_Canc;
          Parameters.ParamByName('Valor_Cancelamento_Acrecimo').Value :=
            Registro.Valor_Canc_Acre;
          Parameters.ParamByName('IAT').Value := Registro.IATT;
          Parameters.ParamByName('IPPT').Value := Registro.IPPTT;
          Parameters.ParamByName('Casas_Decimais_Qtde').Value :=
            Registro.Casas_Dec_Qtde;
          Parameters.ParamByName('Casas_Decimais_Valor_Unitario').Value :=
            Registro.Casas_Dec_Val_Un;
          ExecSQL;
        end;
      end;
    finally
      // DM.ADOConnection1.CommitTrans;
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TR05.Salva_Banco_PDV(var Registro: TR05);
var
  qAux, qaux2: TADOQuery;
  CDS: TClientDataSet;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);

      with DM.qryr05, SQL do
      begin
        close;
        Connection := DM.ADOConnectionLocal;
        clear;
        add('select * from R05');
        add('where R05.N_Pedido = :N_Pedido');
        Parameters.ParamByName('N_Pedido').Value := DM.qryvendaCodigo.AsInteger;
        open;
        First;
      end;

      while not DM.qryr05.Eof do
      begin
        with qAux, SQL do
        begin
          close;
          clear;
          // Connection:= dm.ADOConnection1;
          Connection := DM.ADOConnection1;
          add('Insert into R05 (Data_Movimento, Tipo, N_Pedido, N_Fabricacao, MF_Adicional, Modelo_ECF, N_Usuario, COO, CCF, N_Item, ');
          add('Codigo_Produto_Inteiro, Codigo_Produto, Descricao, Quantidade, Unidade, Valor_Unitario, Desconto, Acrecimo, Valor_Total,');
          add('Totalizador_Parcial, Cancelamento, Quantidade_Cancelada, Valor_Cancelado, Valor_Cancelamento_Acrecimo,');
          add('IAT, IPPT, Casas_Decimais_Qtde, Casas_Decimais_Valor_Unitario, Caixa, MD5) values (:Data_Movimento, :Tipo, :N_Pedido, :N_Fabricacao, :MF_Adicional,');
          add(':Modelo_ECF, :N_Usuario, :COO, :CCF, :N_Item, :Codigo_Produto_Inteiro, :Codigo_Produto, :Descricao, :Quantidade, :Unidade,');
          add(':Valor_Unitario, :Desconto, :Acrecimo, :Valor_Total, :Totalizador_Parcial, :Cancelamento, :Quantidade_Cancelada,');
          add(':Valor_Cancelado, :Valor_Cancelamento_Acrecimo, :IAT, :IPPT, :Casas_Decimais_Qtde, :Casas_Decimais_Valor_Unitario, :Caixa, :MD5)');

          Parameters.ParamByName('Data_Movimento').Value :=
            DM.qryr05['Data_Movimento'];
          Parameters.ParamByName('Tipo').Value := DM.qryr05['Tipo'];
          Parameters.ParamByName('N_Pedido').Value := UDeclaracao.Codigo;
          Parameters.ParamByName('N_Fabricacao').Value :=
            DM.qryr05['N_Fabricacao'];
          Parameters.ParamByName('MF_Adicional').Value :=
            DM.qryr05['MF_Adicional'];
          Parameters.ParamByName('Modelo_ECF').Value := DM.qryr05['Modelo_ECF'];
          Parameters.ParamByName('N_Usuario').Value := DM.qryr05['N_Usuario'];
          Parameters.ParamByName('COO').Value := DM.qryr05['COO'];
          Parameters.ParamByName('CCF').Value := DM.qryr05['CCF'];
          Parameters.ParamByName('N_Item').Value := DM.qryr05['N_Item'];
          Parameters.ParamByName('Codigo_Produto_Inteiro').Value :=
            DM.qryr05['Codigo_Produto_Inteiro'];
          Parameters.ParamByName('Codigo_Produto').Value :=
            DM.qryr05['Codigo_Produto'];
          Parameters.ParamByName('Descricao').Value := DM.qryr05['Descricao'];
          Parameters.ParamByName('Quantidade').Value := DM.qryr05['Quantidade'];
          Parameters.ParamByName('Unidade').Value := DM.qryr05['Unidade'];
          Parameters.ParamByName('Valor_Unitario').Value :=
            DM.qryr05['Valor_Unitario'];
          Parameters.ParamByName('Desconto').Value := DM.qryr05['Desconto'];
          Parameters.ParamByName('Acrecimo').Value := DM.qryr05['Acrecimo'];
          Parameters.ParamByName('Valor_Total').Value :=
            DM.qryr05['Valor_Total'];
          Parameters.ParamByName('Totalizador_Parcial').Value :=
            DM.qryr05['Totalizador_Parcial'];
          Parameters.ParamByName('Cancelamento').Value :=
            DM.qryr05['Cancelamento'];
          Parameters.ParamByName('Quantidade_Cancelada').Value :=
            DM.qryr05['Quantidade_Cancelada'];
          Parameters.ParamByName('Valor_Cancelado').Value :=
            DM.qryr05['Valor_Cancelado'];
          Parameters.ParamByName('Valor_Cancelamento_Acrecimo').Value :=
            DM.qryr05['Valor_Cancelamento_Acrecimo'];
          Parameters.ParamByName('IAT').Value := DM.qryr05['IAT'];
          Parameters.ParamByName('IPPT').Value := DM.qryr05['IPPT'];
          Parameters.ParamByName('Casas_Decimais_Qtde').Value :=
            DM.qryr05['Casas_Decimais_Qtde'];
          Parameters.ParamByName('Casas_Decimais_Valor_Unitario').Value :=
            DM.qryr05['Casas_Decimais_Valor_Unitario'];
          Parameters.ParamByName('Caixa').Value := DM.qryr05['Caixa'];
          Parameters.ParamByName('MD5').Value := DM.qryr05['MD5'];
          ExecSQL;
        end;

        {with qAux, SQL do
        begin
          close;
          clear;
          // Connection:= dm.ADOConnection1;
          Connection := DM.ADOConnection1;
          add('Insert into R05_Aux (Data_Movimento, Tipo, N_Pedido, N_Fabricacao, MF_Adicional, Modelo_ECF, N_Usuario, COO, CCF, N_Item, ');
          add('Codigo_Produto_Inteiro, Codigo_Produto, Descricao, Quantidade, Unidade, Valor_Unitario, Desconto, Acrecimo, Valor_Total,');
          add('Totalizador_Parcial, Cancelamento, Quantidade_Cancelada, Valor_Cancelado, Valor_Cancelamento_Acrecimo,');
          add('IAT, IPPT, Casas_Decimais_Qtde, Casas_Decimais_Valor_Unitario, Caixa) values (:Data_Movimento, :Tipo, :N_Pedido, :N_Fabricacao, :MF_Adicional,');
          add(':Modelo_ECF, :N_Usuario, :COO, :CCF, :N_Item, :Codigo_Produto_Inteiro, :Codigo_Produto, :Descricao, :Quantidade, :Unidade,');
          add(':Valor_Unitario, :Desconto, :Acrecimo, :Valor_Total, :Totalizador_Parcial, :Cancelamento, :Quantidade_Cancelada,');
          add(':Valor_Cancelado, :Valor_Cancelamento_Acrecimo, :IAT, :IPPT, :Casas_Decimais_Qtde, :Casas_Decimais_Valor_Unitario, :Caixa)');

          Parameters.ParamByName('Data_Movimento').Value :=
            DM.qryr05['Data_Movimento'];
          Parameters.ParamByName('Tipo').Value := DM.qryr05['Tipo'];
          Parameters.ParamByName('N_Pedido').Value := UDeclaracao.Codigo;
          Parameters.ParamByName('N_Fabricacao').Value :=
            DM.qryr05['N_Fabricacao'];
          Parameters.ParamByName('MF_Adicional').Value :=
            DM.qryr05['MF_Adicional'];
          Parameters.ParamByName('Modelo_ECF').Value := DM.qryr05['Modelo_ECF'];
          Parameters.ParamByName('N_Usuario').Value := DM.qryr05['N_Usuario'];
          Parameters.ParamByName('COO').Value := DM.qryr05['COO'];
          Parameters.ParamByName('CCF').Value := DM.qryr05['CCF'];
          Parameters.ParamByName('N_Item').Value := DM.qryr05['N_Item'];
          Parameters.ParamByName('Codigo_Produto_Inteiro').Value :=
            DM.qryr05['Codigo_Produto_Inteiro'];
          Parameters.ParamByName('Codigo_Produto').Value :=
            DM.qryr05['Codigo_Produto'];
          Parameters.ParamByName('Descricao').Value := DM.qryr05['Descricao'];
          Parameters.ParamByName('Quantidade').Value := DM.qryr05['Quantidade'];
          Parameters.ParamByName('Unidade').Value := DM.qryr05['Unidade'];
          Parameters.ParamByName('Valor_Unitario').Value :=
            DM.qryr05['Valor_Unitario'];
          Parameters.ParamByName('Desconto').Value := DM.qryr05['Desconto'];
          Parameters.ParamByName('Acrecimo').Value := DM.qryr05['Acrecimo'];
          Parameters.ParamByName('Valor_Total').Value :=
            DM.qryr05['Valor_Total'];
          Parameters.ParamByName('Totalizador_Parcial').Value :=
            DM.qryr05['Totalizador_Parcial'];
          Parameters.ParamByName('Cancelamento').Value :=
            DM.qryr05['Cancelamento'];
          Parameters.ParamByName('Quantidade_Cancelada').Value :=
            DM.qryr05['Quantidade_Cancelada'];
          Parameters.ParamByName('Valor_Cancelado').Value :=
            DM.qryr05['Valor_Cancelado'];
          Parameters.ParamByName('Valor_Cancelamento_Acrecimo').Value :=
            DM.qryr05['Valor_Cancelamento_Acrecimo'];
          Parameters.ParamByName('IAT').Value := DM.qryr05['IAT'];
          Parameters.ParamByName('IPPT').Value := DM.qryr05['IPPT'];
          Parameters.ParamByName('Casas_Decimais_Qtde').Value :=
            DM.qryr05['Casas_Decimais_Qtde'];
          Parameters.ParamByName('Casas_Decimais_Valor_Unitario').Value :=
            DM.qryr05['Casas_Decimais_Valor_Unitario'];
          Parameters.ParamByName('Caixa').Value := DM.qryr05['Caixa'];
          ExecSQL;
        end; }

        DM.qryr05.Next;
      end;
      AtualizarQuantidadeRegistro('R05', 'QtdeR05');
    finally
      // DM.ADOConnection1.CommitTrans;
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TR05.Salva_Banco_PDV_Aux(var Registro: TR05);
var
  qAux, qaux2: TADOQuery;
  CDS: TClientDataSet;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      DM.qryr05.close;
      DM.qryr05.open;
      DM.qryr05.First;
      begin
        while not DM.qryr05.Eof do
        begin
          with qAux, SQL do
          begin
            close;
            clear;
            // Connection:= dm.ADOConnection1;
            Connection := DM.ADOConnection1;
            add('Insert into R05_Aux (Data_Movimento, Tipo, N_Pedido, N_Fabricacao, MF_Adicional, Modelo_ECF, N_Usuario, COO, CCF, N_Item, ');
            add('Codigo_Produto_Inteiro, Codigo_Produto, Descricao, Quantidade, Unidade, Valor_Unitario, Desconto, Acrecimo, Valor_Total,');
            add('Totalizador_Parcial, Cancelamento, Quantidade_Cancelada, Valor_Cancelado, Valor_Cancelamento_Acrecimo,');
            add('IAT, IPPT, Casas_Decimais_Qtde, Casas_Decimais_Valor_Unitario, Caixa) values (:Data_Movimento, :Tipo, :N_Pedido, :N_Fabricacao, :MF_Adicional,');
            add(':Modelo_ECF, :N_Usuario, :COO, :CCF, :N_Item, :Codigo_Produto_Inteiro, :Codigo_Produto, :Descricao, :Quantidade, :Unidade,');
            add(':Valor_Unitario, :Desconto, :Acrecimo, :Valor_Total, :Totalizador_Parcial, :Cancelamento, :Quantidade_Cancelada,');
            add(':Valor_Cancelado, :Valor_Cancelamento_Acrecimo, :IAT, :IPPT, :Casas_Decimais_Qtde, :Casas_Decimais_Valor_Unitario, :Caixa)');

            Parameters.ParamByName('Data_Movimento').Value :=
              DM.qryr05['Data_Movimento'];
            Parameters.ParamByName('Tipo').Value := DM.qryr05['Tipo'];
            Parameters.ParamByName('N_Pedido').Value := DM.qryr05['N_Pedido'];
            Parameters.ParamByName('N_Fabricacao').Value :=
              DM.qryr05['N_Fabricacao'];
            Parameters.ParamByName('MF_Adicional').Value :=
              DM.qryr05['MF_Adicional'];
            Parameters.ParamByName('Modelo_ECF').Value :=
              DM.qryr05['Modelo_ECF'];
            Parameters.ParamByName('N_Usuario').Value := DM.qryr05['N_Usuario'];
            Parameters.ParamByName('COO').Value := DM.qryr05['COO'];
            Parameters.ParamByName('CCF').Value := DM.qryr05['CCF'];
            Parameters.ParamByName('N_Item').Value := DM.qryr05['N_Item'];
            Parameters.ParamByName('Codigo_Produto_Inteiro').Value :=
              DM.qryr05['Codigo_Produto_Inteiro'];
            Parameters.ParamByName('Codigo_Produto').Value :=
              DM.qryr05['Codigo_Produto'];
            Parameters.ParamByName('Descricao').Value := DM.qryr05['Descricao'];
            Parameters.ParamByName('Quantidade').Value :=
              DM.qryr05['Quantidade'];
            Parameters.ParamByName('Unidade').Value := DM.qryr05['Unidade'];
            Parameters.ParamByName('Valor_Unitario').Value :=
              DM.qryr05['Valor_Unitario'];
            Parameters.ParamByName('Desconto').Value := DM.qryr05['Desconto'];
            Parameters.ParamByName('Acrecimo').Value := DM.qryr05['Acrecimo'];
            Parameters.ParamByName('Valor_Total').Value :=
              DM.qryr05['Valor_Total'];
            Parameters.ParamByName('Totalizador_Parcial').Value :=
              DM.qryr05['Totalizador_Parcial'];
            Parameters.ParamByName('Cancelamento').Value :=
              DM.qryr05['Cancelamento'];
            Parameters.ParamByName('Quantidade_Cancelada').Value :=
              DM.qryr05['Quantidade_Cancelada'];
            Parameters.ParamByName('Valor_Cancelado').Value :=
              DM.qryr05['Valor_Cancelado'];
            Parameters.ParamByName('Valor_Cancelamento_Acrecimo').Value :=
              DM.qryr05['Valor_Cancelamento_Acrecimo'];
            Parameters.ParamByName('IAT').Value := DM.qryr05['IAT'];
            Parameters.ParamByName('IPPT').Value := DM.qryr05['IPPT'];
            Parameters.ParamByName('Casas_Decimais_Qtde').Value :=
              DM.qryr05['Casas_Decimais_Qtde'];
            Parameters.ParamByName('Casas_Decimais_Valor_Unitario').Value :=
              DM.qryr05['Casas_Decimais_Valor_Unitario'];
            Parameters.ParamByName('Caixa').Value := DM.qryr05['Caixa'];
            ExecSQL;
          end;
          DM.qryr05.Next;
        end;
      end;
    finally
      // DM.ADOConnection1.CommitTrans;
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TR07 }

procedure TR07.Excluir(var Registro: TR07);
var
  qAux, qaux2: TADOQuery;
begin
  try
    //DM.ADOConnectionLocal.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnectionLocal;
        add('Delete from R07');
        ExecSQL;
        AtualizarQuantidadeRegistro('R07', 'QtdeR07');
        //DM.ADOConnectionLocal.CommitTrans;
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      //DM.ADOConnectionLocal.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

function TR07.GetCaixa: string;
begin
  GetCaixa := StringOfChar('0', 4 - Length(UDeclaracao.Sequencia)) +
    UDeclaracao.Sequencia;
end;

function TR07.GetCCF: string;
begin
  GetCCF := UDeclaracao.CCF;
end;

function TR07.GetCOO: string;
begin
  GetCOO := UDeclaracao.COO;
end;

function TR07.GetData_Movimento: Tdate;
begin
  GetData_Movimento := StrToDate(dataf);
end;

function TR07.GetEstorno: string;
begin
  GetEstorno := UDeclaracao.indicador_estorno;
end;

function TR07.GetGNF: string;
begin
  GetGNF := UDeclaracao.GNF;
end;

function TR07.GetMeio_Pagamento: string;
begin
  GetMeio_Pagamento := UDeclaracao.forma_pg;
end;

function TR07.GetMF_Adicional: string;
begin
  GetMF_Adicional := UDeclaracao.mf;
end;

function TR07.GetModelo: string;
begin
  GetModelo := UDeclaracao.sModelo;
end;

function TR07.GetNumero_Serie: string;
begin
  GetNumero_Serie := UDeclaracao.nu_serie;
end;

function TR07.GetNumero_Usuario: string;
begin
  GetNumero_Usuario := UDeclaracao.n_usuario;
end;

function TR07.GetTipo: string;
begin
  GetTipo := 'R07';
end;

function TR07.GetValor_Estornado: string;
begin
  GetValor_Estornado := UDeclaracao.valor_estorno;
end;

function TR07.GetValor_Pago: string;
begin
  GetValor_Pago := UDeclaracao.valor_pag;
end;

procedure TR07.Inserir(var Registro: TR07);
begin
  if not(DM.qryr07.Active) then
    DM.qryr07.open;
  DM.qryr07.Insert;
  DM.qryr07['Data_Movimento'] := Registro.Data_Mov;
  DM.qryr07['Tipo'] := Registro.Tip;
  DM.qryr07['N_Fabricacao'] := Registro.N_Serie;
  DM.qryr07['MF_Adicional'] := Registro.MF_Ad;
  DM.qryr07['Modelo_ECF'] := Registro.Mode;
  DM.qryr07['N_Usuario'] := Registro.N_Usu;
  DM.qryr07['COO'] := Registro.COOO;
  DM.qryr07['CCF'] := Registro.CCFF;
  DM.qryr07['GNF'] := '';
  DM.qryr07['Meio_Pagamento'] := Registro.Meio_Pag;
  DM.qryr07['Valor_Pago'] := Registro.Valor_PG;
  DM.qryr07['Estorno'] := Registro.Estor;
  DM.qryr07['Valor_Estorno'] := Registro.Valor_Estor;
  DM.qryr07['Caixa'] := Registro.Caix;
  DM.qryr07['MD5'] := GeraMD5([Registro.N_Serie, Registro.COOO, '']);
  DM.qryr07.Post;
  // dm.qryr07.SaveToFile(Local_Arquivo(7));
end;

procedure TR07.Inserir_Outros(var Registro: TR07);
var
  qAux: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      begin
        with qAux, SQL do
        begin
          close;
          clear;
          Connection := DM.ADOConnection1;
          add('Insert into R07 (Data_Movimento, Tipo, N_Fabricacao, MF_Adicional, Modelo_ECF, N_Usuario, COO, CCF, GNF, ');
          add('Meio_Pagamento, Valor_Pago, Estorno, Valor_Estorno, Caixa, MD5) values (:Data_Movimento, :Tipo, :N_Fabricacao, :MF_Adicional,');
          add(':Modelo_ECF, :N_Usuario, :COO, :CCF, :GNF, :Meio_Pagamento, :Valor_Pago, :Estorno, :Valor_Estorno, :Caixa, :MD5)');
          Parameters.ParamByName('Data_Movimento').Value := Registro.Data_Mov;
          Parameters.ParamByName('Tipo').Value := Registro.Tip;
          Parameters.ParamByName('N_Fabricacao').Value := Registro.N_Serie;
          Parameters.ParamByName('MF_Adicional').Value := Registro.MF_Ad;
          Parameters.ParamByName('Modelo_ECF').Value := Registro.Mode;
          Parameters.ParamByName('N_Usuario').Value := Registro.N_Usu;
          Parameters.ParamByName('COO').Value := Registro.COOO;
          Parameters.ParamByName('CCF').Value := Registro.CCFF;
          Parameters.ParamByName('GNF').Value := Registro.GNFF;
          Parameters.ParamByName('Meio_Pagamento').Value := Registro.Meio_Pag;
          Parameters.ParamByName('Valor_Pago').Value := Registro.Valor_PG;
          Parameters.ParamByName('Estorno').Value := Registro.Estor;
          Parameters.ParamByName('Valor_Estorno').Value := Registro.Valor_Estor;
          Parameters.ParamByName('Caixa').Value := Registro.Caix;
          Parameters.ParamByName('MD5').Value := GeraMD5([Registro.N_Serie, Registro.COOO, Registro.GNFF]);
          ExecSQL;
          AtualizarQuantidadeRegistro('R07', 'QtdeR07');
        end;
      end;
    finally
      // DM.ADOConnection1.CommitTrans;
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TR07.Inserir_Outros_Aux(var Registro: TR07);
var
  qAux: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      begin
        with qAux, SQL do
        begin
          close;
          clear;
          Connection := DM.ADOConnection1;
          add('Insert into R07_Aux (Data_Movimento, Tipo, N_Fabricacao, MF_Adicional, Modelo_ECF, N_Usuario, COO, CCF, GNF, ');
          add('Meio_Pagamento, Valor_Pago, Estorno, Valor_Estorno, Caixa) values (:Data_Movimento, :Tipo, :N_Fabricacao, :MF_Adicional,');
          add(':Modelo_ECF, :N_Usuario, :COO, :CCF, :GNF, :Meio_Pagamento, :Valor_Pago, :Estorno, :Valor_Estorno, :Caixa)');
          Parameters.ParamByName('Data_Movimento').Value := Registro.Data_Mov;
          Parameters.ParamByName('Tipo').Value := Registro.Tip;
          Parameters.ParamByName('N_Fabricacao').Value := Registro.N_Serie;
          Parameters.ParamByName('MF_Adicional').Value := Registro.MF_Ad;
          Parameters.ParamByName('Modelo_ECF').Value := Registro.Mode;
          Parameters.ParamByName('N_Usuario').Value := Registro.N_Usu;
          Parameters.ParamByName('COO').Value := Registro.COOO;
          Parameters.ParamByName('CCF').Value := '';
          Parameters.ParamByName('GNF').Value := Registro.GNFF;
          Parameters.ParamByName('Meio_Pagamento').Value := Registro.Meio_Pag;
          Parameters.ParamByName('Valor_Pago').Value := Registro.Valor_PG;
          Parameters.ParamByName('Estorno').Value := Registro.Estor;
          Parameters.ParamByName('Valor_Estorno').Value := Registro.Valor_Estor;
          Parameters.ParamByName('Caixa').Value := Registro.Caix;
          ExecSQL;
        end;
      end;
    finally
      // DM.ADOConnection1.CommitTrans;
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TR07.Salva_Banco(var Registro: TR07);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      DM.qryr07.close;
      DM.qryr07.open;
      DM.qryr07.First;
      begin
        while not DM.qryr07.Eof do
        begin
          with qAux, SQL do
          begin
            close;
            clear;
            // Connection:= dm.ADOConnection1;
            Connection := DM.ADOConnection1;
            add('Insert into R07 (Data_Movimento, Tipo, N_Fabricacao, MF_Adicional, Modelo_ECF, N_Usuario, COO, CCF, GNF, ');
            add('Meio_Pagamento, Valor_Pago, Estorno, Valor_Estorno, Caixa, MD5) values (:Data_Movimento, :Tipo, :N_Fabricacao, :MF_Adicional,');
            add(':Modelo_ECF, :N_Usuario, :COO, :CCF, :GNF, :Meio_Pagamento, :Valor_Pago, :Estorno, :Valor_Estorno, :Caixa, :MD5)');
            Parameters.ParamByName('Data_Movimento').Value :=
              DM.qryr07['Data_Movimento'];
            Parameters.ParamByName('Tipo').Value := DM.qryr07['Tipo'];
            Parameters.ParamByName('N_Fabricacao').Value :=
              DM.qryr07['N_Fabricacao'];
            Parameters.ParamByName('MF_Adicional').Value :=
              DM.qryr07['MF_Adicional'];
            Parameters.ParamByName('Modelo_ECF').Value :=
              DM.qryr07['Modelo_ECF'];
            Parameters.ParamByName('N_Usuario').Value := DM.qryr07['N_Usuario'];
            Parameters.ParamByName('COO').Value := DM.qryr07['COO'];
            Parameters.ParamByName('CCF').Value := DM.qryr07['CCF'];
            Parameters.ParamByName('GNF').Value := DM.qryr07['GNF'];
            Parameters.ParamByName('Meio_Pagamento').Value :=
              DM.qryr07['Meio_Pagamento'];
            Parameters.ParamByName('Valor_Pago').Value :=
              DM.qryr07['Valor_Pago'];
            Parameters.ParamByName('Estorno').Value := DM.qryr07['Estorno'];
            Parameters.ParamByName('Valor_Estorno').Value :=
              DM.qryr07['Valor_Estorno'];
            Parameters.ParamByName('Caixa').Value := DM.qryr07['Caixa'];
            Parameters.ParamByName('MD5').Value := DM.qryr07['MD5'];
            ExecSQL;
          end;
          DM.qryr07.Next;
        end;
        AtualizarQuantidadeRegistro('R07', 'QtdeR07');
      end;
    finally
      // DM.ADOConnection1.CommitTrans;
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TR07.Salva_Banco_Aux(var Registro: TR07);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      DM.qryr07.close;
      DM.qryr07.open;
      DM.qryr07.First;
      begin
        while not DM.qryr07.Eof do
        begin
          with qAux, SQL do
          begin
            close;
            clear;
            // Connection:= dm.ADOConnection1;
            Connection := DM.ADOConnection1;
            add('Insert into R07_Aux (Data_Movimento, Tipo, N_Fabricacao, MF_Adicional, Modelo_ECF, N_Usuario, COO, CCF, GNF, ');
            add('Meio_Pagamento, Valor_Pago, Estorno, Valor_Estorno, Caixa) values (:Data_Movimento, :Tipo, :N_Fabricacao, :MF_Adicional,');
            add(':Modelo_ECF, :N_Usuario, :COO, :CCF, :GNF, :Meio_Pagamento, :Valor_Pago, :Estorno, :Valor_Estorno, :Caixa)');
            Parameters.ParamByName('Data_Movimento').Value :=
              DM.qryr07['Data_Movimento'];
            Parameters.ParamByName('Tipo').Value := DM.qryr07['Tipo'];
            Parameters.ParamByName('N_Fabricacao').Value :=
              DM.qryr07['N_Fabricacao'];
            Parameters.ParamByName('MF_Adicional').Value :=
              DM.qryr07['MF_Adicional'];
            Parameters.ParamByName('Modelo_ECF').Value :=
              DM.qryr07['Modelo_ECF'];
            Parameters.ParamByName('N_Usuario').Value := DM.qryr07['N_Usuario'];
            Parameters.ParamByName('COO').Value := DM.qryr07['COO'];
            Parameters.ParamByName('CCF').Value := DM.qryr07['CCF'];
            Parameters.ParamByName('GNF').Value := DM.qryr07['GNF'];
            Parameters.ParamByName('Meio_Pagamento').Value :=
              DM.qryr07['Meio_Pagamento'];
            Parameters.ParamByName('Valor_Pago').Value :=
              DM.qryr07['Valor_Pago'];
            Parameters.ParamByName('Estorno').Value := DM.qryr07['Estorno'];
            Parameters.ParamByName('Valor_Estorno').Value :=
              DM.qryr07['Valor_Estorno'];
            Parameters.ParamByName('Caixa').Value := DM.qryr07['Caixa'];
            ExecSQL;
          end;
          DM.qryr07.Next;
        end;
      end;
    finally
      // DM.ADOConnection1.CommitTrans;
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TR06 }

procedure TR06.Excluir(var Registro: TR06);
var
  qAux, qaux2: TADOQuery;
begin
  try
    //DM.ADOConnectionLocal.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnectionLocal;
        add('Delete from R06');
        ExecSQL;
        AtualizarQuantidadeRegistro('R06', 'QtdeR06');
        //DM.ADOConnectionLocal.CommitTrans;
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      //DM.ADOConnectionLocal.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

function TR06.GetCaixa: string;
begin
  GetCaixa := StringOfChar('0', 4 - Length(UDeclaracao.Sequencia)) +
    UDeclaracao.Sequencia;
end;

function TR06.GetCDC: string;
begin
  if (den_op = 'CC') then
    GetCDC := UDeclaracao.CDC
  else
    GetCDC := '';
end;

function TR06.GetCOO: string;
begin
  GetCOO := UDeclaracao.COO;
end;

function TR06.GetData_Final_Emissao: string;
begin
  GetData_Final_Emissao := UDeclaracao.Data_Final_Emissao;
end;

function TR06.GetData_Movimento: Tdate;
begin
  GetData_Movimento := StrToDate(dataf);
end;

function TR06.GetDenominacao: string;
begin
  GetDenominacao := den_op;
end;

function TR06.GetGNF: string;
begin
  GetGNF := UDeclaracao.GNF;
end;

function TR06.GetGRG: string;
begin
  if (den_op = 'RG') then
    GetGRG := UDeclaracao.GRG
  else
    GetGRG := '';
end;

function TR06.GetHora_Final_Emissao: string;
begin
  GetHora_Final_Emissao := UDeclaracao.Hora_Final_Emissao;
end;

function TR06.GetMF_Adicional: string;
begin
  GetMF_Adicional := mf;
end;

function TR06.GetModelo: string;
begin
  GetModelo := UDeclaracao.sModelo;
end;

function TR06.GetNumero_Serie: string;
begin
  GetNumero_Serie := nu_serie;
end;

function TR06.GetNumero_Usuario: string;
begin
  GetNumero_Usuario := n_usuario;
end;

function TR06.GetTipo: string;
begin
  GetTipo := 'R06';
end;

procedure TR06.Inserir(var Registro: TR06);
begin
  if not(DM.qryr06.Active) then
    DM.qryr06.open;
  DM.qryr06.Insert;
  DM.qryr06['Data_Movimento'] := Registro.Data_Mov;
  DM.qryr06['Tipo'] := Registro.Tip;
  DM.qryr06['N_Fabricacao'] := Registro.N_Serie;
  DM.qryr06['MF_Adicional'] := Registro.MF_Ad;
  DM.qryr06['Modelo_ECF'] := Registro.Mode;
  DM.qryr06['N_Usuario'] := Registro.N_Usu;
  DM.qryr06['COO'] := Registro.COOO;
  DM.qryr06['GNF'] := Registro.GNFF;
  DM.qryr06['GRG'] := Registro.GRGG;
  DM.qryr06['CDC'] := Registro.CDCC;
  DM.qryr06['Denominacao'] := Registro.Denom;
  DM.qryr06['Data_Final_Emissao'] := Registro.Data_Final_Emis;
  DM.qryr06['Hora_Final_Emissao'] := Registro.Hora_Final_Emis;
  DM.qryr06['Caixa'] := Registro.Caix;
  DM.qryr06['MD5'] := GeraMD5([Registro.N_Serie, Registro.COOO, Registro.GNFF,
                               Registro.CDCC, Registro.Denom, Registro.Data_Final_Emis]);
  DM.qryr06.Post;
  // dm.qryr06.SaveToFile(Local_Arquivo(13));
end;

procedure TR06.Inserir_Outros(var Registro: TR06);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      begin
        with qAux, SQL do
        begin
          close;
          clear;
          Connection := DM.ADOConnection1;
          add('Insert into R06 (Data_Movimento, Tipo, N_Fabricacao, MF_Adicional, Modelo_ECF, N_Usuario, COO, GNF, GRG,');
          add('CDC, Denominacao, Data_Final_Emissao, Hora_Final_Emissao, Caixa, MD5) values (:Data_Movimento, :Tipo, :N_Fabricacao, :MF_Adicional,');
          add(':Modelo_ECF, :N_Usuario, :COO, :GNF, :GRG, :CDC, :Denominacao, :Data_Final_Emissao, :Hora_Final_Emissao, :Caixa, :MD5)');
          Parameters.ParamByName('Data_Movimento').Value := Registro.Data_Mov;
          Parameters.ParamByName('Tipo').Value := Registro.Tip;
          Parameters.ParamByName('N_Fabricacao').Value := Registro.N_Serie;
          Parameters.ParamByName('MF_Adicional').Value := Registro.MF_Ad;
          Parameters.ParamByName('Modelo_ECF').Value := Registro.Mode;
          Parameters.ParamByName('N_Usuario').Value := Registro.N_Usu;
          Parameters.ParamByName('COO').Value := Registro.COOO;
          Parameters.ParamByName('GNF').Value := Registro.GNFF;
          Parameters.ParamByName('GRG').Value := Registro.GRGG;
          Parameters.ParamByName('CDC').Value := Registro.CDCC;
          Parameters.ParamByName('Denominacao').Value := Registro.Denom;
          Parameters.ParamByName('Data_Final_Emissao').Value :=
            Registro.Data_Final_Emis;
          Parameters.ParamByName('Hora_Final_Emissao').Value :=
            Registro.Hora_Final_Emis;
          Parameters.ParamByName('Caixa').Value := Registro.Caix;
          Parameters.ParamByName('MD5').Value := GeraMD5([Registro.N_Serie, Registro.COOO, Registro.GNFF,
                               Registro.CDCC, Registro.Denom, Registro.Data_Final_Emis]);
          ExecSQL;
          AtualizarQuantidadeRegistro('R06', 'QtdeR06');
        end;
      end;
    finally
      // DM.ADOConnection1.CommitTrans;
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TR06.Inserir_Outros_Aux(var Registro: TR06);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      begin
        with qAux, SQL do
        begin
          close;
          clear;
          Connection := DM.ADOConnection1;
          add('Insert into R06_Aux (Data_Movimento, Tipo, N_Fabricacao, MF_Adicional, Modelo_ECF, N_Usuario, COO, GNF, GRG,');
          add('CDC, Denominacao, Data_Final_Emissao, Hora_Final_Emissao, Caixa) values (:Data_Movimento, :Tipo, :N_Fabricacao, :MF_Adicional,');
          add(':Modelo_ECF, :N_Usuario, :COO, :GNF, :GRG, :CDC, :Denominacao, :Data_Final_Emissao, :Hora_Final_Emissao, :Caixa)');
          Parameters.ParamByName('Data_Movimento').Value := Registro.Data_Mov;
          Parameters.ParamByName('Tipo').Value := Registro.Tip;
          Parameters.ParamByName('N_Fabricacao').Value := Registro.N_Serie;
          Parameters.ParamByName('MF_Adicional').Value := Registro.MF_Ad;
          Parameters.ParamByName('Modelo_ECF').Value := Registro.Mode;
          Parameters.ParamByName('N_Usuario').Value := Registro.N_Usu;
          Parameters.ParamByName('COO').Value := Registro.COOO;
          Parameters.ParamByName('GNF').Value := Registro.GNFF;
          Parameters.ParamByName('GRG').Value := Registro.GRGG;
          Parameters.ParamByName('CDC').Value := Registro.CDCC;
          Parameters.ParamByName('Denominacao').Value := Registro.Denom;
          Parameters.ParamByName('Data_Final_Emissao').Value :=
            Registro.Data_Final_Emis;
          Parameters.ParamByName('Hora_Final_Emissao').Value :=
            Registro.Hora_Final_Emis;
          Parameters.ParamByName('Caixa').Value := Registro.Caix;
          ExecSQL;
        end;
      end;
    finally
      // DM.ADOConnection1.CommitTrans;
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TR06.Salva_Banco(var Registro: TR06);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      DM.qryr06.close;
      DM.qryr06.open;
      DM.qryr06.First;
      begin
        while not DM.qryr06.Eof do
        begin
          with qAux, SQL do
          begin
            close;
            clear;
            // Connection:= dm.ADOConnection1;
            Connection := DM.ADOConnection1;
            add('Insert into R06 (Data_Movimento, Tipo, N_Fabricacao, MF_Adicional, Modelo_ECF, N_Usuario, COO, GNF, GRG,');
            add('CDC, Denominacao, Data_Final_Emissao, Hora_Final_Emissao, Caixa, MD5) values (:Data_Movimento, :Tipo, :N_Fabricacao, :MF_Adicional,');
            add(':Modelo_ECF, :N_Usuario, :COO, :GNF, :GRG, :CDC, :Denominacao, :Data_Final_Emissao, :Hora_Final_Emissao, :Caixa, :MD5)');
            Parameters.ParamByName('Data_Movimento').Value :=
              DM.qryr06['Data_Movimento'];
            Parameters.ParamByName('Tipo').Value := DM.qryr06['Tipo'];
            Parameters.ParamByName('N_Fabricacao').Value :=
              DM.qryr06['N_Fabricacao'];
            Parameters.ParamByName('MF_Adicional').Value :=
              DM.qryr06['MF_Adicional'];
            Parameters.ParamByName('Modelo_ECF').Value :=
              DM.qryr06['Modelo_ECF'];
            Parameters.ParamByName('N_Usuario').Value := DM.qryr06['N_Usuario'];
            Parameters.ParamByName('COO').Value := DM.qryr06['COO'];
            Parameters.ParamByName('GNF').Value := DM.qryr06['GNF'];
            Parameters.ParamByName('GRG').Value := DM.qryr06['GRG'];
            Parameters.ParamByName('CDC').Value := DM.qryr06['CDC'];
            Parameters.ParamByName('Denominacao').Value :=
              DM.qryr06['Denominacao'];
            Parameters.ParamByName('Data_Final_Emissao').Value :=
              DM.qryr06['Data_Final_Emissao'];
            Parameters.ParamByName('Hora_Final_Emissao').Value :=
              DM.qryr06['Hora_Final_Emissao'];
            Parameters.ParamByName('Caixa').Value := DM.qryr06['Caixa'];
            Parameters.ParamByName('MD5').Value := DM.qryr06['MD5'];
            ExecSQL;
          end;
          DM.qryr06.Next;
        end;
        AtualizarQuantidadeRegistro('R06', 'QtdeR06');
      end;
    finally
      // DM.ADOConnection1.CommitTrans;
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TR06.Salva_Banco_Aux(var Registro: TR06);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      DM.qryr06.close;
      DM.qryr06.open;
      DM.qryr06.First;
      begin
        while not DM.qryr06.Eof do
        begin
          with qAux, SQL do
          begin
            close;
            clear;
            // Connection:= dm.ADOConnection1;
            Connection := DM.ADOConnection1;
            add('Insert into R06_Aux (Data_Movimento, Tipo, N_Fabricacao, MF_Adicional, Modelo_ECF, N_Usuario, COO, GNF, GRG,');
            add('CDC, Denominacao, Data_Final_Emissao, Hora_Final_Emissao, Caixa) values (:Data_Movimento, :Tipo, :N_Fabricacao, :MF_Adicional,');
            add(':Modelo_ECF, :N_Usuario, :COO, :GNF, :GRG, :CDC, :Denominacao, :Data_Final_Emissao, :Hora_Final_Emissao, :Caixa)');
            Parameters.ParamByName('Data_Movimento').Value :=
              DM.qryr06['Data_Movimento'];
            Parameters.ParamByName('Tipo').Value := DM.qryr06['Tipo'];
            Parameters.ParamByName('N_Fabricacao').Value :=
              DM.qryr06['N_Fabricacao'];
            Parameters.ParamByName('MF_Adicional').Value :=
              DM.qryr06['MF_Adicional'];
            Parameters.ParamByName('Modelo_ECF').Value :=
              DM.qryr06['Modelo_ECF'];
            Parameters.ParamByName('N_Usuario').Value := DM.qryr06['N_Usuario'];
            Parameters.ParamByName('COO').Value := DM.qryr06['COO'];
            Parameters.ParamByName('GNF').Value := DM.qryr06['GNF'];
            Parameters.ParamByName('GRG').Value := DM.qryr06['GRG'];
            Parameters.ParamByName('CDC').Value := DM.qryr06['CDC'];
            Parameters.ParamByName('Denominacao').Value :=
              DM.qryr06['Denominacao'];
            Parameters.ParamByName('Data_Final_Emissao').Value :=
              DM.qryr06['Data_Final_Emissao'];
            Parameters.ParamByName('Hora_Final_Emissao').Value :=
              DM.qryr06['Hora_Final_Emissao'];
            Parameters.ParamByName('Caixa').Value := DM.qryr06['Caixa'];
            ExecSQL;
          end;
          DM.qryr06.Next;
        end;
      end;
    finally
      // DM.ADOConnection1.CommitTrans;
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TPedido }

procedure TPedido.Alterar(var Registro: TPedido);
var
  qAux, qaux2: TADOQuery;
begin
  try
    try
      qAux := TADOQuery.Create(nil);
      begin
        with qAux, SQL do
        begin
          close;
          clear;
          Connection := DM.ADOConnection1;
          add('Update Pedido set Codigo_Cliente = :Codigo_Cliente, Codigo_Empresa = :Codigo_Empresa,');
          add('Codigo_Veiculo = :Codigo_Veiculo, Codigo_Funcionario = :Codigo_Funcionario, ');
          add('Codigo_Tabela_Preco = :Codigo_Tabela_Preco, Codigo_Forma_Pag = :Codigo_Forma_Pag, Data_Venda = :Data_Venda, ');
          add('Data_Vencimento = :Data_Vencimento,');
          add('Qtde_Itens = :Qtde_Itens, Qtde_Servicos = :Qtde_Servicos, Total_Produtos = :Total_Produtos,');
          add('Total_Servicos = :Total_Servicos, Total_Desc_Acr = :Total_Desc_Acr, Desc_Acr = :Desc_Acr,');
          add('Tipo_Desc_Acr = :Tipo_Desc_Acr, ');
          add('Total_Pedido = :Total_Pedido, ');
          add('Tipo = :Tipo, Status = :Status, Valor_Recebido = :Valor_Recebido, Troco = :Troco,');
          add('Mesclada = :Mesclada, Problema_Reclamado = :Problema_Reclamado, ');
          add('Problema_Constatado = :Problema_Constatado, Solucao = :Solucao, Observacao = :Observacao');
          add('where Codigo = :Codigo');
          Parameters.ParamByName('Codigo').Value := Registro.Cod;
          Parameters.ParamByName('Codigo_Cliente').Value := Registro.Cod_Cli;
          Parameters.ParamByName('Codigo_Empresa').Value :=
            Registro.Cod_Empresa;
          Parameters.ParamByName('Codigo_Veiculo').Value :=
            Registro.Cod_Veiculo;
          Parameters.ParamByName('Codigo_Funcionario').Value :=
            Registro.Cod_Funcionario;
          Parameters.ParamByName('Codigo_Tabela_Preco').Value :=
            Registro.Cod_Tabela_Preco;
          Parameters.ParamByName('Codigo_Forma_Pag').Value :=
            Registro.Cod_Forma_Pag;
          Parameters.ParamByName('Data_Venda').Value := Registro.Data_Ve;
          Parameters.ParamByName('Data_Vencimento').Value := Registro.Data_Venc;
          Parameters.ParamByName('Qtde_Itens').Value := Registro.Qtde_It;
          Parameters.ParamByName('Qtde_Servicos').Value := Registro.Qtde_Serv;
          Parameters.ParamByName('Total_Produtos').Value := Registro.Tot_Prod;
          Parameters.ParamByName('Total_Servicos').Value := Registro.Tot_Serv;
          Parameters.ParamByName('Total_Desc_Acr').Value :=
            Registro.Tot_Desc_Acr;
          Parameters.ParamByName('Desc_Acr').Value := Registro.Desc_Acr_Pedido;
          Parameters.ParamByName('Tipo_Desc_Acr').Value := Tipo_Desc_Acr_Pedido;
          Parameters.ParamByName('Total_Pedido').Value := Registro.Tot_Ped;
          Parameters.ParamByName('Tipo').Value := Tipo_Venda;
          Parameters.ParamByName('Status').Value := 'PENDENTE';
          Parameters.ParamByName('Valor_Recebido').Value := Registro.Val_Rec;
          Parameters.ParamByName('Troco').Value := Registro.Troc;
          Parameters.ParamByName('Mesclada').Value := Registro.Mesc;
          Parameters.ParamByName('Problema_Reclamado').Value :=
            Registro.Problema_Rec;
          Parameters.ParamByName('Problema_Constatado').Value :=
            Registro.Problema_Const;
          Parameters.ParamByName('Solucao').Value := Registro.Soluc;
          Parameters.ParamByName('Observacao').Value := Registro.Obss;
          ExecSQL;
        end;
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
      lrControle := Altera;
      UGeral.Mensagem_Padrao(lrControle);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TPedido.Alterar_PDV(var Registro: TPedido);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      begin
        with qAux, SQL do
        begin
          close;
          clear;
          Connection := DM.ADOConnection1;
          add('Update Pedido set Codigo_Cliente = :Codigo_Cliente,');
          add('Codigo_Condicao_Pagamento = :Codigo_Condicao_Pagamento, Outras_Despesas = :Outras_Despesas,');
          add('Tipo_Frete = :Tipo_Frete, Valor_Frete = :Valor_Frete, Data_Venda = :Data_Venda,');
          add('Qtde_Itens = :Qtde_Itens, Total_Produtos = :Total_Produtos, Peso_Total = :Peso_Total,');
          add('Desconto = :Desconto, Tipo_Desconto = :Tipo_Desconto, Total_Pedido = :Total_Pedido, Tipo = :Tipo, Status = :Status, Observacoes = :Observacoes ');
          add('where N_Pedido = :N_Pedido and Codigo = :Codigo');
          Parameters.ParamByName('Codigo').Value := Registro.Cod_PDV;
          Parameters.ParamByName('N_Pedido').Value := Registro.N_Ped_PDV;
          Parameters.ParamByName('Codigo_Cliente').Value :=
            Registro.Cod_Cli_PDV;
          Parameters.ParamByName('Data_Venda').Value := Registro.Data_Ve_PDV;
          Parameters.ParamByName('Qtde_Itens').Value := Registro.Qtde_It_PDV;
          Parameters.ParamByName('Total_Produtos').Value :=
            Registro.Tot_Prod_PDV;
          Parameters.ParamByName('Desconto').Value := Registro.Desc_Acr_PDV;
          Parameters.ParamByName('Tipo_Desconto').Value := Tipo_Desc_Acr_PDV;
          Parameters.ParamByName('Total_Pedido').Value := Registro.Tot_Ped_PDV;
          Parameters.ParamByName('Tipo').Value := Tipo_Venda;
          Parameters.ParamByName('Status').Value := '';
          ExecSQL;
        end;
      end;
    finally
      // DM.ADOConnection1.CommitTrans;
      qAux.close;
      FreeAndNil(qAux);
      lrControle := Altera;
      UGeral.Mensagem_Padrao(lrControle);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TPedido.Alterar_Pedido(COO, COO_Vin, CCF: Ansistring);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      begin
        with qAux, SQL do
        begin
          close;
          clear;
          Connection := DM.ADOConnection1;
          add('Update Pedido set COO = :COO,');
          add('COO_Vin = :COO_Vin, CCF = :CCF,');
          add('Status = :Status, Valor_Recebido = :Valor_Recebido, ');
          add('Troco = :Troco, Data_Venda = :Data_Venda, ECF = :ECF');
          add('where Codigo = :Codigo');
          Parameters.ParamByName('Codigo').Value :=
            StrToInt(FrmFechamento_Venda_PDV.LblCodigo.Caption);
          Parameters.ParamByName('COO').Value := COO;
          Parameters.ParamByName('COO_Vin').Value := COO_Vin;
          Parameters.ParamByName('CCF').Value := CCF;
          Parameters.ParamByName('Status').Value := 'PAGO';
          Parameters.ParamByName('Valor_Recebido').Value :=
            FrmFechamento_Venda_PDV.EdtValor_Recebido.Text;
          Parameters.ParamByName('Troco').Value :=
            FrmFechamento_Venda_PDV.EdtTroco.Text;
          Parameters.ParamByName('Data_Venda').Value := date;
          Parameters.ParamByName('ECF').Value := nu_serie_inteiro;
          ExecSQL;
        end;
      end;
    finally
      // DM.ADOConnection1.CommitTrans;
      qAux.close;
      FreeAndNil(qAux);
      // lrControle:= Altera;
      // UGeral.Mensagem_Padrao(lrControle);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TPedido.Excluir(var Registro: TPedido; var Conexao: TADOConnection);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := Conexao;
        add('Delete from Pedido where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        // lrControle := Exclui;
        // UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      Application.MessageBox(PChar('Erro: ' + E.Message), 'Erro',
        MB_OK + MB_ICONHAND);
      TLog.Error('Erro ao excluir pedido: ' + E.Message);
    end;
  end;
end;

procedure TPedido.ExcluirLocal(var Registro: TPedido);
var
  qAux, qaux2: TADOQuery;
begin
  try
    DM.ADOConnectionLocal.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnectionLocal;
        add('Delete from Pedido');
        ExecSQL;
        DM.ADOConnectionLocal.CommitTrans;
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      DM.ADOConnectionLocal.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TPedido.Excluir_PDV(var Registro: TPedido);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Delete from Pedido where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod_PDV;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Exclui;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

function TPedido.GetCCF: string;
begin
  // if (FrmCarrega_Pedido_Caixa.qrycarrega_caixaTipo.AsString= 'DAV-OS') or (FrmCarrega_Pedido_Caixa.qrycarrega_caixaDAVC.AsString= 'SIM') then
  GetCCF := UDeclaracao.CCF;
  // else
  // GetCCF:= '';
end;

function TPedido.GetCodigo: integer;
begin
  if (FrmPedido_Venda <> nil) then
  begin
    if (FrmPedido_Venda.ativo = true) then
      GetCodigo := StrToInt(FrmPedido_Venda.EdtCodigo.Text);
  end;

  if (FrmOS <> nil) then
  begin
    if (FrmOS.ativo = true) then
      GetCodigo := StrToInt(FrmOS.EdtCodigo.Text);
  end;

  if (FrmPre_Venda <> nil) then
  begin
    if (FrmPre_Venda.ativo = true) then
      GetCodigo := StrToInt(FrmPre_Venda.EdtCodigo.Text);
  end;

  if (FrmPDV <> nil) then
  begin
    GetCodigo := StrToInt(FrmPDV.LblCodigo.Caption);
  end;
end;

function TPedido.GetCodigo_Cliente: integer;
begin
  if (FrmPedido_Venda <> nil) then
  begin
    if (FrmPedido_Venda.ativo = true) then
      GetCodigo_Cliente := StrToInt(FrmPedido_Venda.EdtCodigo_Cliente.Text);
  end;

  if (FrmOS <> nil) then
  begin
    if (FrmOS.ativo = true) then
      GetCodigo_Cliente := StrToInt(FrmOS.EdtCodigo_Cliente.Text);
  end;

  if (FrmPre_Venda <> nil) then
  begin
    if (FrmPre_Venda.ativo = true) then
      GetCodigo_Cliente := StrToInt(FrmPre_Venda.EdtCodigo_Cliente.Text);
  end;

  if (FrmPDV <> nil) then
  begin
    GetCodigo_Cliente := FrmPDV.Codigo_Cliente;
  end;
end;

function TPedido.GetCodigo_Cliente_PDV: integer;
begin
  GetCodigo_Cliente_PDV := FrmPDV.Codigo_Cliente;
end;

function TPedido.GetCodigo_Empresa: integer;
begin
  GetCodigo_Empresa := UDeclaracao.Codigo_Empresa;
end;

function TPedido.GetCodigo_Empresa_PDV: integer;
begin
  GetCodigo_Empresa_PDV := UDeclaracao.Codigo_Empresa;
end;

function TPedido.GetCodigo_Forma_Pag: integer;
begin
  if (FrmPedido_Venda <> nil) then
  begin
    if (FrmPedido_Venda.ativo = true) then
    begin
      if (FrmPedido_Venda.EdtCodigo_Forma_Pagamento.Text <> '') then
        GetCodigo_Forma_Pag :=
          StrToInt(FrmPedido_Venda.EdtCodigo_Forma_Pagamento.Text)
      else
        GetCodigo_Forma_Pag := NULL;
    end;
  end;

  if (FrmOS <> nil) then
  begin
    if (FrmOS.ativo = true) then
      GetCodigo_Forma_Pag := 0;
  end;

  if (FrmPre_Venda <> nil) then
  begin
    if (FrmPre_Venda.ativo = true) then
      GetCodigo_Forma_Pag := 0;
  end;

  if (FrmPDV <> nil) then
  begin
    GetCodigo_Forma_Pag := 0;
  end;
end;

function TPedido.GetCodigo_Funcionario: integer;
begin
  if (FrmOS <> nil) and (FrmOS.ativo = true) then
    GetCodigo_Funcionario := StrToInt(FrmOS.EdtCodigo_Funcionario.Text)
  else
    GetCodigo_Funcionario := codigo_usu;
end;

function TPedido.GetCodigo_Funcionario_PDV: integer;
begin
  GetCodigo_Funcionario_PDV := codigo_usu;
end;

function TPedido.GetCodigo_PDV: integer;
begin
  GetCodigo_PDV := StrToInt(FrmPDV.LblCodigo.Caption)
end;

function TPedido.GetCodigo_Tabela_Preco: integer;
begin
  GetCodigo_Tabela_Preco := codigo_tabela_preco_ativo;
end;

function TPedido.GetCodigo_Tabela_Preco_PDV: integer;
begin
  GetCodigo_Tabela_Preco_PDV := codigo_tabela_preco_ativo;
end;

function TPedido.GetCodigo_Veiculo: integer;
begin
  if (FrmOS <> nil) and (FrmOS.ativo = true) then
    GetCodigo_Veiculo := StrToInt(FrmOS.EdtCodigo_Veiculo.Text)
  else
    GetCodigo_Veiculo := 0;
end;

function TPedido.GetCOO: string;
begin
  GetCOO := UDeclaracao.COO;
end;

function TPedido.GetCOO_PDV: string;
begin
  GetCOO_PDV := UDeclaracao.COO;
end;

function TPedido.GetCOO_Vinculado: string;
begin
  GetCOO_Vinculado := '';
end;

function TPedido.GetCOO_Vinculado_PDV: string;
begin
  GetCOO_Vinculado_PDV := '';
end;

function TPedido.GetData_Vencimento: Tdate;
begin
  if (FrmPedido_Venda <> nil) then
  begin
    if (FrmPedido_Venda.ativo = true) then
      GetData_Vencimento :=
        StrToDateTime(FrmPedido_Venda.MEdtData_Vencimento.Text);
  end;

  if (FrmOS <> nil) then
  begin
    if (FrmOS.ativo = true) then
      GetData_Vencimento := date;
  end;

  if (FrmPre_Venda <> nil) then
  begin
    if (FrmPre_Venda.ativo = true) then
      GetData_Vencimento := date;
  end;

  if (FrmPDV <> nil) then
  begin
    GetData_Vencimento := date;
  end;
end;

function TPedido.GetData_Venda: Tdate;
begin
  // GetData_Venda:= date;

  if (FrmPedido_Venda <> nil) then
  begin
    if (FrmPedido_Venda.ativo = true) then
      GetData_Venda := StrToDateTime(FrmPedido_Venda.MEdtData_Venda.Text);
  end;

  if (FrmOS <> nil) then
  begin
    if (FrmOS.ativo = true) then
      GetData_Venda := StrToDateTime(FrmOS.MEdtData_Entrada.Text);
  end;

  if (FrmPre_Venda <> nil) then
  begin
    if (FrmPre_Venda.ativo = true) then
      GetData_Venda := StrToDateTime(FrmPre_Venda.MEdtData_Venda.Text);
  end;

  if (FrmPDV <> nil) then
  begin
    GetData_Venda := date;
  end;
end;

function TPedido.GetData_Venda_PDV: Tdate;
var
  d, m, a, Data, dataf: string;
  iConta: integer;
begin
  { for iConta := 1 to 6 do DataMovimento := DataMovimento + ' ';
    iRetorno:= Bematech_FI_DataMovimento(DataMovimento);
    Analisa_iRetorno;
    d:= copy(DataMovimento, 1, 2);
    m:= copy(DataMovimento, 3, 2);
    a:= copy(DataMovimento, 5, 2);
    data:= d + '/' + m + '/' + a;
    dataf:= FormatDateTime('DD/MM/YYYY', StrToDate(data)); }
  GetData_Venda_PDV := date;
end;

function TPedido.GetDAVAnt: string;
begin
  if (FrmOS <> Nil) and (FrmOS.ativo = true) then
    GetDAVAnt := FrmOS.dav_ant
  else
    GetDAVAnt := '';
end;

function TPedido.GetDAVAnt_PDV: string;
begin
  GetDAVAnt_PDV := '';
end;

function TPedido.GetDAVC: string;
begin
  GetDAVC := 'NO';
end;

function TPedido.GetDAVC_PDV: string;
begin
  GetDAVC_PDV := 'NO';
end;

function TPedido.GetDesc_Acr: double;
begin
  if (FrmPedido_Venda <> nil) then
  begin
    if (FrmPedido_Venda.ativo = true) then
      GetDesc_Acr := StrToFloat(FrmPedido_Venda.EdtDesc_Acr_Total.Text);
  end;

  if (FrmOS <> nil) then
  begin
    if (FrmOS.ativo = true) then
      GetDesc_Acr := StrToFloat(FrmOS.EdtDesconto.Text);
  end;

  if (FrmPre_Venda <> nil) then
  begin
    if (FrmPre_Venda.ativo = true) then
      GetDesc_Acr := StrToFloat(FrmPre_Venda.EdtDesconto.Text);
  end;

  if (FrmPDV <> nil) then
  begin
    GetDesc_Acr := StrToFloat(FrmFechamento_Venda_PDV.EdtDesconto.Text);
  end;
end;

function TPedido.GetDesc_Acr_PDV: double;
begin
  GetDesc_Acr_PDV := StrToFloat(FrmFechamento_Venda_PDV.EdtDesconto.Text);
end;

function TPedido.GetHora_Venda: string;
var
  taux: Ansistring;
begin
  if (FrmPedido_Venda <> nil) then
  begin
    if (FrmPedido_Venda.ativo = true) then
      GetHora_Venda := (FrmPedido_Venda.MEdtHora_Venda.Text);
  end;

  if (FrmPDV <> nil) then
  begin
    taux := FormatDateTime('hh:mm', Time);
    GetHora_Venda := (taux);
  end;
end;

function TPedido.GetMesclada: integer;
begin
  if (FrmPedido_Venda <> nil) then
  begin
    if (FrmPedido_Venda.ativo = true) then
      GetMesclada := 0;
  end;

  if (FrmOS <> nil) then
  begin
    if (FrmOS.ativo = true) then
      GetMesclada := 0;
  end;

  if (FrmPre_Venda <> nil) then
  begin
    if (FrmPre_Venda.ativo = true) then
    begin
      if (FrmPre_Venda.mescla = true) then
        GetMesclada := 1
      else
        GetMesclada := 0;
    end;
  end;

  if (FrmPDV <> nil) then
  begin
    GetMesclada := 0;
  end;

end;

function TPedido.GetMesclada_PDV: integer;
begin
  GetMesclada_PDV := 0;
end;

function TPedido.GetN_Pedido: string;
begin
  GetN_Pedido := UDeclaracao.pedido;
end;

function TPedido.GetN_Pedido_PDV: string;
begin
  GetN_Pedido_PDV := '';
end;

function TPedido.GetN_Pre_Venda: string;
begin
  GetN_Pre_Venda := UDeclaracao.pre_venda;
end;

function TPedido.GetObservacao: string;
begin
  if (FrmPedido_Venda <> nil) then
  begin
    if (FrmPedido_Venda.ativo = true) then
      GetObservacao := FrmPedido_Venda.MmoObservacao.Text;
  end;

  if (FrmOS <> nil) then
  begin
    if (FrmOS.ativo = true) then
      GetObservacao := '';
  end;

  if (FrmPre_Venda <> nil) then
  begin
    if (FrmPre_Venda.ativo = true) then
      GetObservacao := '';
  end;

  if (FrmPDV <> nil) then
  begin
    GetObservacao := '';
  end;

end;

{ function TPedido.GetPeso_Total: double;
  begin
  if (FrmPedido_Venda <> nil) then
  begin
  if (FrmPedido_Venda.ativo = true) then
  GetPeso_Total:= StrToFloat(FrmPedido_Venda.EdtPeso_Total.Text);
  end;

  if (FrmPedido_Venda_Extra <> nil) then
  begin
  if (FrmPedido_Venda_Extra.ativo = true) then
  GetPeso_Total:= StrToFloat(FrmPedido_Venda_Extra.EdtPeso_Total.Text);
  end;

  if (FrmOS <> nil) then
  begin
  if (FrmOS.ativo = true) then
  GetPeso_Total:= 0;
  end;

  if (FrmPre_Venda <> nil) then
  begin
  if (FrmPre_Venda.ativo = true) then
  GetPeso_Total:= StrToFloat(FrmPre_Venda.EdtPeso_Total.Text);
  end;
  end;

  function TPedido.GetPeso_Total_PDV: double;
  begin
  GetPeso_Total_PDV:= 0;
  end; }

function TPedido.GetProblema_Constatado: string;
begin
  if (FrmOS <> nil) and (FrmOS.ativo = true) then
    GetProblema_Constatado := FrmOS.MMOProblema_Constatado.Text
  else
    GetProblema_Constatado := '';
end;

function TPedido.GetProblema_Constatado_PDV: string;
begin
  GetProblema_Constatado_PDV := '';
end;

function TPedido.GetProblema_Reclamado: string;
begin
  if (FrmOS <> nil) and (FrmOS.ativo = true) then
    GetProblema_Reclamado := FrmOS.MMOProblema_Reclamado.Text
  else
    GetProblema_Reclamado := '';
end;

function TPedido.GetProblema_Reclamado_PDV: string;
begin
  GetProblema_Reclamado_PDV := '';
end;

function TPedido.GetQtde_Itens: integer;
begin
  if (FrmPedido_Venda <> nil) then
  begin
    if (FrmPedido_Venda.ativo = true) then
      GetQtde_Itens := StrToInt(FrmPedido_Venda.EdtQuantidade_Itens.Text);
  end;

  if (FrmOS <> nil) then
  begin
    if (FrmOS.ativo = true) then
      GetQtde_Itens := StrToInt(FrmOS.EdtQuantidade_Itens.Text);
  end;

  if (FrmPre_Venda <> nil) then
  begin
    if (FrmPre_Venda.ativo = true) then
      GetQtde_Itens := StrToInt(FrmPre_Venda.EdtQuantidade_Itens.Text);
  end;

  if (FrmPDV <> nil) then
  begin
    GetQtde_Itens := 0;
  end;

end;

function TPedido.GetQtde_Itens_PDV: integer;
begin
  GetQtde_Itens_PDV := 0;
end;

function TPedido.GetQtde_Servicos: integer;
begin
  if (FrmOS <> nil) and (FrmOS.ativo = true) then
    GetQtde_Servicos := StrToInt(FrmOS.EdtQuantidade_Servicos.Text)
  else
    GetQtde_Servicos := 0;
end;

function TPedido.GetSolucao: string;
begin
  if (FrmOS <> nil) and (FrmOS.ativo = true) then
    GetSolucao := FrmOS.MMOSolucao.Text
  else
    GetSolucao := '';
end;

function TPedido.GetSolucao_PDV: string;
begin
  GetSolucao_PDV := '';
end;

function TPedido.GetStatus: string;
begin
  if (FrmPedido_Venda <> nil) then
  begin
    if (FrmPedido_Venda.ativo) then
      GetStatus := 'PENDENTE';
  end;

  if (FrmPDV <> nil) then
  begin
    GetStatus := 'PAGO';
  end;
end;

function TPedido.GetTipo_Desc_Acr: string;
begin
  if (FrmPedido_Venda <> nil) then
  begin
    if (FrmPedido_Venda.ativo = true) then
      GetTipo_Desc_Acr := '$';
  end;

  if (FrmOS <> nil) then
  begin
    if (FrmOS.ativo = true) then
      GetTipo_Desc_Acr := '$';
  end;

  if (FrmPre_Venda <> nil) then
  begin
    if (FrmPre_Venda.ativo = true) then
      GetTipo_Desc_Acr := '$';
  end;

  if (FrmPDV <> nil) then
  begin
    GetTipo_Desc_Acr := '$';
  end;
end;

function TPedido.GetTipo_Desc_Acr_PDV: string;
begin
  // if (FrmFechamento_Venda_PDV.RGTipo.ItemIndex = 0) then
  GetTipo_Desc_Acr_PDV := '$' // mudei aqui, estava V
  // else
  // GetTipo_Desconto_PDV:= 'P';
end;

function TPedido.GetTotal_Desc_Acr: double;
begin
  if (FrmPedido_Venda <> nil) then
  begin
    if (FrmPedido_Venda.ativo) then
    begin
      GetTotal_Desc_Acr := StrToFloat(FrmPedido_Venda.EdtTotal_Desc_Acr.Text);
    end;
  end;

  if (FrmPDV <> nil) then
  begin
    GetTotal_Desc_Acr := 0;
  end;

end;

function TPedido.GetTotal_Pedido: double;
begin
  if (FrmPedido_Venda <> nil) then
  begin
    if (FrmPedido_Venda.ativo) then
      GetTotal_Pedido := StrToFloat(FrmPedido_Venda.EdtTotal_Pedido.Text);
  end;

  if (FrmOS <> nil) then
  begin
    if (FrmOS.ativo = true) then
      GetTotal_Pedido := StrToFloat(FrmOS.EdtTotal_Pedido.Text);
  end;

  if (FrmPre_Venda <> nil) then
  begin
    if (FrmPre_Venda.ativo = true) then
      GetTotal_Pedido := StrToFloat(FrmPre_Venda.EdtTotal_Pedido.Text);
  end;

  if (FrmPDV <> nil) then
  begin
    GetTotal_Pedido := StrToFloat(FrmFechamento_Venda_PDV.EdtTotal_Venda.Text);
  end;

end;

function TPedido.GetTotal_Pedido_PDV: double;
begin
  GetTotal_Pedido_PDV :=
    StrToFloat(FrmFechamento_Venda_PDV.EdtTotal_Venda.Text);
end;

function TPedido.GetTotal_Produtos: double;
begin
  if (FrmPedido_Venda <> nil) then
  begin
    if (FrmPedido_Venda.ativo = true) then
      GetTotal_Produtos := StrToFloat(FrmPedido_Venda.EdtTotal_Produtos.Text);
  end;

  if (FrmOS <> nil) then
  begin
    if (FrmOS.ativo = true) then
      GetTotal_Produtos := StrToFloat(FrmOS.EdtTotal_Produtos.Text);
  end;

  if (FrmPre_Venda <> nil) then
  begin
    if (FrmPre_Venda.ativo = true) then
      GetTotal_Produtos := StrToFloat(FrmPre_Venda.EdtTotal_Produtos.Text);
  end;

  if (FrmPDV <> nil) then
  begin
    GetTotal_Produtos := StrToFloat(FrmFechamento_Venda_PDV.EdtSub_Total.Text);
  end;

end;

function TPedido.GetTotal_Produtos_PDV: double;
begin
  GetTotal_Produtos_PDV :=
    StrToFloat(FrmFechamento_Venda_PDV.EdtSub_Total.Text);;
end;

function TPedido.GetTotal_Servicos: double;
begin
  if (FrmOS <> nil) and (FrmOS.ativo = true) then
    GetTotal_Servicos := StrToFloat(FrmOS.EdtTotal_Servicos.Text)
  else
    GetTotal_Servicos := 0;
end;

function TPedido.GetTroco: double;
begin
  if (FrmPedido_Venda <> nil) then
  begin
    if (FrmPedido_Venda.ativo) then
    begin
      GetTroco := 0;
    end;
  end;

  if (FrmPDV <> nil) then
  begin
    GetTroco := StrToFloat(FrmFechamento_Venda_PDV.EdtTroco.Text);
  end;

end;

function TPedido.GetTroco_PDV: double;
begin
  GetTroco_PDV := StrToFloat(FrmFechamento_Venda_PDV.EdtTroco.Text);
end;

function TPedido.GetValor_Recebido: double;
begin
  if (FrmPedido_Venda <> nil) then
  begin
    if (FrmPedido_Venda.ativo) then
    begin
      GetValor_Recebido := 0;
    end;
  end;

  if (FrmPDV <> nil) then
  begin
    GetValor_Recebido :=
      StrToFloat(FrmFechamento_Venda_PDV.EdtValor_Recebido.Text);
  end;

end;

function TPedido.GetValor_Recebido_PDV: double;
begin
  GetValor_Recebido_PDV :=
    StrToFloat(FrmFechamento_Venda_PDV.EdtValor_Recebido.Text);
end;

procedure TPedido.Inserir(var Registro: TPedido);
begin
  { FrmPedido_Venda.qryvenda.Open;
    FrmPedido_Venda.qryvenda.Insert;
    FrmPedido_Venda.qryvenda['Codigo']:= Registro.Cod;
    FrmPedido_Venda.qryvenda['N_Pedido']:= Registro.N_Ped;
    FrmPedido_Venda.qryvenda['COO']:= Registro.COOO;
    FrmPedido_Venda.qryvenda['COO_Vin']:= Registro.COOO_Vin;
    FrmPedido_Venda.qryvenda['CCF']:= Registro.CCFF;
    FrmPedido_Venda.qryvenda['Codigo_Cliente']:= Registro.Cod_Cli;
    FrmPedido_Venda.qryvenda['Codigo_Condicao_Pagamento']:= Registro.Cod_Con_Pag;
    FrmPedido_Venda.qryvenda['Codigo_Empresa']:= Registro.Cod_Empresa;
    FrmPedido_Venda.qryvenda['Codigo_Veiculo']:= Registro.Cod_Veiculo;
    FrmPedido_Venda.qryvenda['Outras_Despesas']:= Registro.Outras_Desp;
    FrmPedido_Venda.qryvenda['Tipo_Frete']:= Registro.Tipo_Fre;
    FrmPedido_Venda.qryvenda['Valor_Frete']:= Registro.Valor_Fre;
    FrmPedido_Venda.qryvenda['Data_Venda']:= Registro.Data_Ve;
    FrmPedido_Venda.qryvenda['Data_Previsao_Entrega']:= Registro.Data_Prev_Entrega;
    FrmPedido_Venda.qryvenda['Hora_Entrega']:= Registro.Hora_Entre;
    FrmPedido_Venda.qryvenda['Qtde_Itens']:= Registro.Qtde_It;
    FrmPedido_Venda.qryvenda['Qtde_Servicos']:= Registro.Qtde_Serv;
    FrmPedido_Venda.qryvenda['Total_Produtos']:= Registro.Tot_Prod;
    FrmPedido_Venda.qryvenda['Total_Servicos']:= Registro.Tot_Serv;
    FrmPedido_Venda.qryvenda['Peso_Total']:= Registro.Peso_Tot;
    FrmPedido_Venda.qryvenda['Desconto']:= Registro.Desc;
    FrmPedido_Venda.qryvenda['Tipo_Desconto']:= Tipo_Desc;
    FrmPedido_Venda.qryvenda['Acrecimo']:= Registro.Acre;
    FrmPedido_Venda.qryvenda['Tipo_Acrecimo']:= Tipo_Acre;
    FrmPedido_Venda.qryvenda['Total_Pedido']:= Registro.Tot_Ped;
    FrmPedido_Venda.qryvenda['Tipo']:= tipo_venda;
    FrmPedido_Venda.qryvenda['Status']:= 'CAIXA';
    FrmPedido_Venda.qryvenda['Valor_Recebido']:= Registro.Val_Rec;
    FrmPedido_Venda.qryvenda['Troco']:= Registro.Troc;
    FrmPedido_Venda.qryvenda['Observacoes']:= Registro.Obs;
    FrmPedido_Venda.qryvenda['Nome_Nome_Fantasia']:= FrmPedido_Venda.EdtCliente.Text;
    FrmPedido_Venda.qryvenda['CPF']:= FrmPedido_Venda.LblCPF.Caption;
    FrmPedido_Venda.qryvenda['Descricao']:= FrmPedido_Venda.EdtCondicao_Pagamento.Text;
    FrmPedido_Venda.qryvenda.SaveToFile(Local_Arquivo(1), dfXMLUTF8); }

end;

procedure TPedido.Inserir_PDV(var Registro: TPedido);
begin
  if not(DM.qryvenda.Active) then
    DM.qryvenda.open;

  try
    DM.qryvenda.Insert;
    DM.qryvendaCodigo.AsInteger := Registro.Cod;
    DM.qryvendaN_Pedido.AsString := Registro.N_Ped;
    DM.qryvendaN_Pre_Venda.AsString := Registro.N_Pre_Ven;
    DM.qryvendaCOO.AsString := Registro.COOO;
    DM.qryvendaCOO_Vin.AsString := Registro.COOO_Vin;
    DM.qryvendaCCF.AsString := Registro.CCFF;
    DM.qryvendaCodigo_Cliente.AsInteger := Registro.Cod_Cli;
    DM.qryvendaCodigo_Empresa.AsInteger := Registro.Cod_Empresa;
    DM.qryvendaCodigo_Veiculo.AsInteger := Registro.Cod_Veiculo;
    DM.qryvendaCodigo_Funcionario.AsInteger := Registro.Cod_Funcionario;
    DM.qryvendaCodigo_Tabela_Preco.AsInteger := Registro.Cod_Tabela_Preco;
    DM.qryvendaCodigo_Forma_Pag.AsInteger := Registro.Cod_Forma_Pag;
    DM.qryvendaData_Venda.AsDateTime := Registro.Data_Ve;
    DM.qryvendaData_Vencimento.AsDateTime := Registro.Data_Venc;
    DM.qryvendaQtde_Itens.AsInteger := Registro.Qtde_It;
    DM.qryvendaQtde_Servicos.AsInteger := Registro.Qtde_Serv;
    DM.qryvendaTotal_Produtos.AsFloat := Registro.Tot_Prod;
    DM.qryvendaTotal_Servicos.AsFloat := Registro.Tot_Serv;
    DM.qryvendaTotal_Desc_Acr.AsFloat := Registro.Tot_Desc_Acr;
    DM.qryvendaDesc_Acr.AsFloat := Registro.Desc_Acr_Pedido;
    DM.qryvendaTipo_Desc_Acr.AsString := Tipo_Desc_Acr_Pedido;
    DM.qryvendaTotal_Pedido.AsFloat := Registro.Tot_Ped;
    DM.qryvendaTipo.AsString := Tipo_Venda;
    DM.qryvendaStatus.AsString := Registro.Stat;
    DM.qryvendaValor_Recebido.AsFloat := Registro.Val_Rec;
    DM.qryvendaTroco.AsFloat := Registro.Troc;
    DM.qryvendaMesclada.AsInteger := Registro.Mesc;
    DM.qryvendaProblema_Reclamado.AsString := Registro.Problema_Rec;
    DM.qryvendaProblema_Constatado.AsString := Registro.Problema_Const;
    DM.qryvendaSolucao.AsString := Registro.Soluc;
    DM.qryvendaDAVC.AsString := Registro.DAVCC;
    DM.qryvendaDAVAnt.AsString := Registro.DAVAntt;
    DM.qryvendaObservacao.AsString := Registro.Obss;
    DM.qryvendaHora_Venda.AsString := Registro.Hora_Ven;
    DM.qryvenda.Post;
  except
    on E: Exception do
    begin
      ShowMessage(E.Message);
    end;

  end;
  // dm.qryvenda.SaveToFile(Local_Arquivo(1), dfXMLUTF8);
end;

procedure TPedido.Salva_Banco(lOUs: Ansistring; Tipo_Op: Ansistring;
  Codigo: integer; N_Pedido: Ansistring; N_Pre_Venda: Ansistring;
  COO: Ansistring; COO_Vin: Ansistring; CCF: Ansistring;
  Codigo_Cliente: integer; Codigo_Empresa: integer; Codigo_Veiculo: integer;
  Codigo_Funcionario: integer; Codigo_Tabela_Preco: integer;
  Codigo_Forma_Pag: integer; Data_Venda: Tdate; Data_Vencimento: Tdate;
  Qtde_Itens: integer; Qtde_Servicos: integer; Total_Produtos: double;
  Total_Servicos: double; Total_Desc_Acr: double; Desc_Acr: double;
  Tipo_Desc_Acr: Ansistring; Total_Pedido: double; Tipo: Ansistring;
  Status: Ansistring; Status_OS: Ansistring; Valor_Recebido: double;
  Troco: double; Mesclada: integer; Problema_Reclamado: Ansistring;
  Problema_Constatado: Ansistring; Solucao: Ansistring; DAVC: Ansistring;
  DAVAnt: Ansistring; Chave_NFe: Ansistring; Protocolo_NFe: Ansistring;
  N_Nota_Fiscal: integer; Observacao: Ansistring; Hora_Venda: Ansistring;
  Atualizou_Orcamento_Vencido: integer; Data_Previsao_Entrega: Tdate;
  Data_Entrega: Tdate; Kilometragem: double; ECF: Ansistring;
  Codigo_CFOP: integer; Total_Impostos: double; DataEmissaoNFe: TDateTime;
  var Conexao: TADOConnection);
var
  qAux, qaux2: TADOQuery;
begin
  try
    try
      qAux := TADOQuery.Create(nil);
      begin
        with qAux, SQL do
        begin
          close;
          clear;

          if (lOUs = 'S') then
          begin
            Connection := Conexao; // DM.ADOConnection1;
          end
          else if (lOUs = 'L') then
          begin
            Connection := DM.ADOConnectionLocal;
          end;

          if (Tipo_Op = 'I') then
          begin
            add('INSERT INTO Pedido');
            add('           (Codigo,N_Pedido,N_Pre_Venda,COO,COO_Vin,CCF,Codigo_Cliente,Codigo_Empresa,Codigo_Veiculo');
            add('           ,Codigo_Funcionario,Codigo_Tabela_Preco,Codigo_Forma_Pag,Data_Venda,Data_Vencimento');
            add('           ,Qtde_Itens,Qtde_Servicos,Total_Produtos,Total_Servicos,Total_Desc_Acr,Desc_Acr');
            add('           ,Tipo_Desc_Acr,Total_Pedido,Tipo,Status,Status_OS,Valor_Recebido,Troco,Mesclada,Problema_Reclamado');
            add('           ,Problema_Constatado,Solucao,DAVC,DAVAnt,Observacao,Hora_Venda,Atualizou_Orcamento_Vencido,');
            add('         Data_Previsao_Entrega, Data_Entrega, Kilometragem, ECF, Codigo_CFOP, Total_Impostos, Data_Emissao_NFe)');
            add('     VALUES');
            add('           (:Codigo,:N_Pedido,:N_Pre_Venda,:COO,:COO_Vin,:CCF,:Codigo_Cliente,:Codigo_Empresa,:Codigo_Veiculo');
            add('           ,:Codigo_Funcionario,:Codigo_Tabela_Preco,:Codigo_Forma_Pag,:Data_Venda,:Data_Vencimento');
            add('           ,:Qtde_Itens,:Qtde_Servicos,:Total_Produtos,:Total_Servicos,:Total_Desc_Acr,:Desc_Acr');
            add('           ,:Tipo_Desc_Acr,:Total_Pedido,:Tipo,:Status,:Status_OS,:Valor_Recebido,:Troco,:Mesclada,:Problema_Reclamado');
            add('           ,:Problema_Constatado,:Solucao,:DAVC,:DAVAnt,:Observacao,:Hora_Venda,:Atualizou_Orcamento_Vencido');
            add('         ,:Data_Previsao_Entrega, :Data_Entrega, :Kilometragem, :ECF, :Codigo_CFOP, :Total_Impostos, :Data_Emissao_NFe)');
          end
          else if (Tipo_Op = 'A') then
          begin
            add('           UPDATE Pedido');
            add('              SET N_Pre_Venda = :N_Pre_Venda, COO = :COO,COO_Vin = :COO_Vin,CCF = :CCF,Codigo_Cliente = :Codigo_Cliente,Codigo_Empresa = :Codigo_Empresa');
            add('                 ,Codigo_Veiculo = :Codigo_Veiculo,Codigo_Funcionario = :Codigo_Funcionario,Codigo_Tabela_Preco = :Codigo_Tabela_Preco');
            add('                 ,Codigo_Forma_Pag = :Codigo_Forma_Pag,Data_Venda = :Data_Venda,Data_Vencimento = :Data_Vencimento');
            add('                 ,Qtde_Itens = :Qtde_Itens,Qtde_Servicos = :Qtde_Servicos,Total_Produtos = :Total_Produtos,Total_Servicos = :Total_Servicos');
            add('                 ,Total_Desc_Acr = :Total_Desc_Acr,Desc_Acr = :Desc_Acr,Tipo_Desc_Acr = :Tipo_Desc_Acr,Total_Pedido = :Total_Pedido');
            add('                 ,Tipo = :Tipo,Status = :Status,Status_OS = :Status_OS,Valor_Recebido = :Valor_Recebido,Troco = :Troco,Mesclada = :Mesclada,Problema_Reclamado = :Problema_Reclamado');
            add('                 ,Problema_Constatado = :Problema_Constatado,Solucao = :Solucao,DAVC = :DAVC,DAVAnt = :DAVAnt');
            add('                 ,Chave_NFe = :Chave_NFe,Protocolo_NFe = :Protocolo_NFe,N_Nota_Fiscal = :N_Nota_Fiscal');
            add('                 ,Observacao = :Observacao,Hora_Venda = :Hora_Venda, Atualizou_Orcamento_Vencido = :Atualizou_Orcamento_Vencido,');
            add('                 Data_Previsao_Entrega = :Data_Previsao_Entrega, Data_Entrega = :Data_Entrega, Kilometragem = :Kilometragem, ECF = :ECF, Codigo_CFOP = :Codigo_CFOP, Total_Impostos = :Total_Impostos, Data_Emissao_NFe = :Data_Emissao_NFe ');
            add('where Codigo = :Codigo');
          end;

          Parameters.ParamByName('Codigo').Value := Codigo;

          if (Tipo_Op = 'I') then
          begin
            Parameters.ParamByName('N_Pedido').Value := N_Pedido;
          end;

          Parameters.ParamByName('N_Pre_Venda').Value := N_Pre_Venda;
          Parameters.ParamByName('COO').Value := COO;
          Parameters.ParamByName('COO_Vin').Value := COO_Vin;
          Parameters.ParamByName('CCF').Value := CCF;
          Parameters.ParamByName('Codigo_Cliente').Value := Codigo_Cliente;
          Parameters.ParamByName('Codigo_Empresa').Value := Codigo_Empresa;
          Parameters.ParamByName('Codigo_Veiculo').Value := Codigo_Veiculo;
          Parameters.ParamByName('Codigo_Funcionario').Value :=
            Codigo_Funcionario;
          Parameters.ParamByName('Codigo_Tabela_Preco').Value :=
            Codigo_Tabela_Preco;
          Parameters.ParamByName('Codigo_Forma_Pag').Value := Codigo_Forma_Pag;
          Parameters.ParamByName('Data_Venda').Value := Data_Venda;
          Parameters.ParamByName('Data_Vencimento').Value := Data_Vencimento;
          Parameters.ParamByName('Qtde_Itens').Value := Qtde_Itens;
          Parameters.ParamByName('Qtde_Servicos').Value := Qtde_Servicos;
          Parameters.ParamByName('Total_Produtos').Value := Total_Produtos;
          Parameters.ParamByName('Total_Servicos').Value := Total_Servicos;
          Parameters.ParamByName('Total_Desc_Acr').Value := Total_Desc_Acr;
          Parameters.ParamByName('Desc_Acr').Value := Desc_Acr;
          Parameters.ParamByName('Tipo_Desc_Acr').Value := Tipo_Desc_Acr;
          Parameters.ParamByName('Total_Pedido').Value := Total_Pedido;
          Parameters.ParamByName('Tipo').Value := Tipo;
          Parameters.ParamByName('Status').Value := Status;
          Parameters.ParamByName('Status_OS').Value := Status_OS;
          Parameters.ParamByName('Valor_Recebido').Value := Valor_Recebido;
          Parameters.ParamByName('Troco').Value := Troco;
          Parameters.ParamByName('Mesclada').Value := Mesclada;
          Parameters.ParamByName('Problema_Reclamado').Value :=
            Problema_Reclamado;
          Parameters.ParamByName('Problema_Constatado').Value :=
            Problema_Constatado;
          Parameters.ParamByName('Solucao').Value := Solucao;
          Parameters.ParamByName('DAVC').Value := DAVC;
          Parameters.ParamByName('DAVAnt').Value := DAVAnt;
          Parameters.ParamByName('Observacao').Value := Observacao;
          Parameters.ParamByName('Hora_Venda').Value := Hora_Venda;
          Parameters.ParamByName('Atualizou_Orcamento_Vencido').Value :=
            Atualizou_Orcamento_Vencido;
          Parameters.ParamByName('Data_Previsao_Entrega').Value :=
            Data_Previsao_Entrega;
          Parameters.ParamByName('Data_Entrega').Value := Data_Entrega;
          Parameters.ParamByName('Kilometragem').Value := Kilometragem;
          Parameters.ParamByName('ECF').Value := ECF;
          Parameters.ParamByName('Codigo_CFOP').Value := Codigo_CFOP;
          Parameters.ParamByName('Total_Impostos').Value := Total_Impostos;
          Parameters.ParamByName('Data_Emissao_NFe').Value := DataEmissaoNFe;
          ExecSQL;
        end;
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      Application.MessageBox(PChar('Erro: ' + E.Message), 'Erro',
        MB_OK + MB_ICONHAND);
      /// /DM.ADOConnection1.RollbackTrans;
    end;
  end;
end;

procedure TPedido.Salva_Banco_PDV(var Registro: TPedido);
var
  qAux, qaux2: TADOQuery;
begin
  try
    /// /DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      // dm.qryvenda.Close;
      // dm.qryvenda.Open;
      // dm.qryvenda.First;
      // while not dm.qryvenda.Eof do
      // begin
      with qAux, SQL do
      begin
        close;
        clear;
        // Connection:= dm.ADOConnection1;
        Connection := DM.ADOConnection1;
        add('INSERT INTO Pedido');
        add('           (Codigo');
        add('           ,N_Pedido');
        add('           ,N_Pre_Venda');
        add('           ,COO');
        add('           ,COO_Vin');
        add('           ,CCF');
        add('           ,Codigo_Cliente');
        add('           ,Codigo_Empresa');
        add('           ,Codigo_Veiculo');
        add('           ,Codigo_Funcionario');
        add('           ,Codigo_Tabela_Preco');
        add('           ,Codigo_Forma_Pag');
        add('           ,Data_Venda');
        add('           ,Data_Vencimento');
        add('           ,Qtde_Itens');
        add('           ,Qtde_Servicos');
        add('           ,Total_Produtos');
        add('           ,Total_Servicos');
        add('           ,Total_Desc_Acr');
        add('           ,Desc_Acr');
        add('           ,Tipo_Desc_Acr');
        add('           ,Total_Pedido');
        add('           ,Tipo');
        add('           ,Status');
        add('           ,Valor_Recebido');
        add('           ,Troco');
        add('           ,Mesclada');
        add('           ,Problema_Reclamado');
        add('           ,Problema_Constatado');
        add('           ,Solucao');
        add('           ,DAVC');
        add('           ,DAVAnt');
        add('           ,Observacao');
        add('           ,Hora_Venda)');
        add('     VALUES');
        add('           (:Codigo');
        add('           ,:N_Pedido');
        add('           ,:N_Pre_Venda');
        add('           ,:COO');
        add('           ,:COO_Vin');
        add('           ,:CCF');
        add('           ,:Codigo_Cliente');
        add('           ,:Codigo_Empresa');
        add('           ,:Codigo_Veiculo');
        add('           ,:Codigo_Funcionario');
        add('           ,:Codigo_Tabela_Preco');
        add('           ,:Codigo_Forma_Pag');
        add('           ,:Data_Venda');
        add('           ,:Data_Vencimento');
        add('           ,:Qtde_Itens');
        add('           ,:Qtde_Servicos');
        add('           ,:Total_Produtos');
        add('           ,:Total_Servicos');
        add('           ,:Total_Desc_Acr');
        add('           ,:Desc_Acr');
        add('           ,:Tipo_Desc_Acr');
        add('           ,:Total_Pedido');
        add('           ,:Tipo');
        add('           ,:Status');
        add('           ,:Valor_Recebido');
        add('           ,:Troco');
        add('           ,:Mesclada');
        add('           ,:Problema_Reclamado');
        add('           ,:Problema_Constatado');
        add('           ,:Solucao');
        add('           ,:DAVC');
        add('           ,:DAVAnt');
        add('           ,:Observacao');
        add('           ,:Hora_Venda)');

        Parameters.ParamByName('Codigo').Value := UDeclaracao.Codigo;
        Parameters.ParamByName('N_Pedido').Value := DM.qryvenda['N_Pedido'];
        Parameters.ParamByName('N_Pre_Venda').Value :=
          DM.qryvenda['N_Pre_Venda'];
        Parameters.ParamByName('COO').Value := DM.qryvenda['COO'];
        Parameters.ParamByName('COO_Vin').Value := DM.qryvenda['COO_Vin'];
        Parameters.ParamByName('CCF').Value := DM.qryvenda['CCF'];
        Parameters.ParamByName('Codigo_Cliente').Value :=
          DM.qryvenda['Codigo_Cliente'];
        Parameters.ParamByName('Codigo_Empresa').Value :=
          DM.qryvenda['Codigo_Empresa'];
        Parameters.ParamByName('Codigo_Veiculo').Value :=
          DM.qryvenda['Codigo_Veiculo'];
        Parameters.ParamByName('Codigo_Funcionario').Value :=
          DM.qryvenda['Codigo_Funcionario'];
        Parameters.ParamByName('Codigo_Tabela_Preco').Value :=
          DM.qryvenda['Codigo_Tabela_Preco'];
        Parameters.ParamByName('Codigo_Forma_Pag').Value :=
          DM.qryvenda['Codigo_Forma_Pag'];
        Parameters.ParamByName('Data_Venda').Value := DM.qryvenda['Data_Venda'];
        Parameters.ParamByName('Data_Vencimento').Value :=
          DM.qryvenda['Data_Vencimento'];
        Parameters.ParamByName('Qtde_Itens').Value := DM.qryvenda['Qtde_Itens'];
        Parameters.ParamByName('Qtde_Servicos').Value :=
          DM.qryvenda['Qtde_Servicos'];
        Parameters.ParamByName('Total_Produtos').Value :=
          DM.qryvenda['Total_Produtos'];
        Parameters.ParamByName('Total_Servicos').Value :=
          DM.qryvenda['Total_Servicos'];
        Parameters.ParamByName('Total_Desc_Acr').Value :=
          DM.qryvenda['Total_Desc_Acr'];
        Parameters.ParamByName('Desc_Acr').Value := DM.qryvenda['Desc_Acr'];
        Parameters.ParamByName('Tipo_Desc_Acr').Value :=
          DM.qryvenda['Tipo_Desc_Acr'];
        Parameters.ParamByName('Total_Pedido').Value :=
          DM.qryvenda['Total_Pedido'];
        Parameters.ParamByName('Tipo').Value := DM.qryvenda['Tipo'];
        Parameters.ParamByName('Status').Value := DM.qryvenda['Status'];
        Parameters.ParamByName('Valor_Recebido').Value :=
          DM.qryvenda['Valor_Recebido'];
        Parameters.ParamByName('Troco').Value := DM.qryvenda['Troco'];
        Parameters.ParamByName('Mesclada').Value := DM.qryvenda['Mesclada'];
        Parameters.ParamByName('Problema_Reclamado').Value :=
          DM.qryvenda['Problema_Reclamado'];
        Parameters.ParamByName('Problema_Constatado').Value :=
          DM.qryvenda['Problema_Constatado'];
        Parameters.ParamByName('Solucao').Value := DM.qryvenda['Solucao'];
        Parameters.ParamByName('DAVC').Value := DM.qryvenda['DAVC'];
        Parameters.ParamByName('DAVAnt').Value := DM.qryvenda['DAVAnt'];
        Parameters.ParamByName('Observacao').Value := DM.qryvenda['Observacao'];
        Parameters.ParamByName('Hora_Venda').Value := DM.qryvenda['Hora_Venda'];
        ExecSQL;
      end;
      // dm.qryvenda.Next;
      // end;
    finally
      /// /DM.ADOConnection1.CommitTrans;
      // qAux.Close;
      // FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      ShowMessage(E.Message);
      /// /DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TItens_Pedido }

procedure TItens_Pedido.Atualiza_Itens(var Registro: TItens_Pedido;
  Conexao: TADOConnection);
var
  qAux: TADOQuery;
begin
  try
    /// /DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);

      with qAux, SQL do
      begin
        close;
        Connection := FrmCarrega_Pedido_Caixa.Conexao;
        clear;
        add('Update Itens_Pedido set N_Item = :N_Item');
        add('where Codigo = :Codigo and Codigo_Produto = :Codigo_Produto');

        Parameters.ParamByName('N_Item').Value := UDeclaracao.N_Item;

        if (FrmCarrega_Pedido_Caixa.cancela_pre = true) then
          Parameters.ParamByName('Codigo').Value :=
            FrmCarrega_Pedido_Caixa.qTemp3.FieldByName
            ('Codigo_Pre_Venda_Antiga').AsString
        else
          Parameters.ParamByName('Codigo').Value :=
            FrmCarrega_Pedido_Caixa.qrycarrega_caixaCodigo.AsString;

        if (FrmCarrega_Pedido_Caixa.cancela_pre = true) then
          Parameters.ParamByName('Codigo_Produto').Value :=
            FrmCarrega_Pedido_Caixa.qTemp2.FieldByName('Codigo_Produto')
            .AsInteger
        else
          Parameters.ParamByName('Codigo_Produto').Value :=
            FrmCarrega_Pedido_Caixa.qAux.FieldByName('Codigo').AsInteger;
        ExecSQL;
        /// /DM.ADOConnection1.CommitTrans;
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      /// /DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TItens_Pedido.Excluir(Codigo: integer; var Conexao: TADOConnection);
var
  qAux, qaux2: TADOQuery;
begin
  try
    /// /DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := Conexao;
        add('Delete from Itens_Pedido where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Codigo;
        ExecSQL;
        /// /DM.ADOConnection1.CommitTrans;
        // lrControle:= Exclui;
        // UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      TMensagens.MensagemErro('Erro: ' + E.Message);
      TLog.Error('Erro ao excluir itens de pedido: ' + E.Message);
    end;
  end;
end;

procedure TItens_Pedido.ExcluirLocal(var Registro: TItens_Pedido);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnectionLocal.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnectionLocal;
        add('Delete from Itens_Pedido');
        ExecSQL;
        // DM.ADOConnectionLocal.CommitTrans;
        // lrControle:= Exclui;
        // UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnectionLocal.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TItens_Pedido.Salva_Banco(var Conexao: TADOConnection;
  lOUs: Ansistring; Tipo_Op: Ansistring; Codigo: integer; N_Item: Ansistring;
  Codigo_Produto: integer; Codigo_Venda: Ansistring; Descricao: Ansistring;
  NCM: Ansistring; Origem: Ansistring; CFOP: Ansistring; Un: Ansistring;
  Tipo_Calculo_BC_ICMS: Ansistring; Tipo_Recolhimento: Ansistring;
  ICMS: Ansistring; CST: Ansistring; CSOSN: Ansistring;
  Base_Reduzida: Ansistring; BC: Ansistring; Valor_ICMS: Ansistring;
  Tipo_Calculo_BC_ICMS_ST: Ansistring; MVAST: Ansistring; ICMST_ST: Ansistring;
  CST_ST: Ansistring; Base_Reduzida_ST: Ansistring;
  Base_Acrescida_ST: Ansistring; BC_ST: Ansistring; Valor_ICMS_ST: double;
  Aliquota_Calculo_Credito: Ansistring; Credito_ICMS: Ansistring;
  Tipo_Calculo_IPI: Ansistring; IPI: Ansistring; CST_IPI: Ansistring;
  Base_Reduzida_IPI: Ansistring; Base_Acrescida_IPI: Ansistring;
  BC_IPI: Ansistring; Valor_IPI: double; Tipo_Calculo_PIS: Ansistring;
  PIS: Ansistring; CST_PIS: Ansistring; Base_Reduzida_PIS: Ansistring;
  Base_Acrescida_PIS: Ansistring; BC_PIS: Ansistring; Valor_PIS: double;
  Tipo_Calculo_COFINS: Ansistring; COFINS: Ansistring; CST_COFINS: Ansistring;
  Base_Reduzida_COFINS: Ansistring; Base_Acrescida_COFINS: Ansistring;
  BC_COFINS: Ansistring; Valor_COFINS: double; Qtde: double;
  Qtde_Entregue: double; Qtde_Restante: double; Qtde_S_Previsao: double;
  Valor_Compra: double; Valor_Original: double; Valor_Unitario: double;
  Desc_Acr: double; Desc_Acr_P: double; Tipo_Desc_Acr: Ansistring;
  dOUa: Ansistring; Valor_Frete: double; Valor_Seguro: double;
  Outras_Despesas: double; Sub_Total: double; Sub_Total_Liquido: double;
  Cancelado: Ansistring; Indica_Valor_Total: Ansistring; Data_Entrega: Tdate;
  Hora_Entrega: Ansistring; Tipo_Venda: Ansistring; Tipo_Entrega: Ansistring;
  Comissao: double; Perc_Desc_Vista: double; Perc_Desc_Prazo: double;
  Permite_Credito: integer; Codigo_Obs_Fiscal: integer;
  Qtde_Estoque_Atual: double; Valor_Compra_Nota: double);
var
  qAux, qaux2: TADOQuery;
begin
  try

    { if not (dm.ADOConnection1.InTransaction) then
      begin
      //DM.ADOConnection1.BeginTrans;
      end; }

    try
      qAux := TADOQuery.Create(nil);
      begin
        with qAux, SQL do
        begin
          close;

          if (lOUs = 'S') then
            Connection := Conexao
          else if (lOUs = 'L') then
            Connection := DM.ADOConnectionLocal;

          clear;

          if (Tipo_Op = 'I') then
          begin
            add('INSERT INTO Itens_Pedido');
            add('           (Codigo,N_Item,Codigo_Produto,Codigo_Venda,Descricao,NCM,Origem,CFOP,UN,Tipo_Calculo_BC_ICMS,Tipo_Recolhimento');
            add('           ,ICMS,CST,CSOSN,Base_Reduzida,BC,Valor_ICMS,Tipo_Calculo_BC_ICMS_ST');
            add('           ,MVAST,ICMS_ST,CST_ST,Base_Reduzida_ST,Base_Acrescida_ST,BC_ST,Valor_ICMS_ST,Aliquota_Calculo_Credito,Credito_ICMS');
            add('           ,Tipo_Calculo_IPI,IPI,CST_IPI,Base_Reduzida_IPI,Base_Acrescida_IPI,BC_IPI,Valor_IPI,Tipo_Calculo_PIS,PIS');
            add('           ,CST_PIS,Base_Reduzida_PIS,Base_Acrescida_PIS,BC_PIS,Valor_PIS,Tipo_Calculo_COFINS,COFINS,CST_COFINS,Base_Reduzida_COFINS');
            add('           ,Base_Acrescida_COFINS,BC_COFINS,Valor_COFINS,Qtde,Qtde_Entregue,Qtde_Restante,Qtde_S_Previsao');
            add('           ,Valor_Compra,Valor_Original,Valor_Unitario,Desc_Acr,Desc_Acr_P,Tipo_Desc_Acr,dOUa,Valor_Frete,Valor_Seguro');
            add('           ,Outras_Despesas,Sub_Total,Sub_Total_Liquido,Cancelado,Indica_Valor_Total,Data_Entrega,Hora_Entrega');
            add('           ,Tipo_Venda,Tipo_Entrega,Comissao, Perc_Desc_Vista, Perc_Desc_Prazo, Permite_Credito, Codigo_Obs_Fiscal, Qtde_Estoque_Atual, Valor_Compra_Nota)');
            add('     VALUES');
            add('           (:Codigo,:N_Item,:Codigo_Produto,:Codigo_Venda,:Descricao,:NCM,:Origem,:CFOP,:UN,:Tipo_Calculo_BC_ICMS,:Tipo_Recolhimento');
            add('           ,:ICMS,:CST,:CSOSN,:Base_Reduzida,:BC,:Valor_ICMS,:Tipo_Calculo_BC_ICMS_ST');
            add('           ,:MVAST,:ICMS_ST,:CST_ST,:Base_Reduzida_ST,:Base_Acrescida_ST,:BC_ST,:Valor_ICMS_ST,:Aliquota_Calculo_Credito,:Credito_ICMS');
            add('           ,:Tipo_Calculo_IPI,:IPI,:CST_IPI,:Base_Reduzida_IPI,:Base_Acrescida_IPI,:BC_IPI,:Valor_IPI,:Tipo_Calculo_PIS,:PIS');
            add('           ,:CST_PIS,:Base_Reduzida_PIS,:Base_Acrescida_PIS,:BC_PIS,:Valor_PIS,:Tipo_Calculo_COFINS,:COFINS,:CST_COFINS,:Base_Reduzida_COFINS');
            add('           ,:Base_Acrescida_COFINS,:BC_COFINS,:Valor_COFINS,:Qtde,:Qtde_Entregue,:Qtde_Restante,:Qtde_S_Previsao');
            add('           ,:Valor_Compra,:Valor_Original,:Valor_Unitario,:Desc_Acr,:Desc_Acr_P,:Tipo_Desc_Acr,:dOUa,:Valor_Frete,:Valor_Seguro');
            add('           ,:Outras_Despesas,:Sub_Total,:Sub_Total_Liquido,:Cancelado,:Indica_Valor_Total,:Data_Entrega,:Hora_Entrega');
            add('           ,:Tipo_Venda,:Tipo_Entrega,:Comissao, :Perc_Desc_Vista, :Perc_Desc_Prazo, :Permite_Credito, :Codigo_Obs_Fiscal, :Qtde_Estoque_Atual, :Valor_Compra_Nota)');
          end
          else
          begin
            add('           UPDATE Itens_Pedido');
            add('              SET Codigo_Venda = :Codigo_Venda,Descricao = :Descricao,NCM = :NCM,Origem = :Origem,CFOP = :CFOP,UN = :UN,Tipo_Calculo_BC_ICMS = :Tipo_Calculo_BC_ICMS,Tipo_Recolhimento = :Tipo_Recolhimento');
            add('                 ,ICMS = :ICMS,CST = :CST,CSOSN = :CSOSN,Base_Reduzida = :Base_Reduzida,BC = :BC,Valor_ICMS = :Valor_ICMS');
            add('                 ,Tipo_Calculo_BC_ICMS_ST = :Tipo_Calculo_BC_ICMS_ST,MVAST = :MVAST,ICMS_ST = :ICMS_ST,CST_ST = :CST_ST,Base_Reduzida_ST = :Base_Reduzida_ST');
            add('                 ,Base_Acrescida_ST = :Base_Acrescida_ST,BC_ST = :BC_ST,Valor_ICMS_ST = :Valor_ICMS_ST,Aliquota_Calculo_Credito = :Aliquota_Calculo_Credito,Credito_ICMS = :Credito_ICMS,Tipo_Calculo_IPI = :Tipo_Calculo_IPI');
            add('                 ,IPI = :IPI,CST_IPI = :CST_IPI,Base_Reduzida_IPI = :Base_Reduzida_IPI,Base_Acrescida_IPI = :Base_Acrescida_IPI,BC_IPI = :BC_IPI,Valor_IPI = :Valor_IPI,Tipo_Calculo_PIS = :Tipo_Calculo_PIS');
            add('                 ,PIS = :PIS,CST_PIS = :CST_PIS,Base_Reduzida_PIS = :Base_Reduzida_PIS,Base_Acrescida_PIS = :Base_Acrescida_PIS,BC_PIS = :BC_PIS,Valor_PIS = :Valor_PIS,Tipo_Calculo_COFINS = :Tipo_Calculo_COFINS');
            add('                 ,COFINS = :COFINS,CST_COFINS = :CST_COFINS,Base_Reduzida_COFINS = :Base_Reduzida_COFINS,Base_Acrescida_COFINS = :Base_Acrescida_COFINS,BC_COFINS = :BC_COFINS,Valor_COFINS = :Valor_COFINS');
            add('                 ,Qtde = :Qtde,Qtde_Entregue = :Qtde_Entregue,Qtde_Restante = :Qtde_Restante,Qtde_S_Previsao = :Qtde_S_Previsao,Valor_Compra = :Valor_Compra,Valor_Original = :Valor_Original,Valor_Unitario = :Valor_Unitario');
            add('                 ,Desc_Acr = :Desc_Acr,Desc_Acr_P = :Desc_Acr_P,Tipo_Desc_Acr = :Tipo_Desc_Acr,dOUa = :dOUa,Valor_Frete = :Valor_Frete,Valor_Seguro = :Valor_Seguro,Outras_Despesas = :Outras_Despesas,Sub_Total = :Sub_Total');
            add('                 ,Sub_Total_Liquido = :Sub_Total_Liquido,Cancelado = :Cancelado,Indica_Valor_Total = :Indica_Valor_Total,Data_Entrega = :Data_Entrega,Hora_Entrega = :Hora_Entrega,Tipo_Venda = :Tipo_Venda');
            add('                 ,Tipo_Entrega = :Tipo_Entrega,Comissao = :Comissao, Perc_Desc_Vista = :Perc_Desc_Vista, Perc_Desc_Prazo = :Perc_Desc_Prazo, Permite_Credito = :Permite_Credito, Codigo_Obs_Fiscal = :Codigo_Obs_Fiscal,');
            add('Qtde_Estoque_Atual = :Qtde_Estoque_Atual, Valor_Compra_Nota = :Valor_Compra_Nota');
            add('where Codigo = :Codigo and Codigo_Produto = :Codigo_Produto');
          end;

          Parameters.ParamByName('Codigo').Value := Codigo;
          Parameters.ParamByName('Codigo_Produto').Value := Codigo_Produto;

          if (Tipo_Op = 'I') then
          begin
            Parameters.ParamByName('N_Item').Value := N_Item;
          end;
          Parameters.ParamByName('Codigo_Venda').Value := Codigo_Venda;
          Parameters.ParamByName('Descricao').Value := Descricao;
          Parameters.ParamByName('NCM').Value := NCM;
          Parameters.ParamByName('Origem').Value := Origem;
          Parameters.ParamByName('CFOP').Value := CFOP;
          Parameters.ParamByName('UN').Value := Un;

          Parameters.ParamByName('Tipo_Calculo_BC_ICMS').Value :=
            Tipo_Calculo_BC_ICMS;
          Parameters.ParamByName('Tipo_Recolhimento').Value :=
            Tipo_Recolhimento;
          Parameters.ParamByName('ICMS').Value := ICMS;
          Parameters.ParamByName('CST').Value := CST;
          Parameters.ParamByName('CSOSN').Value := CSOSN;
          Parameters.ParamByName('Base_Reduzida').Value := Base_Reduzida;
          Parameters.ParamByName('BC').Value := BC;
          Parameters.ParamByName('Valor_ICMS').Value := Valor_ICMS;

          Parameters.ParamByName('Tipo_Calculo_BC_ICMS_ST').Value :=
            Tipo_Calculo_BC_ICMS_ST;
          Parameters.ParamByName('MVAST').Value := MVAST;
          Parameters.ParamByName('ICMS_ST').Value := ICMS_ST;
          Parameters.ParamByName('CST_ST').Value := CST_ST;
          Parameters.ParamByName('Base_Reduzida_ST').Value := Base_Reduzida_ST;
          Parameters.ParamByName('Base_Acrescida_ST').Value :=
            Base_Acrescida_ST;
          Parameters.ParamByName('BC_ST').Value := BC_ST;
          Parameters.ParamByName('Valor_ICMS_ST').Value := Valor_ICMS_ST;

          Parameters.ParamByName('Aliquota_Calculo_Credito').Value :=
            Aliquota_Calculo_Credito;
          Parameters.ParamByName('Credito_ICMS').Value := Credito_ICMS;

          Parameters.ParamByName('Tipo_Calculo_IPI').Value := Tipo_Calculo_IPI;
          Parameters.ParamByName('IPI').Value := IPI;
          Parameters.ParamByName('CST_IPI').Value := CST_IPI;
          Parameters.ParamByName('Base_Reduzida_IPI').Value :=
            Base_Reduzida_IPI;
          Parameters.ParamByName('Base_Acrescida_IPI').Value :=
            Base_Acrescida_IPI;
          Parameters.ParamByName('BC_IPI').Value := BC_IPI;
          Parameters.ParamByName('Valor_IPI').Value := Valor_IPI;

          Parameters.ParamByName('Tipo_Calculo_PIS').Value := Tipo_Calculo_PIS;
          Parameters.ParamByName('PIS').Value := PIS;
          Parameters.ParamByName('CST_PIS').Value := CST_PIS;
          Parameters.ParamByName('Base_Reduzida_PIS').Value :=
            Base_Reduzida_PIS;
          Parameters.ParamByName('Base_Acrescida_PIS').Value :=
            Base_Acrescida_PIS;
          Parameters.ParamByName('BC_PIS').Value := BC_PIS;
          Parameters.ParamByName('Valor_PIS').Value := Valor_PIS;

          Parameters.ParamByName('Tipo_Calculo_COFINS').Value :=
            Tipo_Calculo_COFINS;
          Parameters.ParamByName('COFINS').Value := COFINS;
          Parameters.ParamByName('CST_COFINS').Value := CST_COFINS;
          Parameters.ParamByName('Base_Reduzida_COFINS').Value :=
            Base_Reduzida_COFINS;
          Parameters.ParamByName('Base_Acrescida_COFINS').Value :=
            Base_Acrescida_COFINS;
          Parameters.ParamByName('BC_COFINS').Value := BC_COFINS;
          Parameters.ParamByName('Valor_COFINS').Value := Valor_COFINS;

          Parameters.ParamByName('Qtde').Value := Qtde;
          Parameters.ParamByName('Qtde_Entregue').Value := Qtde_Entregue;
          Parameters.ParamByName('Qtde_Restante').Value := Qtde_Restante;
          Parameters.ParamByName('Qtde_S_Previsao').Value := Qtde_S_Previsao;
          Parameters.ParamByName('Valor_Compra').Value := Valor_Compra;
          Parameters.ParamByName('Valor_Original').Value := Valor_Original;
          Parameters.ParamByName('Valor_Unitario').Value := Valor_Unitario;
          Parameters.ParamByName('Desc_Acr').Value := Desc_Acr;
          Parameters.ParamByName('Desc_Acr_P').Value := Desc_Acr_P;
          Parameters.ParamByName('Tipo_Desc_Acr').Value := Tipo_Desc_Acr;
          Parameters.ParamByName('dOUa').Value := dOUa;
          Parameters.ParamByName('Valor_Frete').Value := Valor_Frete;
          Parameters.ParamByName('Valor_Seguro').Value := Valor_Seguro;
          Parameters.ParamByName('Outras_Despesas').Value := Outras_Despesas;
          Parameters.ParamByName('Sub_Total').Value := Sub_Total;
          Parameters.ParamByName('Sub_Total_Liquido').Value :=
            Sub_Total_Liquido;
          Parameters.ParamByName('Cancelado').Value := Cancelado;
          Parameters.ParamByName('Indica_Valor_Total').Value :=
            Indica_Valor_Total;

          Parameters.ParamByName('Data_Entrega').Value := Data_Entrega;

          Parameters.ParamByName('Hora_Entrega').Value := '';
          Parameters.ParamByName('Tipo_Venda').Value := Tipo_Venda;
          Parameters.ParamByName('Tipo_Entrega').Value := Tipo_Entrega;
          Parameters.ParamByName('Comissao').Value := Comissao;
          Parameters.ParamByName('Perc_Desc_Vista').Value := Perc_Desc_Vista;
          Parameters.ParamByName('Perc_Desc_Prazo').Value := Perc_Desc_Prazo;
          Parameters.ParamByName('Permite_Credito').Value := Permite_Credito;
          Parameters.ParamByName('Codigo_Obs_Fiscal').Value :=
            Codigo_Obs_Fiscal;
          Parameters.ParamByName('Qtde_Estoque_Atual').Value :=
            Qtde_Estoque_Atual;
          Parameters.ParamByName('Valor_Compra_Nota').Value :=
            Valor_Compra_Nota;

          ExecSQL;

          // if (FrmPedido_Venda = nil) then
          // DM.ADOConnection1.CommitTrans
          // else
          // qAux.Post;

        end;
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      /// /DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TItens_Pedido.Salva_Banco_PDV(var Registro: TItens_Pedido);
var
  qAux, qaux2: TADOQuery;
  Estoque: double;
begin
  try
    qAux := TADOQuery.Create(nil);
    qaux2 := TADOQuery.Create(nil);

    with DM.qryitens_venda, SQL do
    begin
      close;
      Connection := DM.ADOConnectionLocal;
      clear;
      add('select * from Itens_Pedido IP');
      add('where IP.Codigo = :Codigo');
      Parameters.ParamByName('Codigo').Value := DM.qryvendaCodigo.AsInteger;
      open;
    end;

    while not DM.qryitens_venda.Eof do
    begin

      with qaux2, SQL do
      begin
        close;
        Connection := DM.ADOConnection1;
        clear;
        add('select P.Codigo, P.Estoque, P.Valor_Medio, P.Valor_Compra, P.Volume from Produto P');
        open;
      end;

      qaux2.Locate('Codigo', DM.qryitens_vendaCodigo_Produto.AsInteger, []);

      try
        Salva_Banco(DM.ADOConnection1, 'S', 'I', UDeclaracao.Codigo,
          DM.qryitens_venda['N_Item'], DM.qryitens_venda['Codigo_Produto'],
          DM.qryitens_venda['Codigo_Venda'], DM.qryitens_venda['Descricao'],
          DM.qryitens_venda['NCM'], DM.qryitens_venda['Origem'],
          DM.qryitens_venda['CFOP'], DM.qryitens_venda['UN'],
          DM.qryitens_venda['Tipo_Calculo_BC_ICMS'],
          DM.qryitens_venda['Tipo_Recolhimento'], DM.qryitens_venda['ICMS'],
          DM.qryitens_venda['CST'], DM.qryitens_venda['CSOSN'],
          DM.qryitens_venda['Base_Reduzida'], DM.qryitens_venda['BC'],
          DM.qryitens_venda['Valor_ICMS'],
          DM.qryitens_venda['Tipo_Calculo_BC_ICMS_ST'],
          DM.qryitens_venda['MVAST'], DM.qryitens_venda['ICMS_ST'],
          DM.qryitens_venda['CST_ST'], DM.qryitens_venda['Base_Reduzida_ST'],
          DM.qryitens_venda['Base_Acrescida_ST'], DM.qryitens_venda['BC_ST'],
          DM.qryitens_venda['Valor_ICMS_ST'],
          DM.qryitens_venda['Aliquota_Calculo_Credito'],
          DM.qryitens_venda['Credito_ICMS'],
          DM.qryitens_venda['Tipo_Calculo_IPI'], DM.qryitens_venda['IPI'],
          DM.qryitens_venda['CST_IPI'], DM.qryitens_venda['Base_Reduzida_IPI'],
          DM.qryitens_venda['Base_Acrescida_IPI'], DM.qryitens_venda['BC_IPI'],
          DM.qryitens_venda['Valor_IPI'], DM.qryitens_venda['Tipo_Calculo_PIS'],
          DM.qryitens_venda['PIS'], DM.qryitens_venda['CST_PIS'],
          DM.qryitens_venda['Base_Reduzida_PIS'],
          DM.qryitens_venda['Base_Acrescida_PIS'], DM.qryitens_venda['BC_PIS'],
          DM.qryitens_venda['Valor_PIS'],
          DM.qryitens_venda['Tipo_Calculo_COFINS'], DM.qryitens_venda['COFINS'],
          DM.qryitens_venda['CST_COFINS'],
          DM.qryitens_venda['Base_Reduzida_COFINS'],
          DM.qryitens_venda['Base_Acrescida_COFINS'],
          DM.qryitens_venda['BC_COFINS'], DM.qryitens_venda['Valor_COFINS'],
          DM.qryitens_venda['Qtde'], DM.qryitens_venda['Qtde_Entregue'],
          DM.qryitens_venda['Qtde_Restante'],
          DM.qryitens_venda['Qtde_S_Previsao'],
          DM.qryitens_venda['Valor_Compra'],
          DM.qryitens_venda['Valor_Original'],
          DM.qryitens_venda['Valor_Unitario'], DM.qryitens_venda['Desc_Acr'],
          DM.qryitens_venda['Desc_Acr_P'], DM.qryitens_venda['Tipo_Desc_Acr'],
          DM.qryitens_venda['dOUa'], DM.qryitens_venda['Valor_Frete'],
          DM.qryitens_venda['Valor_Seguro'],
          DM.qryitens_venda['Outras_Despesas'], DM.qryitens_venda['Sub_Total'],
          DM.qryitens_venda['Sub_Total_Liquido'],
          DM.qryitens_venda['Cancelado'],
          DM.qryitens_venda['Indica_Valor_Total'],
          DM.qryitens_venda['Data_Entrega'], DM.qryitens_venda['Hora_Entrega'],
          DM.qryitens_venda['Tipo_Venda'], DM.qryitens_venda['Tipo_Entrega'],
          DM.qryitens_venda['Comissao'], DM.qryitens_venda['Perc_Desc_Vista'],
          DM.qryitens_venda['Perc_Desc_Prazo'],
          DM.qryitens_venda['Permite_Credito'],
          DM.qryitens_venda['Codigo_Obs_Fiscal'],
          DM.qryitens_venda['Qtde_Estoque_Atual'],
          DM.qryitens_venda['Valor_Compra_Nota']);

        if (FrmPDV.quero_cancelar = false) and
          (DM.qryitens_vendaCancelado.AsString = 'N') and (gerar_estoque = 0)
        then
        begin
          Estoque := qaux2.FieldByName('Estoque').AsFloat - DM.qryitens_vendaQtde.AsFloat;

          { Insere_Movimentacao_Estoque(UDeclaracao.Codigo_Empresa,
            qaux2.FieldByName('Codigo').AsInteger,
            DM.qryitens_vendaCodigo_Venda.AsString,
            DM.qryitens_vendaDescricao.AsString, 'SADA', date,
            qaux2.FieldByName('Estoque').AsFloat,
            DM.qryitens_vendaQtde.AsFloat,
            DM.qryitens_vendaValor_Unitario.AsFloat,
            (DM.qryitens_vendaQtde.AsFloat *
            DM.qryitens_vendaValor_Unitario.AsFloat),
            qaux2.FieldByName('Valor_Medio').AsFloat, Estoque,
            (qaux2.FieldByName('Valor_Medio').AsFloat * Estoque)); }

          Atualiza_Saldo_Estoque(dm.ADOConnection1, qaux2.FieldByName('Codigo').AsInteger,
            qaux2.FieldByName('Valor_Compra').AsFloat * Estoque);
          Atualiza_Estoque(dm.ADOConnection1, Estoque, qaux2.FieldByName('Codigo').AsInteger);
          Atualiza_Volume(dm.ADOConnection1, Estoque * qaux2.FieldByName('Volume').AsFloat,
            qaux2.FieldByName('Codigo').AsInteger);

          AtualizaMD51(qaux2.FieldByName('Codigo').AsInteger,
            GeraMD5([DM.qryitens_venda['Codigo_Venda'],
            DM.qryitens_venda['Descricao'],
            FloatToStr( estoque)]));

          Calcula_Estoque_Fabricacao(DM.qryitens_venda['Codigo_Produto'], DM.qryitens_venda['Qtde'],
                                     Date, DM.ADOConnection1);

        end;
      except
        on E: Exception do
        begin
          ShowMessage(E.Message);
        end;
      end;

      DM.qryitens_venda.Next;
    end;

    { finally
      //DM.ADOConnection1.CommitTrans;
      qAux.Close;
      FreeAndNil(qAux);
      end; }

  except
    on E: Exception do
    begin
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TCadastro_CFOP }

procedure TCadastro_CFOP.Alterar(var Registro: TCadastro_CFOP);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      begin
        with qAux, SQL do
        begin
          close;
          clear;
          Connection := DM.ADOConnection1;
          add('Update Cadastro_CFOP set CFOP = :CFOP, Descricao = :Descricao, Data_Cadastro = :Data_Cadastro,');
          add('Mostrar_Imposto = :Mostrar_Imposto, Gera_Financeiro = :Gera_Financeiro, Controla_Estoque = :Controla_Estoque, Estoque = :Estoque, Faturar_NFe = :Faturar_NFe');
          add('where Codigo = :Codigo');
          Parameters.ParamByName('Codigo').Value := Registro.Cod;
          Parameters.ParamByName('CFOP').Value := Registro.CFO;
          Parameters.ParamByName('Descricao').Value := Registro.Desc;
          Parameters.ParamByName('Data_Cadastro').Value := Registro.Data_Cad;
          if (FrmCadastro_CFOP.CBMostra_Imposto.Checked) then
            Parameters.ParamByName('Mostrar_Imposto').Value := 0
          else
            Parameters.ParamByName('Mostrar_Imposto').Value := 1;

          if (FrmCadastro_CFOP.CBGera_Financeiro.Checked) then
            Parameters.ParamByName('Gera_Financeiro').Value := 0
          else
            Parameters.ParamByName('Gera_Financeiro').Value := 1;

          if (FrmCadastro_CFOP.CBControla_Estoque.Checked) then
            Parameters.ParamByName('Controla_Estoque').Value := 0
          else
            Parameters.ParamByName('Controla_Estoque').Value := 1;

          Parameters.ParamByName('Estoque').Value :=
            FrmCadastro_CFOP.RGEstoque.ItemIndex;
          if (FrmCadastro_CFOP.CBFatura.Checked) then
            Parameters.ParamByName('Faturar_NFe').Value := 0
          else
            Parameters.ParamByName('Faturar_NFe').Value := 1;

          ExecSQL;
        end;
      end;
    finally
      // DM.ADOConnection1.CommitTrans;
      qAux.close;
      FreeAndNil(qAux);
      lrControle := Altera;
      UGeral.Mensagem_Padrao(lrControle);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TCadastro_CFOP.Excluir(var Registro: TCadastro_CFOP);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Delete from Cadastro_CFOP where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        ExecSQL;
      end;
    finally
      // DM.ADOConnection1.CommitTrans;
      lrControle := Exclui;
      UGeral.Mensagem_Padrao(lrControle);
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

function TCadastro_CFOP.GetCFOP: string;
begin
  GetCFOP := FrmCadastro_CFOP.MEdtCFOP.Text;
end;

function TCadastro_CFOP.GetCodigo: integer;
begin
  GetCodigo := StrToInt(FrmCadastro_CFOP.EdtCodigo.Text);
end;

function TCadastro_CFOP.GetData_Cadastro: Tdate;
begin
  GetData_Cadastro := StrToDateTime(FrmCadastro_CFOP.MEdtData_Cadastro.Text);
end;

function TCadastro_CFOP.GetDescricao: string;
begin
  GetDescricao := FrmCadastro_CFOP.EdtDescricao.Text;
end;

procedure TCadastro_CFOP.Inserir(var Registro: TCadastro_CFOP);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      begin
        with qAux, SQL do
        begin
          close;
          clear;
          Connection := DM.ADOConnection1;
          add('Insert into Cadastro_CFOP (CFOP, Descricao, Data_Cadastro, Mostrar_Imposto, Gera_Financeiro, Controla_Estoque, Estoque, Faturar_NFe)');
          add('values (:CFOP, :Descricao, :Data_Cadastro, :Mostrar_Imposto, :Gera_Financeiro, :Controla_Estoque, :Estoque, :Faturar_NFe)');
          Parameters.ParamByName('CFOP').Value := Registro.CFO;
          Parameters.ParamByName('Descricao').Value := Registro.Desc;
          Parameters.ParamByName('Data_Cadastro').Value := Registro.Data_Cad;

          if (FrmCadastro_CFOP.CBMostra_Imposto.Checked) then
            Parameters.ParamByName('Mostrar_Imposto').Value := 0
          else
            Parameters.ParamByName('Mostrar_Imposto').Value := 1;

          if (FrmCadastro_CFOP.CBGera_Financeiro.Checked) then
            Parameters.ParamByName('Gera_Financeiro').Value := 0
          else
            Parameters.ParamByName('Gera_Financeiro').Value := 1;

          if (FrmCadastro_CFOP.CBControla_Estoque.Checked) then
            Parameters.ParamByName('Controla_Estoque').Value := 0
          else
            Parameters.ParamByName('Controla_Estoque').Value := 1;

          Parameters.ParamByName('Estoque').Value :=
            FrmCadastro_CFOP.RGEstoque.ItemIndex;

          if (FrmCadastro_CFOP.CBFatura.Checked) then
            Parameters.ParamByName('Faturar_NFe').Value := 0
          else
            Parameters.ParamByName('Faturar_NFe').Value := 1;

          ExecSQL;
        end;
      end;
    finally
      // DM.ADOConnection1.CommitTrans;
      qAux.close;
      FreeAndNil(qAux);
      lrControle := Insere;
      UGeral.Mensagem_Padrao(lrControle);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TCadastro_Situacao_Tributaria }

procedure TCadastro_Situacao_Tributaria.Alterar(var Registro
  : TCadastro_Situacao_Tributaria);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      begin
        with qAux, SQL do
        begin
          close;
          clear;
          Connection := DM.ADOConnection1;
          add('Update Cadastro_Situacao_Tributaria set Origem = :Origem, Codigo_Situacao = :Codigo_Situacao, ');
          add('Descricao = :Descricao, Codigo_CSOSN = :Codigo_CSOSN, Descricao_CSOSN = :Descricao_CSOSN, Data_Cadastro = :Data_Cadastro,');
          add('Permite_Credito = :Permite_Credito, Codigo_Obs_Fiscal = :Codigo_Obs_Fiscal');
          add('where Codigo = :Codigo');
          Parameters.ParamByName('Codigo').Value := Registro.Cod;
          Parameters.ParamByName('Origem').Value := Registro.Orig;
          Parameters.ParamByName('Codigo_Situacao').Value :=
            Registro.Codigo_Sit;
          Parameters.ParamByName('Descricao').Value := Registro.Desc;
          Parameters.ParamByName('Codigo_CSOSN').Value :=
            FrmCadastro_Situacao_Tributaria.EdtCSOSN.Text;
          Parameters.ParamByName('Descricao_CSOSN').Value :=
            FrmCadastro_Situacao_Tributaria.EdtDescricao_CSOSN.Text;
          Parameters.ParamByName('Data_Cadastro').Value := Registro.Data_Cad;
          Parameters.ParamByName('Permite_Credito').Value :=
            FrmCadastro_Situacao_Tributaria.RGPermite_Credito.ItemIndex;

          if (FrmCadastro_Situacao_Tributaria.EdtCodigo_Observacao_Fiscal.Text
            <> '') then
            Parameters.ParamByName('Codigo_Obs_Fiscal').Value :=
              StrToInt(FrmCadastro_Situacao_Tributaria.
              EdtCodigo_Observacao_Fiscal.Text)
          else
            Parameters.ParamByName('Codigo_Obs_Fiscal').Value := 0;
          ExecSQL;
        end;
      end;
    finally
      // DM.ADOConnection1.CommitTrans;
      qAux.close;
      FreeAndNil(qAux);
      lrControle := Altera;
      UGeral.Mensagem_Padrao(lrControle);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TCadastro_Situacao_Tributaria.Excluir(var Registro
  : TCadastro_Situacao_Tributaria);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Delete from Cadastro_Situacao_Tributaria where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        ExecSQL;
      end;
    finally
      // DM.ADOConnection1.CommitTrans;
      lrControle := Exclui;
      UGeral.Mensagem_Padrao(lrControle);
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

function TCadastro_Situacao_Tributaria.GetCodigo: integer;
begin
  GetCodigo := StrToInt(FrmCadastro_Situacao_Tributaria.EdtCodigo.Text);
end;

function TCadastro_Situacao_Tributaria.GetCodigo_Situacao: string;
begin
  GetCodigo_Situacao := FrmCadastro_Situacao_Tributaria.EdtCodigo_Situacao.Text;
end;

function TCadastro_Situacao_Tributaria.GetData_Cadastro: Tdate;
begin
  GetData_Cadastro := StrToDateTime
    (FrmCadastro_Situacao_Tributaria.MEdtData_Cadastro.Text);
end;

function TCadastro_Situacao_Tributaria.GetDescricao: string;
begin
  GetDescricao := FrmCadastro_Situacao_Tributaria.EdtDescricao.Text;
end;

function TCadastro_Situacao_Tributaria.GetOrigem: integer;
begin
  GetOrigem := StrToInt(FrmCadastro_Situacao_Tributaria.EdtOrigem.Text);
end;

procedure TCadastro_Situacao_Tributaria.Inserir(var Registro
  : TCadastro_Situacao_Tributaria);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      begin
        with qAux, SQL do
        begin
          close;
          clear;
          Connection := DM.ADOConnection1;
          add('Insert into Cadastro_Situacao_Tributaria (Origem, Codigo_Situacao, Descricao, Codigo_CSOSN, Descricao_CSOSN, Data_Cadastro, Permite_Credito, Codigo_Obs_Fiscal)');
          add('values (:Origem, :Codigo_Situacao, :Descricao, :Codigo_CSOSN, :Descricao_CSOSN, :Data_Cadastro, :Permite_Credito, :Codigo_Obs_Fiscal)');
          Parameters.ParamByName('Origem').Value := Registro.Orig;
          Parameters.ParamByName('Codigo_Situacao').Value :=
            Registro.Codigo_Sit;
          Parameters.ParamByName('Descricao').Value := Registro.Desc;
          Parameters.ParamByName('Codigo_CSOSN').Value :=
            FrmCadastro_Situacao_Tributaria.EdtCSOSN.Text;
          Parameters.ParamByName('Descricao_CSOSN').Value :=
            FrmCadastro_Situacao_Tributaria.EdtDescricao_CSOSN.Text;
          Parameters.ParamByName('Data_Cadastro').Value := Registro.Data_Cad;
          Parameters.ParamByName('Permite_Credito').Value :=
            FrmCadastro_Situacao_Tributaria.RGPermite_Credito.ItemIndex;

          if (FrmCadastro_Situacao_Tributaria.EdtCodigo_Observacao_Fiscal.Text
            <> '') then
            Parameters.ParamByName('Codigo_Obs_Fiscal').Value :=
              StrToInt(FrmCadastro_Situacao_Tributaria.
              EdtCodigo_Observacao_Fiscal.Text)
          else
            Parameters.ParamByName('Codigo_Obs_Fiscal').Value := 0;
          ExecSQL;
        end;
      end;
    finally
      // DM.ADOConnection1.CommitTrans;
      qAux.close;
      FreeAndNil(qAux);
      lrControle := Insere;
      UGeral.Mensagem_Padrao(lrControle);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TCompra }

procedure TCompra.Alterar(var Registro: TCompra);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      begin
        with qAux, SQL do
        begin
          close;
          clear;
          Connection := DM.ADOConnection1;
          add('Update Compra set Data_Pedido = :Data_Pedido, Hora_Pedido = :Hora_Pedido,');
          add('Data_Previsao_Entrega = :Data_Previsao_Entrega, Codigo_Fornecedor = :Codigo_Fornecedor,');
          add('Codigo_Condicao_Pagamento = :Codigo_Condicao_Pagamento, Codigo_Funcionario = :Codigo_Funcionario,');
          add('Codigo_Empresa = :Codigo_Empresa, Tipo_Frete = :Tipo_Frete, Valor_Frete = :Valor_Frete, Outras_Despesas = :Outras_Despesas,');
          add('Qtde_Itens = :Qtde_Itens, Total_Produtos = :Total_Produtos, Peso_Total = :Peso_Total,');
          add('Desconto = :Desconto, Tipo_Desconto = :Tipo_Desconto, Total_Pedido = :Total_Pedido,');
          add('Status = :Status, Observacoes = :Observacoes');
          add('where Codigo = :Codigo and N_Pedido = :N_Pedido');
          Parameters.ParamByName('Codigo').Value := Registro.Cod;
          Parameters.ParamByName('N_Pedido').Value := Registro.N_Ped;
          Parameters.ParamByName('Data_Pedido').Value := Registro.Data_Ped;
          Parameters.ParamByName('Hora_Pedido').Value := Registro.Hora_Ped;
          Parameters.ParamByName('Data_Previsao_Entrega').Value :=
            Registro.Data_Prev_Entrega;
          Parameters.ParamByName('Codigo_Fornecedor').Value :=
            Registro.Cod_Forn;
          Parameters.ParamByName('Codigo_Condicao_Pagamento').Value :=
            Registro.Cod_Cond_Pag;
          Parameters.ParamByName('Codigo_Funcionario').Value :=
            Registro.Cod_Fun;
          Parameters.ParamByName('Codigo_Empresa').Value :=
            Registro.Cod_Empresa;
          Parameters.ParamByName('Tipo_Frete').Value := Registro.Tipo_Fre;
          Parameters.ParamByName('Valor_Frete').Value := Registro.Valor_Fre;
          Parameters.ParamByName('Outras_Despesas').Value :=
            Registro.Outras_Desp;
          Parameters.ParamByName('Qtde_Itens').Value := Registro.Qtde_It;
          Parameters.ParamByName('Total_Produtos').Value := Registro.Total_Prod;
          Parameters.ParamByName('Peso_Total').Value := Registro.Peso_Tot;
          Parameters.ParamByName('Desconto').Value := Registro.Desc;
          Parameters.ParamByName('Tipo_Desconto').Value := Registro.Tipo_Desc;
          Parameters.ParamByName('Total_Pedido').Value := Registro.Total_Ped;
          Parameters.ParamByName('Status').Value := Registro.Stat;
          Parameters.ParamByName('Observacoes').Value := Registro.Obs;
          ExecSQL;
        end;
      end;
    finally
      // DM.ADOConnection1.CommitTrans;
      qAux.close;
      FreeAndNil(qAux);
      lrControle := Altera;
      UGeral.Mensagem_Padrao(lrControle);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TCompra.Excluir(var Registro: TCompra);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Delete from Compra where Codigo = :Codigo and N_Pedido = :N_Pedido');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        Parameters.ParamByName('N_Pedido').Value := Registro.N_Ped;
        ExecSQL;
      end;
    finally
      // DM.ADOConnection1.CommitTrans;
      lrControle := Exclui;
      UGeral.Mensagem_Padrao(lrControle);
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

function TCompra.GetCodigo: integer;
begin
  GetCodigo := StrToInt(FrmCompra.EdtCodigo.Text);
end;

function TCompra.GetCodigo_Condicao_Pagamento: integer;
begin
  GetCodigo_Condicao_Pagamento :=
    StrToInt(FrmCompra.EdtCodigo_Condicao_Pagamento.Text);
end;

function TCompra.GetCodigo_Empresa: integer;
begin
  GetCodigo_Empresa := UDeclaracao.Codigo_Empresa;
end;

function TCompra.GetCodigo_Fornecedor: integer;
begin
  GetCodigo_Fornecedor := StrToInt(FrmCompra.EdtCodigo_Fornecedor.Text);
end;

function TCompra.GetCodigo_Funcionario: integer;
begin
  GetCodigo_Funcionario := StrToInt(FrmCompra.EdtCodigo_Funcionario.Text);
end;

function TCompra.GetData_Pedido: Tdate;
begin
  GetData_Pedido := StrToDateTime(FrmCompra.MEdtData_Pedido.Text);
end;

function TCompra.GetData_Previsao_Entrega: Tdate;
begin
  GetData_Previsao_Entrega :=
    StrToDateTime(FrmCompra.MEdtPrevisao_Entrega.Text);
end;

function TCompra.GetDesconto: double;
begin
  GetDesconto := StrToFloat(FrmCompra.EdtDesconto.Text);
end;

function TCompra.GetHora_Pedido: string;
begin
  GetHora_Pedido := FrmCompra.MEdtHora_Pedido.Text;
end;

function TCompra.GetN_Pedido: integer;
begin
  GetN_Pedido := StrToInt(FrmCompra.LblPedido.Caption);
end;

function TCompra.GetObservacoes: string;
begin
  GetObservacoes := FrmCompra.MmoObservacao.Text;
end;

function TCompra.GetOutras_Despesas: double;
begin
  GetOutras_Despesas := StrToFloat(FrmCompra.EdtOutras_Despesas.Text);
end;

function TCompra.GetPeso_Total: double;
begin
  GetPeso_Total := StrToFloat(FrmCompra.EdtPeso_Total.Text);
end;

function TCompra.GetQtde_Itens: integer;
begin
  GetQtde_Itens := StrToInt(FrmCompra.EdtQuantidade_Itens.Text);
end;

function TCompra.GetStatus: string;
begin
  GetStatus := 'PENDENTE';
end;

function TCompra.GetTipo_Desconto: string;
begin
  GetTipo_Desconto := '$';
end;

function TCompra.GetTipo_Frete: string;
begin
  if (FrmCompra.RGTipo_Frete.ItemIndex = 0) then
    GetTipo_Frete := 'CIF'
  else if (FrmCompra.RGTipo_Frete.ItemIndex = 1) then
    GetTipo_Frete := 'FOB'
  else if (FrmCompra.RGTipo_Frete.ItemIndex = 2) then
    GetTipo_Frete := 'TERCEIROS'
  else if (FrmCompra.RGTipo_Frete.ItemIndex = 3) then
    GetTipo_Frete := 'ISENTO';
end;

function TCompra.GetTotal_Pedido: double;
begin
  GetTotal_Pedido := StrToFloat(FrmCompra.EdtTotal_Pedido.Text);
end;

function TCompra.GetTotal_Produtos: double;
begin
  GetTotal_Produtos := StrToFloat(FrmCompra.EdtTotal_Produtos.Text);
end;

function TCompra.GetValor_Frete: double;
begin
  GetValor_Frete := StrToFloat(FrmCompra.EdtValor_Frete.Text);
end;

procedure TCompra.Inserir(var Registro: TCompra);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      begin
        with qAux, SQL do
        begin
          close;
          clear;
          Connection := DM.ADOConnection1;
          add('Insert into Compra (N_Pedido, Data_Pedido, Hora_Pedido, Data_Previsao_Entrega, Codigo_Fornecedor,');
          add('Codigo_Condicao_Pagamento, Codigo_Funcionario, Codigo_Empresa, Tipo_Frete, Valor_Frete, Outras_Despesas,');
          add('Qtde_Itens, Total_Produtos, Peso_Total, Desconto, Tipo_Desconto, Total_Pedido, Status,');
          add('Observacoes)');
          add('values (:N_Pedido, :Data_Pedido, :Hora_Pedido, :Data_Previsao_Entrega, :Codigo_Fornecedor,');
          add(':Codigo_Condicao_Pagamento, :Codigo_Funcionario, :Codigo_Empresa, :Tipo_Frete, :Valor_Frete, :Outras_Despesas,');
          add(':Qtde_Itens, :Total_Produtos, :Peso_Total, :Desconto, :Tipo_Desconto, :Total_Pedido, :Status,');
          add(':Observacoes)');
          Parameters.ParamByName('N_Pedido').Value := Registro.N_Ped;
          Parameters.ParamByName('Data_Pedido').Value := Registro.Data_Ped;
          Parameters.ParamByName('Hora_Pedido').Value := Registro.Hora_Ped;
          Parameters.ParamByName('Data_Previsao_Entrega').Value :=
            Registro.Data_Prev_Entrega;
          Parameters.ParamByName('Codigo_Fornecedor').Value :=
            Registro.Cod_Forn;
          Parameters.ParamByName('Codigo_Condicao_Pagamento').Value :=
            Registro.Cod_Cond_Pag;
          Parameters.ParamByName('Codigo_Funcionario').Value :=
            Registro.Cod_Fun;
          Parameters.ParamByName('Codigo_Empresa').Value :=
            Registro.Cod_Empresa;
          Parameters.ParamByName('Tipo_Frete').Value := Registro.Tipo_Fre;
          Parameters.ParamByName('Valor_Frete').Value := Registro.Valor_Fre;
          Parameters.ParamByName('Outras_Despesas').Value :=
            Registro.Outras_Desp;
          Parameters.ParamByName('Qtde_Itens').Value := Registro.Qtde_It;
          Parameters.ParamByName('Total_Produtos').Value := Registro.Total_Prod;
          Parameters.ParamByName('Peso_Total').Value := Registro.Peso_Tot;
          Parameters.ParamByName('Desconto').Value := Registro.Desc;
          Parameters.ParamByName('Tipo_Desconto').Value := Registro.Tipo_Desc;
          Parameters.ParamByName('Total_Pedido').Value := Registro.Total_Ped;
          Parameters.ParamByName('Status').Value := Registro.Stat;
          Parameters.ParamByName('Observacoes').Value := Registro.Obs;
          ExecSQL;
        end;
      end;
    finally
      // DM.ADOConnection1.CommitTrans;
      qAux.close;
      FreeAndNil(qAux);
      lrControle := Insere;
      UGeral.Mensagem_Padrao(lrControle);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TItens_Compra }

procedure TItens_Compra.Excluir(var Registro: TItens_Compra);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Delete from Itens_Compra where N_Pedido = :N_Pedido');
        Parameters.ParamByName('N_Pedido').Value := Registro.N_Ped;
        ExecSQL;
      end;
    finally
      // DM.ADOConnection1.CommitTrans;
      // lrControle:= Exclui;
      // UGeral.Mensagem_Padrao(lrControle);
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TItens_Compra.Excluir_Selecionado(var Registro: TItens_Compra);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Delete from Itens_Compra where N_Pedido = :N_Pedido and Codigo_Produto = :Produto');
        Parameters.ParamByName('N_Pedido').Value := Registro.N_Ped;
        Parameters.ParamByName('Produto').Value :=
          Registro.Cod_Prod_Selecionado;
        ExecSQL;
      end;
    finally
      // DM.ADOConnection1.CommitTrans;
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

function TItens_Compra.GetCodigo: integer;
begin
  GetCodigo := StrToInt(FrmCompra.EdtCodigo.Text);
end;

function TItens_Compra.GetCodigo_Produto: integer;
begin
  GetCodigo_Produto := StrToInt(FrmCompra.LblProduto.Caption);
end;

function TItens_Compra.GetCodigo_Produto_Selecionado: integer;
begin
  GetCodigo_Produto_Selecionado :=
    FrmCompra.qryitens_compraCodigo_Produto.AsInteger;
end;

function TItens_Compra.GetDesconto: double;
begin
  GetDesconto := StrToFloat(FrmCompra.EdtDesconto_Item.Text);
end;

function TItens_Compra.GetN_Pedido: integer;
begin
  GetN_Pedido := StrToInt(FrmCompra.LblPedido.Caption);
end;

function TItens_Compra.GetQtde: double;
begin
  GetQtde := StrToFloat(FrmCompra.EdtQuantidade.Text);
end;

function TItens_Compra.GetQtde_Recebida: double;
begin
  GetQtde_Recebida := 0;
end;

function TItens_Compra.GetQtde_Restante: double;
begin
  GetQtde_Restante := StrToFloat(FrmCompra.EdtQuantidade.Text);
end;

function TItens_Compra.GetStatus: string;
begin
  GetStatus := 'PENDENTE';
end;

function TItens_Compra.GetSub_Total: double;
begin
  GetSub_Total := StrToFloat(FrmCompra.EdtValor_Total.Text);
end;

function TItens_Compra.GetTipo_Desconto: string;
begin
  if (FrmCompra.RGDesconto_Item.ItemIndex = 0) then
    GetTipo_Desconto := '%'
  else
    GetTipo_Desconto := '$';
end;

function TItens_Compra.GetValor_Unitario: double;
begin
  GetValor_Unitario := StrToFloat(FrmCompra.EdtValor_Unitario.Text);
end;

procedure TItens_Compra.Inserir(var Registro: TItens_Compra);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      begin
        with qAux, SQL do
        begin
          close;
          clear;
          Connection := DM.ADOConnection1;
          add('Insert into Itens_Compra (Codigo, N_Pedido, Codigo_Produto, Qtde, Qtde_Recebida,');
          add('Qtde_Restante, Valor_Unitario, Desconto, Tipo_Desconto, Sub_Total, Status)');
          add('values (:Codigo, :N_Pedido, :Codigo_Produto, :Qtde, :Qtde_Recebida, :Qtde_Restante, :Valor_Unitario,');
          add(':Desconto, :Tipo_Desconto, :Sub_Total, :Status)');
          Parameters.ParamByName('Codigo').Value := Registro.Cod;
          Parameters.ParamByName('N_Pedido').Value := Registro.N_Ped;
          Parameters.ParamByName('Codigo_Produto').Value := Registro.Cod_Prod;
          Parameters.ParamByName('Qtde').Value := Registro.Qtd;
          Parameters.ParamByName('Qtde_Recebida').Value := Registro.Qtd_Rec;
          Parameters.ParamByName('Qtde_Restante').Value := Registro.Qtd_Res;
          Parameters.ParamByName('Valor_Unitario').Value := Registro.Valor_Un;
          Parameters.ParamByName('Desconto').Value := Registro.Desc;
          Parameters.ParamByName('Tipo_Desconto').Value := Registro.Tipo_Desc;
          Parameters.ParamByName('Sub_Total').Value := Registro.Sub_Tot;
          Parameters.ParamByName('Status').Value := Registro.Stat;
          ExecSQL;
        end;
      end;
    finally
      // DM.ADOConnection1.CommitTrans;
      qAux.close;
      FreeAndNil(qAux);
      lrControle := Item;
      UGeral.Mensagem_Padrao(lrControle);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TConciliacao_Compra }

procedure TConciliacao_Compra.Excluir(var Registro: TConciliacao_Compra);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Delete from Conciliacao_Compra where N_Pedido = :N_Pedido and Codigo_Produto = :Produto');
        Parameters.ParamByName('N_Pedido').Value := Registro.N_Ped;
        Parameters.ParamByName('Produto').Value :=
          FrmConciliacao_Compra.qryitens_compraCodigo_Produto.AsInteger;
        ExecSQL;
      end;
    finally
      // DM.ADOConnection1.CommitTrans;
      lrControle := Exclui;
      UGeral.Mensagem_Padrao(lrControle);
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

function TConciliacao_Compra.GetCodigo_Produto: integer;
begin
  GetCodigo_Produto := StrToInt(FrmConciliacao_Compra.LblProduto.Caption);
end;

function TConciliacao_Compra.GetN_Pedido: integer;
begin
  GetN_Pedido := StrToInt(FrmConciliacao_Compra.EdtN_Pedido.Text);
end;

function TConciliacao_Compra.GetQtde_Recebida: double;
begin
  GetQtde_Recebida := StrToFloat(FrmConciliacao_Compra.EdtQtde_Recebida.Text);
end;

function TConciliacao_Compra.GetQtde_Restante: double;
begin
  GetQtde_Restante := StrToFloat(FrmConciliacao_Compra.EdtQtde_Restante.Text);
end;

function TConciliacao_Compra.GetQtde_Solicitada: double;
begin
  GetQtde_Solicitada :=
    StrToFloat(FrmConciliacao_Compra.EdtQtde_Solicitada.Text);
end;

function TConciliacao_Compra.GetValor_Total_Recebido: double;
begin
  GetValor_Total_Recebido :=
    StrToFloat(FrmConciliacao_Compra.EdtValor_Total_Recebido.Text);
end;

function TConciliacao_Compra.GetValor_Total_Restante: double;
begin
  GetValor_Total_Restante :=
    StrToFloat(FrmConciliacao_Compra.Edtvalor_Total_Restante.Text);
end;

function TConciliacao_Compra.GetValor_Unitario: double;
begin
  GetValor_Unitario := StrToFloat(FrmConciliacao_Compra.EdtValor_Unitario.Text);
end;

procedure TConciliacao_Compra.Inserir(var Registro: TConciliacao_Compra);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      begin
        with qAux, SQL do
        begin
          close;
          clear;
          Connection := DM.ADOConnection1;
          add('Insert into Conciliacao_Compra (N_Pedido, Codigo_Produto, Qtde_Solicitada, Qtde_Recebida,');
          add('Qtde_Restante, Valor_Unitario, Valor_Total_Recebido, Valor_Total_Restante)');
          add('values (:N_Pedido, :Codigo_Produto, :Qtde_Solicitada, :Qtde_Recebida, :Qtde_Restante,');
          add(':Valor_Unitario, :Valor_Total_Recebido, :Valor_Total_Restante)');
          Parameters.ParamByName('N_Pedido').Value := Registro.N_Ped;
          Parameters.ParamByName('Codigo_Produto').Value := Registro.Cod_Prod;
          Parameters.ParamByName('Qtde_Solicitada').Value := Registro.Qtde_Sol;
          Parameters.ParamByName('Qtde_Recebida').Value := Registro.Qtde_Rec;
          Parameters.ParamByName('Qtde_Restante').Value := Registro.Qtde_Res;
          Parameters.ParamByName('Valor_Unitario').Value := Registro.Valor_Un;
          Parameters.ParamByName('Valor_Total_Recebido').Value :=
            Registro.Valor_Total_Rec;
          Parameters.ParamByName('Valor_Total_Restante').Value :=
            Registro.Valor_Total_Res;
          ExecSQL;
        end;
      end;
    finally
      // DM.ADOConnection1.CommitTrans;
      qAux.close;
      FreeAndNil(qAux);
      lrControle := Item;
      UGeral.Mensagem_Padrao(lrControle);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TConfiguracao_Sistema }

procedure TConfiguracao_Sistema.Alterar(var Registro: TConfiguracao_Sistema);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      begin
        with qAux, SQL do
        begin
          close;
          clear;
          Connection := DM.ADOConnection1;
          add('Update Configuracao_Sistema set Caminho_ECF = :Caminho_ECF, Mensagem_Cupom = :Mensagem_Cupom,');
          add('Porta_Comunicacao = :Porta_Comunicacao, Perfil_Arquivo_Fiscal = :Perfil_Arquivo_Fiscal, ');
          add('Versao_EFD = :Versao_EFD, Codigo_Tipo_Atividade = :Codigo_Tipo_Atividade, Tipo_Atividade = :Tipo_Atividade,');
          add('Ambiente = :Ambiente, Tipo_Impressao = :Tipo_Impressao,');
          add(' Tipo_Emissao = :Tipo_Emissao, Logomarca = :Logomarca, Salvar_XML = :Salvar_XML,');
          add('Codigo_Tabela_Preco_Padrao = :Codigo_Tabela_Preco_Padrao, Avisa_Tabela_Preco = :Avisa_Tabela_Preco,');
          add('Avisa_Lancamento_Financeiro = :Avisa_Lancamento_Financeiro, Avisa_Cheque = :Avisa_Cheque, ');
          add('Avisa_Pedido_Compra_Pendente = :Avisa_Pedido_Compra_Pendente, Avisa_Aniversario_Cliente = :Avisa_Aniversario_Cliente,');
          add('Avisa_Aniversario_Funcionario = :Avisa_Aniversario_Funcionario, Avisa_Produto_Vencido = :Avisa_Produto_Vencido,');
          add('Fazer_Backup = :Fazer_Backup, Avisa_Conta_Fixa = :Avisa_Conta_Fixa, Avisa_Cotacao_Preco = :Avisa_Cotacao_Preco, Dias_Aviso = :Dias_Aviso,');
          add('Tempo_Atualizacao = :Tempo_Atualizacao, ');
          add('ISSQN = :ISSQN, Codigo_Tipo_Documento = :Codigo_Tipo_Documento, Codigo_Departamento = :Codigo_Departamento,');
          add('Codigo_Plano_Financeiro = :Codigo_Plano_Financeiro, Historico = :Historico, ');
          add('Codigo_Tipo_Documento_Pagar = :Codigo_Tipo_Documento_Pagar, Codigo_Departamento_Pagar = :Codigo_Departamento_Pagar,');
          add('Codigo_Plano_Financeiro_Pagar = :Codigo_Plano_Financeiro_Pagar, Historico_Pagar = :Historico_Pagar, N_Certificado = :N_Certificado, Senha_Certificado = :Senha,');
          add('Caminho_Schema = :Caminho_Schema, EAN_Balanca = :EAN_Balanca, Gerar_Financeiro = :Gerar_Financeiro, Dias_Orcamento_Vencido = :Dias_Orcamento_Vencido,');
          add('Fechar_Caixa = :Fechar_Caixa, Calcula_Juro = :Calcula_Juro, Atualiza_Orcamento_Vencido = :Atualiza_Orcamento_Vencido, Consulta_Padrao_Produto = :Consulta_Padrao_Produto,');
          add('Tipo_Desc_Acr_Padrao = :Tipo_Desc_Acr_Padrao, Gerar_Estoque = :Gerar_Estoque,');

          add('Ob_Cliente_Nome = :Ob_Cliente_Nome, Ob_Cliente_Razao_Social = :Ob_Cliente_Razao_Social, ');
          add('Ob_Cliente_CPF = :Ob_Cliente_CPF, Ob_Cliente_RG = :Ob_Cliente_RG, Ob_Cliente_CNPJ = :Ob_Cliente_CNPJ,');
          add('Ob_Cliente_Insc_Estadual = :Ob_Cliente_Insc_Estadual, Ob_Cliente_Endereco = :Ob_Cliente_Endereco,');
          add('Ob_Cliente_Numero = :Ob_Cliente_Numero, Ob_Cliente_Setor = :Ob_Cliente_Setor, Ob_Cliente_Email = :Ob_Cliente_Email,');
          add('Ob_Cliente_Cidade = :Ob_Cliente_Cidade, Ob_Cliente_Data_Nascimento = :Ob_Cliente_Data_Nascimento,');
          add('Ob_Cliente_Telefone = :Ob_Cliente_Telefone, Bloqueia_Cliente = :Bloqueia_Cliente, Caminho_PDF_Pedido = :Caminho_PDF_Pedido,');
          add('Tipo_Impressao_Pedido = :Tipo_Impressao_Pedido, Usar_Comissao = :Usar_Comissao, Tamanho_Impressao = :Tamanho_Impressao, ');
          add('Qtde_Copias = :Qtde_Copias, Caminho_PDF_Carne = :Caminho_PDF_Carne, Observacoes_Carne = :Observacoes_Carne,');
          add('Tipo_Dias = :Tipo_Dias, Gera_Pre_Venda = :Gera_Pre_Venda, Gera_OS = :Gera_OS, Gera_DAV = :Gera_DAV, ');
          add('Gera_NFE = :Gera_NFE, Qtde_Maq = :Qtde_Maq, Tipo_OS = :Tipo_OS,');

          add('Modelo_Etiqueta = :Modelo_Etiqueta, DPI_Impressora_Etiqueta = :DPI_Impressora_Etiqueta, Avanco_Impressora_Etiqueta = :Avanco_Impressora_Etiqueta,');
          add('Porta_Impressora_Etiqueta = :Porta_Impressora_Etiqueta, Temperatura_Impressora_Etiqueta = :Temperatura_Impressora_Etiqueta, ');
          add('Limpar_Memoria_Impressora_Etiqueta = :Limpar_Memoria_Impressora_Etiqueta, ');
//          add('Orientacao_Impressao_Texto_Etiqueta = :Orientacao_Impressao_Texto_Etiqueta, Tamanho_Fonte_Texto_Etiqueta_Campo_1 = :Tamanho_Fonte_Texto_Etiqueta_Campo_1, Multiplicador_V_Texto_Etiqueta_Campo_1 = :Multiplicador_V_Texto_Etiqueta_Campo_1,');
//          add('Multiplicador_H_Texto_Etiqueta_Campo_1 = :Multiplicador_H_Texto_Etiqueta_Campo_1, Horizontal_Texto_Etiqueta_Campo_1 = :Horizontal_Texto_Etiqueta_Campo_1,');
//          add('Vertical_Texto_Etiqueta_Campo_1 = :Vertical_Texto_Etiqueta_Campo_1, Tamanho_Fonte_Texto_Etiqueta_Campo_2 = :Tamanho_Fonte_Texto_Etiqueta_Campo_2,');
//          add('Multiplicador_V_Texto_Etiqueta_Campo_2 = :Multiplicador_V_Texto_Etiqueta_Campo_2, Multiplicador_H_Texto_Etiqueta_Campo_2 = :Multiplicador_H_Texto_Etiqueta_Campo_2,');
//          add('Horizontal_Texto_Etiqueta_Campo_2 = :Horizontal_Texto_Etiqueta_Campo_2, Vertical_Texto_Etiqueta_Campo_2 = :Vertical_Texto_Etiqueta_Campo_2,');
//          add('Tipo_Barra_Etiqueta = :Tipo_Barra_Etiqueta, Largura_Barra_Larga = :Largura_Barra_Larga, Largura_Barra_Fina = :Largura_Barra_Fina, Horizontal_Barra_Etiqueta = :Horizontal_Barra_Etiqueta,');
//          add('Vertical_Barra_Etiqueta = :Vertical_Barra_Etiqueta, Altura_Barra = :Altura_Barra,');
//
//          add('Tamanho_Fonte_Texto_Etiqueta_Campo_3 = :Tamanho_Fonte_Texto_Etiqueta_Campo_3, Multiplicador_V_Texto_Etiqueta_Campo_3 = :Multiplicador_V_Texto_Etiqueta_Campo_3, Multiplicador_H_Texto_Etiqueta_Campo_3 = :Multiplicador_H_Texto_Etiqueta_Campo_3,');
//          add('Horizontal_Texto_Etiqueta_Campo_3 = :Horizontal_Texto_Etiqueta_Campo_3, Vertical_Texto_Etiqueta_Campo_3 = :Vertical_Texto_Etiqueta_Campo_3,');
//
//          add('Tamanho_Fonte_Texto_Etiqueta_Campo_4 = :Tamanho_Fonte_Texto_Etiqueta_Campo_4, Multiplicador_V_Texto_Etiqueta_Campo_4 = :Multiplicador_V_Texto_Etiqueta_Campo_4, Multiplicador_H_Texto_Etiqueta_Campo_4 = :Multiplicador_H_Texto_Etiqueta_Campo_4,');
//          add('Horizontal_Texto_Etiqueta_Campo_4 = :Horizontal_Texto_Etiqueta_Campo_4, Vertical_Texto_Etiqueta_Campo_4 = :Vertical_Texto_Etiqueta_Campo_4,');
//
//          add('Tamanho_Fonte_Texto_Etiqueta_Campo_5 = :Tamanho_Fonte_Texto_Etiqueta_Campo_5, Multiplicador_V_Texto_Etiqueta_Campo_5 = :Multiplicador_V_Texto_Etiqueta_Campo_5, Multiplicador_H_Texto_Etiqueta_Campo_5 = :Multiplicador_H_Texto_Etiqueta_Campo_5,');
//          add('Horizontal_Texto_Etiqueta_Campo_5 = :Horizontal_Texto_Etiqueta_Campo_5, Vertical_Texto_Etiqueta_Campo_5 = :Vertical_Texto_Etiqueta_Campo_5,');

//          add('Distancia_Horizontal_Etiqueta = :Distancia_Horizontal_Etiqueta, Distancia_Vertical_Etiqueta = :Distancia_Vertical_Etiqueta,');
          add('Opcao_Servico_Padrao = :Opcao_Servico_Padrao, Desbloqueia_Cliente = :Desbloqueia_Cliente, Controla_Credito_Cliente = :Controla_Credito_Cliente, Busca_Parametro_Calculo_Preco = :Busca_Parametro_Calculo_Preco,');
          add('Gera_Cupom_Fiscal = :Gera_Cupom_Fiscal, Gera_Codigo_EAN_Valido = :Gera_Codigo_EAN_Valido, Codigo_CFOP_Padrao = :Codigo_CFOP_Padrao,');
          add('Trazer_Somente_Cond_Pag_ECF = :Trazer_Somente_Cond_Pag_ECF, IdCSC = :IdCSC, NumeroCSC = :NumeroCSC ');

          // Add('Balanca_Modelo = :Balanca_Modelo, Balanca_Porta = :Balanca_Porta, Balanca_BaudRate = :Balanca_BaudRate, Balanca_DataBits = :Balanca_DataBits,');
          // Add('Balanca_Parity = :Balanca_Parity, Balanca_StopBits = :Balanca_StopBits, Balanca_Hand = :Balanca_Hand, Balanca_TimeOut = :Balanca_TimeOut');

          add('where Codigo_Empresa = :Codigo_Empresa');
          Parameters.ParamByName('Codigo_Empresa').Value :=
            Registro.Cod_Empresa;
          Parameters.ParamByName('Caminho_ECF').Value := Registro.Caminho_EC;
          Parameters.ParamByName('Mensagem_Cupom').Value := Registro.Men_Cupom;
          Parameters.ParamByName('Porta_Comunicacao').Value :=
            Registro.Porta_Com;
          Parameters.ParamByName('Perfil_Arquivo_Fiscal').Value :=
            Registro.Perfil_Arq;
          Parameters.ParamByName('Versao_EFD').Value := Registro.Ver_EFD;
          Parameters.ParamByName('Codigo_Tipo_Atividade').Value :=
            Registro.Codigo_Tipo_At;
          Parameters.ParamByName('Tipo_Atividade').Value := Registro.Tipo_At;
          Parameters.ParamByName('Ambiente').Value := Registro.Amb;
          Parameters.ParamByName('Tipo_Impressao').Value := Registro.Tipo_Imp;
          Parameters.ParamByName('Tipo_Emissao').Value := Registro.Tipo_Emis;
          Parameters.ParamByName('Logomarca').Value := Registro.Logo;
          Parameters.ParamByName('Salvar_XML').Value := Registro.Sa_XML;
          Parameters.ParamByName('Codigo_Tabela_Preco_Padrao').Value :=
            Registro.Cod_Tabela_Preco_Padrao;
          Parameters.ParamByName('Avisa_Tabela_Preco').Value :=
            Registro.Av_Tabela_Preco;
          Parameters.ParamByName('Avisa_Lancamento_Financeiro').Value :=
            Registro.Av_Lancamento_Financeiro;
          Parameters.ParamByName('Avisa_Cheque').Value := Registro.Av_Cheque;
          Parameters.ParamByName('Avisa_Pedido_Compra_Pendente').Value :=
            Registro.Av_Pedido_Compra_Pendente;
          Parameters.ParamByName('Avisa_Aniversario_Cliente').Value :=
            Registro.Av_Aniversario_Cliente;
          Parameters.ParamByName('Avisa_Aniversario_Funcionario').Value :=
            Registro.Av_Aniversario_Funcionario;
          Parameters.ParamByName('Avisa_Produto_Vencido').Value :=
            Registro.Av_Produto_Vencido;
          Parameters.ParamByName('Fazer_Backup').Value := Registro.Faz_Backup;
          Parameters.ParamByName('Avisa_Conta_Fixa').Value :=
            Registro.Av_Conta_Fixa;
          Parameters.ParamByName('Avisa_Cotacao_Preco').Value :=
            Registro.Cot_Preco;
          Parameters.ParamByName('Dias_Aviso').Value := Registro.Dias_Avis;
          Parameters.ParamByName('Tempo_Atualizacao').Value :=
            Registro.Tempo_At;
          Parameters.ParamByName('ISSQN').Value := Registro.ISSQNN;

          Parameters.ParamByName('Codigo_Tipo_Documento').Value :=
            Registro.Cod_Tipo_Documento;
          Parameters.ParamByName('Codigo_Departamento').Value :=
            Registro.Cod_Departamento;
          Parameters.ParamByName('Codigo_Plano_Financeiro').Value :=
            Registro.Cod_Plano_Financeiro;
          Parameters.ParamByName('Historico').Value := Registro.Hist;

          Parameters.ParamByName('Codigo_Tipo_Documento_Pagar').Value :=
            Registro.Cod_Tipo_Documento_Pagar;
          Parameters.ParamByName('Codigo_Departamento_Pagar').Value :=
            Registro.Cod_Departamento_Pagar;
          Parameters.ParamByName('Codigo_Plano_Financeiro_Pagar').Value :=
            Registro.Cod_Plano_Financeiro_Pagar;
          Parameters.ParamByName('Historico_Pagar').Value :=
            Registro.Hist_Pagar;
          Parameters.ParamByName('N_Certificado').Value :=
            FrmConfiguracao_Sistema.EdtN_Certificado.Text;
          Parameters.ParamByName('Senha').Value :=
            FrmConfiguracao_Sistema.EdtSenha_Certificado.Text;
          Parameters.ParamByName('Caminho_Schema').Value :=
            FrmConfiguracao_Sistema.EdtCaminho_Schema.Text;
          Parameters.ParamByName('EAN_Balanca').Value :=
            FrmConfiguracao_Sistema.RGEAN.ItemIndex;
          Parameters.ParamByName('Gerar_Financeiro').Value :=
            FrmConfiguracao_Sistema.RGGerar_Financeiro.ItemIndex;
          Parameters.ParamByName('Dias_Orcamento_Vencido').Value :=
            StrToInt(FrmConfiguracao_Sistema.EdtDias_Orcamento_Vencido.Text);

          if (FrmConfiguracao_Sistema.CBFechar_Caixa.Checked) then
            Parameters.ParamByName('Fechar_Caixa').Value := 0
          else
            Parameters.ParamByName('Fechar_Caixa').Value := 1;

          if (FrmConfiguracao_Sistema.CBCalcula_Juro.Checked) then
            Parameters.ParamByName('Calcula_Juro').Value := 0
          else
            Parameters.ParamByName('Calcula_Juro').Value := 1;

          if (FrmConfiguracao_Sistema.CBOrcamento_Vencido.Checked) then
            Parameters.ParamByName('Atualiza_Orcamento_Vencido').Value := 0
          else
            Parameters.ParamByName('Atualiza_Orcamento_Vencido').Value := 1;

          Parameters.ParamByName('Consulta_Padrao_Produto').Value :=
            FrmConfiguracao_Sistema.RGConsulta_Produto_Por.ItemIndex;
          Parameters.ParamByName('Tipo_Desc_Acr_Padrao').Value :=
            FrmConfiguracao_Sistema.RGTipoDesc_Acr_Fechamento.ItemIndex;
          Parameters.ParamByName('Gerar_Estoque').Value :=
            FrmConfiguracao_Sistema.RGGerar_Estoque.ItemIndex;

          if (FrmConfiguracao_Sistema.CBCliente_Nome.Checked) then
            Parameters.ParamByName('Ob_Cliente_Nome').Value := 0
          else
            Parameters.ParamByName('Ob_Cliente_Nome').Value := 1;

          if (FrmConfiguracao_Sistema.CBCliente_Razao_Social.Checked) then
            Parameters.ParamByName('Ob_Cliente_Razao_Social').Value := 0
          else
            Parameters.ParamByName('Ob_Cliente_Razao_Social').Value := 1;

          if (FrmConfiguracao_Sistema.CBCliente_CPF.Checked) then
            Parameters.ParamByName('Ob_Cliente_CPF').Value := 0
          else
            Parameters.ParamByName('Ob_Cliente_CPF').Value := 1;

          if (FrmConfiguracao_Sistema.CBCliente_RG.Checked) then
            Parameters.ParamByName('Ob_Cliente_RG').Value := 0
          else
            Parameters.ParamByName('Ob_Cliente_RG').Value := 1;

          if (FrmConfiguracao_Sistema.CBCliente_CNPJ.Checked) then
            Parameters.ParamByName('Ob_Cliente_CNPJ').Value := 0
          else
            Parameters.ParamByName('Ob_Cliente_CNPJ').Value := 1;

          if (FrmConfiguracao_Sistema.CBCliente_Insc_Estadual.Checked) then
            Parameters.ParamByName('Ob_Cliente_Insc_Estadual').Value := 0
          else
            Parameters.ParamByName('Ob_Cliente_Insc_Estadual').Value := 1;

          if (FrmConfiguracao_Sistema.CBCliente_Endereco.Checked) then
            Parameters.ParamByName('Ob_Cliente_Endereco').Value := 0
          else
            Parameters.ParamByName('Ob_Cliente_Endereco').Value := 1;

          if (FrmConfiguracao_Sistema.CBCliente_Numero.Checked) then
            Parameters.ParamByName('Ob_Cliente_Numero').Value := 0
          else
            Parameters.ParamByName('Ob_Cliente_Numero').Value := 1;

          if (FrmConfiguracao_Sistema.CBCliente_Setor.Checked) then
            Parameters.ParamByName('Ob_Cliente_Setor').Value := 0
          else
            Parameters.ParamByName('Ob_Cliente_Setor').Value := 1;

          if (FrmConfiguracao_Sistema.CBCliente_Email.Checked) then
            Parameters.ParamByName('Ob_Cliente_Email').Value := 0
          else
            Parameters.ParamByName('Ob_Cliente_Email').Value := 1;

          if (FrmConfiguracao_Sistema.CBCliente_Cidade.Checked) then
            Parameters.ParamByName('Ob_Cliente_Cidade').Value := 0
          else
            Parameters.ParamByName('Ob_Cliente_Cidade').Value := 1;

          if (FrmConfiguracao_Sistema.CBCliente_Data_Nascimento.Checked) then
            Parameters.ParamByName('Ob_Cliente_Data_Nascimento').Value := 0
          else
            Parameters.ParamByName('Ob_Cliente_Data_Nascimento').Value := 1;

          if (FrmConfiguracao_Sistema.CBCliente_Telefone.Checked) then
            Parameters.ParamByName('Ob_Cliente_Telefone').Value := 0
          else
            Parameters.ParamByName('Ob_Cliente_Telefone').Value := 1;

          if (FrmConfiguracao_Sistema.CBBloqueia_Cliente.Checked) then
            Parameters.ParamByName('Bloqueia_Cliente').Value := 'SIM'
          else
            Parameters.ParamByName('Bloqueia_Cliente').Value := 'NO';

          Parameters.ParamByName('Caminho_PDF_Pedido').Value :=
            FrmConfiguracao_Sistema.EdtCaminho_PDF_Pedido.Text;
          Parameters.ParamByName('Tipo_Impressao_Pedido').Value :=
            FrmConfiguracao_Sistema.RGImpressao_Pedido.ItemIndex;
          Parameters.ParamByName('Usar_Comissao').Value :=
            FrmConfiguracao_Sistema.RGUsar_Comissao.ItemIndex;
          Parameters.ParamByName('Tamanho_Impressao').Value :=
            FrmConfiguracao_Sistema.RGTamanho_Impressao.ItemIndex;
          Parameters.ParamByName('Qtde_Copias').Value :=
            StrToInt(FrmConfiguracao_Sistema.EdtQtde_Copias.Text);
          Parameters.ParamByName('Caminho_PDF_Carne').Value :=
            FrmConfiguracao_Sistema.EdtCaminho_PDF_Carne.Text;
          Parameters.ParamByName('Observacoes_Carne').Value :=
            FrmConfiguracao_Sistema.MmoObservacoes_Carne.Text;
          Parameters.ParamByName('Tipo_Dias').Value :=
            FrmConfiguracao_Sistema.RGTipo_Dias.ItemIndex;

          if (FrmConfiguracao_Sistema.cbPre_Venda.Checked) then
            Parameters.ParamByName('Gera_Pre_Venda').Value := '0101'
          else
            Parameters.ParamByName('Gera_Pre_Venda').Value := '0202';

          if (FrmConfiguracao_Sistema.cbOS.Checked) then
            Parameters.ParamByName('Gera_OS').Value := '0101'
          else
            Parameters.ParamByName('Gera_OS').Value := '0202';

          if (FrmConfiguracao_Sistema.cbDAV.Checked) then
            Parameters.ParamByName('Gera_DAV').Value := '0101'
          else
            Parameters.ParamByName('Gera_DAV').Value := '0202';

          if (FrmConfiguracao_Sistema.cbNFe.Checked) then
            Parameters.ParamByName('Gera_NFE').Value := '0101'
          else
            Parameters.ParamByName('Gera_NFE').Value := '0202';

          Parameters.ParamByName('Qtde_Maq').Value :=
            StrToInt(FrmConfiguracao_Sistema.edtQuantidade_Maquinas.Text);
          Parameters.ParamByName('Tipo_OS').Value :=
            FrmConfiguracao_Sistema.RGTipo_OS.ItemIndex;

          Parameters.ParamByName('Modelo_Etiqueta').Value :=
            FrmConfiguracao_Sistema.CBModelo_Etiqueta.ItemIndex;
          Parameters.ParamByName('DPI_Impressora_Etiqueta').Value :=
            FrmConfiguracao_Sistema.CBDPI_Impressora_Etiqueta.ItemIndex;
          Parameters.ParamByName('Avanco_Impressora_Etiqueta').Value :=
            StrToInt(FrmConfiguracao_Sistema.EdtAvanco_Etiqueta.Text);
          Parameters.ParamByName('Porta_Impressora_Etiqueta').Value :=
            FrmConfiguracao_Sistema.EdtPorta_Impressora_Etiqueta.Text;
          Parameters.ParamByName('Temperatura_Impressora_Etiqueta').Value :=
            StrToInt(FrmConfiguracao_Sistema.
            EdtTemperatura_Impressora_Etiqueta.Text);

          if (FrmConfiguracao_Sistema.CBLimpar_Memoria.Checked) then
          begin
            Parameters.ParamByName('Limpar_Memoria_Impressora_Etiqueta')
              .Value := 0;
          end
          else
          begin
            Parameters.ParamByName('Limpar_Memoria_Impressora_Etiqueta')
              .Value := 1;
          end;

//          Parameters.ParamByName('Orientacao_Impressao_Texto_Etiqueta').Value :=
//            FrmConfiguracao_Sistema.CBOrientacao.ItemIndex;
//          Parameters.ParamByName('Tamanho_Fonte_Texto_Etiqueta_Campo_1').Value
//            := StrToInt
//            (FrmConfiguracao_Sistema.EdtTamanho_Fonte_Etiqueta_Campo_1.Text);
//          Parameters.ParamByName('Multiplicador_V_Texto_Etiqueta_Campo_1').Value
//            := StrToInt
//            (FrmConfiguracao_Sistema.EdtMultiplicador_V_Campo_1.Text);
//          Parameters.ParamByName('Multiplicador_H_Texto_Etiqueta_Campo_1').Value
//            := StrToInt
//            (FrmConfiguracao_Sistema.EdtMultiplicador_H_Campo_1.Text);
//          Parameters.ParamByName('Horizontal_Texto_Etiqueta_Campo_1').Value :=
//            StrToInt(FrmConfiguracao_Sistema.EdtHorizontal_Texto_Campo_1.Text);
//          Parameters.ParamByName('Vertical_Texto_Etiqueta_Campo_1').Value :=
//            StrToInt(FrmConfiguracao_Sistema.EdtVertical_Texto_Campo_1.Text);
//          Parameters.ParamByName('Tamanho_Fonte_Texto_Etiqueta_Campo_2').Value
//            := StrToInt
//            (FrmConfiguracao_Sistema.EdtTamanho_Fonte_Etiqueta_Campo_2.Text);
//          Parameters.ParamByName('Multiplicador_V_Texto_Etiqueta_Campo_2').Value
//            := StrToInt
//            (FrmConfiguracao_Sistema.EdtMultiplicador_V_Campo_2.Text);
//          Parameters.ParamByName('Multiplicador_H_Texto_Etiqueta_Campo_2').Value
//            := StrToInt
//            (FrmConfiguracao_Sistema.EdtMultiplicador_H_Campo_2.Text);
//          Parameters.ParamByName('Horizontal_Texto_Etiqueta_Campo_2').Value :=
//            StrToInt(FrmConfiguracao_Sistema.EdtHorizontal_Texto_Campo_2.Text);
//          Parameters.ParamByName('Vertical_Texto_Etiqueta_Campo_2').Value :=
//            StrToInt(FrmConfiguracao_Sistema.EdtVertical_Texto_Campo_2.Text);
//          Parameters.ParamByName('Tipo_Barra_Etiqueta').Value :=
//            FrmConfiguracao_Sistema.EdtTipo_Barra.Text;
//          Parameters.ParamByName('Largura_Barra_Larga').Value :=
//            StrToInt(FrmConfiguracao_Sistema.EdtLargura_Barra_Larga.Text);
//          Parameters.ParamByName('Largura_Barra_Fina').Value :=
//            StrToInt(FrmConfiguracao_Sistema.EdtLargura_Barra_Fina.Text);
//          Parameters.ParamByName('Horizontal_Barra_Etiqueta').Value :=
//            StrToInt(FrmConfiguracao_Sistema.EdtHorizontal_Barra.Text);
//          Parameters.ParamByName('Vertical_Barra_Etiqueta').Value :=
//            StrToInt(FrmConfiguracao_Sistema.EdtVertical_Barra.Text);
//          Parameters.ParamByName('Altura_Barra').Value :=
//            StrToInt(FrmConfiguracao_Sistema.EdtAltura_Codigo.Text);
//
//          Parameters.ParamByName('Tamanho_Fonte_Texto_Etiqueta_Campo_3').Value
//            := StrToInt
//            (FrmConfiguracao_Sistema.EdtTamanho_Fonte_Etiqueta_Campo_3.Text);
//          Parameters.ParamByName('Multiplicador_V_Texto_Etiqueta_Campo_3').Value
//            := StrToInt
//            (FrmConfiguracao_Sistema.EdtMultiplicador_V_Campo_3.Text);
//          Parameters.ParamByName('Multiplicador_H_Texto_Etiqueta_Campo_3').Value
//            := StrToInt
//            (FrmConfiguracao_Sistema.EdtMultiplicador_H_Campo_3.Text);
//          Parameters.ParamByName('Horizontal_Texto_Etiqueta_Campo_3').Value :=
//            StrToInt(FrmConfiguracao_Sistema.EdtHorizontal_Texto_Campo_3.Text);
//          Parameters.ParamByName('Vertical_Texto_Etiqueta_Campo_3').Value :=
//            StrToInt(FrmConfiguracao_Sistema.EdtVertical_Texto_Campo_3.Text);
//
//          Parameters.ParamByName('Tamanho_Fonte_Texto_Etiqueta_Campo_4').Value
//            := StrToInt
//            (FrmConfiguracao_Sistema.EdtTamanho_Fonte_Etiqueta_Campo_4.Text);
//          Parameters.ParamByName('Multiplicador_V_Texto_Etiqueta_Campo_4').Value
//            := StrToInt
//            (FrmConfiguracao_Sistema.EdtMultiplicador_V_Campo_4.Text);
//          Parameters.ParamByName('Multiplicador_H_Texto_Etiqueta_Campo_4').Value
//            := StrToInt
//            (FrmConfiguracao_Sistema.EdtMultiplicador_H_Campo_4.Text);
//          Parameters.ParamByName('Horizontal_Texto_Etiqueta_Campo_4').Value :=
//            StrToInt(FrmConfiguracao_Sistema.EdtHorizontal_Texto_Campo_4.Text);
//          Parameters.ParamByName('Vertical_Texto_Etiqueta_Campo_4').Value :=
//            StrToInt(FrmConfiguracao_Sistema.EdtVertical_Texto_Campo_4.Text);
//
//          Parameters.ParamByName('Tamanho_Fonte_Texto_Etiqueta_Campo_5').Value
//            := StrToInt
//            (FrmConfiguracao_Sistema.EdtTamanho_Fonte_Etiqueta_Campo_5.Text);
//          Parameters.ParamByName('Multiplicador_V_Texto_Etiqueta_Campo_5').Value
//            := StrToInt
//            (FrmConfiguracao_Sistema.EdtMultiplicador_V_Campo_5.Text);
//          Parameters.ParamByName('Multiplicador_H_Texto_Etiqueta_Campo_5').Value
//            := StrToInt
//            (FrmConfiguracao_Sistema.EdtMultiplicador_H_Campo_5.Text);
//          Parameters.ParamByName('Horizontal_Texto_Etiqueta_Campo_5').Value :=
//            StrToInt(FrmConfiguracao_Sistema.EdtHorizontal_Texto_Campo_5.Text);
//          Parameters.ParamByName('Vertical_Texto_Etiqueta_Campo_5').Value :=
//            StrToInt(FrmConfiguracao_Sistema.EdtVertical_Texto_Campo_5.Text);
//
//          Parameters.ParamByName('Distancia_Horizontal_Etiqueta').Value :=
//            StrToInt(FrmConfiguracao_Sistema.EdtDistancia_Horizontal.Text);
//          Parameters.ParamByName('Distancia_Vertical_Etiqueta').Value :=
//            StrToInt(FrmConfiguracao_Sistema.EdtDistancia_Vertical.Text);

          if (FrmConfiguracao_Sistema.CBOpcao_Servico_Marcada.Checked) then
            Parameters.ParamByName('Opcao_Servico_Padrao').Value := 0
          else
            Parameters.ParamByName('Opcao_Servico_Padrao').Value := 1;

          if (FrmConfiguracao_Sistema.CBDesbloqueia_Cliente.Checked) then
            Parameters.ParamByName('Desbloqueia_Cliente').Value := 'SIM'
          else
            Parameters.ParamByName('Desbloqueia_Cliente').Value := 'NO';

          if (FrmConfiguracao_Sistema.CBControla_Credito.Checked) then
            Parameters.ParamByName('Controla_Credito_Cliente').Value := 0
          else
            Parameters.ParamByName('Controla_Credito_Cliente').Value := 1;

          Parameters.ParamByName('Busca_Parametro_Calculo_Preco').Value :=
            FrmConfiguracao_Sistema.RGBusca_Parametros_Calcular_Preco.ItemIndex;

          if (FrmConfiguracao_Sistema.cbCupomFiscal.Checked) then
            Parameters.ParamByName('Gera_Cupom_Fiscal').Value := '0101'
          else
            Parameters.ParamByName('Gera_Cupom_Fiscal').Value := '0202';

          if (FrmConfiguracao_Sistema.CBGera_Codigo_EAN.Checked) then
            Parameters.ParamByName('Gera_Codigo_EAN_Valido').Value := 0
          else
            Parameters.ParamByName('Gera_Codigo_EAN_Valido').Value := 1;

          Parameters.ParamByName('Codigo_CFOP_Padrao').Value :=
            StrToInt(FrmConfiguracao_Sistema.EdtCodigo_CFOP.Text);

          if (FrmConfiguracao_Sistema.CBTrazer_Cond_Pag_ECF.Checked) then
            Parameters.ParamByName('Trazer_Somente_Cond_Pag_ECF').Value := 0
          else
            Parameters.ParamByName('Trazer_Somente_Cond_Pag_ECF').Value := 1;

          Parameters.ParamByName('IdCSC').Value := FrmConfiguracao_Sistema.EdtIdCSC.Text;
          Parameters.ParamByName('NumeroCSC').Value := FrmConfiguracao_Sistema.EdtNumero_CSC.Text;
          { Parameters.ParamByName('Balanca_Modelo').Value := FrmConfiguracao_Sistema.cmbBalanca.ItemIndex;
            Parameters.ParamByName('Balanca_Porta').Value := FrmConfiguracao_Sistema.EdtPorta_Balanca.Text;
            Parameters.ParamByName('Balanca_BaudRate').Value := FrmConfiguracao_Sistema.cmbBaudRate.Text;
            Parameters.ParamByName('Balanca_DataBits').Value := FrmConfiguracao_Sistema.cmbDataBits.Text;
            Parameters.ParamByName('Balanca_Parity').Value := FrmConfiguracao_Sistema.cmbParity.ItemIndex;
            Parameters.ParamByName('Balanca_StopBits').Value := FrmConfiguracao_Sistema.cmbStopBits.ItemIndex;
            Parameters.ParamByName('Balanca_Hand').Value := FrmConfiguracao_Sistema.cmbHandShaking.ItemIndex;
            Parameters.ParamByName('Balanca_TimeOut').Value := FrmConfiguracao_Sistema.EdtTimeOut_Balanca.Text; }
          ExecSQL;
        end;
      end;
    finally
      // DM.ADOConnection1.CommitTrans;
      qAux.close;
      FreeAndNil(qAux);
      lrControle := Altera;
      UGeral.Mensagem_Padrao(lrControle);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TConfiguracao_Sistema.Excluir(var Registro: TConfiguracao_Sistema);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Delete from Configuracao_Sistema where Codigo_Empresa = :Codigo_Empresa');
        Parameters.ParamByName('Codigo_Empresa').Value := Registro.Cod_Empresa;
        ExecSQL;
      end;
    finally
      // DM.ADOConnection1.CommitTrans;
      lrControle := Exclui;
      UGeral.Mensagem_Padrao(lrControle);
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

function TConfiguracao_Sistema.GetAmbiente: string;
begin
  if (FrmConfiguracao_Sistema.RGAmbiente.ItemIndex = 0) then
    GetAmbiente := 'PRODUO'
  else
    GetAmbiente := 'HOMOLOGAO';
end;

function TConfiguracao_Sistema.GetAvisa_Aniversario_Cliente: string;
begin
  if (FrmConfiguracao_Sistema.CBAniversario_Cliente.Checked = true) then
    GetAvisa_Aniversario_Cliente := 'SIM'
  else
    GetAvisa_Aniversario_Cliente := 'NO';
end;

function TConfiguracao_Sistema.GetAvisa_Aniversario_Funcionario: string;
begin
  if (FrmConfiguracao_Sistema.CBAniversario_Funcionario.Checked = true) then
    GetAvisa_Aniversario_Funcionario := 'SIM'
  else
    GetAvisa_Aniversario_Funcionario := 'NO';
end;

function TConfiguracao_Sistema.GetAvisa_Cheque: string;
begin
  if (FrmConfiguracao_Sistema.CBCheque.Checked = true) then
    GetAvisa_Cheque := 'SIM'
  else
    GetAvisa_Cheque := 'NO';
end;

function TConfiguracao_Sistema.GetAvisa_Conta_Fixa: string;
begin
  if (FrmConfiguracao_Sistema.CBConta_Fixa.Checked = true) then
    GetAvisa_Conta_Fixa := 'SIM'
  else
    GetAvisa_Conta_Fixa := 'NO';
end;

function TConfiguracao_Sistema.GetAvisa_Lancamento_Financeiro: string;
begin
  if (FrmConfiguracao_Sistema.CBLancamento_Financeiro.Checked = true) then
    GetAvisa_Lancamento_Financeiro := 'SIM'
  else
    GetAvisa_Lancamento_Financeiro := 'NO';
end;

function TConfiguracao_Sistema.GetAvisa_Pedido_Compra_Pendente: string;
begin
  if (FrmConfiguracao_Sistema.CBPedido_Compra.Checked = true) then
    GetAvisa_Pedido_Compra_Pendente := 'SIM'
  else
    GetAvisa_Pedido_Compra_Pendente := 'NO';
end;

function TConfiguracao_Sistema.GetAvisa_Produto_Vencido: string;
begin
  if (FrmConfiguracao_Sistema.CBProduto_Vencido.Checked = true) then
    GetAvisa_Produto_Vencido := 'SIM'
  else
    GetAvisa_Produto_Vencido := 'NO';
end;

function TConfiguracao_Sistema.GetAvisa_Tabela_Preco: string;
begin
  if (FrmConfiguracao_Sistema.CBTabela_Preco.Checked = true) then
    GetAvisa_Tabela_Preco := 'SIM'
  else
    GetAvisa_Tabela_Preco := 'NO';
end;

function TConfiguracao_Sistema.GetCaminho_ECF: string;
begin
  // GetCaminho_ECF := FrmConfiguracao_Sistema.EdtCaminho_ECF.Text;
end;

function TConfiguracao_Sistema.GetCodigo_Departamento: integer;
begin
  if (FrmConfiguracao_Sistema.EdtCodigo_Departamento.Text = '') then
    GetCodigo_Departamento := 0
  else
    GetCodigo_Departamento :=
      StrToInt(FrmConfiguracao_Sistema.EdtCodigo_Departamento.Text);
end;

function TConfiguracao_Sistema.GetCodigo_Departamento_Pagar: integer;
begin
  if (FrmConfiguracao_Sistema.EdtCodigo_Departamento_Pagar.Text = '') then
    GetCodigo_Departamento_Pagar := 0
  else
    GetCodigo_Departamento_Pagar :=
      StrToInt(FrmConfiguracao_Sistema.EdtCodigo_Departamento_Pagar.Text);
end;

function TConfiguracao_Sistema.GetCodigo_Empresa: integer;
begin
  GetCodigo_Empresa := UDeclaracao.Codigo_Empresa;
end;

function TConfiguracao_Sistema.GetCodigo_Plano_Financeiro: integer;
begin
  if (FrmConfiguracao_Sistema.EdtCodigo_Plano.Text = '') then
    GetCodigo_Plano_Financeiro := 0
  else
    GetCodigo_Plano_Financeiro :=
      StrToInt(FrmConfiguracao_Sistema.EdtCodigo_Plano.Text);
end;

function TConfiguracao_Sistema.GetCodigo_Plano_Financeiro_Pagar: integer;
begin
  if (FrmConfiguracao_Sistema.EdtCodigo_Plano_Pagar.Text = '') then
    GetCodigo_Plano_Financeiro_Pagar := 0
  else
    GetCodigo_Plano_Financeiro_Pagar :=
      StrToInt(FrmConfiguracao_Sistema.EdtCodigo_Plano_Pagar.Text);
end;

function TConfiguracao_Sistema.GetCodigo_Tabela_Preco_Padrao: integer;
begin
  GetCodigo_Tabela_Preco_Padrao :=
    StrToInt(FrmConfiguracao_Sistema.EdtCodigo_Tabela_Preco.Text);
end;

function TConfiguracao_Sistema.GetCodigo_Tipo_Atividade: string;
begin
  GetCodigo_Tipo_Atividade :=
    FrmConfiguracao_Sistema.EdtCodigo_Tipo_Atividade.Text;
end;

function TConfiguracao_Sistema.GetCodigo_Tipo_Documento: integer;
begin
  if (FrmConfiguracao_Sistema.EdtCodigo_Tipo_Documento.Text = '') then
    GetCodigo_Tipo_Documento := 0
  else
    GetCodigo_Tipo_Documento :=
      StrToInt(FrmConfiguracao_Sistema.EdtCodigo_Tipo_Documento.Text);
end;

function TConfiguracao_Sistema.GetCodigo_Tipo_Documento_Pagar: integer;
begin
  if (FrmConfiguracao_Sistema.EdtCodigo_Tipo_Documento_Pagar.Text = '') then
    GetCodigo_Tipo_Documento_Pagar := 0
  else
    GetCodigo_Tipo_Documento_Pagar :=
      StrToInt(FrmConfiguracao_Sistema.EdtCodigo_Tipo_Documento_Pagar.Text);
end;

function TConfiguracao_Sistema.GetCotacao_Preco: string;
begin
  if (FrmConfiguracao_Sistema.CBCotacao_Preco.Checked = true) then
    GetCotacao_Preco := 'SIM'
  else
    GetCotacao_Preco := 'NO';
end;

function TConfiguracao_Sistema.GetDias_Aviso: integer;
begin
  GetDias_Aviso := StrToInt(FrmConfiguracao_Sistema.EdtDias_Avisar.Text);
end;

function TConfiguracao_Sistema.GetFazer_Backup: string;
begin
  if (FrmConfiguracao_Sistema.CBBackup.Checked = true) then
    GetFazer_Backup := 'SIM'
  else
    GetFazer_Backup := 'NO';
end;

function TConfiguracao_Sistema.GetHistorico: string;
begin
  GetHistorico := FrmConfiguracao_Sistema.EdtHistorico.Text;
end;

function TConfiguracao_Sistema.GetHistorico_Pagar: string;
begin
  GetHistorico_Pagar := FrmConfiguracao_Sistema.EdtHistorico_Pagar.Text;
end;

function TConfiguracao_Sistema.GetISSQN: string;
begin
  GetISSQN := FrmConfiguracao_Sistema.EdtISSQN.Text;
end;

function TConfiguracao_Sistema.GetLogomarca: string;
begin
  GetLogomarca := FrmConfiguracao_Sistema.EdtLogomarca.Text;
end;

function TConfiguracao_Sistema.GetMensagem_Cupom: string;
begin
  GetMensagem_Cupom := FrmConfiguracao_Sistema.EdtMensagem_Cupom.Text;
end;

function TConfiguracao_Sistema.GetPerfil_Arquivo_Fiscal: string;
begin
  GetPerfil_Arquivo_Fiscal := FrmConfiguracao_Sistema.EdtPerfil.Text;
end;

function TConfiguracao_Sistema.GetPorta_Comunicacao: string;
begin
  // GetPorta_Comunicacao := FrmConfiguracao_Sistema.EdtPorta_Comunicacao.Text;
end;

function TConfiguracao_Sistema.GetSalvar_XML: string;
begin
  GetSalvar_XML := FrmConfiguracao_Sistema.EdtSalva_XML.Text;
end;

function TConfiguracao_Sistema.GetTempo_Atualizacao: integer;
begin
  GetTempo_Atualizacao :=
    StrToInt(FrmConfiguracao_Sistema.EdtTempo_Atualizacao.Text);
end;

function TConfiguracao_Sistema.GetTipo_Atividade: string;
begin
  GetTipo_Atividade := FrmConfiguracao_Sistema.EdtTipo_Atividade.Text;
end;

function TConfiguracao_Sistema.GetTipo_Emissao: string;
begin
  if (FrmConfiguracao_Sistema.RGForma_Emissao.ItemIndex = 0) then
    GetTipo_Emissao := 'NORMAL'
  else if (FrmConfiguracao_Sistema.RGForma_Emissao.ItemIndex = 1) then
    GetTipo_Emissao := 'CONTINGNCIA'
  else if (FrmConfiguracao_Sistema.RGForma_Emissao.ItemIndex = 2) then
    GetTipo_Emissao := 'SCAN'
  else if (FrmConfiguracao_Sistema.RGForma_Emissao.ItemIndex = 3) then
    GetTipo_Emissao := 'DPEC'
  else if (FrmConfiguracao_Sistema.RGForma_Emissao.ItemIndex = 4) then
    GetTipo_Emissao := 'FSDA';
end;

function TConfiguracao_Sistema.GetTipo_Impressao: string;
begin
  if (FrmConfiguracao_Sistema.RGDanfe.ItemIndex = 0) then
    GetTipo_Impressao := 'RETRATO'
  else
    GetTipo_Impressao := 'PAISAGEM';
end;

function TConfiguracao_Sistema.GetVersao_EFD: string;
begin
  GetVersao_EFD := FrmConfiguracao_Sistema.EdtVersao_EFD.Text;
end;

function TConfiguracao_Sistema.GetWebService_UF_1_Homologacao: string;
begin
  // GetWebService_UF_1_Homologacao :=
  // FrmConfiguracao_Sistema.EdtWebService_UF_1_Homologacao.Text;
end;

function TConfiguracao_Sistema.GetWebService_UF_1_Producao: string;
begin
  // GetWebService_UF_1_Producao :=
  // FrmConfiguracao_Sistema.EdtWebService_UF_1_Producao.Text;
end;

function TConfiguracao_Sistema.GetWebService_UF_2_Homologacao: string;
begin
  // GetWebService_UF_2_Homologacao :=
  // FrmConfiguracao_Sistema.EdtWebService_UF_2_Homologacao.Text;
end;

function TConfiguracao_Sistema.GetWebService_UF_2_Producao: string;
begin
  // GetWebService_UF_2_Producao :=
  // FrmConfiguracao_Sistema.EdtWebService_UF_2_Producao.Text;
end;

procedure TConfiguracao_Sistema.Inserir(var Registro: TConfiguracao_Sistema);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      begin
        with qAux, SQL do
        begin
          close;
          clear;
          Connection := DM.ADOConnection1;
          add('Insert into Configuracao_Sistema (Codigo_Empresa, Caminho_ECF, Mensagem_Cupom, Porta_Comunicacao,');
          add('Perfil_Arquivo_Fiscal, Versao_EFD, Codigo_Tipo_Atividade, Tipo_Atividade,');
          add('Ambiente, Tipo_Impressao, Tipo_Emissao, Logomarca, Salvar_XML,');
          add('Codigo_Tabela_Preco_Padrao, Avisa_Tabela_Preco, Avisa_Lancamento_Financeiro, Avisa_Cheque,');
          add('Avisa_Pedido_Compra_Pendente, Avisa_Aniversario_Cliente, Avisa_Aniversario_Funcionario,');
          add('Avisa_Produto_Vencido, Fazer_Backup, Avisa_Conta_Fixa, Avisa_Cotacao_Preco, Dias_Aviso, Tempo_Atualizacao, ');
          add('ISSQN, Codigo_Tipo_Documento, Codigo_Departamento, Codigo_Plano_Financeiro, Historico, ');
          add('Codigo_Tipo_Documento_Pagar, Codigo_Departamento_Pagar, Codigo_Plano_Financeiro_Pagar, Historico_Pagar, ');
          add('N_Certificado, Senha_Certificado, Caminho_Schema, EAN_Balanca, Gerar_Financeiro, Dias_Orcamento_Vencido, Fechar_Caixa, Calcula_Juro, Atualiza_Orcamento_Vencido,');
          add('Consulta_Padrao_Produto, Tipo_Desc_Acr_Padrao, Gerar_Estoque,');

          add('Ob_Cliente_Nome, Ob_Cliente_Razao_Social, Ob_Cliente_CPF, Ob_Cliente_RG, Ob_Cliente_CNPJ,');
          add('Ob_Cliente_Insc_Estadual, Ob_Cliente_Endereco, Ob_Cliente_Numero, Ob_Cliente_Setor, Ob_Cliente_Email,');
          add('Ob_Cliente_Cidade, Ob_Cliente_Data_Nascimento, Ob_Cliente_Telefone, Bloqueia_Cliente, Caminho_PDF_Pedido, ');
          add('Tipo_Impressao_Pedido, Usar_Comissao, Tamanho_Impressao, Qtde_Copias, Caminho_PDF_Carne, Observacoes_Carne, Tipo_Dias,');
          add('Gera_Pre_Venda, Gera_OS, Gera_DAV, Gera_NFE, Qtde_Maq, Tipo_OS,');

          add('Modelo_Etiqueta, DPI_Impressora_Etiqueta, Avanco_Impressora_Etiqueta, Porta_Impressora_Etiqueta, Temperatura_Impressora_Etiqueta,');
          add('Limpar_Memoria_Impressora_Etiqueta, ');
//          add('Orientacao_Impressao_Texto_Etiqueta, Tamanho_Fonte_Texto_Etiqueta_Campo_1, Multiplicador_V_Texto_Etiqueta_Campo_1, Multiplicador_H_Texto_Etiqueta_Campo_1, ');
//          add('Horizontal_Texto_Etiqueta_Campo_1, Vertical_Texto_Etiqueta_Campo_1, Tamanho_Fonte_Texto_Etiqueta_Campo_2,');
//          add('Multiplicador_V_Texto_Etiqueta_Campo_2, Multiplicador_H_Texto_Etiqueta_Campo_2, Horizontal_Texto_Etiqueta_Campo_2, Vertical_Texto_Etiqueta_Campo_2,');
//          add('Tipo_Barra_Etiqueta, Largura_Barra_Larga, Largura_Barra_Fina, Horizontal_Barra_Etiqueta, Vertical_Barra_Etiqueta, Altura_Barra,');
//          add('Tamanho_Fonte_Texto_Etiqueta_Campo_3, Multiplicador_V_Texto_Etiqueta_Campo_3, Multiplicador_H_Texto_Etiqueta_Campo_3, Horizontal_Texto_Etiqueta_Campo_3, Vertical_Texto_Etiqueta_Campo_3,');
//          add('Tamanho_Fonte_Texto_Etiqueta_Campo_4, Multiplicador_V_Texto_Etiqueta_Campo_4, Multiplicador_H_Texto_Etiqueta_Campo_4, Horizontal_Texto_Etiqueta_Campo_4, Vertical_Texto_Etiqueta_Campo_4,');
//          add('Tamanho_Fonte_Texto_Etiqueta_Campo_5, Multiplicador_V_Texto_Etiqueta_Campo_5, Multiplicador_H_Texto_Etiqueta_Campo_5, Horizontal_Texto_Etiqueta_Campo_5, Vertical_Texto_Etiqueta_Campo_5,');
//
//          add('Distancia_Horizontal_Etiqueta, Distancia_Vertical_Etiqueta,');

          add('Opcao_Servico_Padrao, Desbloqueia_Cliente, Controla_Credito_Cliente, Busca_Parametro_Calculo_Preco, Gera_Cupom_Fiscal, Gera_Codigo_EAN_Valido, Codigo_CFOP_Padrao,');
          add('Trazer_Somente_Cond_Pag_ECF, IdCSC, NumeroCSC)');

          add('values ');

          add('(:Codigo_Empresa, :Caminho_ECF, :Mensagem_Cupom, :Porta_Comunicacao,');
          add(':Perfil_Arquivo_Fiscal, :Versao_EFD, :Codigo_Tipo_Atividade, :Tipo_Atividade,');
          add(':Ambiente, :Tipo_Impressao, :Tipo_Emissao, :Logomarca, :Salvar_XML,');
          add(':Codigo_Tabela_Preco_Padrao, :Avisa_Tabela_Preco, :Avisa_Lancamento_Financeiro, :Avisa_Cheque,');
          add(':Avisa_Pedido_Compra_Pendente, :Avisa_Aniversario_Cliente, :Avisa_Aniversario_Funcionario,');
          add(':Avisa_Produto_Vencido, :Fazer_Backup, :Avisa_Conta_Fixa, :Avisa_Cotacao_Preco, :Dias_Aviso, :Tempo_Atualizacao, ');
          add(':ISSQN, :Codigo_Tipo_Documento, :Codigo_Departamento, :Codigo_Plano_Financeiro, :Historico,');
          add(':Codigo_Tipo_Documento_Pagar, :Codigo_Departamento_Pagar, :Codigo_Plano_Financeiro_Pagar, :Historico_Pagar, ');
          add(':N_Certificado, :Senha, :Caminho_Schema, :EAN_Balanca, :Gerar_Financeiro, :Dias_Orcamento_Vencido, :Fechar_Caixa, :Calcula_Juro, :Atualiza_Orcamento_Vencido,');
          add(':Consulta_Padrao_Produto, :Tipo_Desc_Acr_Padrao, :Gerar_Estoque, ');

          add(':Ob_Cliente_Nome, :Ob_Cliente_Razao_Social, :Ob_Cliente_CPF, :Ob_Cliente_RG, :Ob_Cliente_CNPJ,');
          add(':Ob_Cliente_Insc_Estadual, :Ob_Cliente_Endereco, :Ob_Cliente_Numero, :Ob_Cliente_Setor, :Ob_Cliente_Email,');
          add(':Ob_Cliente_Cidade, :Ob_Cliente_Data_Nascimento, :Ob_Cliente_Telefone, :Bloqueia_Cliente, :Caminho_PDF_Pedido, ');
          add(':Tipo_Impressao_Pedido, :Usar_Comissao, :Tamanho_Impressao, :Qtde_Copias, :Caminho_PDF_Carne, :Observacoes_Carne, :Tipo_Dias,');
          add(':Gera_Pre_Venda, :Gera_OS, :Gera_DAV, :Gera_NFE, :Qtde_Maq, :Tipo_OS,');

          add(':Modelo_Etiqueta, :DPI_Impressora_Etiqueta, :Avanco_Impressora_Etiqueta, :Porta_Impressora_Etiqueta, :Temperatura_Impressora_Etiqueta,');
          add(':Limpar_Memoria_Impressora_Etiqueta, :Orientacao_Impressao_Texto_Etiqueta,');
          add(':Tamanho_Fonte_Texto_Etiqueta_Campo_1, :Multiplicador_V_Texto_Etiqueta_Campo_1, :Multiplicador_H_Texto_Etiqueta_Campo_1, ');
          add(':Horizontal_Texto_Etiqueta_Campo_1, :Vertical_Texto_Etiqueta_Campo_1, :Tamanho_Fonte_Texto_Etiqueta_Campo_2,');
          add(':Multiplicador_V_Texto_Etiqueta_Campo_2, :Multiplicador_H_Texto_Etiqueta_Campo_2, :Horizontal_Texto_Etiqueta_Campo_2, :Vertical_Texto_Etiqueta_Campo_2,');
          add(':Tipo_Barra_Etiqueta, :Largura_Barra_Larga, :Largura_Barra_Fina, :Horizontal_Barra_Etiqueta, :Vertical_Barra_Etiqueta, :Altura_Barra,');
          add(':Tamanho_Fonte_Texto_Etiqueta_Campo_3, :Multiplicador_V_Texto_Etiqueta_Campo_3, :Multiplicador_H_Texto_Etiqueta_Campo_3, :Horizontal_Texto_Etiqueta_Campo_3, :Vertical_Texto_Etiqueta_Campo_3,');
          add(':Tamanho_Fonte_Texto_Etiqueta_Campo_4, :Multiplicador_V_Texto_Etiqueta_Campo_4, :Multiplicador_H_Texto_Etiqueta_Campo_4, :Horizontal_Texto_Etiqueta_Campo_4, :Vertical_Texto_Etiqueta_Campo_4,');
          add(':Tamanho_Fonte_Texto_Etiqueta_Campo_5, :Multiplicador_V_Texto_Etiqueta_Campo_5, :Multiplicador_H_Texto_Etiqueta_Campo_5, :Horizontal_Texto_Etiqueta_Campo_5, :Vertical_Texto_Etiqueta_Campo_5,');
          add(':Distancia_Horizontal_Etiqueta, :Distancia_Vertical_Etiqueta,');
          add(':Opcao_Servico_Padrao, :Desbloqueia_Cliente, :Controla_Credito_Cliente, :Busca_Parametro_Calculo_Preco, :Gera_Cupom_Fiscal, :Gera_Codigo_EAN_Valido, :Codigo_CFOP_Padrao,');
          add(':Trazer_Somente_Cond_Pag_ECF, :IdCSC, :NumeroCSC)');

          Parameters.ParamByName('Codigo_Empresa').Value :=
            Registro.Cod_Empresa;
          Parameters.ParamByName('Caminho_ECF').Value := Registro.Caminho_EC;
          Parameters.ParamByName('Mensagem_Cupom').Value := Registro.Men_Cupom;
          Parameters.ParamByName('Porta_Comunicacao').Value :=
            Registro.Porta_Com;
          Parameters.ParamByName('Perfil_Arquivo_Fiscal').Value :=
            Registro.Perfil_Arq;
          Parameters.ParamByName('Versao_EFD').Value := Registro.Ver_EFD;
          Parameters.ParamByName('Codigo_Tipo_Atividade').Value :=
            Registro.Codigo_Tipo_At;
          Parameters.ParamByName('Tipo_Atividade').Value := Registro.Tipo_At;
          Parameters.ParamByName('Ambiente').Value := Registro.Amb;
          Parameters.ParamByName('Tipo_Impressao').Value := Registro.Tipo_Imp;
          Parameters.ParamByName('Tipo_Emissao').Value := Registro.Tipo_Emis;
          Parameters.ParamByName('Logomarca').Value := Registro.Logo;
          Parameters.ParamByName('Salvar_XML').Value := Registro.Sa_XML;
          Parameters.ParamByName('Codigo_Tabela_Preco_Padrao').Value :=
            Registro.Cod_Tabela_Preco_Padrao;
          Parameters.ParamByName('Avisa_Tabela_Preco').Value :=
            Registro.Av_Tabela_Preco;
          Parameters.ParamByName('Avisa_Lancamento_Financeiro').Value :=
            Registro.Av_Lancamento_Financeiro;
          Parameters.ParamByName('Avisa_Cheque').Value := Registro.Av_Cheque;
          Parameters.ParamByName('Avisa_Pedido_Compra_Pendente').Value :=
            Registro.Av_Pedido_Compra_Pendente;
          Parameters.ParamByName('Avisa_Aniversario_Cliente').Value :=
            Registro.Av_Aniversario_Cliente;
          Parameters.ParamByName('Avisa_Aniversario_Funcionario').Value :=
            Registro.Av_Aniversario_Funcionario;
          Parameters.ParamByName('Avisa_Produto_Vencido').Value :=
            Registro.Av_Produto_Vencido;
          Parameters.ParamByName('Fazer_Backup').Value := Registro.Faz_Backup;
          Parameters.ParamByName('Avisa_Conta_Fixa').Value :=
            Registro.Av_Conta_Fixa;
          Parameters.ParamByName('Avisa_Cotacao_Preco').Value :=
            Registro.Cot_Preco;
          Parameters.ParamByName('Dias_Aviso').Value := Registro.Dias_Avis;
          Parameters.ParamByName('Tempo_Atualizacao').Value :=
            Registro.Tempo_At;
          Parameters.ParamByName('ISSQN').Value := Registro.ISSQNN;

          Parameters.ParamByName('Codigo_Tipo_Documento').Value :=
            Registro.Cod_Tipo_Documento;
          Parameters.ParamByName('Codigo_Departamento').Value :=
            Registro.Cod_Departamento;
          Parameters.ParamByName('Codigo_Plano_Financeiro').Value :=
            Registro.Cod_Plano_Financeiro;
          Parameters.ParamByName('Historico').Value := Registro.Hist;

          Parameters.ParamByName('Codigo_Tipo_Documento_Pagar').Value :=
            Registro.Cod_Tipo_Documento_Pagar;
          Parameters.ParamByName('Codigo_Departamento_Pagar').Value :=
            Registro.Cod_Departamento_Pagar;
          Parameters.ParamByName('Codigo_Plano_Financeiro_Pagar').Value :=
            Registro.Cod_Plano_Financeiro_Pagar;
          Parameters.ParamByName('Historico_Pagar').Value :=
            Registro.Hist_Pagar;
          Parameters.ParamByName('N_Certificado').Value :=
            FrmConfiguracao_Sistema.EdtN_Certificado.Text;
          Parameters.ParamByName('Senha').Value :=
            FrmConfiguracao_Sistema.EdtSenha_Certificado.Text;
          Parameters.ParamByName('Caminho_Schema').Value :=
            FrmConfiguracao_Sistema.EdtCaminho_Schema.Text;
          Parameters.ParamByName('EAN_Balanca').Value :=
            FrmConfiguracao_Sistema.RGEAN.ItemIndex;
          Parameters.ParamByName('Gerar_Financeiro').Value :=
            FrmConfiguracao_Sistema.RGGerar_Financeiro.ItemIndex;
          Parameters.ParamByName('Dias_Orcamento_Vencido').Value :=
            StrToInt(FrmConfiguracao_Sistema.EdtDias_Orcamento_Vencido.Text);

          if (FrmConfiguracao_Sistema.CBFechar_Caixa.Checked) then
            Parameters.ParamByName('Fechar_Caixa').Value := 0
          else
            Parameters.ParamByName('Fechar_Caixa').Value := 1;

          if (FrmConfiguracao_Sistema.CBCalcula_Juro.Checked) then
            Parameters.ParamByName('Calcula_Juro').Value := 0
          else
            Parameters.ParamByName('Calcula_Juro').Value := 1;

          if (FrmConfiguracao_Sistema.CBOrcamento_Vencido.Checked) then
            Parameters.ParamByName('Atualiza_Orcamento_Vencido').Value := 0
          else
            Parameters.ParamByName('Atualiza_Orcamento_Vencido').Value := 1;
          Parameters.ParamByName('Consulta_Padrao_Produto').Value :=
            FrmConfiguracao_Sistema.RGConsulta_Produto_Por.ItemIndex;
          Parameters.ParamByName('Tipo_Desc_Acr_Padrao').Value :=
            FrmConfiguracao_Sistema.RGTipoDesc_Acr_Fechamento.ItemIndex;
          Parameters.ParamByName('Gerar_Estoque').Value :=
            FrmConfiguracao_Sistema.RGGerar_Estoque.ItemIndex;

          if (FrmConfiguracao_Sistema.CBCliente_Nome.Checked) then
            Parameters.ParamByName('Ob_Cliente_Nome').Value := 0
          else
            Parameters.ParamByName('Ob_Cliente_Nome').Value := 1;

          if (FrmConfiguracao_Sistema.CBCliente_Razao_Social.Checked) then
            Parameters.ParamByName('Ob_Cliente_Razao_Social').Value := 0
          else
            Parameters.ParamByName('Ob_Cliente_Razao_Social').Value := 1;

          if (FrmConfiguracao_Sistema.CBCliente_CPF.Checked) then
            Parameters.ParamByName('Ob_Cliente_CPF').Value := 0
          else
            Parameters.ParamByName('Ob_Cliente_CPF').Value := 1;

          if (FrmConfiguracao_Sistema.CBCliente_RG.Checked) then
            Parameters.ParamByName('Ob_Cliente_RG').Value := 0
          else
            Parameters.ParamByName('Ob_Cliente_RG').Value := 1;

          if (FrmConfiguracao_Sistema.CBCliente_CNPJ.Checked) then
            Parameters.ParamByName('Ob_Cliente_CNPJ').Value := 0
          else
            Parameters.ParamByName('Ob_Cliente_CNPJ').Value := 1;

          if (FrmConfiguracao_Sistema.CBCliente_Insc_Estadual.Checked) then
            Parameters.ParamByName('Ob_Cliente_Insc_Estadual').Value := 0
          else
            Parameters.ParamByName('Ob_Cliente_Insc_Estadual').Value := 1;

          if (FrmConfiguracao_Sistema.CBCliente_Endereco.Checked) then
            Parameters.ParamByName('Ob_Cliente_Endereco').Value := 0
          else
            Parameters.ParamByName('Ob_Cliente_Endereco').Value := 1;

          if (FrmConfiguracao_Sistema.CBCliente_Numero.Checked) then
            Parameters.ParamByName('Ob_Cliente_Numero').Value := 0
          else
            Parameters.ParamByName('Ob_Cliente_Numero').Value := 1;

          if (FrmConfiguracao_Sistema.CBCliente_Setor.Checked) then
            Parameters.ParamByName('Ob_Cliente_Setor').Value := 0
          else
            Parameters.ParamByName('Ob_Cliente_Setor').Value := 1;

          if (FrmConfiguracao_Sistema.CBCliente_Email.Checked) then
            Parameters.ParamByName('Ob_Cliente_Email').Value := 0
          else
            Parameters.ParamByName('Ob_Cliente_Email').Value := 1;

          if (FrmConfiguracao_Sistema.CBCliente_Cidade.Checked) then
            Parameters.ParamByName('Ob_Cliente_Cidade').Value := 0
          else
            Parameters.ParamByName('Ob_Cliente_Cidade').Value := 1;

          if (FrmConfiguracao_Sistema.CBCliente_Data_Nascimento.Checked) then
            Parameters.ParamByName('Ob_Cliente_Data_Nascimento').Value := 0
          else
            Parameters.ParamByName('Ob_Cliente_Data_Nascimento').Value := 1;

          if (FrmConfiguracao_Sistema.CBCliente_Telefone.Checked) then
            Parameters.ParamByName('Ob_Cliente_Telefone').Value := 0
          else
            Parameters.ParamByName('Ob_Cliente_Telefone').Value := 1;

          if (FrmConfiguracao_Sistema.CBBloqueia_Cliente.Checked) then
            Parameters.ParamByName('Bloqueia_Cliente').Value := 'SIM'
          else
            Parameters.ParamByName('Bloqueia_Cliente').Value := 'NO';

          Parameters.ParamByName('Caminho_PDF_Pedido').Value :=
            FrmConfiguracao_Sistema.EdtCaminho_PDF_Pedido.Text;
          Parameters.ParamByName('Tipo_Impressao_Pedido').Value :=
            FrmConfiguracao_Sistema.RGImpressao_Pedido.ItemIndex;
          Parameters.ParamByName('Usar_Comissao').Value :=
            FrmConfiguracao_Sistema.RGUsar_Comissao.ItemIndex;
          Parameters.ParamByName('Tamanho_Impressao').Value :=
            FrmConfiguracao_Sistema.RGTamanho_Impressao.ItemIndex;
          Parameters.ParamByName('Qtde_Copias').Value :=
            StrToInt(FrmConfiguracao_Sistema.EdtQtde_Copias.Text);
          Parameters.ParamByName('Caminho_PDF_Carne').Value :=
            FrmConfiguracao_Sistema.EdtCaminho_PDF_Carne.Text;
          Parameters.ParamByName('Observacoes_Carne').Value :=
            FrmConfiguracao_Sistema.MmoObservacoes_Carne.Text;
          Parameters.ParamByName('Tipo_Dias').Value :=
            FrmConfiguracao_Sistema.RGTipo_Dias.ItemIndex;

          if (FrmConfiguracao_Sistema.cbPre_Venda.Checked) then
            Parameters.ParamByName('Gera_Pre_Venda').Value := '0101'
          else
            Parameters.ParamByName('Gera_Pre_Venda').Value := '0202';

          if (FrmConfiguracao_Sistema.cbOS.Checked) then
            Parameters.ParamByName('Gera_OS').Value := '0101'
          else
            Parameters.ParamByName('Gera_OS').Value := '0202';

          if (FrmConfiguracao_Sistema.cbDAV.Checked) then
            Parameters.ParamByName('Gera_DAV').Value := '0101'
          else
            Parameters.ParamByName('Gera_DAV').Value := '0202';

          if (FrmConfiguracao_Sistema.cbNFe.Checked) then
            Parameters.ParamByName('Gera_NFE').Value := '0101'
          else
            Parameters.ParamByName('Gera_NFE').Value := '0202';

          Parameters.ParamByName('Qtde_Maq').Value :=
            StrToInt(FrmConfiguracao_Sistema.edtQuantidade_Maquinas.Text);
          Parameters.ParamByName('Tipo_OS').Value :=
            FrmConfiguracao_Sistema.RGTipo_OS.ItemIndex;

          Parameters.ParamByName('Modelo_Etiqueta').Value :=
            FrmConfiguracao_Sistema.CBModelo_Etiqueta.ItemIndex;
          Parameters.ParamByName('DPI_Impressora_Etiqueta').Value :=
            FrmConfiguracao_Sistema.CBDPI_Impressora_Etiqueta.ItemIndex;
          Parameters.ParamByName('Avanco_Impressora_Etiqueta').Value :=
            StrToInt(FrmConfiguracao_Sistema.EdtAvanco_Etiqueta.Text);
          Parameters.ParamByName('Porta_Impressora_Etiqueta').Value :=
            FrmConfiguracao_Sistema.EdtPorta_Impressora_Etiqueta.Text;
          Parameters.ParamByName('Temperatura_Impressora_Etiqueta').Value :=
            StrToInt(FrmConfiguracao_Sistema.
            EdtTemperatura_Impressora_Etiqueta.Text);

          if (FrmConfiguracao_Sistema.CBLimpar_Memoria.Checked) then
          begin
            Parameters.ParamByName('Limpar_Memoria_Impressora_Etiqueta')
              .Value := 0;
          end
          else
          begin
            Parameters.ParamByName('Limpar_Memoria_Impressora_Etiqueta')
              .Value := 1;
          end;

//          Parameters.ParamByName('Orientacao_Impressao_Texto_Etiqueta').Value :=
//            FrmConfiguracao_Sistema.CBOrientacao.ItemIndex;
//          Parameters.ParamByName('Tamanho_Fonte_Texto_Etiqueta_Campo_1').Value
//            := StrToInt
//            (FrmConfiguracao_Sistema.EdtTamanho_Fonte_Etiqueta_Campo_1.Text);
//          Parameters.ParamByName('Multiplicador_V_Texto_Etiqueta_Campo_1').Value
//            := StrToInt
//            (FrmConfiguracao_Sistema.EdtMultiplicador_V_Campo_1.Text);
//          Parameters.ParamByName('Multiplicador_H_Texto_Etiqueta_Campo_1').Value
//            := StrToInt
//            (FrmConfiguracao_Sistema.EdtMultiplicador_H_Campo_1.Text);
//          Parameters.ParamByName('Horizontal_Texto_Etiqueta_Campo_1').Value :=
//            StrToInt(FrmConfiguracao_Sistema.EdtHorizontal_Texto_Campo_1.Text);
//          Parameters.ParamByName('Vertical_Texto_Etiqueta_Campo_1').Value :=
//            StrToInt(FrmConfiguracao_Sistema.EdtVertical_Texto_Campo_1.Text);
//          Parameters.ParamByName('Tamanho_Fonte_Texto_Etiqueta_Campo_2').Value
//            := StrToInt
//            (FrmConfiguracao_Sistema.EdtTamanho_Fonte_Etiqueta_Campo_2.Text);
//          Parameters.ParamByName('Multiplicador_V_Texto_Etiqueta_Campo_2').Value
//            := StrToInt
//            (FrmConfiguracao_Sistema.EdtMultiplicador_V_Campo_2.Text);
//          Parameters.ParamByName('Multiplicador_H_Texto_Etiqueta_Campo_2').Value
//            := StrToInt
//            (FrmConfiguracao_Sistema.EdtMultiplicador_H_Campo_2.Text);
//          Parameters.ParamByName('Horizontal_Texto_Etiqueta_Campo_2').Value :=
//            StrToInt(FrmConfiguracao_Sistema.EdtHorizontal_Texto_Campo_2.Text);
//          Parameters.ParamByName('Vertical_Texto_Etiqueta_Campo_2').Value :=
//            StrToInt(FrmConfiguracao_Sistema.EdtVertical_Texto_Campo_2.Text);
//          Parameters.ParamByName('Tipo_Barra_Etiqueta').Value :=
//            FrmConfiguracao_Sistema.EdtTipo_Barra.Text;
//          Parameters.ParamByName('Largura_Barra_Larga').Value :=
//            StrToInt(FrmConfiguracao_Sistema.EdtLargura_Barra_Larga.Text);
//          Parameters.ParamByName('Largura_Barra_Fina').Value :=
//            StrToInt(FrmConfiguracao_Sistema.EdtLargura_Barra_Fina.Text);
//          Parameters.ParamByName('Horizontal_Barra_Etiqueta').Value :=
//            StrToInt(FrmConfiguracao_Sistema.EdtHorizontal_Barra.Text);
//          Parameters.ParamByName('Vertical_Barra_Etiqueta').Value :=
//            StrToInt(FrmConfiguracao_Sistema.EdtVertical_Barra.Text);
//          Parameters.ParamByName('Altura_Barra').Value :=
//            StrToInt(FrmConfiguracao_Sistema.EdtAltura_Codigo.Text);
//
//          Parameters.ParamByName('Tamanho_Fonte_Texto_Etiqueta_Campo_3').Value
//            := StrToInt
//            (FrmConfiguracao_Sistema.EdtTamanho_Fonte_Etiqueta_Campo_3.Text);
//          Parameters.ParamByName('Multiplicador_V_Texto_Etiqueta_Campo_3').Value
//            := StrToInt
//            (FrmConfiguracao_Sistema.EdtMultiplicador_V_Campo_3.Text);
//          Parameters.ParamByName('Multiplicador_H_Texto_Etiqueta_Campo_3').Value
//            := StrToInt
//            (FrmConfiguracao_Sistema.EdtMultiplicador_H_Campo_3.Text);
//          Parameters.ParamByName('Horizontal_Texto_Etiqueta_Campo_3').Value :=
//            StrToInt(FrmConfiguracao_Sistema.EdtHorizontal_Texto_Campo_3.Text);
//          Parameters.ParamByName('Vertical_Texto_Etiqueta_Campo_3').Value :=
//            StrToInt(FrmConfiguracao_Sistema.EdtVertical_Texto_Campo_3.Text);
//
//          Parameters.ParamByName('Tamanho_Fonte_Texto_Etiqueta_Campo_4').Value
//            := StrToInt
//            (FrmConfiguracao_Sistema.EdtTamanho_Fonte_Etiqueta_Campo_4.Text);
//          Parameters.ParamByName('Multiplicador_V_Texto_Etiqueta_Campo_4').Value
//            := StrToInt
//            (FrmConfiguracao_Sistema.EdtMultiplicador_V_Campo_4.Text);
//          Parameters.ParamByName('Multiplicador_H_Texto_Etiqueta_Campo_4').Value
//            := StrToInt
//            (FrmConfiguracao_Sistema.EdtMultiplicador_H_Campo_4.Text);
//          Parameters.ParamByName('Horizontal_Texto_Etiqueta_Campo_4').Value :=
//            StrToInt(FrmConfiguracao_Sistema.EdtHorizontal_Texto_Campo_4.Text);
//          Parameters.ParamByName('Vertical_Texto_Etiqueta_Campo_4').Value :=
//            StrToInt(FrmConfiguracao_Sistema.EdtVertical_Texto_Campo_4.Text);
//
//          Parameters.ParamByName('Tamanho_Fonte_Texto_Etiqueta_Campo_5').Value
//            := StrToInt
//            (FrmConfiguracao_Sistema.EdtTamanho_Fonte_Etiqueta_Campo_5.Text);
//          Parameters.ParamByName('Multiplicador_V_Texto_Etiqueta_Campo_5').Value
//            := StrToInt
//            (FrmConfiguracao_Sistema.EdtMultiplicador_V_Campo_5.Text);
//          Parameters.ParamByName('Multiplicador_H_Texto_Etiqueta_Campo_5').Value
//            := StrToInt
//            (FrmConfiguracao_Sistema.EdtMultiplicador_H_Campo_5.Text);
//          Parameters.ParamByName('Horizontal_Texto_Etiqueta_Campo_5').Value :=
//            StrToInt(FrmConfiguracao_Sistema.EdtHorizontal_Texto_Campo_5.Text);
//          Parameters.ParamByName('Vertical_Texto_Etiqueta_Campo_5').Value :=
//            StrToInt(FrmConfiguracao_Sistema.EdtVertical_Texto_Campo_5.Text);
//
//          Parameters.ParamByName('Distancia_Horizontal_Etiqueta').Value :=
//            StrToInt(FrmConfiguracao_Sistema.EdtDistancia_Horizontal.Text);
//          Parameters.ParamByName('Distancia_Vertical_Etiqueta').Value :=
//            StrToInt(FrmConfiguracao_Sistema.EdtDistancia_Vertical.Text);

          if (FrmConfiguracao_Sistema.CBOpcao_Servico_Marcada.Checked) then
            Parameters.ParamByName('Opcao_Servico_Padrao').Value := 0
          else
            Parameters.ParamByName('Opcao_Servico_Padrao').Value := 1;

          if (FrmConfiguracao_Sistema.CBDesbloqueia_Cliente.Checked) then
            Parameters.ParamByName('Desbloqueia_Cliente').Value := 'SIM'
          else
            Parameters.ParamByName('Desbloqueia_Cliente').Value := 'NO';

          if (FrmConfiguracao_Sistema.CBControla_Credito.Checked) then
            Parameters.ParamByName('Controla_Credito_Cliente').Value := 0
          else
            Parameters.ParamByName('Controla_Credito_Cliente').Value := 1;

          Parameters.ParamByName('Busca_Parametro_Calculo_Preco').Value :=
            FrmConfiguracao_Sistema.RGBusca_Parametros_Calcular_Preco.ItemIndex;

          if (FrmConfiguracao_Sistema.cbCupomFiscal.Checked) then
            Parameters.ParamByName('Gera_Cupom_Fiscal').Value := '0101'
          else
            Parameters.ParamByName('Gera_Cupom_Fiscal').Value := '0202';

          if (FrmConfiguracao_Sistema.CBGera_Codigo_EAN.Checked) then
            Parameters.ParamByName('Gera_Codigo_EAN_Valido').Value := 0
          else
            Parameters.ParamByName('Gera_Codigo_EAN_Valido').Value := 1;
          Parameters.ParamByName('Codigo_CFOP_Padrao').Value :=
            StrToInt(FrmConfiguracao_Sistema.EdtCodigo_CFOP.Text);

          if (FrmConfiguracao_Sistema.CBTrazer_Cond_Pag_ECF.Checked) then
            Parameters.ParamByName('Trazer_Somente_Cond_Pag_ECF').Value := 0
          else
            Parameters.ParamByName('Trazer_Somente_Cond_Pag_ECF').Value := 1;

          Parameters.ParamByName('IdCSC').Value := FrmConfiguracao_Sistema.EdtIdCSC.Text;
          Parameters.ParamByName('NumeroCSC').Value := FrmConfiguracao_Sistema.EdtNumero_CSC.Text;
          { Parameters.ParamByName('Balanca_Modelo').Value := FrmConfiguracao_Sistema.cmbBalanca.ItemIndex;
            Parameters.ParamByName('Balanca_Porta').Value := FrmConfiguracao_Sistema.EdtPorta_Balanca.Text;
            Parameters.ParamByName('Balanca_BaudRate').Value := FrmConfiguracao_Sistema.cmbBaudRate.Text;
            Parameters.ParamByName('Balanca_DataBits').Value := FrmConfiguracao_Sistema.cmbDataBits.Text;
            Parameters.ParamByName('Balanca_Parity').Value := FrmConfiguracao_Sistema.cmbParity.ItemIndex;
            Parameters.ParamByName('Balanca_StopBits').Value := FrmConfiguracao_Sistema.cmbStopBits.ItemIndex;
            Parameters.ParamByName('Balanca_Hand').Value := FrmConfiguracao_Sistema.cmbHandShaking.ItemIndex;
            Parameters.ParamByName('Balanca_TimeOut').Value := FrmConfiguracao_Sistema.EdtTimeOut_Balanca.Text;
          }
          ExecSQL;
        end;
      end;
    finally
      // DM.ADOConnection1.CommitTrans;
      qAux.close;
      FreeAndNil(qAux);
      lrControle := Insere;
      UGeral.Mensagem_Padrao(lrControle);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TContabilista }

procedure TContabilista.Alterar(var Registro: TContabilista);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      begin
        with qAux, SQL do
        begin
          close;
          clear;
          Connection := DM.ADOConnection1;
          add('Update Contabilista set Nome_Contador = :Nome_Contador,');
          add('CNPJ = :CNPJ, CPF = :CPF, CRC = :CRC, Numero = :Numero,');
          add('Complemento = :Complemento, Codigo_Setor = :Codigo_Setor, Codigo_Cidade = :Codigo_Cidade,');
          add('Email = :Email, Telefone = :Telefone, Endereco = :Endereco, CEP = :CEP');
          add('where Codigo_Empresa = :Codigo_Empresa');
          Parameters.ParamByName('Codigo_Empresa').Value :=
            Registro.Cod_Empresa;
          Parameters.ParamByName('Nome_Contador').Value := Registro.Nome_Cont;
          Parameters.ParamByName('CNPJ').Value := Registro.CNPJJ;
          Parameters.ParamByName('CPF').Value := Registro.CPFF;
          Parameters.ParamByName('CRC').Value := Registro.CRCC;
          Parameters.ParamByName('Numero').Value := Registro.Num;
          Parameters.ParamByName('Complemento').Value := Registro.Complem;
          Parameters.ParamByName('Codigo_Setor').Value := Registro.Codigo_Set;
          Parameters.ParamByName('Codigo_Cidade').Value := Registro.Codigo_Cid;
          Parameters.ParamByName('Email').Value := Registro.Ema;
          Parameters.ParamByName('Telefone').Value := Registro.Tel;
          Parameters.ParamByName('Endereco').Value :=
            FrmCadastro_Empresa.EdtEndereco_Contador.Text;
          Parameters.ParamByName('CEP').Value :=
            FrmCadastro_Empresa.EdtCEP_Contador.Text;
          ExecSQL;
        end;
      end;
    finally
      // DM.ADOConnection1.CommitTrans;
      qAux.close;
      FreeAndNil(qAux);
      // lrControle:= Altera;
      // UGeral.Mensagem_Padrao(lrControle);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TContabilista.Excluir(var Registro: TContabilista);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Delete from Contabilista where Codigo_Empresa = :Codigo_Empresa');
        Parameters.ParamByName('Codigo_Empresa').Value := Registro.Cod_Empresa;
        ExecSQL;
      end;
    finally
      // DM.ADOConnection1.CommitTrans;
      lrControle := Exclui;
      UGeral.Mensagem_Padrao(lrControle);
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

function TContabilista.GetCNPJ: string;
begin
  GetCNPJ := FrmCadastro_Empresa.MEdtCNPJ_Contador.Text;
end;

function TContabilista.GetCodigo_Cidade: integer;
begin
  if (FrmCadastro_Empresa.EdtCodigo_Cidade_Contador.Text = '') then
    GetCodigo_Cidade := 0
  else
    GetCodigo_Cidade :=
      StrToInt(FrmCadastro_Empresa.EdtCodigo_Cidade_Contador.Text);
end;

function TContabilista.GetCodigo_Empresa: integer;
begin
  GetCodigo_Empresa := StrToInt(FrmCadastro_Empresa.EdtCodigo.Text);
end;

function TContabilista.GetCodigo_Logradouro: integer;
begin
  { if (FrmCadastro_Empresa.EdtCodigo_Endereco_Contador.Text = '') then
    GetCodigo_Logradouro := 0
    else
    GetCodigo_Logradouro := StrToInt
    (FrmCadastro_Empresa.EdtCodigo_Endereco_Contador.Text); }
end;

function TContabilista.GetCodigo_Setor: integer;
begin
  if (FrmCadastro_Empresa.EdtCodigo_Setor_Contador.Text = '') then
    GetCodigo_Setor := 0
  else
    GetCodigo_Setor :=
      StrToInt(FrmCadastro_Empresa.EdtCodigo_Setor_Contador.Text);
end;

function TContabilista.GetComplemento: string;
begin
  GetComplemento := FrmCadastro_Empresa.EdtComplemento_Contador.Text;
end;

function TContabilista.GetCPF: string;
begin
  GetCPF := FrmCadastro_Empresa.MEdtCPF_Contador.Text;
end;

function TContabilista.GetCRC: string;
begin
  GetCRC := FrmCadastro_Empresa.EdtCRC.Text;
end;

function TContabilista.GetEmail: string;
begin
  GetEmail := FrmCadastro_Empresa.EdtEmail_Contador.Text;
end;

function TContabilista.GetNome_Contabilista: string;
begin
  GetNome_Contabilista := FrmCadastro_Empresa.EdtNome_Contador.Text;
end;

function TContabilista.GetNumero: string;
begin
  GetNumero := FrmCadastro_Empresa.EdtNumero_Contador.Text;
end;

function TContabilista.GetTelefone: string;
begin
  GetTelefone := FrmCadastro_Empresa.MEdtTelefone_Contador.Text;
end;

procedure TContabilista.Inserir(var Registro: TContabilista);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      begin
        with qAux, SQL do
        begin
          close;
          clear;
          Connection := DM.ADOConnection1;
          add('Insert into Contabilista (Codigo_Empresa, Nome_Contador, CNPJ, CPF, CRC, ');
          add('Numero, Complemento, Codigo_Setor, Codigo_Cidade, Email, Telefone, Endereco, CEP)');
          add('values (:Codigo_Empresa, :Nome_Contador, :CNPJ, :CPF, :CRC,');
          add(':Numero, :Complemento, :Codigo_Setor, :Codigo_Cidade, :Email, :Telefone, :Endereco, :CEP)');
          Parameters.ParamByName('Codigo_Empresa').Value :=
            Registro.Cod_Empresa;
          Parameters.ParamByName('Nome_Contador').Value := Registro.Nome_Cont;
          Parameters.ParamByName('CNPJ').Value := Registro.CNPJJ;
          Parameters.ParamByName('CPF').Value := Registro.CPFF;
          Parameters.ParamByName('CRC').Value := Registro.CRCC;
          Parameters.ParamByName('Numero').Value := Registro.Num;
          Parameters.ParamByName('Complemento').Value := Registro.Complem;
          Parameters.ParamByName('Codigo_Setor').Value := Registro.Codigo_Set;
          Parameters.ParamByName('Codigo_Cidade').Value := Registro.Codigo_Cid;
          Parameters.ParamByName('Email').Value := Registro.Ema;
          Parameters.ParamByName('Telefone').Value := Registro.Tel;
          Parameters.ParamByName('Endereco').Value :=
            FrmCadastro_Empresa.EdtEndereco_Contador.Text;
          Parameters.ParamByName('CEP').Value :=
            FrmCadastro_Empresa.EdtCEP_Contador.Text;
          ExecSQL;
        end;
      end;
    finally
      // DM.ADOConnection1.CommitTrans;
      qAux.close;
      FreeAndNil(qAux);
      // lrControle:= Insere;
      // UGeral.Mensagem_Padrao(lrControle);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TNCM }

procedure TNCM.Alterar(var Registro: TNCM);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      begin
        with qAux, SQL do
        begin
          close;
          clear;
          Connection := DM.ADOConnection1;
          add('Update NCM set Codigo_NCM = :Codigo_NCM, Descricao = :Descricao,');
          add('Data_Cadastro = :Data_Cadastro, Ex = :Ex, Aliquota_Nacional = :Aliquota_Nacional, Aliquota_Importada = :Aliquota_Importada,');
          add('Versao = :Versao, Tabela = :Tabela, Aliquota_Estadual = :Aliquota_Estadual, Aliquota_Municipal = :Aliquota_Municipal, Vigencia_Inicio = :Vigencia_Inicio,');
          add('Vigencia_Fim = :Vigencia_Fim, IVA = :IVA');
          add('where Codigo = :Codigo');
          Parameters.ParamByName('Codigo').Value := Registro.Cod;
          Parameters.ParamByName('Codigo_NCM').Value := Registro.Cod_NCM;
          Parameters.ParamByName('Descricao').Value := Registro.Desc;
          Parameters.ParamByName('Data_Cadastro').Value := Registro.Data;
          Parameters.ParamByName('Ex').Value := FrmCadastro_NCM.EdtEx.Text;
          Parameters.ParamByName('Aliquota_Nacional').Value :=
            StrToFloat(FrmCadastro_NCM.EdtAliquota_Nacional.Text);
          Parameters.ParamByName('Aliquota_Importada').Value :=
            StrToFloat(FrmCadastro_NCM.EdtAliquota_Importada.Text);
          Parameters.ParamByName('Versao').Value :=
            FrmCadastro_NCM.EdtVersao.Text;
          Parameters.ParamByName('Tabela').Value :=
            FrmCadastro_NCM.RGTabela.ItemIndex;
          Parameters.ParamByName('Aliquota_Estadual').Value :=
            StrToFloat(FrmCadastro_NCM.EdtAliquota_Estadual.Text);
          Parameters.ParamByName('Aliquota_Municipal').Value :=
            StrToFloat(FrmCadastro_NCM.EdtAliquota_Municipal.Text);
          Parameters.ParamByName('Vigencia_Inicio').Value :=
            StrToDate(FrmCadastro_NCM.MEdtVigencia_Inicio.Text);
          Parameters.ParamByName('Vigencia_Fim').Value :=
            StrToDate(FrmCadastro_NCM.MEdtVigencia_Fim.Text);
          Parameters.ParamByName('IVA').Value :=
            StrToFloat(FrmCadastro_NCM.EdtIVA.Text);
          ExecSQL;
        end;
      end;
    finally
      // DM.ADOConnection1.CommitTrans;
      qAux.close;
      FreeAndNil(qAux);
      lrControle := Altera;
      UGeral.Mensagem_Padrao(lrControle);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TNCM.Excluir(var Registro: TNCM);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Delete from NCM where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        ExecSQL;
      end;
    finally
      // DM.ADOConnection1.CommitTrans;
      lrControle := Exclui;
      UGeral.Mensagem_Padrao(lrControle);
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

function TNCM.GetCodigo: integer;
begin
  GetCodigo := StrToInt(FrmCadastro_NCM.EdtCodigo.Text);
end;

function TNCM.GetCodigo_NCM: string;
begin
  GetCodigo_NCM := FrmCadastro_NCM.EdtCodigo_NCM.Text;
end;

function TNCM.GetData_Cadastro: Tdate;
begin
  GetData_Cadastro := StrToDateTime(FrmCadastro_NCM.MEdtData_Cadastro.Text);
end;

function TNCM.GetDesc: string;
begin
  GetDesc := FrmCadastro_NCM.EdtDescricao.Text;
end;

procedure TNCM.Inserir(var Registro: TNCM);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      begin
        with qAux, SQL do
        begin
          close;
          clear;
          Connection := DM.ADOConnection1;
          add('Insert into NCM (Codigo_NCM, Descricao, Data_Cadastro, Ex, Aliquota_Nacional, Aliquota_Importada, Versao, Tabela, Aliquota_Estadual, Aliquota_Municipal, Vigencia_Inicio, Vigencia_Fim, IVA)');
          add('values (:Codigo_NCM, :Descricao, :Data_Cadastro, :Ex, :Aliquota_Nacional, :Aliquota_Importada, :Versao, :Tabela, :Aliquota_Estadual, :Aliquota_Municipal, :Vigencia_Inicio, :Vigencia_Fim, :IVA)');
          Parameters.ParamByName('Codigo_NCM').Value := Registro.Cod_NCM;
          Parameters.ParamByName('Descricao').Value := Registro.Desc;
          Parameters.ParamByName('Data_Cadastro').Value := Registro.Data;
          Parameters.ParamByName('Ex').Value := FrmCadastro_NCM.EdtEx.Text;
          Parameters.ParamByName('Aliquota_Nacional').Value :=
            StrToFloat(FrmCadastro_NCM.EdtAliquota_Nacional.Text);
          Parameters.ParamByName('Aliquota_Importada').Value :=
            StrToFloat(FrmCadastro_NCM.EdtAliquota_Importada.Text);
          Parameters.ParamByName('Versao').Value :=
            FrmCadastro_NCM.EdtVersao.Text;
          Parameters.ParamByName('Tabela').Value :=
            FrmCadastro_NCM.RGTabela.ItemIndex;
          Parameters.ParamByName('Aliquota_Estadual').Value :=
            StrToFloat(FrmCadastro_NCM.EdtAliquota_Estadual.Text);
          Parameters.ParamByName('Aliquota_Municipal').Value :=
            StrToFloat(FrmCadastro_NCM.EdtAliquota_Municipal.Text);
          Parameters.ParamByName('Vigencia_Inicio').Value :=
            StrToDate(FrmCadastro_NCM.MEdtVigencia_Inicio.Text);
          Parameters.ParamByName('Vigencia_Fim').Value :=
            StrToDate(FrmCadastro_NCM.MEdtVigencia_Fim.Text);
          Parameters.ParamByName('IVA').Value :=
            StrToFloat(FrmCadastro_NCM.EdtIVA.Text);
          ExecSQL;
        end;
      end;
    finally
      // DM.ADOConnection1.CommitTrans;
      qAux.close;
      FreeAndNil(qAux);
      lrControle := Insere;
      UGeral.Mensagem_Padrao(lrControle);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TPais }

procedure TPais.Alterar(var Registro: TPais);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      begin
        with qAux, SQL do
        begin
          close;
          clear;
          Connection := DM.ADOConnection1;
          add('Update Pais set Codigo_Pais = :Codigo_Pais, Descricao = :Descricao,');
          add('Data_Cadastro = :Data_Cadastro');
          add('where Codigo = :Codigo');
          Parameters.ParamByName('Codigo').Value := Registro.Cod;
          Parameters.ParamByName('Codigo_Pais').Value := Registro.Cod_Pais;
          Parameters.ParamByName('Descricao').Value := Registro.Desc;
          Parameters.ParamByName('Data_Cadastro').Value := Registro.Data;
          ExecSQL;
        end;
      end;
    finally
      // DM.ADOConnection1.CommitTrans;
      qAux.close;
      FreeAndNil(qAux);
      lrControle := Altera;
      UGeral.Mensagem_Padrao(lrControle);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TPais.Excluir(var Registro: TPais);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Delete from Pais where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        ExecSQL;
      end;
    finally
      // DM.ADOConnection1.CommitTrans;
      lrControle := Exclui;
      UGeral.Mensagem_Padrao(lrControle);
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

function TPais.GetCodigo: integer;
begin
  GetCodigo := StrToInt(FrmCadastro_Pais.EdtCodigo.Text);
end;

function TPais.GetCodigo_Pais: string;
begin
  GetCodigo_Pais := FrmCadastro_Pais.EdtCodigo_Pais.Text;
end;

function TPais.GetData_Cadastro: Tdate;
begin
  GetData_Cadastro := StrToDateTime(FrmCadastro_Pais.MEdtData_Cadastro.Text);
end;

function TPais.GetDesc: string;
begin
  GetDesc := FrmCadastro_Pais.EdtDescricao.Text;
end;

procedure TPais.Inserir(var Registro: TPais);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      begin
        with qAux, SQL do
        begin
          close;
          clear;
          Connection := DM.ADOConnection1;
          add('Insert into Pais (Codigo_Pais, Descricao, Data_Cadastro)');
          add('values (:Codigo_Pais, :Descricao, :Data_Cadastro)');
          Parameters.ParamByName('Codigo_Pais').Value := Registro.Cod_Pais;
          Parameters.ParamByName('Descricao').Value := Registro.Desc;
          Parameters.ParamByName('Data_Cadastro').Value := Registro.Data;
          ExecSQL;
        end;
      end;
    finally
      // DM.ADOConnection1.CommitTrans;
      qAux.close;
      FreeAndNil(qAux);
      lrControle := Insere;
      UGeral.Mensagem_Padrao(lrControle);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TMovimentacao_Manual }

procedure TMovimentacao_Manual.Alterar(var Registro: TMovimentacao_Manual);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      begin
        with qAux, SQL do
        begin
          close;
          clear;
          Connection := DM.ADOConnection1;
          add('Update Movimentacao_Manual set Codigo_Empresa = :Codigo_Empresa, Codigo_Funcionario = :Codigo_Funcionario,');
          add('Codigo_Cliente = :Codigo_Cliente, Data_Emissao = :Data_Emissao, N_Ordem = :N_Ordem,');
          add('Modelo = :Modelo, N_Serie = :N_Serie, Caixa = :Caixa, Total_Produtos = :Total_Produtos,');
          add('Desconto = :Desconto, Tipo_Desconto = :Tipo_Desconto, Total_Pedido = :Total_Pedido,');
          add('Observacao = :Observacao');
          add('where Codigo = :Codigo');
          Parameters.ParamByName('Codigo').Value := Registro.Cod;
          Parameters.ParamByName('Codigo_Empresa').Value :=
            Registro.Cod_Empresa;
          Parameters.ParamByName('Codigo_Funcionario').Value :=
            Registro.Cod_Funcionario;
          Parameters.ParamByName('Codigo_Cliente').Value :=
            Registro.Cod_Cliente;
          Parameters.ParamByName('Data_Emissao').Value := Registro.Data_Emis;
          Parameters.ParamByName('N_Ordem').Value := Registro.N_Ord;
          Parameters.ParamByName('Modelo').Value := Registro.Model;
          Parameters.ParamByName('N_Serie').Value := Registro.N_Ser;
          Parameters.ParamByName('Caixa').Value := Registro.Cai;
          Parameters.ParamByName('Total_Produtos').Value := Registro.Total_Prod;
          Parameters.ParamByName('Desconto').Value := Registro.Desc;
          Parameters.ParamByName('Tipo_Desconto').Value := Registro.Tipo_Desc;
          Parameters.ParamByName('Total_Pedido').Value := Registro.Total_Ped;
          Parameters.ParamByName('Observacao').Value := Registro.Obs;
          ExecSQL;
        end;
      end;
    finally
      // DM.ADOConnection1.CommitTrans;
      qAux.close;
      FreeAndNil(qAux);
      lrControle := Altera;
      UGeral.Mensagem_Padrao(lrControle);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TMovimentacao_Manual.Excluir(var Registro: TMovimentacao_Manual);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Delete from Movimentacao_Manual where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        ExecSQL;
      end;
    finally
      // DM.ADOConnection1.CommitTrans;
      lrControle := Exclui;
      UGeral.Mensagem_Padrao(lrControle);
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

function TMovimentacao_Manual.GetCaixa: string;
begin
  GetCaixa := StringOfChar('0', 4 - Length(UDeclaracao.Sequencia)) +
    UDeclaracao.Sequencia;
end;

function TMovimentacao_Manual.GetCodigo: integer;
begin
  GetCodigo := StrToInt(FrmMovimentacao_Manual.EdtCodigo.Text);
end;

function TMovimentacao_Manual.GetCodigo_Cliente: integer;
begin
  GetCodigo_Cliente := StrToInt(FrmMovimentacao_Manual.EdtCodigo_Cliente.Text);
end;

function TMovimentacao_Manual.GetCodigo_Empresa: integer;
begin
  GetCodigo_Empresa := UDeclaracao.Codigo_Empresa;
end;

function TMovimentacao_Manual.GetCodigo_Funcionario: integer;
begin
  GetCodigo_Funcionario :=
    StrToInt(FrmMovimentacao_Manual.EdtCodigo_Funcionario.Text);
end;

function TMovimentacao_Manual.GetData_Emissao: Tdate;
begin
  GetData_Emissao := StrToDateTime(FrmMovimentacao_Manual.MEdtData_Venda.Text);
end;

function TMovimentacao_Manual.GetDesconto: double;
begin
  GetDesconto := StrToFloat(FrmMovimentacao_Manual.EdtDesconto.Text);
end;

function TMovimentacao_Manual.GetModelo: string;
begin
  GetModelo := FrmMovimentacao_Manual.EdtModelo.Text;
end;

function TMovimentacao_Manual.GetN_Ordem: string;
begin
  GetN_Ordem := FrmMovimentacao_Manual.EdtN_Ordem.Text;
end;

function TMovimentacao_Manual.GetN_Serie: string;
begin
  GetN_Serie := FrmMovimentacao_Manual.EdtN_Serie.Text;
end;

function TMovimentacao_Manual.GetObservacao: string;
begin
  GetObservacao := FrmMovimentacao_Manual.MmoObservacao.Text;
end;

function TMovimentacao_Manual.GetTipo_Desconto: string;
begin
  GetTipo_Desconto := '$';
end;

function TMovimentacao_Manual.GetTotal_Pedido: double;
begin
  GetTotal_Pedido := StrToFloat(FrmMovimentacao_Manual.EdtTotal_Pedido.Text);
end;

function TMovimentacao_Manual.GetTotal_Produtos: double;
begin
  GetTotal_Produtos :=
    StrToFloat(FrmMovimentacao_Manual.EdtTotal_Produtos.Text);
end;

procedure TMovimentacao_Manual.Inserir(var Registro: TMovimentacao_Manual);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      begin
        with qAux, SQL do
        begin
          close;
          clear;
          Connection := DM.ADOConnection1;
          add('Insert into Movimentacao_Manual (Codigo, Codigo_Empresa, Codigo_Funcionario, Codigo_Cliente,');
          add('Data_Emissao, N_Ordem, Modelo, N_Serie, Caixa, Total_Produtos, Desconto, Tipo_Desconto,');
          add('Total_Pedido, Observacao)');
          add('values (:Codigo, :Codigo_Empresa, :Codigo_Funcionario, :Codigo_Cliente,');
          add(':Data_Emissao, :N_Ordem, :Modelo, :N_Serie, :Caixa, :Total_Produtos, :Desconto,');
          add(':Tipo_Desconto, :Total_Pedido, :Observacao)');
          Parameters.ParamByName('Codigo').Value := Registro.Cod;
          Parameters.ParamByName('Codigo_Empresa').Value :=
            Registro.Cod_Empresa;
          Parameters.ParamByName('Codigo_Funcionario').Value :=
            Registro.Cod_Funcionario;
          Parameters.ParamByName('Codigo_Cliente').Value :=
            Registro.Cod_Cliente;
          Parameters.ParamByName('Data_Emissao').Value := Registro.Data_Emis;
          Parameters.ParamByName('N_Ordem').Value := Registro.N_Ord;
          Parameters.ParamByName('Modelo').Value := Registro.Model;
          Parameters.ParamByName('N_Serie').Value := Registro.N_Ser;
          Parameters.ParamByName('Caixa').Value := Registro.Cai;
          Parameters.ParamByName('Total_Produtos').Value := Registro.Total_Prod;
          Parameters.ParamByName('Desconto').Value := Registro.Desc;
          Parameters.ParamByName('Tipo_Desconto').Value := Registro.Tipo_Desc;
          Parameters.ParamByName('Total_Pedido').Value := Registro.Total_Ped;
          Parameters.ParamByName('Observacao').Value := Registro.Obs;
          ExecSQL;
        end;
      end;
    finally
      // DM.ADOConnection1.CommitTrans;
      qAux.close;
      FreeAndNil(qAux);
      lrControle := Insere;
      UGeral.Mensagem_Padrao(lrControle);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TItens_Movimentacao_Manual }

procedure TItens_Movimentacao_Manual.Alterar(var Registro
  : TItens_Movimentacao_Manual);
begin
  //
end;

procedure TItens_Movimentacao_Manual.Excluir(var Registro
  : TItens_Movimentacao_Manual);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Delete from Itens_Movimentacao_Manual where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        ExecSQL;
      end;
    finally
      // DM.ADOConnection1.CommitTrans;
      // lrControle:= Exclui;
      // UGeral.Mensagem_Padrao(lrControle);
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TItens_Movimentacao_Manual.Excluir_Item(var Registro
  : TItens_Movimentacao_Manual);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Delete from Itens_Movimentacao_Manual where Codigo = :Codigo and Codigo_Produto = :Produto');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        Parameters.ParamByName('Produto').Value :=
          FrmMovimentacao_Manual.qryitens_movimentacaoCodigo_Produto.AsInteger;
        ExecSQL;
      end;
    finally
      // DM.ADOConnection1.CommitTrans;
      // lrControle:= Exclui;
      // UGeral.Mensagem_Padrao(lrControle);
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

function TItens_Movimentacao_Manual.GetBase_Acrescida: string;
begin
  GetBase_Acrescida := FrmMovimentacao_Manual.LblBase_Acrescida.Caption;
end;

function TItens_Movimentacao_Manual.GetBase_Acrescida_COFINS: string;
begin
  GetBase_Acrescida_COFINS :=
    FrmMovimentacao_Manual.LblBase_Acrescida_COFINS.Caption;
end;

function TItens_Movimentacao_Manual.GetBase_Acrescida_IPI: string;
begin
  GetBase_Acrescida_IPI := FrmMovimentacao_Manual.LblBase_Acrescida_IPI.Caption;
end;

function TItens_Movimentacao_Manual.GetBase_Acrescida_PIS: string;
begin
  GetBase_Acrescida_PIS := FrmMovimentacao_Manual.LblBase_Acrescida_PIS.Caption;
end;

function TItens_Movimentacao_Manual.GetBase_Reduzida: string;
begin
  GetBase_Reduzida := FrmMovimentacao_Manual.LblBase_Reduzida.Caption;
end;

function TItens_Movimentacao_Manual.GetBase_Reduzida_COFINS: string;
begin
  GetBase_Reduzida_COFINS :=
    FrmMovimentacao_Manual.LblBase_Reduzida_COFINS.Caption;
end;

function TItens_Movimentacao_Manual.GetBase_Reduzida_IPI: string;
begin
  GetBase_Reduzida_IPI := FrmMovimentacao_Manual.LblBase_Reduzida_IPI.Caption;
end;

function TItens_Movimentacao_Manual.GetBase_Reduzida_PIS: string;
begin
  GetBase_Reduzida_PIS := FrmMovimentacao_Manual.LblBase_Reduzida_PIS.Caption;
end;

function TItens_Movimentacao_Manual.GetBC: string;
begin
  GetBC := FrmMovimentacao_Manual.LblBC.Caption;
end;

function TItens_Movimentacao_Manual.GetBC_COFINS: string;
begin
  GetBC_COFINS := FrmMovimentacao_Manual.LblBC_COFINS.Caption;
end;

function TItens_Movimentacao_Manual.GetBC_IPI: string;
begin
  GetBC_IPI := FrmMovimentacao_Manual.LblBC_IPI.Caption;
end;

function TItens_Movimentacao_Manual.GetBC_PIS: string;
begin
  GetBC_PIS := FrmMovimentacao_Manual.LblBC_PIS.Caption;
end;

function TItens_Movimentacao_Manual.GetCodigo: integer;
begin
  GetCodigo := StrToInt(FrmMovimentacao_Manual.EdtCodigo.Text);
end;

function TItens_Movimentacao_Manual.GetCodigo_Produto: integer;
begin
  GetCodigo_Produto := StrToInt(FrmMovimentacao_Manual.LblProduto.Caption);
end;

function TItens_Movimentacao_Manual.GetCOFINS: string;
begin
  GetCOFINS := FrmMovimentacao_Manual.LblCOFINS.Caption;
end;

function TItens_Movimentacao_Manual.GetCST: string;
begin
  GetCST := FrmMovimentacao_Manual.LblCST.Caption;
end;

function TItens_Movimentacao_Manual.GetCST_COFINS: string;
begin
  GetCST_COFINS := FrmMovimentacao_Manual.LblCST_COFINS.Caption;
end;

function TItens_Movimentacao_Manual.GetCST_IPI: string;
begin
  GetCST_IPI := FrmMovimentacao_Manual.LblCST_IPI.Caption;
end;

function TItens_Movimentacao_Manual.GetCST_PIS: string;
begin
  GetCST_PIS := FrmMovimentacao_Manual.LblCST_PIS.Caption;
end;

function TItens_Movimentacao_Manual.GetDesconto: double;
begin
  GetDesconto := StrToFloat(FrmMovimentacao_Manual.EdtDesconto_Item.Text);
end;

function TItens_Movimentacao_Manual.GetICMS: string;
begin
  GetICMS := FrmMovimentacao_Manual.LblICMS.Caption;
end;

function TItens_Movimentacao_Manual.GetIPI: string;
begin
  GetIPI := FrmMovimentacao_Manual.LblIPI.Caption;
end;

function TItens_Movimentacao_Manual.GetPIS: string;
begin
  GetPIS := FrmMovimentacao_Manual.LblPIS.Caption;
end;

function TItens_Movimentacao_Manual.GetQuantidade: double;
begin
  GetQuantidade := StrToFloat(FrmMovimentacao_Manual.EdtQuantidade.Text);
end;

function TItens_Movimentacao_Manual.GetSequencia: string;
begin
  GetSequencia := StringOfChar('0',
    3 - Length(IntToStr(FrmMovimentacao_Manual.sequencial))) +
    IntToStr(FrmMovimentacao_Manual.sequencial);
end;

function TItens_Movimentacao_Manual.GetSub_Total: double;
begin
  GetSub_Total := StrToFloat(FrmMovimentacao_Manual.EdtValor_Total.Text);
end;

function TItens_Movimentacao_Manual.GetSub_Total_Liquido: double;
begin
  GetSub_Total_Liquido :=
    StrToFloat(FrmMovimentacao_Manual.LblSub_Total_Liquido.Caption);
end;

function TItens_Movimentacao_Manual.GetTipo_Desconto: string;
begin
  GetTipo_Desconto := '$';
end;

function TItens_Movimentacao_Manual.GetUN: string;
begin
  GetUN := FrmMovimentacao_Manual.EdtUnidade.Text;
end;

function TItens_Movimentacao_Manual.GetValor_COFINS: double;
begin
  GetValor_COFINS := StrToFloat(FrmMovimentacao_Manual.LblValor_COFINS.Caption);
end;

function TItens_Movimentacao_Manual.GetValor_ICMS: double;
begin
  GetValor_ICMS := StrToFloat(FrmMovimentacao_Manual.LblValor_ICMS.Caption);
end;

function TItens_Movimentacao_Manual.GetValor_IPI: double;
begin
  GetValor_IPI := StrToFloat(FrmMovimentacao_Manual.LblValor_IPI.Caption);
end;

function TItens_Movimentacao_Manual.GetValor_PIS: double;
begin
  GetValor_PIS := StrToFloat(FrmMovimentacao_Manual.LblValor_PIS.Caption);
end;

function TItens_Movimentacao_Manual.GetValor_Unitario: double;
begin
  GetValor_Unitario :=
    StrToFloat(FrmMovimentacao_Manual.EdtValor_Unitario.Text);
end;

procedure TItens_Movimentacao_Manual.Inserir(var Registro
  : TItens_Movimentacao_Manual);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      begin
        with qAux, SQL do
        begin
          close;
          clear;
          Connection := DM.ADOConnection1;
          add('Insert into Itens_Movimentacao_Manual (Codigo, Sequencia, Codigo_Produto, UN, ');

          add('ICMS, CST, Base_Reduzida, Base_Acrescida, BC, Valor_ICMS, ');
          add('IPI, CST_IPI, Base_Reduzida_IPI, Base_Acrescida_IPI, BC_IPI, Valor_IPI, ');
          add('PIS, CST_PIS, Base_Reduzida_PIS, Base_Acrescida_PIS, BC_PIS, Valor_PIS, ');
          add('COFINS, CST_COFINS, Base_Reduzida_COFINS, Base_Acrescida_COFINS, BC_COFINS, Valor_COFINS, ');
          add('Valor_Unitario, Quantidade, Desconto, Tipo_Desconto, Sub_Total, Sub_Total_Liquido)');
          add('values (:Codigo, :Sequencia, :Codigo_Produto, :UN, ');

          add(':ICMS, :CST, :Base_Reduzida, :Base_Acrescida, :BC, :Valor_ICMS, ');
          add(':IPI, :CST_IPI, :Base_Reduzida_IPI, :Base_Acrescida_IPI, :BC_IPI, :Valor_IPI, ');
          add(':PIS, :CST_PIS, :Base_Reduzida_PIS, :Base_Acrescida_PIS, :BC_PIS, :Valor_PIS, ');
          add(':COFINS, :CST_COFINS, :Base_Reduzida_COFINS, :Base_Acrescida_COFINS, :BC_COFINS, :Valor_COFINS, ');
          add(':Valor_Unitario, :Quantidade, :Desconto, :Tipo_Desconto, :Sub_Total, :Sub_Total_Liquido)');

          Parameters.ParamByName('Codigo').Value := Registro.Cod;
          Parameters.ParamByName('Sequencia').Value := Registro.Seq;
          Parameters.ParamByName('Codigo_Produto').Value := Registro.Cod_Prod;
          Parameters.ParamByName('UN').Value := Registro.UNN;

          Parameters.ParamByName('ICMS').Value := Registro.ICMSS;
          Parameters.ParamByName('CST').Value := Registro.CSTT;
          Parameters.ParamByName('Base_Reduzida').Value :=
            Registro.Bas_Reduzida;
          Parameters.ParamByName('Base_Acrescida').Value :=
            Registro.Bas_Acrescida;
          Parameters.ParamByName('BC').Value := Registro.BCC;
          Parameters.ParamByName('Valor_ICMS').Value := Registro.Val_ICMS;

          Parameters.ParamByName('IPI').Value := Registro.IPII;
          Parameters.ParamByName('CST_IPI').Value := Registro.CSTT_IPI;
          Parameters.ParamByName('Base_Reduzida_IPI').Value :=
            Registro.Bas_Reduzida_IPI;
          Parameters.ParamByName('Base_Acrescida_IPI').Value :=
            Registro.Bas_Acrescida_IPI;
          Parameters.ParamByName('BC_IPI').Value := Registro.BCC_IPI;
          Parameters.ParamByName('Valor_IPI').Value := Registro.Val_IPI;

          Parameters.ParamByName('PIS').Value := Registro.PISS;
          Parameters.ParamByName('CST_PIS').Value := Registro.CSTT_PIS;
          Parameters.ParamByName('Base_Reduzida_PIS').Value :=
            Registro.Bas_Reduzida_PIS;
          Parameters.ParamByName('Base_Acrescida_PIS').Value :=
            Registro.Bas_Acrescida_PIS;
          Parameters.ParamByName('BC_PIS').Value := Registro.BCC_PIS;
          Parameters.ParamByName('Valor_PIS').Value := Registro.Val_PIS;

          Parameters.ParamByName('COFINS').Value := Registro.COFINSS;
          Parameters.ParamByName('CST_COFINS').Value := Registro.CSTT_COFINS;
          Parameters.ParamByName('Base_Reduzida_COFINS').Value :=
            Registro.Bas_Reduzida_COFINS;
          Parameters.ParamByName('Base_Acrescida_COFINS').Value :=
            Registro.Bas_Acrescida_COFINS;
          Parameters.ParamByName('BC_COFINS').Value := Registro.BCC_COFINS;
          Parameters.ParamByName('Valor_COFINS').Value := Registro.Val_COFINS;

          Parameters.ParamByName('Valor_Unitario').Value := Registro.Valor_Un;
          Parameters.ParamByName('Quantidade').Value := Registro.Qtde;
          Parameters.ParamByName('Desconto').Value := Registro.Desc;
          Parameters.ParamByName('Tipo_Desconto').Value := Registro.Tipo_Desc;
          Parameters.ParamByName('Sub_Total').Value := Registro.Sub_Tot;
          Parameters.ParamByName('Sub_Total_Liquido').Value :=
            Registro.Sub_Tot_Liquido;
          ExecSQL;
        end;
      end;
    finally
      // DM.ADOConnection1.CommitTrans;
      qAux.close;
      FreeAndNil(qAux);
      lrControle := Item;
      UGeral.Mensagem_Padrao(lrControle);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TVeiculo }

procedure TVeiculo.Alterar(var Registro: TVeiculo);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      begin
        with qAux, SQL do
        begin
          close;
          clear;
          Connection := DM.ADOConnection1;
          add('Update Veiculo set Tipo = :Tipo, Data_Cadastro = :Data_Cadastro, Veiculo = :Veiculo,');
          add('Codigo_Cliente = :Codigo_Cliente, Codigo_Marca = :Codigo_Marca, Modelo = :Modelo,');
          add('Ano_Fabricacao = :Ano_Fabricacao, Placa = :Placa, UF = :UF, Chassi = :Chassi, Renavam = :Renavam,');
          add('ANTT = :ANTT');
          add('where Codigo = :Codigo');
          Parameters.ParamByName('Codigo').Value := Registro.Cod;
          Parameters.ParamByName('Tipo').Value := Registro.Tip;
          Parameters.ParamByName('Data_Cadastro').Value := Registro.Data_Cad;
          Parameters.ParamByName('Veiculo').Value := Registro.Vei;
          Parameters.ParamByName('Codigo_Cliente').Value :=
            Registro.Cod_Cliente;
          Parameters.ParamByName('Codigo_Marca').Value := Registro.Marc;
          Parameters.ParamByName('Modelo').Value := Registro.Model;
          Parameters.ParamByName('Ano_Fabricacao').Value := Registro.Ano_Fab;
          Parameters.ParamByName('Placa').Value := Registro.Plac;
          Parameters.ParamByName('UF').Value := Registro.UFF;
          Parameters.ParamByName('Chassi').Value := Registro.Chas;
          Parameters.ParamByName('Renavam').Value := Registro.Rena;
          Parameters.ParamByName('ANTT').Value := Registro.ANTTT;
          ExecSQL;
        end;
      end;
    finally
      // DM.ADOConnection1.CommitTrans;
      qAux.close;
      FreeAndNil(qAux);
      lrControle := Altera;
      UGeral.Mensagem_Padrao(lrControle);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TVeiculo.Excluir(var Registro: TVeiculo);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Delete from Veiculo where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        ExecSQL;
      end;
    finally
      // DM.ADOConnection1.CommitTrans;
      lrControle := Exclui;
      UGeral.Mensagem_Padrao(lrControle);
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

function TVeiculo.GetAno_Fabricacao: string;
begin
  GetAno_Fabricacao := FrmCadastro_Veiculo.EdtAno_Fabricacao.Text;
end;

function TVeiculo.GetANTT: string;
begin
  GetANTT := FrmCadastro_Veiculo.EdtANTT.Text
end;

function TVeiculo.GetChassi: string;
begin
  GetChassi := FrmCadastro_Veiculo.EdtChassi.Text;
end;

function TVeiculo.GetCodigo: integer;
begin
  GetCodigo := StrToInt(FrmCadastro_Veiculo.EdtCodigo.Text);
end;

function TVeiculo.GetCodigo_Cliente: integer;
begin
  GetCodigo_Cliente := StrToInt(FrmCadastro_Veiculo.EdtCodigo_Cliente.Text);
end;

function TVeiculo.GetData_Cadastro: Tdate;
begin
  GetData_Cadastro := StrToDateTime(FrmCadastro_Veiculo.MEdtData_Cadastro.Text);
end;

function TVeiculo.GetMarca: integer;
begin
  GetMarca := StrToInt(FrmCadastro_Veiculo.EdtCodigo_Marca.Text);
end;

function TVeiculo.GetModelo: string;
begin
  GetModelo := FrmCadastro_Veiculo.EdtModelo.Text;
end;

function TVeiculo.GetPlaca: string;
begin
  GetPlaca := FrmCadastro_Veiculo.EdtPlaca.Text;
end;

function TVeiculo.GetRenavam: string;
begin
  GetRenavam := FrmCadastro_Veiculo.EdtRenavam.Text;
end;

function TVeiculo.GetTipo: string;
begin
  if (FrmCadastro_Veiculo.RGTipo.ItemIndex = 0) then
    GetTipo := 'VECULO'
  else
    GetTipo := 'REBOQUE';
end;

function TVeiculo.GetUF: string;
begin
  GetUF := FrmCadastro_Veiculo.EdtUF.Text;
end;

function TVeiculo.GetVeiculo: string;
begin
  GetVeiculo := FrmCadastro_Veiculo.EdtVeiculo.Text;
end;

procedure TVeiculo.Inserir(var Registro: TVeiculo);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      begin
        with qAux, SQL do
        begin
          close;
          clear;
          Connection := DM.ADOConnection1;
          add('Insert into Veiculo (Tipo, Data_Cadastro, Veiculo, Codigo_Cliente, ');
          add('Codigo_Marca, Modelo, Ano_Fabricacao, Placa, UF, Chassi, Renavam, ANTT)');
          add('values (:Tipo, :Data_Cadastro, :Veiculo, :Codigo_Cliente, :Codigo_Marca, ');
          add(':Modelo, :Ano_Fabricacao, :Placa, :UF, :Chassi, :Renavam, :ANTT)');
          // Parameters.ParamByName('Codigo').Value:= Registro.Cod;
          Parameters.ParamByName('Tipo').Value := Registro.Tip;
          Parameters.ParamByName('Data_Cadastro').Value := Registro.Data_Cad;
          Parameters.ParamByName('Veiculo').Value := Registro.Vei;
          Parameters.ParamByName('Codigo_Cliente').Value :=
            Registro.Cod_Cliente;
          Parameters.ParamByName('Codigo_Marca').Value := Registro.Marc;
          Parameters.ParamByName('Modelo').Value := Registro.Model;
          Parameters.ParamByName('Ano_Fabricacao').Value := Registro.Ano_Fab;
          Parameters.ParamByName('Placa').Value := Registro.Plac;
          Parameters.ParamByName('UF').Value := Registro.UFF;
          Parameters.ParamByName('Chassi').Value := Registro.Chas;
          Parameters.ParamByName('Renavam').Value := Registro.Rena;
          Parameters.ParamByName('ANTT').Value := Registro.ANTTT;
          ExecSQL;
        end;
      end;
    finally
      // DM.ADOConnection1.CommitTrans;
      qAux.close;
      FreeAndNil(qAux);
      lrControle := Insere;
      UGeral.Mensagem_Padrao(lrControle);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TItens_OS }

procedure TItens_OS.Excluir(var Registro: TItens_OS;
  var Conexao: TADOConnection);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := Conexao;
        add('Delete from Itens_OS where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        ExecSQL;
      end;
    finally
      // DM.ADOConnection1.CommitTrans;
      // lrControle:= Exclui;
      // UGeral.Mensagem_Padrao(lrControle);
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      TMensagens.MensagemErro('Erro: ' + E.Message);
      TLog.Error('Erro ao excluir itens de pedido: ' + E.Message);
    end;
  end;
end;

function TItens_OS.GetCodigo: integer;
begin
  GetCodigo := StrToInt(FrmPedido_Venda.EdtCodigo.Text);
end;

function TItens_OS.GetCodigo_Servico: integer;
begin
  GetCodigo_Servico := StrToInt(FrmOS.LblProduto.Caption);
end;

function TItens_OS.GetDesconto: double;
begin
  GetDesconto := StrToFloat(FrmOS.EdtDesconto_Servico.Text);
end;

function TItens_OS.GetN_Pedido: string;
begin
  if (FrmPedido_Venda <> NIl) then
    GetN_Pedido := FrmPedido_Venda.EdtN_Pedido.Text
  else if (FrmOS <> Nil) then
    GetN_Pedido := FrmOS.EdtN_Pedido.Text;
end;

function TItens_OS.GetSub_Total: double;
begin
  GetSub_Total := StrToFloat(FrmOS.EdtValor_Total_Servico.Text);
end;

function TItens_OS.GetTipo_Desconto: string;
begin
  GetTipo_Desconto := '$';
end;

function TItens_OS.GetValor_Unitario: double;
begin
  GetValor_Unitario := StrToFloat(FrmOS.EdtValor_Servico.Text);
end;

procedure TItens_OS.Inserir(var Registro: TItens_OS);
begin
  try
    { FrmPedido_Venda.CDSItens_OS.Open;
      FrmPedido_Venda.CDSItens_OS.Insert;
      FrmPedido_Venda.CDSItens_OS['N_Pedido']:= Registro.N_Ped;
      FrmPedido_Venda.CDSItens_OS['Codigo_Servico']:= Registro.Cod_Serv;
      FrmPedido_Venda.CDSItens_OS['Valor_Unitario']:= Registro.Valor_Un;
      FrmPedido_Venda.CDSItens_OS['Desconto']:= Registro.Desc;
      FrmPedido_Venda.CDSItens_OS['Tipo_Desconto']:= Registro.Tipo_Desc;
      FrmPedido_Venda.CDSItens_OS['Sub_Total']:= Registro.Sub_Tot;
      FrmPedido_Venda.CDSItens_OS['Codigo_Servico']:= FrmPedido_Venda.cod_servico;
      FrmPedido_Venda.CDSItens_OS['Descricao']:= FrmPedido_Venda.descricao_servico;
      FrmPedido_Venda.CDSItens_OS.SaveToFile(Local_Arquivo(15), dfXML); }
    lrControle := Item;
    UGeral.Mensagem_Padrao(lrControle);
  except
    //
  end;
end;

procedure TItens_OS.Salva_Banco(var Registro: TItens_OS);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      begin
        with qAux, SQL do
        begin
          close;
          clear;
          Connection := DM.ADOConnection1;
          add('Insert into Itens_Pedido (Codigo, N_Item, Codigo_Produto, UN, ');
          add('ICMS, CST, Base_Reduzida, Base_Acrescida, BC, Valor_ICMS, ');
          add('IPI, CST_IPI, Base_Reduzida_IPI, Base_Acrescida_IPI, BC_IPI, Valor_IPI, ');
          add('PIS, CST_PIS, Base_Reduzida_PIS, Base_Acrescida_PIS, BC_PIS, Valor_PIS, ');
          add('COFINS, CST_COFINS, Base_Reduzida_COFINS, Base_Acrescida_COFINS, BC_COFINS, Valor_COFINS, ');
          add('Qtde, Qtde_Entregue, Qtde_Restante, ');
          add('Valor_Unitario, Desconto, Tipo_Desconto, Acrecimo, Tipo_Acrecimo, Sub_Total, Sub_Total_Liquido, Cancelado)');
          add('values (:Codigo, :N_Item, :Codigo_Produto, :UN, ');
          add(':ICMS, :CST, :Base_Reduzida, :Base_Acrescida, :BC, :Valor_ICMS, ');
          add(':IPI, :CST_IPI, :Base_Reduzida_IPI, :Base_Acrescida_IPI, :BC_IPI, :Valor_IPI, ');
          add(':PIS, :CST_PIS, :Base_Reduzida_PIS, :Base_Acrescida_PIS, :BC_PIS, :Valor_PIS, ');
          add(':COFINS, :CST_COFINS, :Base_Reduzida_COFINS, :Base_Acrescida_COFINS, :BC_COFINS, :Valor_COFINS, ');
          add(':Qtde, :Qtde_Entregue, :Qtde_Restante, :Valor_Unitario,');
          add(':Desconto, :Tipo_Desconto, :Acrecimo, :Tipo_Acrecimo, :Sub_Total, :Sub_Total_Liquido, :Cancelado)');

          Parameters.ParamByName('Codigo').Value :=
            StrToInt(FrmOS.EdtCodigo.Text);
          Parameters.ParamByName('N_Item').Value := UDeclaracao.N_Item;;
          Parameters.ParamByName('Codigo_Produto').Value :=
            StrToInt(FrmOS.LblProduto.Caption);
          Parameters.ParamByName('UN').Value := FrmOS.EdtUnidade_Servico.Text;

          Parameters.ParamByName('ICMS').Value := FrmOS.LblICMS.Caption;
          Parameters.ParamByName('CST').Value := FrmOS.LblCST.Caption;
          Parameters.ParamByName('Base_Reduzida').Value :=
            FrmOS.LblBase_Reduzida.Caption;
          Parameters.ParamByName('Base_Acrescida').Value :=
            FrmOS.LblBase_Acrescida.Caption;
          Parameters.ParamByName('BC').Value := FrmOS.LblBC.Caption;
          Parameters.ParamByName('Valor_ICMS').Value :=
            StrToFloat(FrmOS.LblValor_ICMS.Caption);

          Parameters.ParamByName('IPI').Value := '';
          Parameters.ParamByName('CST_IPI').Value := '';
          Parameters.ParamByName('Base_Reduzida_IPI').Value := '';
          Parameters.ParamByName('Base_Acrescida_IPI').Value := '';
          Parameters.ParamByName('BC_IPI').Value := '';
          Parameters.ParamByName('Valor_IPI').Value := 0;

          Parameters.ParamByName('PIS').Value := '';
          Parameters.ParamByName('CST_PIS').Value := '';
          Parameters.ParamByName('Base_Reduzida_PIS').Value := '';
          Parameters.ParamByName('Base_Acrescida_PIS').Value := '';
          Parameters.ParamByName('BC_PIS').Value := '';
          Parameters.ParamByName('Valor_PIS').Value := 0;

          Parameters.ParamByName('COFINS').Value := '';
          Parameters.ParamByName('CST_COFINS').Value := '';
          Parameters.ParamByName('Base_Reduzida_COFINS').Value := '';
          Parameters.ParamByName('Base_Acrescida_COFINS').Value := '';
          Parameters.ParamByName('BC_COFINS').Value := '';
          Parameters.ParamByName('Valor_COFINS').Value := 0;

          Parameters.ParamByName('Qtde').Value := 1;
          Parameters.ParamByName('Qtde_Entregue').Value := 1;
          Parameters.ParamByName('Qtde_Restante').Value := 0;
          Parameters.ParamByName('Valor_Unitario').Value :=
            FrmOS.EdtValor_Servico.Text;
          Parameters.ParamByName('Desconto').Value :=
            StrToFloat(FrmOS.EdtDesconto_Servico.Text);
          Parameters.ParamByName('Tipo_Desconto').Value := '$';
          Parameters.ParamByName('Acrecimo').Value := 0;
          Parameters.ParamByName('Tipo_Acrecimo').Value := '$';
          Parameters.ParamByName('Sub_Total').Value :=
            FrmOS.EdtValor_Total_Servico.Text;
          Parameters.ParamByName('Sub_Total_Liquido').Value :=
            StrToFloat(FrmOS.LblSub_Total_Liquido.Caption);
          Parameters.ParamByName('Cancelado').Value := 'N';
          ExecSQL;
          // DM.ADOConnection1.CommitTrans;
        end;
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
      lrControle := Item;
      UGeral.Mensagem_Padrao(lrControle);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TFechamento_Estoque }

procedure TFechamento_Estoque.Alterar(var Registro: TFechamento_Estoque);
begin
  //
end;

procedure TFechamento_Estoque.Excluir(var Registro: TFechamento_Estoque);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Delete from Fechamento_Estoque where Codigo = :Codigo');
        Parameters.ParamByName('N_Pedido').Value := Registro.Cod;
        ExecSQL;
      end;
    finally
      // DM.ADOConnection1.CommitTrans;
      lrControle := Exclui;
      UGeral.Mensagem_Padrao(lrControle);
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

function TFechamento_Estoque.GetAno: string;
begin
  GetAno := FrmFechamento_Inventario.Ano;
end;

function TFechamento_Estoque.GetCodigo: integer;
begin
  GetCodigo := FrmFechamento_Inventario.Codigo;
end;

function TFechamento_Estoque.GetCodigo_Conta: string;
begin
  GetCodigo_Conta := '00000';
end;

function TFechamento_Estoque.GetCodigo_Empresa: integer;
begin
  GetCodigo_Empresa := UDeclaracao.Codigo_Empresa;
end;

function TFechamento_Estoque.GetCodigo_Participante: string;
begin
  GetCodigo_Participante := '';
end;

function TFechamento_Estoque.GetCodigo_Produto: integer;
begin
  GetCodigo_Produto := FrmFechamento_Inventario.qryestoqueCodigo.AsInteger;
end;

function TFechamento_Estoque.GetInd_Prop: integer;
begin
  GetInd_Prop := 0;
end;

function TFechamento_Estoque.GetMes: string;
begin
  GetMes := FrmFechamento_Inventario.Mes;
end;

function TFechamento_Estoque.GetQuantidade: double;
begin
  GetQuantidade := FrmFechamento_Inventario.qryestoqueEstoque.AsFloat;
end;

function TFechamento_Estoque.GetSub_Total: double;
begin
  GetSub_Total := FrmFechamento_Inventario.qryestoqueValorEstoque.AsFloat;
end;

function TFechamento_Estoque.GetTexto_Complementar: string;
begin
  GetTexto_Complementar := '';
end;

function TFechamento_Estoque.GetUN: string;
begin
  GetUN := FrmFechamento_Inventario.qryestoqueSigla.AsString;
end;

function TFechamento_Estoque.GetValor_Compra: double;
begin
  GetValor_Compra := FrmFechamento_Inventario.qryestoqueValor_Compra.AsFloat;
end;

procedure TFechamento_Estoque.Inserir(var Registro: TFechamento_Estoque);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      while not FrmFechamento_Inventario.qryestoque.Eof do
      begin
        with qAux, SQL do
        begin
          close;
          clear;
          Connection := DM.ADOConnection1;
          add('Insert into Fechamento_Estoque (Codigo, Codigo_Empresa, Mes, Ano, Codigo_Produto, UN,');
          add('Quantidade, Valor_Compra, Sub_Total, Ind_Prop, Codigo_Participante, Texto_Complementar,');
          add('Codigo_Conta)');
          add('values (:Codigo, :Codigo_Empresa, :Mes, :Ano, :Codigo_Produto, :UN, ');
          add(':Quantidade, :Valor_Compra, :Sub_Total, :Ind_Prop, :Codigo_Participante,');
          add(':Texto_Complementar, :Codigo_Conta)');
          Parameters.ParamByName('Codigo').Value := Registro.Cod;
          Parameters.ParamByName('Codigo_Empresa').Value :=
            Registro.Cod_Empresa;
          Parameters.ParamByName('Mes').Value := Registro.Me;
          Parameters.ParamByName('Ano').Value := Registro.An;
          Parameters.ParamByName('Codigo_Produto').Value := Registro.Cod_Pro;
          Parameters.ParamByName('UN').Value := Registro.UNN;
          Parameters.ParamByName('Quantidade').Value := Registro.Quant;
          Parameters.ParamByName('Valor_Compra').Value := Registro.Valor_Comp;
          Parameters.ParamByName('Sub_Total').Value := Registro.Sub_Tot;
          Parameters.ParamByName('Ind_Prop').Value := Registro.Ind_Pro;
          Parameters.ParamByName('Codigo_Participante').Value :=
            Registro.Cod_Part;
          Parameters.ParamByName('Texto_Complementar').Value :=
            Registro.Texto_Comp;
          Parameters.ParamByName('Codigo_Conta').Value := Registro.Codigo_Cont;
          ExecSQL;
        end;
        FrmFechamento_Inventario.qryestoque.Next;
      end;
    finally
      // DM.ADOConnection1.CommitTrans;
      qAux.close;
      FreeAndNil(qAux);
      lrControle := Insere;
      UGeral.Mensagem_Padrao(lrControle);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TControla_Codigo }

procedure TControla_Codigo.Excluir_Local;
var
  qAux: TADOQuery;
begin
  try
    DM.ADOConnectionLocal.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        Connection := DM.ADOConnectionLocal;
        clear;
        add('Delete from Controla_Codigo');
        ExecSQL;
        DM.ADOConnectionLocal.CommitTrans;
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      DM.ADOConnectionLocal.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

function TControla_Codigo.GetCodigo: integer;
begin
  GetCodigo := DM.qrycontrola_codigo['Codigo'];
end;

procedure TControla_Codigo.Inserir(var Registro: TControla_Codigo);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      DM.qrycontrola_codigo.First;
      while not DM.qrycontrola_codigo.Eof do
      begin
        with qAux, SQL do
        begin
          close;
          clear;
          Connection := DM.ADOConnection1;
          add('Insert into Controla_Codigo (Codigo)');
          add('values (:Codigo)');
          Parameters.ParamByName('Codigo').Value := DM.qrycontrola_codigo
            ['Codigo'];
          ExecSQL;
        end;
        DM.qrycontrola_codigo.Next;
      end;
    finally
      // DM.ADOConnection1.CommitTrans;
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TItens_Folha_Pagamento }

procedure TItens_Folha_Pagamento.Alterar(var Registro: TItens_Folha_Pagamento;
  Conexao: TADOConnection);
begin
  //
end;

procedure TItens_Folha_Pagamento.Excluir(var Registro: TItens_Folha_Pagamento;
  Conexao: TADOConnection);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := Conexao;
        add('Delete from Itens_Folha_Pagamento where Codigo = :Codigo and Codigo_Item = :Codigo_Item');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        Parameters.ParamByName('Codigo_Item').Value :=
          Registro.Cod_Item_Selecionado;
        ExecSQL;
      end;
    finally
      // DM.ADOConnection1.CommitTrans;
      // lrControle:= Exclui;
      // UGeral.Mensagem_Padrao(lrControle);
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TItens_Folha_Pagamento.Excluir_Tudo(var Registro
  : TItens_Folha_Pagamento; Conexao: TADOConnection);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := Conexao;
        add('Delete from Itens_Folha_Pagamento where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        ExecSQL;
      end;
    finally
      // DM.ADOConnection1.CommitTrans;
      lrControle := Exclui;
      UGeral.Mensagem_Padrao(lrControle);
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

function TItens_Folha_Pagamento.GetCodigo: integer;
begin
  GetCodigo := StrToInt(FrmFolha_Pagamento.EdtCodigo.Text);
end;

function TItens_Folha_Pagamento.GetCodigo_Item: integer;
begin
  GetCodigo_Item := StrToInt(FrmFolha_Pagamento.EdtCodigo_Item.Text);
end;

function TItens_Folha_Pagamento.GetCodigo_Item_Selecionado: integer;
begin
  GetCodigo_Item_Selecionado :=
    FrmFolha_Pagamento.qryitens_folhaCodigo_Item.AsInteger;
end;

function TItens_Folha_Pagamento.GetValor: double;
begin
  GetValor := StrToFloat(FrmFolha_Pagamento.EdtValor.Text);
end;

procedure TItens_Folha_Pagamento.Inserir(var Registro: TItens_Folha_Pagamento;
  Conexao: TADOConnection);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := Conexao;
        add('Insert into Itens_Folha_Pagamento (Codigo, Codigo_Item, Valor)');
        add('values (:Codigo, :Codigo_Item, :Valor)');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        Parameters.ParamByName('Codigo_Item').Value := Registro.Cod_Item;
        Parameters.ParamByName('Valor').Value := Registro.Val;
        ExecSQL;
      end;
    finally
      // DM.ADOConnection1.CommitTrans;
      qAux.close;
      FreeAndNil(qAux);
      lrControle := Item;
      UGeral.Mensagem_Padrao(lrControle);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TFolha_Pagamento }

procedure TFolha_Pagamento.Alterar(var Registro: TFolha_Pagamento;
  Conexao: TADOConnection);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      begin
        with qAux, SQL do
        begin
          close;
          clear;
          Connection := Conexao;
          add('Update Folha_Pagamento set Codigo_Funcionario = :Codigo_Funcionario, Codigo_Empresa = :Codigo_Empresa,');
          add('Mes_Ano = :Mes_Ano, Data_Fechamento = :Data_Fechamento, Entradas = :Entradas,');
          add('Saidas = :Saidas, Comissao = :Comissao, Desconto = :Desconto, Salario = :Salario, ');
          add('Quantidade_Itens = :Quantidade_Itens, Observacao = :Observacao');
          add('where Codigo = :Codigo');
          Parameters.ParamByName('Codigo').Value := Registro.Cod;
          Parameters.ParamByName('Codigo_Funcionario').Value :=
            Registro.Cod_Funcionario;
          Parameters.ParamByName('Codigo_Empresa').Value :=
            Registro.Cod_Empresa;
          Parameters.ParamByName('Mes_Ano').Value := Registro.Mes_An;
          Parameters.ParamByName('Data_Fechamento').Value := Registro.Data_Fec;
          Parameters.ParamByName('Entradas').Value := Registro.Entr;
          Parameters.ParamByName('Saidas').Value := Registro.Sai;
          Parameters.ParamByName('Comissao').Value := Registro.Comis;
          Parameters.ParamByName('Desconto').Value := Registro.Desc;
          Parameters.ParamByName('Salario').Value := Registro.Sal;
          Parameters.ParamByName('Quantidade_Itens').Value :=
            Registro.Quant_Itens;
          Parameters.ParamByName('Observacao').Value := Registro.Obs;
          ExecSQL;
        end;
      end;
    finally
      // DM.ADOConnection1.CommitTrans;
      qAux.close;
      FreeAndNil(qAux);
      lrControle := Altera;
      UGeral.Mensagem_Padrao(lrControle);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TFolha_Pagamento.Excluir(var Registro: TFolha_Pagamento;
  Conexao: TADOConnection);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := Conexao;
        add('Delete from Folha_Pagamento where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        ExecSQL;
      end;
    finally
      // DM.ADOConnection1.CommitTrans;
      // lrControle:= Exclui;
      // UGeral.Mensagem_Padrao(lrControle);
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

function TFolha_Pagamento.GetCodigo: integer;
begin
  GetCodigo := StrToInt(FrmFolha_Pagamento.EdtCodigo.Text);
end;

function TFolha_Pagamento.GetCodigo_Empresa: integer;
begin
  GetCodigo_Empresa := StrToInt(FrmFolha_Pagamento.EdtCodigo_Empresa.Text);
end;

function TFolha_Pagamento.GetCodigo_Funcionario: integer;
begin
  GetCodigo_Funcionario :=
    StrToInt(FrmFolha_Pagamento.EdtCodigo_Funcionario.Text);
end;

function TFolha_Pagamento.GetComissao: double;
begin
  GetComissao := StrToFloat(FrmFolha_Pagamento.EdtComissao.Text);
end;

function TFolha_Pagamento.GetData_Fechamento: Tdate;
begin
  GetData_Fechamento := StrToDateTime
    (FrmFolha_Pagamento.MEdtData_Fechamento.Text);
end;

function TFolha_Pagamento.GetDesconto: double;
begin
  GetDesconto := StrToFloat(FrmFolha_Pagamento.EdtDesconto.Text);
end;

function TFolha_Pagamento.GetEntradas: double;
begin
  GetEntradas := StrToFloat(FrmFolha_Pagamento.EdtEntradas.Text);
end;

function TFolha_Pagamento.GetMes_Ano: string;
begin
  GetMes_Ano := FrmFolha_Pagamento.MEdtMes_Ano.Text
end;

function TFolha_Pagamento.GetObservacao: string;
begin
  GetObservacao := FrmFolha_Pagamento.MmoObservacao.Text;
end;

function TFolha_Pagamento.GetQuantidade_Itens: integer;
begin
  GetQuantidade_Itens := StrToInt(FrmFolha_Pagamento.EdtQuantidade_Itens.Text);
end;

function TFolha_Pagamento.GetSaidas: double;
begin
  GetSaidas := StrToFloat(FrmFolha_Pagamento.EdtSaidas.Text);
end;

function TFolha_Pagamento.GetSalario: double;
begin
  GetSalario := StrToFloat(FrmFolha_Pagamento.EdtSalario.Text);
end;

procedure TFolha_Pagamento.Inserir(var Registro: TFolha_Pagamento;
  Conexao: TADOConnection);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := Conexao;
        add('Insert into Folha_Pagamento (Codigo, Codigo_Funcionario, Codigo_Empresa, Mes_Ano, Data_Fechamento,');
        add('Entradas, Saidas, Comissao, Desconto, Salario, Observacao, Quantidade_Itens)');
        add('values (:Codigo, :Codigo_Funcionario, :Codigo_Empresa, :Mes_Ano, :Data_Fechamento,');
        add(':Entradas, :Saidas, :Comissao, :Desconto, :Salario, :Observacao, :Quantidade_Itens)');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        Parameters.ParamByName('Codigo_Funcionario').Value :=
          Registro.Cod_Funcionario;
        Parameters.ParamByName('Codigo_Empresa').Value := Registro.Cod_Empresa;
        Parameters.ParamByName('Mes_Ano').Value := Registro.Mes_An;
        Parameters.ParamByName('Data_Fechamento').Value := Registro.Data_Fec;
        Parameters.ParamByName('Entradas').Value := Registro.Entr;
        Parameters.ParamByName('Saidas').Value := Registro.Sai;
        Parameters.ParamByName('Comissao').Value := Registro.Comis;
        Parameters.ParamByName('Desconto').Value := Registro.Desc;
        Parameters.ParamByName('Salario').Value := Registro.Sal;
        Parameters.ParamByName('Quantidade_Itens').Value :=
          Registro.Quant_Itens;
        Parameters.ParamByName('Observacao').Value := Registro.Obs;
        ExecSQL;
      end;
    finally
      // DM.ADOConnection1.CommitTrans;
      qAux.close;
      FreeAndNil(qAux);
      lrControle := Insere;
      UGeral.Mensagem_Padrao(lrControle);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TConta_Fixa }

procedure TConta_Fixa.Alterar(var Registro: TConta_Fixa);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Update Conta_Fixa set Codigo_Empresa = :Codigo_Empresa, Data_Cadastro = :Data_Cadastro, ');
        add('Descricao = :Descricao, Codigo_Plano = :Codigo_Plano, Valor = :Valor, ');
        add('Dia_Vencimento = :Dia_Vencimento, Tipo = :Tipo, Observacao = :Observacao');
        add('where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Codi;
        Parameters.ParamByName('Codigo_Empresa').Value := Registro.Cod_Empresa;
        Parameters.ParamByName('Data_Cadastro').Value := Registro.Data_Cad;
        Parameters.ParamByName('Descricao').Value := Registro.Desc;
        Parameters.ParamByName('Codigo_Plano').Value := Registro.Cod_Plan;
        Parameters.ParamByName('Valor').Value := Registro.Val;
        Parameters.ParamByName('Dia_Vencimento').Value := Registro.Dia_Venc;
        Parameters.ParamByName('Tipo').Value := Registro.Tip;
        Parameters.ParamByName('Observacao').Value := Registro.Obs;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Altera;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TConta_Fixa.Excluir(var Registro: TConta_Fixa);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Delete from Conta_Fixa where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Codi;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Exclui;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

function TConta_Fixa.GetCodigo: integer;
begin
  GetCodigo := StrToInt(FrmConta_Fixa.EdtCodigo.Text);
end;

function TConta_Fixa.GetCodigo_Empresa: integer;
begin
  GetCodigo_Empresa := UDeclaracao.Codigo_Empresa;
end;

function TConta_Fixa.GetCodigo_Plano: integer;
begin
  if (FrmConta_Fixa.EdtCodigo_Plano.Text = '') then
    GetCodigo_Plano := 0
  else
    GetCodigo_Plano := StrToInt(FrmConta_Fixa.EdtCodigo_Plano.Text);
end;

function TConta_Fixa.GetData_Cadastro: Tdate;
begin
  GetData_Cadastro := StrToDateTime(FrmConta_Fixa.MEdtData_Lancamento.Text);
end;

function TConta_Fixa.GetDescricao: string;
begin
  GetDescricao := FrmConta_Fixa.EdtDescricao.Text;
end;

function TConta_Fixa.GetDia_Vencimento: integer;
begin
  GetDia_Vencimento := StrToInt(FrmConta_Fixa.EdtDia.Text);
end;

function TConta_Fixa.GetObservacao: string;
begin
  GetObservacao := FrmConta_Fixa.MmoObservacoes.Text;
end;

function TConta_Fixa.GetTipo: string;
begin
  if (FrmConta_Fixa.RGTipo.ItemIndex = 0) then
    GetTipo := 'CRDITO'
  else
    GetTipo := 'DBITO';
end;

function TConta_Fixa.GetValor: double;
begin
  GetValor := StrToFloat(FrmConta_Fixa.EdtValor.Text);
end;

procedure TConta_Fixa.Inserir(var Registro: TConta_Fixa);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Insert into Conta_Fixa (Codigo_Empresa = :Codigo_Empresa, Data_Cadastro, Descricao, Codigo_Plano, Valor, Dia_Vencimento, Tipo, Observacao) ');
        add('values (:Data_Cadastro, :Descricao, :Codigo_Plano, :Valor, :Dia_Vencimento, :Tipo, :Observacao)');
        Parameters.ParamByName('Codigo_Empresa').Value := Registro.Cod_Empresa;
        Parameters.ParamByName('Data_Cadastro').Value := Registro.Data_Cad;
        Parameters.ParamByName('Descricao').Value := Registro.Desc;
        Parameters.ParamByName('Codigo_Plano').Value := Registro.Cod_Plan;
        Parameters.ParamByName('Valor').Value := Registro.Val;
        Parameters.ParamByName('Dia_Vencimento').Value := Registro.Dia_Venc;
        Parameters.ParamByName('Tipo').Value := Registro.Tip;
        Parameters.ParamByName('Observacao').Value := Registro.Obs;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Insere;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TEntrada_Produtos }

procedure TEntrada_Produtos.Alterar(var Registro: TEntrada_Produtos);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Update Entrada_Produtos set N_Nota_Fiscal = :N_Nota_Fiscal, Modelo = :Modelo, Serie = :Serie,');
        add('Data_Emissao = :Data_Emissao, Hora_Emissao = :Hora_Emissao, Data_Entrada = :Data_Entrada,');
        add('Hora_Entrada = :Hora_Entrada, Tipo_Frete = :Tipo_Frete, Tipo_Pagamento = :Tipo_Pagamento,');
        add('Codigo_Fornecedor = :Codigo_Fornecedor, Codigo_CFOP = :Codigo_CFOP,');
        add('Codigo_Empresa = :Codigo_Empresa, Quantidade_Itens = :Quantidade_Itens, Observacao = :Observacao,');
        add('Codigo_Funcionario = :Codigo_Funcionario, Chave_NFe_Entrada = :Chave_NFe_Entrada, Caixa_ECF = :Caixa_ECF');
        add('where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        Parameters.ParamByName('N_Nota_Fiscal').Value := Registro.N_Nota_Fis;
        Parameters.ParamByName('Modelo').Value := Registro.Model;
        Parameters.ParamByName('Serie').Value := Registro.Seri;
        Parameters.ParamByName('Data_Emissao').Value := Registro.Data_Emis;
        Parameters.ParamByName('Hora_Emissao').Value := Registro.Hora_Emis;
        Parameters.ParamByName('Data_Entrada').Value := Registro.Data_Ent;
        Parameters.ParamByName('Hora_Entrada').Value := Registro.Hora_Ent;
        Parameters.ParamByName('Tipo_Frete').Value := Registro.Tipo_Fre;
        Parameters.ParamByName('Tipo_Pagamento').Value := Registro.Tipo_Pag;
        Parameters.ParamByName('Codigo_Fornecedor').Value :=
          Registro.Cod_Fornecedor;
        Parameters.ParamByName('Codigo_CFOP').Value := Registro.Cod_CFOP;
        Parameters.ParamByName('Codigo_Empresa').Value := Registro.Cod_Empresa;
        Parameters.ParamByName('Quantidade_Itens').Value :=
          Registro.Quant_Itens;
        Parameters.ParamByName('Observacao').Value := Registro.Obs;
        Parameters.ParamByName('Codigo_Funcionario').Value := codigo_usu;
        Parameters.ParamByName('Chave_NFe_Entrada').Value :=
          FrmEntrada_Produtos.EdtChave_Acesso.Text;
        Parameters.ParamByName('Caixa_ECF').Value :=
          StrToInt(Registro.CaixaECF);
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        // lrControle:= Altera;
        // UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TEntrada_Produtos.Excluir(var Registro: TEntrada_Produtos);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Delete from Entrada_Produtos where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        // lrControle:= Exclui;
        // UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

function TEntrada_Produtos.GetCaixaECF: string;
begin
  FCaixaECF := Trim(FrmEntrada_Produtos.EditCaixaECF.Text);
  Result := '0' + FCaixaECF;
end;

function TEntrada_Produtos.GetCodigo: integer;
begin
  GetCodigo := StrToInt(FrmEntrada_Produtos.EdtCodigo.Text);
end;

function TEntrada_Produtos.GetCodigo_CFOP: integer;
begin
  GetCodigo_CFOP := StrToInt(FrmEntrada_Produtos.EdtCodigo_CFOP.Text);
end;

function TEntrada_Produtos.GetCodigo_Empresa: integer;
begin
  GetCodigo_Empresa := UDeclaracao.Codigo_Empresa;
end;

function TEntrada_Produtos.GetCodigo_Fornecedor: integer;
begin
  GetCodigo_Fornecedor :=
    StrToInt(FrmEntrada_Produtos.EdtCodigo_Fornecedor.Text);
end;

function TEntrada_Produtos.GetData_Emissao: Tdate;
begin
  GetData_Emissao := StrToDateTime(FrmEntrada_Produtos.MEdtData_Emissao.Text);
end;

function TEntrada_Produtos.GetData_Entrada: Tdate;
begin
  GetData_Entrada := StrToDateTime(FrmEntrada_Produtos.MEdtData_Entrada.Text);
end;

function TEntrada_Produtos.GetHora_Emissao: string;
begin
  GetHora_Emissao := FrmEntrada_Produtos.MEdtHora_Emissao.Text;
end;

function TEntrada_Produtos.GetHora_Entrada: string;
begin
  GetHora_Entrada := FrmEntrada_Produtos.MEdtHora_Entrada.Text;
end;

function TEntrada_Produtos.GetModelo: string;
begin
  GetModelo := FrmEntrada_Produtos.EdtModelo.Text;
end;

function TEntrada_Produtos.GetN_Nota_Fiscal: string;
begin
  GetN_Nota_Fiscal := FrmEntrada_Produtos.EdtN_Nota_Fiscal.Text;
end;

function TEntrada_Produtos.GetObservacao: string;
begin
  GetObservacao := FrmEntrada_Produtos.MmoObservacao.Text;
end;

function TEntrada_Produtos.GetQuantidade_Itens: integer;
begin
  GetQuantidade_Itens := StrToInt(FrmEntrada_Produtos.EdtQuantidade_Itens.Text);
end;

function TEntrada_Produtos.GetSerie: string;
begin
  GetSerie := FrmEntrada_Produtos.EdtSerie.Text;
end;

function TEntrada_Produtos.GetStatus: string;
begin
  GetStatus := 'N';
end;

function TEntrada_Produtos.GetTipo_Frete: string;
begin
  if (FrmEntrada_Produtos.RGTipo_Frete.ItemIndex = 0) then
    GetTipo_Frete := '0'
  else if (FrmEntrada_Produtos.RGTipo_Frete.ItemIndex = 1) then
    GetTipo_Frete := '1'
  else if (FrmEntrada_Produtos.RGTipo_Frete.ItemIndex = 2) then
    GetTipo_Frete := '2'
  else if (FrmEntrada_Produtos.RGTipo_Frete.ItemIndex = 3) then
    GetTipo_Frete := '9';

end;

function TEntrada_Produtos.GetTipo_Pagamento: string;
begin
  if (FrmEntrada_Produtos.RGTipo_Pagamento.ItemIndex = 0) then
    GetTipo_Pagamento := '0'
  else if (FrmEntrada_Produtos.RGTipo_Pagamento.ItemIndex = 1) then
    GetTipo_Pagamento := '1'
  else if (FrmEntrada_Produtos.RGTipo_Pagamento.ItemIndex = 2) then
    GetTipo_Pagamento := '9';
end;

procedure TEntrada_Produtos.Inserir(var Registro: TEntrada_Produtos);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Insert into Entrada_Produtos (Codigo, N_Nota_Fiscal, Modelo, Serie, Data_Emissao, Hora_Emissao, Data_Entrada,');
        add('Hora_Entrada, Tipo_Frete, Tipo_Pagamento, Codigo_Fornecedor, Codigo_CFOP, Codigo_Empresa, Quantidade_Itens, Observacao, Status, Codigo_Funcionario,Chave_NFe_Entrada, Caixa_ECF)');
        add('values (:Codigo, :N_Nota_Fiscal, :Modelo, :Serie, :Data_Emissao, :Hora_Emissao, :Data_Entrada,');
        add(':Hora_Entrada, :Tipo_Frete, :Tipo_Pagamento, :Codigo_Fornecedor, :Codigo_CFOP, :Codigo_Empresa, :Quantidade_Itens, :Observacao, :Status, :Codigo_Funcionario, :Chave_NFe_Entrada, :Caixa_ECF)');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        Parameters.ParamByName('N_Nota_Fiscal').Value := Registro.N_Nota_Fis;
        Parameters.ParamByName('Modelo').Value := Registro.Model;
        Parameters.ParamByName('Serie').Value := Registro.Seri;
        Parameters.ParamByName('Data_Emissao').Value := Registro.Data_Emis;
        Parameters.ParamByName('Hora_Emissao').Value := Registro.Hora_Emis;
        Parameters.ParamByName('Data_Entrada').Value := Registro.Data_Ent;
        Parameters.ParamByName('Hora_Entrada').Value := Registro.Hora_Ent;
        Parameters.ParamByName('Tipo_Frete').Value := Registro.Tipo_Fre;
        Parameters.ParamByName('Tipo_Pagamento').Value := Registro.Tipo_Pag;
        Parameters.ParamByName('Codigo_Fornecedor').Value :=
          Registro.Cod_Fornecedor;
        Parameters.ParamByName('Codigo_CFOP').Value := Registro.Cod_CFOP;
        Parameters.ParamByName('Codigo_Empresa').Value := Registro.Cod_Empresa;
        Parameters.ParamByName('Quantidade_Itens').Value :=
          Registro.Quant_Itens;
        Parameters.ParamByName('Observacao').Value := Registro.Obs;
        Parameters.ParamByName('Status').Value := Registro.St;
        Parameters.ParamByName('Codigo_Funcionario').Value := codigo_usu;
        Parameters.ParamByName('Caixa_ECF').Value :=
          StrToInt(Registro.CaixaECF);
        Parameters.ParamByName('Chave_NFe_Entrada').Value :=
          FrmEntrada_Produtos.EdtChave_Acesso.Text;
        ExecSQL;
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TEntrada_Produtos.Inserir_Copia(var Registro: TEntrada_Produtos);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Insert into Entrada_Produtos (Codigo, N_Nota_Fiscal, Modelo, Serie, Data_Emissao, Hora_Emissao, Data_Entrada,');
        add('Hora_Entrada, Tipo_Frete, Tipo_Pagamento, Codigo_Fornecedor, Codigo_CFOP, Codigo_Empresa, Quantidade_Itens, Observacao, Status, Codigo_Funcionario)');
        add('values (:Codigo, :N_Nota_Fiscal, :Modelo, :Serie, :Data_Emissao, :Hora_Emissao, :Data_Entrada,');
        add(':Hora_Entrada, :Tipo_Frete, :Tipo_Pagamento, :Codigo_Fornecedor, :Codigo_CFOP, :Codigo_Empresa, :Quantidade_Itens, :Observacao, :Status, :Codigo_Funcionario)');

        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        Parameters.ParamByName('N_Nota_Fiscal').Value :=
          FrmInforma_NNF.EdtNota_Destino.Text;
        Parameters.ParamByName('Modelo').Value := Registro.Model;
        Parameters.ParamByName('Serie').Value := Registro.Seri;
        Parameters.ParamByName('Data_Emissao').Value := Registro.Data_Emis;
        Parameters.ParamByName('Hora_Emissao').Value := Registro.Hora_Emis;
        Parameters.ParamByName('Data_Entrada').Value := Registro.Data_Ent;
        Parameters.ParamByName('Hora_Entrada').Value := Registro.Hora_Ent;
        Parameters.ParamByName('Tipo_Frete').Value := Registro.Tipo_Fre;
        Parameters.ParamByName('Tipo_Pagamento').Value := Registro.Tipo_Pag;
        Parameters.ParamByName('Codigo_Fornecedor').Value :=
          Registro.Cod_Fornecedor;
        Parameters.ParamByName('Codigo_CFOP').Value := Registro.Cod_CFOP;
        Parameters.ParamByName('Codigo_Empresa').Value := Registro.Cod_Empresa;
        Parameters.ParamByName('Quantidade_Itens').Value :=
          Registro.Quant_Itens;
        Parameters.ParamByName('Observacao').Value := Registro.Obs;
        Parameters.ParamByName('Status').Value := Registro.St;
        Parameters.ParamByName('Codigo_Funcionario').Value := codigo_usu;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        // lrControle:= Insere;
        // UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TItens_Entrada }

procedure TItens_Entrada.Excluir(var Registro: TItens_Entrada);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Delete from Itens_Entrada where N_Nota_Fiscal = :N_Nota_Fiscal and Codigo_Produto = :Codigo');
        Parameters.ParamByName('N_Nota_Fiscal').Value := Registro.N_Nota_Fis;
        Parameters.ParamByName('Codigo').Value := Registro.Cod_Prod_Sel;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Exclui;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TItens_Entrada.Excluir_Tudo(var Registro: TItens_Entrada);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Delete from Itens_Entrada where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        // lrControle:= Exclui;
        // UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

function TItens_Entrada.GetAliquota_ICMS: string;
begin
  GetAliquota_ICMS := FrmEntrada_Produtos.EdtICMS.Text;
end;

function TItens_Entrada.GetAliquota_IPI: string;
begin
  GetAliquota_IPI := FrmEntrada_Produtos.EdtIPI.Text;
end;

function TItens_Entrada.GetBC_ICMS: double;
begin
  GetBC_ICMS := StrToFloat(FrmEntrada_Produtos.EdtBC_ICMS.Text);
end;

function TItens_Entrada.GetCFOP: string;
begin
  GetCFOP := FrmEntrada_Produtos.EdtCFOP2.Text;
end;

function TItens_Entrada.GetCodigo: integer;
begin
  GetCodigo := StrToInt(FrmEntrada_Produtos.EdtCodigo.Text);
end;

function TItens_Entrada.GetCodigo_Produto: integer;
begin
  GetCodigo_Produto := StrToInt(FrmEntrada_Produtos.LblProduto.Caption);
end;

function TItens_Entrada.GetCodigo_Produto_Selecionado: integer;
begin
  GetCodigo_Produto_Selecionado :=
    FrmEntrada_Produtos.qryitens_entradaCodigo_Produto.AsInteger;
end;

function TItens_Entrada.GetCusto_Unitario: double;
begin
  GetCusto_Unitario := StrToFloat(FrmEntrada_Produtos.EdtCusto_Unitario.Text);
end;

function TItens_Entrada.GetNCM: string;
begin
  GetNCM := FrmEntrada_Produtos.EdtNCM.Text;
end;

function TItens_Entrada.GetN_Item: string;
begin
  GetN_Item := StringOfChar('0', 3 - Length(IntToStr(FrmEntrada_Produtos.N_Item)
    )) + IntToStr(FrmEntrada_Produtos.N_Item);
end;

function TItens_Entrada.GetN_Nota_Fiscal: string;
begin
  GetN_Nota_Fiscal := FrmEntrada_Produtos.EdtN_Nota_Fiscal.Text;
end;

function TItens_Entrada.GetPercentual_Lucro: double;
begin
  GetPercentual_Lucro :=
    StrToFloat(FrmEntrada_Produtos.EdtPercentual_Lucro_Vista.Text);
end;

function TItens_Entrada.GetPercentual_Lucro_Prazo: double;
begin
  GetPercentual_Lucro_Prazo :=
    StrToFloat(FrmEntrada_Produtos.EdtPercentual_Lucro_Prazo.Text);
end;

function TItens_Entrada.GetQuantidade: double;
begin
  GetQuantidade := StrToFloat(FrmEntrada_Produtos.EdtQuantidade.Text);
end;

function TItens_Entrada.GetQuantidade_Restante: double;
begin
  GetQuantidade_Restante := FrmEntrada_Produtos.qtde_pendente;
end;

function TItens_Entrada.GetQuantidade_Volume: double;
begin
  GetQuantidade_Volume :=
    StrToFloat(FrmEntrada_Produtos.EdtQuantidade_Volume.Text);
end;

function TItens_Entrada.GetST: string;
begin
  GetST := FrmEntrada_Produtos.EdtSituacao_Tributaria.Text;
end;

function TItens_Entrada.GetUnidade: string;
begin
  GetUnidade := FrmEntrada_Produtos.EdtUnidade.Text;
end;

function TItens_Entrada.GetValor_ICMS_Unitario: double;
begin
  GetValor_ICMS_Unitario :=
    StrToFloat(FrmEntrada_Produtos.EdtValor_ICMS_Unitario.Text);
end;

function TItens_Entrada.GetValor_IPI: double;
begin
  GetValor_IPI := StrToFloat(FrmEntrada_Produtos.EdtValor_IPI.Text);
end;

function TItens_Entrada.GetValor_Prazo: double;
begin
  GetValor_Prazo := StrToFloat(FrmEntrada_Produtos.EdtValor_Prazo.Text);
end;

function TItens_Entrada.GetValor_Total: double;
begin
  GetValor_Total := StrToFloat(FrmEntrada_Produtos.EdtValor_Total.Text);
end;

function TItens_Entrada.GetValor_Ultima_Compra: double;
begin
  GetValor_Ultima_Compra := FrmEntrada_Produtos.Valor_Compra;
end;

function TItens_Entrada.GetValor_Unitario: double;
begin
  GetValor_Unitario := StrToFloat(FrmEntrada_Produtos.EdtValor_Unitario.Text);
end;

function TItens_Entrada.GetValor_Unitario_Frete: double;
begin
  GetValor_Unitario_Frete :=
    StrToFloat(FrmEntrada_Produtos.EdtValor_Unitario_Frete.Text);
end;

function TItens_Entrada.GetValor_Venda: double;
begin
  GetValor_Venda := StrToFloat(FrmEntrada_Produtos.EdtValor_Vista.Text);
end;

procedure TItens_Entrada.Inserir(var Registro: TItens_Entrada);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Insert into Itens_Entrada (Codigo, N_Item, N_Nota_Fiscal, Codigo_Produto, NCM, Unidade, ST, Valor_Ultima_Compra, Valor_Unitario, Quantidade, Quantidade_Restante,');
        add('Valor_Total, Valor_Frete_Unitario, Quantidade_Volume, BC_ICMS, Aliquota_ICMS, Aliquota_IPI, CFOP, Valor_ICMS_Unitario, Valor_IPI, Custo_Unitario,');
        add('Percentual_Lucro_Vista, Valor_Vista, Percentual_Lucro_Prazo, Valor_Prazo, Valor_Vista_Ultimo, Valor_Prazo_Ultimo, IVA, BC_ICMS_ST, Valor_ICMS_ST, Checado, Codigo_Produto_Fornecedor, Descricao_Produto, Valor_Ultima_Compra_Unitario, ');
        add('Qtde_Estoque_Atual, Ficha_Estoque_Codigo, Data_Validade) values (:Codigo, :N_Item, :N_Nota_Fiscal, :Codigo_Produto, :NCM, :Unidade, :ST, ');
        add(':Valor_Ultima_Compra, :Valor_Unitario, :Quantidade, :Quantidade_Restante, :Valor_Total, :Valor_Frete_Unitario, :Quantidade_Volume, :BC_ICMS, :Aliquota_ICMS, :Aliquota_IPI, :CFOP, :Valor_ICMS_Unitario, ');
        add(':Valor_IPI, :Custo_Unitario, :Percentual_Lucro_Vista, :Valor_Vista, :Percentual_Lucro_Prazo, :Valor_Prazo, :Valor_Vista_Ultimo, :Valor_Prazo_Ultimo, :IVA, :BC_ICMS_ST, :Valor_ICMS_ST, :Checado, :Codigo_Produto_Fornecedor, :Descricao_Produto, ');
        add(':Valor_Ultima_Compra_Unitario, :Qtde_Estoque_Atual, :Ficha_Estoque_Codigo, :Data_Validade)');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        Parameters.ParamByName('N_Item').Value := Registro.N_It;
        Parameters.ParamByName('N_Nota_Fiscal').Value := Registro.N_Nota_Fis;
        Parameters.ParamByName('Codigo_Produto').Value := Registro.Cod_Prod;
        Parameters.ParamByName('NCM').Value := Registro.NCMM;
        Parameters.ParamByName('Unidade').Value := Registro.Un;
        Parameters.ParamByName('ST').Value := Registro.STT;
        Parameters.ParamByName('Valor_Ultima_Compra').Value :=
          Registro.Valor_Ult_Comp;
        Parameters.ParamByName('Valor_Unitario').Value := Registro.Valor_Un;
        Parameters.ParamByName('Quantidade').Value := Registro.Quant;
        Parameters.ParamByName('Quantidade_Restante').Value :=
          Registro.Quant_Res;
        Parameters.ParamByName('Valor_Total').Value := Registro.Valor_Tot;
        Parameters.ParamByName('Valor_Frete_Unitario').Value :=
          Registro.Valor_Frete_Un;
        Parameters.ParamByName('Quantidade_Volume').Value :=
          Registro.Quant_Volume;
        Parameters.ParamByName('BC_ICMS').Value := Registro.BC_ICMSS;
        Parameters.ParamByName('Aliquota_ICMS').Value := Registro.Ali_ICMS;
        Parameters.ParamByName('Aliquota_IPI').Value := Registro.Ali_IPI;
        Parameters.ParamByName('CFOP').Value := Registro.CFOPP;
        Parameters.ParamByName('Valor_ICMS_Unitario').Value :=
          Registro.Val_ICMS_Un;
        Parameters.ParamByName('Valor_IPI').Value := Registro.Val_IPI;
        Parameters.ParamByName('Custo_Unitario').Value := Registro.Custo_Un;
        Parameters.ParamByName('Percentual_Lucro_Vista').Value :=
          Registro.Perc_Lucro;
        Parameters.ParamByName('Valor_Vista').Value := Registro.Val_Venda;
        Parameters.ParamByName('Percentual_Lucro_Prazo').Value :=
          Registro.Perc_Lucro_Prazo;
        Parameters.ParamByName('Valor_Prazo').Value := Registro.Val_Prazo;
        Parameters.ParamByName('Valor_Vista_Ultimo').Value :=
          FrmEntrada_Produtos.valor_vista;
        Parameters.ParamByName('Valor_Prazo_Ultimo').Value :=
          FrmEntrada_Produtos.valor_prazo;
        Parameters.ParamByName('IVA').Value :=
          StrToFloat(FrmEntrada_Produtos.EdtIVA.Text);
        Parameters.ParamByName('BC_ICMS_ST').Value :=
          StrToFloat(FrmEntrada_Produtos.EdtBC_ICMS_ST.Text);
        Parameters.ParamByName('Valor_ICMS_ST').Value :=
          StrToFloat(FrmEntrada_Produtos.EdtValor_ICMS_ST.Text);
        Parameters.ParamByName('Checado').Value := 'N';
        Parameters.ParamByName('Codigo_Produto_Fornecedor').Value :=
          FrmEntrada_Produtos.EdtCodigo_Produto.Text;
        Parameters.ParamByName('Descricao_Produto').Value :=
          FrmEntrada_Produtos.EdtProduto.Text;
        Parameters.ParamByName('Valor_Ultima_Compra_Unitario').Value :=
          FrmEntrada_Produtos.valor_compra_unitario;
        Parameters.ParamByName('Qtde_Estoque_Atual').Value := qtde_estoque;
        Parameters.ParamByName('Ficha_Estoque_Codigo').Value :=
          Registro.Ficha_Estoque_Codigo;

        if (FrmEntrada_Produtos.MEdtData_Validade.Text = '  /  /    ') then
          Parameters.ParamByName('Data_Validade').Value := NULL
        else
          Parameters.ParamByName('Data_Validade').Value :=
            StrToDateTime(FrmEntrada_Produtos.MEdtData_Validade.Text);

        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Insere;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TItens_Entrada.Inserir_Copia(var Registro: TItens_Entrada);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);

      FrmEntrada_Produtos.qryitens_entrada.First;
      while not FrmEntrada_Produtos.qryitens_entrada.Eof do
      begin
        with qAux, SQL do
        begin
          close;
          clear;
          Connection := DM.ADOConnection1;
          add('Insert into Itens_Entrada (Codigo, N_Item, N_Nota_Fiscal, Codigo_Produto, NCM, Unidade, ST, Valor_Ultima_Compra, Valor_Unitario, Quantidade, Quantidade_Restante,');
          add('Valor_Total, Valor_Frete_Unitario, Quantidade_Volume, Aliquota_ICMS, Aliquota_IPI, CFOP, Valor_IPI, Percentual_Lucro_Vista, Valor_Vista, Percentual_Lucro_Prazo, Valor_Prazo)');
          add('values (:Codigo, :N_Item, :N_Nota_Fiscal, :Codigo_Produto, :NCM, :Unidade, :ST, ');
          add(':Valor_Ultima_Compra, :Valor_Unitario, :Quantidade, :Quantidade_Restante, :Valor_Total, :Valor_Frete_Unitario, :Quantidade_Volume, :Aliquota_ICMS, :Aliquota_IPI, :CFOP,');
          add(':Valor_IPI, :Percentual_Lucro_Vista, :Valor_Vista, :Percentual_Lucro_Prazo, :Valor_Prazo)');

          Parameters.ParamByName('Codigo').Value := Registro.Cod;
          Parameters.ParamByName('N_Item').Value :=
            FrmEntrada_Produtos.qryitens_entradaN_Item.AsString;
          Parameters.ParamByName('N_Nota_Fiscal').Value :=
            FrmInforma_NNF.EdtNota_Destino.Text;
          Parameters.ParamByName('Codigo_Produto').Value :=
            FrmEntrada_Produtos.qryitens_entradaCodigo_Produto.AsInteger;
          Parameters.ParamByName('NCM').Value :=
            FrmEntrada_Produtos.qryitens_entradaNCM.AsString;
          Parameters.ParamByName('Unidade').Value :=
            FrmEntrada_Produtos.qryitens_entradaUnidade.AsString;
          Parameters.ParamByName('ST').Value :=
            FrmEntrada_Produtos.qryitens_entradaST.AsString;
          Parameters.ParamByName('Valor_Ultima_Compra').Value :=
            FrmEntrada_Produtos.qryitens_entradaValor_Ultima_Compra.AsFloat;
          Parameters.ParamByName('Valor_Unitario').Value :=
            FrmEntrada_Produtos.qryitens_entradaValor_Unitario.AsFloat;
          Parameters.ParamByName('Quantidade').Value :=
            FrmEntrada_Produtos.qryitens_entradaQuantidade.AsFloat;
          Parameters.ParamByName('Quantidade_Restante').Value :=
            FrmEntrada_Produtos.qryitens_entradaQuantidade_Restante.AsFloat;
          Parameters.ParamByName('Valor_Total').Value :=
            FrmEntrada_Produtos.qryitens_entradaValor_Total.AsFloat;
          Parameters.ParamByName('Valor_Frete_Unitario').Value :=
            FrmEntrada_Produtos.qryitens_entradaValor_Frete_Unitario.AsFloat;
          Parameters.ParamByName('Quantidade_Volume').Value :=
            FrmEntrada_Produtos.qryitens_entradaQuantidade_Volume.AsFloat;
          Parameters.ParamByName('Aliquota_ICMS').Value :=
            FrmEntrada_Produtos.qryitens_entradaAliquota_ICMS.AsString;
          Parameters.ParamByName('Aliquota_IPI').Value :=
            FrmEntrada_Produtos.qryitens_entradaAliquota_IPI.AsString;
          Parameters.ParamByName('CFOP').Value :=
            FrmEntrada_Produtos.qryitens_entradaCFOP.AsString;
          Parameters.ParamByName('Valor_IPI').Value :=
            FrmEntrada_Produtos.qryitens_entradaValor_IPI.AsFloat;
          Parameters.ParamByName('Percentual_Lucro_Vista').Value :=
            FrmEntrada_Produtos.qryitens_entradaPercentual_Lucro_Vista.AsFloat;
          Parameters.ParamByName('Valor_Vista').Value :=
            FrmEntrada_Produtos.qryitens_entradaValor_Vista.AsFloat;
          Parameters.ParamByName('Percentual_Lucro_Prazo').Value :=
            FrmEntrada_Produtos.qryitens_entradaPercentual_Lucro_Prazo.AsFloat;
          Parameters.ParamByName('Valor_Prazo').Value :=
            FrmEntrada_Produtos.qryitens_entradaValor_Prazo.AsFloat;
          ExecSQL;
          // lrControle:= Insere;
          // UGeral.Mensagem_Padrao(lrControle);
        end;
        FrmEntrada_Produtos.qryitens_entrada.Next;
      end;
    finally
      // DM.ADOConnection1.CommitTrans;
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TImpostos_Entrada }

procedure TImpostos_Entrada.Alterar(var Registro: TImpostos_Entrada);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Update Impostos_Entrada set N_Nota_Fiscal = :N_Nota_Fiscal, Total_Produtos = :Total_Produtos, Base_ICMS = :Base_ICMS,');
        add('Valor_ICMS = :Valor_ICMS, Isento_ICMS = :Isento_ICMS, Outros_ICMS = :Outros_ICMS, ');
        add('Base_ICMS_Subs = :Base_ICMS_Subs, Valor_ICMS_Subs = :Valor_ICMS_Subs, Aliquota = :Aliquota,');
        add('Valor_Frete = :Valor_Frete, Valor_Seguro = :Valor_Seguro, Outras_Despesas = :Outras_Despesas,');
        add('Total_IPI = :Total_IPI, Isento_IPI = :Isento_IPI, Outros_IPI = :Outros_IPI, ');
        add('Desconto = :Desconto, Total_Nota = :Total_Nota, Custo_Total = :Custo_Total');
        add('where Codigo = :Codigo');

        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        Parameters.ParamByName('N_Nota_Fiscal').Value := Registro.N_Nota_Fis;
        Parameters.ParamByName('Total_Produtos').Value := Registro.Total_Prod;
        Parameters.ParamByName('Base_ICMS').Value := Registro.Bas_ICMS;
        Parameters.ParamByName('Valor_ICMS').Value := Registro.Val_ICMS;
        Parameters.ParamByName('Isento_ICMS').Value := Registro.Is_ICMS;
        Parameters.ParamByName('Outros_ICMS').Value := Registro.Outr_ICMS;
        Parameters.ParamByName('Base_ICMS_Subs').Value :=
          Registro.Bas_ICMS_Subs;
        Parameters.ParamByName('Valor_ICMS_Subs').Value :=
          Registro.Val_ICMS_Subs;
        Parameters.ParamByName('Aliquota').Value := Registro.Ali;
        Parameters.ParamByName('Valor_Frete').Value := Registro.Val_Frete;
        Parameters.ParamByName('Valor_Seguro').Value := Registro.Val_Seguro;
        Parameters.ParamByName('Outras_Despesas').Value :=
          Registro.Outr_Despesas;
        Parameters.ParamByName('Total_IPI').Value := Registro.Tot_IPI;
        Parameters.ParamByName('Isento_IPI').Value := Registro.Is_IPI;
        Parameters.ParamByName('Outros_IPI').Value := Registro.Outr_IPI;
        Parameters.ParamByName('Desconto').Value := Registro.Desc;
        Parameters.ParamByName('Total_Nota').Value := Registro.Tot_Nota;
        Parameters.ParamByName('Custo_Total').Value :=
          StrToFloat(FrmEntrada_Produtos.EdtCusto_Total.Text);
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        // lrControle := Altera;
        // UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TImpostos_Entrada.Excluir(var Registro: TImpostos_Entrada);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Delete from Impostos_Entrada where N_Nota_Fiscal = :N_Nota_Fiscal');
        Parameters.ParamByName('N_Nota_Fiscal').Value := Registro.N_Nota_Fis;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        // lrControle:= Exclui;
        // UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

function TImpostos_Entrada.GetAliquota: double;
begin
  GetAliquota := StrToFloat(FrmEntrada_Produtos.EdtAliquota_ICMS.Text);
end;

function TImpostos_Entrada.GetBase_ICMS: double;
begin
  GetBase_ICMS := StrToFloat(FrmEntrada_Produtos.EdtBase_ICMS.Text);
end;

function TImpostos_Entrada.GetBase_ICMS_Subs: double;
begin
  GetBase_ICMS_Subs :=
    StrToFloat(FrmEntrada_Produtos.EdtBase_ICMS_Substituicao.Text);
end;

function TImpostos_Entrada.GetCodigo: integer;
begin
  GetCodigo := StrToInt(FrmEntrada_Produtos.EdtCodigo.Text);
end;

function TImpostos_Entrada.GetDesconto: double;
begin
  GetDesconto := StrToFloat(FrmEntrada_Produtos.EdtDesconto.Text);
end;

function TImpostos_Entrada.GetIsento_ICMS: double;
begin
  GetIsento_ICMS := StrToFloat(FrmEntrada_Produtos.EdtIsento_ICMS.Text);
end;

function TImpostos_Entrada.GetIsento_IPI: double;
begin
  GetIsento_IPI := StrToFloat(FrmEntrada_Produtos.EdtIsento_IPI.Text);
end;

function TImpostos_Entrada.GetN_Nota_Fiscal: string;
begin
  GetN_Nota_Fiscal := FrmEntrada_Produtos.EdtN_Nota_Fiscal.Text;
end;

function TImpostos_Entrada.GetOutras_Despesas: double;
begin
  GetOutras_Despesas := StrToFloat(FrmEntrada_Produtos.EdtOutras_Despesas.Text);
end;

function TImpostos_Entrada.GetOutros_ICMS: double;
begin
  GetOutros_ICMS := StrToFloat(FrmEntrada_Produtos.EdtOutros_ICMS.Text);
end;

function TImpostos_Entrada.GetOutros_IPI: double;
begin
  GetOutros_IPI := StrToFloat(FrmEntrada_Produtos.EdtOutros_IPI.Text);
end;

function TImpostos_Entrada.GetTotal_IPI: double;
begin
  GetTotal_IPI := StrToFloat(FrmEntrada_Produtos.EdtTotal_IPI.Text);
end;

function TImpostos_Entrada.GetTotal_Nota: double;
begin
  GetTotal_Nota := StrToFloat(FrmEntrada_Produtos.EdtTotal_Nota.Text);
end;

function TImpostos_Entrada.GetTotal_Produtos: double;
begin
  GetTotal_Produtos := StrToFloat(FrmEntrada_Produtos.EdtTotal_Produtos.Text);
end;

function TImpostos_Entrada.GetValor_Frete: double;
begin
  GetValor_Frete := StrToFloat(FrmEntrada_Produtos.EdtValor_Frete.Text);
end;

function TImpostos_Entrada.GetValor_ICMS: double;
begin
  GetValor_ICMS := StrToFloat(FrmEntrada_Produtos.EdtValor_ICMS.Text);
end;

function TImpostos_Entrada.GetValor_ICMS_Subs: double;
begin
  GetValor_ICMS_Subs :=
    StrToFloat(FrmEntrada_Produtos.EdtValor_ICMS_Substituicao.Text);
end;

function TImpostos_Entrada.GetValor_Seguro: double;
begin
  GetValor_Seguro := StrToFloat(FrmEntrada_Produtos.EdtValor_Seguro.Text);
end;

procedure TImpostos_Entrada.Inserir(var Registro: TImpostos_Entrada);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Insert into Impostos_Entrada (Codigo, N_Nota_Fiscal, Total_Produtos, Base_ICMS, Valor_ICMS, Isento_ICMS, Outros_ICMS,');
        add('Base_ICMS_Subs, Valor_ICMS_Subs, Aliquota, Valor_Frete, Valor_Seguro, Outras_Despesas, ');
        add('Total_IPI, Isento_IPI, Outros_IPI, Desconto, Total_Nota, Custo_Total)');
        add('values (:Codigo, :N_Nota_Fiscal, :Total_Produtos, :Base_ICMS, :Valor_ICMS, :Isento_ICMS, :Outros_ICMS, :Base_ICMS_Subs,');
        add(':Valor_ICMS_Subs, :Aliquota, :Valor_Frete, :Valor_Seguro, :Outras_Despesas,');
        add(':Total_IPI, :Isento_IPI, :Outros_IPI, :Desconto, :Total_Nota, :Custo_Total)');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        Parameters.ParamByName('N_Nota_Fiscal').Value := Registro.N_Nota_Fis;
        Parameters.ParamByName('Total_Produtos').Value := Registro.Total_Prod;
        Parameters.ParamByName('Base_ICMS').Value := Registro.Bas_ICMS;
        Parameters.ParamByName('Valor_ICMS').Value := Registro.Val_ICMS;
        Parameters.ParamByName('Isento_ICMS').Value := Registro.Is_ICMS;
        Parameters.ParamByName('Outros_ICMS').Value := Registro.Outr_ICMS;
        Parameters.ParamByName('Base_ICMS_Subs').Value :=
          Registro.Bas_ICMS_Subs;
        Parameters.ParamByName('Valor_ICMS_Subs').Value :=
          Registro.Val_ICMS_Subs;
        Parameters.ParamByName('Aliquota').Value := Registro.Ali;
        Parameters.ParamByName('Valor_Frete').Value := Registro.Val_Frete;
        Parameters.ParamByName('Valor_Seguro').Value := Registro.Val_Seguro;
        Parameters.ParamByName('Outras_Despesas').Value :=
          Registro.Outr_Despesas;
        Parameters.ParamByName('Total_IPI').Value := Registro.Tot_IPI;
        Parameters.ParamByName('Isento_IPI').Value := Registro.Is_IPI;
        Parameters.ParamByName('Outros_IPI').Value := Registro.Outr_IPI;
        Parameters.ParamByName('Desconto').Value := Registro.Desc;
        Parameters.ParamByName('Total_Nota').Value := Registro.Tot_Nota;
        Parameters.ParamByName('Custo_Total').Value :=
          StrToFloat(FrmEntrada_Produtos.EdtCusto_Total.Text);
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        // lrControle := Insere;
        // UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TImpostos_Entrada.Inserir_Copia(var Registro: TImpostos_Entrada);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Insert into Impostos_Entrada (Codigo, N_Nota_Fiscal, Total_Produtos, Base_ICMS, Valor_ICMS, Isento_ICMS, Outros_ICMS,');
        add('Base_ICMS_Subs, Valor_ICMS_Subs, Aliquota, Valor_Frete, Valor_Seguro, Outras_Despesas, ');
        add('Total_IPI, Isento_IPI, Outros_IPI, Desconto, Total_Nota)');
        add('values (:Codigo, :N_Nota_Fiscal, :Total_Produtos, :Base_ICMS, :Valor_ICMS, :Isento_ICMS, :Outros_ICMS, :Base_ICMS_Subs,');
        add(':Valor_ICMS_Subs, :Aliquota, :Valor_Frete, :Valor_Seguro, :Outras_Despesas,');
        add(':Total_IPI, :Isento_IPI, :Outros_IPI, :Desconto, :Total_Nota)');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        Parameters.ParamByName('N_Nota_Fiscal').Value :=
          FrmInforma_NNF.EdtNota_Destino.Text;
        Parameters.ParamByName('Total_Produtos').Value := Registro.Total_Prod;
        Parameters.ParamByName('Base_ICMS').Value := Registro.Bas_ICMS;
        Parameters.ParamByName('Valor_ICMS').Value := Registro.Val_ICMS;
        Parameters.ParamByName('Isento_ICMS').Value := Registro.Is_ICMS;
        Parameters.ParamByName('Outros_ICMS').Value := Registro.Outr_ICMS;
        Parameters.ParamByName('Base_ICMS_Subs').Value :=
          Registro.Bas_ICMS_Subs;
        Parameters.ParamByName('Valor_ICMS_Subs').Value :=
          Registro.Val_ICMS_Subs;
        Parameters.ParamByName('Aliquota').Value := Registro.Ali;
        Parameters.ParamByName('Valor_Frete').Value := Registro.Val_Frete;
        Parameters.ParamByName('Valor_Seguro').Value := Registro.Val_Seguro;
        Parameters.ParamByName('Outras_Despesas').Value :=
          Registro.Outr_Despesas;
        Parameters.ParamByName('Total_IPI').Value := Registro.Tot_IPI;
        Parameters.ParamByName('Isento_IPI').Value := Registro.Is_IPI;
        Parameters.ParamByName('Outros_IPI').Value := Registro.Outr_IPI;
        Parameters.ParamByName('Desconto').Value := Registro.Desc;
        Parameters.ParamByName('Total_Nota').Value := Registro.Tot_Nota;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        // lrControle:= Insere;
        // UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TTransportadora }

procedure TTransportadora.Alterar(var Registro: TTransportadora);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Update Transportadora set Nome_Fantasia = :Nome_Fantasia, ');
        add('Razao_Social = :Razao_Social, CPF = :CPF, RG = :RG, Orgao_Expedidor = :Orgao_Expedidor, ');
        add('Data_Emissao_RG = :Data_Emissao, CNPJ = :CNPJ, Insc_Estadual_Municipal = :Inscricao,');
        add('Numero = :Numero, Referencia = :Referencia, ');
        add('Codigo_Setor = :Setor, Codigo_Cidade = :Cidade, Telefone = :Telefone, ');
        add('Celular = :Celular, Email = :Email, Site = :Site, Data_Cadastro = :Data_Cad, Observacoes = :Obs, ');
        add('Endereco = :Endereco, CEP = :CEP');
        add('where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        Parameters.ParamByName('Nome_Fantasia').Value := Registro.Nome_Fan;
        Parameters.ParamByName('Razao_Social').Value := Registro.Raz;
        Parameters.ParamByName('CPF').Value := Registro.CP;
        Parameters.ParamByName('RG').Value := Registro.Ident;
        Parameters.ParamByName('Orgao_Expedidor').Value := Registro.Orgao;
        Parameters.ParamByName('Data_Emissao').Value := Registro.Data_Emis;
        Parameters.ParamByName('CNPJ').Value := Registro.CNP;
        Parameters.ParamByName('Inscricao').Value := Registro.Inscr;
        Parameters.ParamByName('Numero').Value := Registro.Num;
        Parameters.ParamByName('Referencia').Value := Registro.Refer;
        Parameters.ParamByName('Setor').Value := Registro.Seto;
        Parameters.ParamByName('Cidade').Value := Registro.Cid;
        Parameters.ParamByName('Telefone').Value := Registro.Tel;
        Parameters.ParamByName('Celular').Value := Registro.Cel;
        Parameters.ParamByName('Email').Value := Registro.Ema;
        Parameters.ParamByName('Site').Value := Registro.Sit;
        Parameters.ParamByName('Data_Cad').Value := Registro.Data_Cad;
        Parameters.ParamByName('Obs').Value := Registro.Obs;
        Parameters.ParamByName('Endereco').Value :=
          FrmCadastro_Transportadora.EdtEndereco.Text;
        Parameters.ParamByName('CEP').Value :=
          FrmCadastro_Transportadora.EdtCEP.Text;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Altera;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TTransportadora.Excluir(var Registro: TTransportadora);
var
  qAux: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Delete from Transportadora where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Exclui;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

function TTransportadora.GetCelular: string;
begin
  GetCelular := FrmCadastro_Transportadora.MEdtCelular.Text;
end;

function TTransportadora.GetCNPJ: string;
begin
  GetCNPJ := FrmCadastro_Transportadora.EdtCNPJ.Text;
end;

function TTransportadora.GetCodigo: integer;
begin
  GetCodigo := StrToInt(FrmCadastro_Transportadora.EdtCodigo.Text);
end;

function TTransportadora.GetCodigo_Cidade: integer;
begin
  if (FrmCadastro_Transportadora.EdtCodigo_Cidade.Text = '') then
    GetCodigo_Cidade := 0
  else
    GetCodigo_Cidade :=
      StrToInt(FrmCadastro_Transportadora.EdtCodigo_Cidade.Text);
end;

function TTransportadora.GetCodigo_Logradouro: integer;
begin
  { if (FrmCadastro_Transportadora.EdtCodigo_Endereco.Text = '') then
    GetCodigo_Logradouro := 0
    else
    GetCodigo_Logradouro := StrToInt
    (FrmCadastro_Transportadora.EdtCodigo_Endereco.Text); }
end;

function TTransportadora.GetCodigo_Setor: integer;
begin
  if (FrmCadastro_Transportadora.EdtCodigo_Setor.Text = '') then
    GetCodigo_Setor := 0
  else
    GetCodigo_Setor :=
      StrToInt(FrmCadastro_Transportadora.EdtCodigo_Setor.Text);
end;

function TTransportadora.GetCPF: string;
begin
  GetCPF := FrmCadastro_Transportadora.EdtCPF.Text;
end;

function TTransportadora.GetData_Cadastro: Tdate;
begin
  if (FrmCadastro_Transportadora.MEdtData_Cadastro.Text = '  /  /    ') then
    GetData_Cadastro := 0
  else
    GetData_Cadastro := StrToDateTime
      (FrmCadastro_Transportadora.MEdtData_Cadastro.Text);
end;

function TTransportadora.GetData_Emissao_RG: Tdate;
begin
  if (FrmCadastro_Transportadora.EdtData_Emissao.Text = '  /  /    ') then
    GetData_Emissao_RG := 0
  else
    GetData_Emissao_RG :=
      StrToDateTime(FrmCadastro_Transportadora.EdtData_Emissao.Text);
end;

function TTransportadora.GetEmail: string;
begin
  GetEmail := FrmCadastro_Transportadora.EdtEmail.Text;
end;

function TTransportadora.GetInsc_Estadual_Municipal: string;
begin
  GetInsc_Estadual_Municipal :=
    FrmCadastro_Transportadora.EdtInsc_Estadual_Municipal.Text;
end;

function TTransportadora.GetNome_Fantasia: string;
begin
  GetNome_Fantasia := FrmCadastro_Transportadora.EdtNome.Text;
end;

function TTransportadora.GetNumero: string;
begin
  GetNumero := FrmCadastro_Transportadora.EdtNumero.Text;
end;

function TTransportadora.GetObservacoes: string;
begin
  GetObservacoes := FrmCadastro_Transportadora.MmoObservacoes.Text;
end;

function TTransportadora.GetOrgao_Expedidor: string;
begin
  GetOrgao_Expedidor := FrmCadastro_Transportadora.EdtOrgao_Expedidor.Text;
end;

function TTransportadora.GetRazao_Social: string;
begin
  GetRazao_Social := FrmCadastro_Transportadora.EdtRazao_Social.Text;
end;

function TTransportadora.GetReferencia: string;
begin
  GetReferencia := FrmCadastro_Transportadora.EdtReferencia.Text;
end;

function TTransportadora.GetRG: string;
begin
  GetRG := FrmCadastro_Transportadora.EdtRG.Text;
end;

function TTransportadora.GetSite: string;
begin
  GetSite := FrmCadastro_Transportadora.EdtSite.Text;
end;

function TTransportadora.GetTelefone: string;
begin
  GetTelefone := FrmCadastro_Transportadora.MEdtTelefone.Text;
end;

procedure TTransportadora.Inserir(var Registro: TTransportadora);
var
  qAux: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Insert into Transportadora (Nome_Fantasia, Razao_Social, CPF, RG, Orgao_Expedidor, ');
        add('Data_Emissao_RG, CNPJ, Insc_Estadual_Municipal, ');
        add('Numero, Referencia, Codigo_Setor, Codigo_Cidade, Telefone, Celular, ');
        add('Email, Site, Data_Cadastro, Observacoes, Endereco, CEP) values');
        add('(:Nome_Fantasia, :Razao_Social, :CPF, :RG, :Orgao_Expedidor, :Data_Emissao,');
        add(':CNPJ, :Inscricao, :Numero, :Referencia, ');
        add(':Setor, :Cidade, :Telefone, :Celular, :Email, :Site, :Data_Cad, :Obs, :Endereco, :CEP)');
        Parameters.ParamByName('Nome_Fantasia').Value := Registro.Nome_Fan;
        Parameters.ParamByName('Razao_Social').Value := Registro.Raz;
        Parameters.ParamByName('CPF').Value := Registro.CP;
        Parameters.ParamByName('RG').Value := Registro.Ident;
        Parameters.ParamByName('Orgao_Expedidor').Value := Registro.Orgao;
        Parameters.ParamByName('Data_Emissao').Value := Registro.Data_Emis;
        Parameters.ParamByName('CNPJ').Value := Registro.CNP;
        Parameters.ParamByName('Inscricao').Value := Registro.Inscr;
        Parameters.ParamByName('Numero').Value := Registro.Num;
        Parameters.ParamByName('Referencia').Value := Registro.Refer;
        Parameters.ParamByName('Setor').Value := Registro.Seto;
        Parameters.ParamByName('Cidade').Value := Registro.Cid;
        Parameters.ParamByName('Telefone').Value := Registro.Tel;
        Parameters.ParamByName('Celular').Value := Registro.Cel;
        Parameters.ParamByName('Email').Value := Registro.Ema;
        Parameters.ParamByName('Site').Value := Registro.Sit;
        Parameters.ParamByName('Data_Cad').Value := Registro.Data_Cad;
        Parameters.ParamByName('Obs').Value := Registro.Obs;
        Parameters.ParamByName('Endereco').Value :=
          FrmCadastro_Transportadora.EdtEndereco.Text;
        Parameters.ParamByName('CEP').Value :=
          FrmCadastro_Transportadora.EdtCEP.Text;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Insere;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TEndereco_Cliente }

procedure TEndereco_Cliente.Alterar(var Registro: TEndereco_Cliente;
  var Conexao: TADOConnection);
var
  qAux: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := Conexao;
        add('UPDATE Endereco_Cliente');
        add('   SET Codigo_Setor = :Codigo_Setor');
        add('      ,Numero = :Numero');
        add('      ,Complemento = :Complemento');
        add('      ,Tipo_Endereco = :Tipo_Endereco,');
        add('      ,Endereco = :Endereco,');
        add('      ,CEP = :CEP');
        add('where Codigo_Registro = :Codigo_Registro');

        Parameters.ParamByName('Codigo_Setor').Value := Registro.Cod_Setor;
        Parameters.ParamByName('Numero').Value := Registro.Numer;
        Parameters.ParamByName('Complemento').Value := Registro.Comple;
        Parameters.ParamByName('Tipo_Endereco').Value := Registro.Tipo_Ender;
        Parameters.ParamByName('Endereco').Value :=
          FrmCadastro_Cliente.EdtEndereco_Outros.Text;
        Parameters.ParamByName('CEP').Value :=
          FrmCadastro_Cliente.EdtCEP_Outros.Text;
        Parameters.ParamByName('Codigo_Registro').Value :=
          FrmCadastro_Cliente.ADOQuery1Codigo_Registro.AsInteger;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Altera;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TEndereco_Cliente.Excluir(var Registro: TEndereco_Cliente;
  var Conexao: TADOConnection);
var
  qAux: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := Conexao;
        add('Delete from Endereco_Cliente where Codigo_Registro = :Codigo_Registro');
        Parameters.ParamByName('Codigo_Registro').Value :=
          FrmCadastro_Cliente.ADOQuery1Codigo_Registro.AsInteger;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Exclui;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TEndereco_Cliente.Excluir_Tudo(var Registro: TEndereco_Cliente;
  var Conexao: TADOConnection);
var
  qAux: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := Conexao;
        add('Delete from Endereco_Cliente where Codigo_Cliente = :Codigo_Cliente');
        Parameters.ParamByName('Codigo_Cliente').Value := Registro.Cod_Cliente;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        // lrControle:= Exclui;
        // UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

function TEndereco_Cliente.GetCodigo_Cliente: integer;
begin
  GetCodigo_Cliente := StrToInt(FrmCadastro_Cliente.EdtCodigo.Text);
end;

function TEndereco_Cliente.GetCodigo_Endereco: integer;
begin
  // GetCodigo_Endereco := StrToInt
  // (FrmCadastro_Cliente.EdtCodigo_Endereco_Outros.Text);
end;

function TEndereco_Cliente.GetCodigo_Endereco_Excluir: integer;
begin
  { GetCodigo_Endereco_Excluir :=
    FrmCadastro_Cliente.ADOQuery1Codigo_Endereco.AsInteger; }
end;

function TEndereco_Cliente.GetCodigo_Setor: integer;
begin
  if (FrmCadastro_Cliente.EdtCodigo_Setor_Outros.Text <> '') then
    GetCodigo_Setor := StrToInt(FrmCadastro_Cliente.EdtCodigo_Setor_Outros.Text)
  else
    GetCodigo_Setor := 0;
end;

function TEndereco_Cliente.GetComplemento: string;
begin
  GetComplemento := FrmCadastro_Cliente.EdtComplemento_Outros.Text;
end;

function TEndereco_Cliente.GetNumero: string;
begin
  GetNumero := FrmCadastro_Cliente.EdtNumero_Outros.Text;
end;

function TEndereco_Cliente.GetTipo_Endereco: string;
begin
  GetTipo_Endereco := FrmCadastro_Cliente.EdtTipo_Endereco.Text;
end;

procedure TEndereco_Cliente.Inserir(var Registro: TEndereco_Cliente;
  var Conexao: TADOConnection);
var
  qAux: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := Conexao;
        add('Insert into Endereco_Cliente (Codigo_Cliente, Codigo_Setor, Numero, Complemento, Tipo_Endereco, Endereco, CEP, Codigo_Cidade) values');
        add('(:Codigo_Cliente, :Codigo_Setor, :Numero, :Complemento, :Tipo_Endereco, :Endereco, :CEP, :Codigo_Cidade)');
        Parameters.ParamByName('Codigo_Cliente').Value := Registro.Cod_Cliente;
        Parameters.ParamByName('Codigo_Setor').Value := Registro.Cod_Setor;
        Parameters.ParamByName('Numero').Value := Registro.Numer;
        Parameters.ParamByName('Complemento').Value := Registro.Comple;
        Parameters.ParamByName('Tipo_Endereco').Value := Registro.Tipo_Ender;
        Parameters.ParamByName('Endereco').Value :=
          FrmCadastro_Cliente.EdtEndereco_Outros.Text;
        Parameters.ParamByName('Codigo_Cidade').Value :=
          StrToInt(FrmCadastro_Cliente.txtEdtCodCidadeOutros.Text);
        Parameters.ParamByName('CEP').Value :=
          FrmCadastro_Cliente.EdtCEP_Outros.Text;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Insere;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TCadastro_Observacao_Fiscal }

procedure TCadastro_Observacao_Fiscal.Alterar(var Registro
  : TCadastro_Observacao_Fiscal);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Update Cadastro_Observacao_Fiscal set Descricao = :Descricao, ');
        add('Data_Cadastro = :Data_Cadastro');
        add('where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        Parameters.ParamByName('Descricao').Value := Registro.Desc;
        Parameters.ParamByName('Data_Cadastro').Value := Registro.Data;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Altera;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TCadastro_Observacao_Fiscal.Excluir(var Registro
  : TCadastro_Observacao_Fiscal);
var
  qAux: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Delete from Cadastro_Observacao_Fiscal where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Exclui;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

function TCadastro_Observacao_Fiscal.GetCodigo: integer;
begin
  GetCodigo := StrToInt(FrmCadastro_Observacao_Fiscal.EdtCodigo.Text);
end;

function TCadastro_Observacao_Fiscal.GetData_Cadastro: Tdate;
begin
  GetData_Cadastro := StrToDateTime
    (FrmCadastro_Observacao_Fiscal.MEdtData_Cadastro.Text);
end;

function TCadastro_Observacao_Fiscal.GetDesc: string;
begin
  GetDesc := FrmCadastro_Observacao_Fiscal.EdtDescricao.Text;
end;

procedure TCadastro_Observacao_Fiscal.Inserir(var Registro
  : TCadastro_Observacao_Fiscal);
var
  qAux: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Insert into Cadastro_Observacao_Fiscal (Descricao, Data_Cadastro) values ');
        add('(:Descricao, :Data_Cadastro)');
        Parameters.ParamByName('Descricao').Value := Registro.Desc;
        Parameters.ParamByName('Data_Cadastro').Value := Registro.Data;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Insere;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TRegra_ICMS }

procedure TRegra_ICMS.Alterar(var Registro: TRegra_ICMS);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Update Regra_ICMS set Data_Cadastro = :Data_Cadastro, ');
        add('Descricao = :Descricao, Aliquota = :Aliquota, Tipo_Recolhimento = :Tipo_Recolhimento, Tipo_Calculo_BC_ICMS = :Tipo_Calculo_BC_ICMS,');
        add('Tipo_Calculo_BC_ICMS_ST = :Tipo_Calculo_BC_ICMS_ST, Base_Reduzida = :Base_Reduzida, Percentual_BC_Reduzida = :Percentual_BC_Reduzida,');
        add('Base_Acrescida = :Base_Acrescida, Percentual_BC_Acrescida = :Percentual_BC_Acrescida,');
        add('Codigo_Situacao_Tributaria = :Codigo_Situacao_Tributaria,');
        add('CFOP_D = :CFOP_D, CFOP_F = :CFOP_F');
        add('where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        Parameters.ParamByName('Data_Cadastro').Value := Registro.Data_Cad;
        Parameters.ParamByName('Descricao').Value := Registro.Desc;
        Parameters.ParamByName('Aliquota').Value := Registro.Aliq;
        Parameters.ParamByName('Tipo_Recolhimento').Value := Registro.Tipo_Rec;
        Parameters.ParamByName('Tipo_Calculo_BC_ICMS').Value :=
          FrmRegra_ICMS.CBModalidade_BC_ICMS.Text;
        Parameters.ParamByName('Tipo_Calculo_BC_ICMS_ST').Value :=
          FrmRegra_ICMS.CBModalidade_BC_ICMS_ST.Text;
        Parameters.ParamByName('Base_Reduzida').Value := Registro.Base_Red;
        Parameters.ParamByName('Percentual_BC_Reduzida').Value :=
          Registro.Perc_Base_Red;
        Parameters.ParamByName('Base_Acrescida').Value := Registro.Base_Acre;
        Parameters.ParamByName('Percentual_BC_Acrescida').Value :=
          Registro.Perc_Base_Acre;
        Parameters.ParamByName('Codigo_Situacao_Tributaria').Value :=
          Registro.Cod_Situacao_Tributaria;
        Parameters.ParamByName('CFOP_D').Value := Registro.CFOP_V_DD;
        Parameters.ParamByName('CFOP_F').Value := Registro.CFOP_V_FF;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Altera;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TRegra_ICMS.Excluir(var Registro: TRegra_ICMS);
var
  qAux: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Delete from Regra_ICMS where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Exclui;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

function TRegra_ICMS.GetAliquota: string;
begin
  GetAliquota := FrmRegra_ICMS.EdtAliquota.Text;
end;

function TRegra_ICMS.GetBase_Acrescida: string;
begin
  if (FrmRegra_ICMS.RGBase_Acrescida.ItemIndex = 0) then
    GetBase_Acrescida := 'SIM'
  else
    GetBase_Acrescida := 'NO';
end;

function TRegra_ICMS.GetBase_Reduzida: string;
begin
  if (FrmRegra_ICMS.RGBase_Reduzida.ItemIndex = 0) then
    GetBase_Reduzida := 'SIM'
  else
    GetBase_Reduzida := 'NO';
end;

function TRegra_ICMS.GetCFOP_V_D: string;
begin
  GetCFOP_V_D := FrmRegra_ICMS.EdtCFOP_V_D.Text;
end;

function TRegra_ICMS.GetCFOP_V_F: string;
begin
  GetCFOP_V_F := FrmRegra_ICMS.EdtCFOP_V_F.Text;
end;

function TRegra_ICMS.GetCodigo: integer;
begin
  GetCodigo := StrToInt(FrmRegra_ICMS.EdtCodigo.Text);
end;

function TRegra_ICMS.GetCodigo_Situacao_Tributaria: integer;
begin
  GetCodigo_Situacao_Tributaria :=
    StrToInt(FrmRegra_ICMS.EdtCodigo_Situacao_Tributaria.Text);
end;

function TRegra_ICMS.GetData_Cadastro: Tdate;
begin
  GetData_Cadastro := StrToDateTime(FrmRegra_ICMS.MEdtData_Cadastro.Text);
end;

function TRegra_ICMS.GetDescricao: string;
begin
  GetDescricao := FrmRegra_ICMS.EdtDescricao.Text;
end;

function TRegra_ICMS.GetPercentual_BC_Acrescida: string;
begin
  GetPercentual_BC_Acrescida :=
    FrmRegra_ICMS.EdtPercentual_Base_Calculo_Acrescida.Text;
end;

function TRegra_ICMS.GetPercentual_BC_Reduzida: string;
begin
  GetPercentual_BC_Reduzida :=
    FrmRegra_ICMS.EdtPercentual_Base_Calculo_Reduzida.Text;
end;

function TRegra_ICMS.GetTipo_Recolhimento: string;
begin
  if (FrmRegra_ICMS.RGTipo_Recolhimento.ItemIndex = 0) then
    GetTipo_Recolhimento := 'TRIBUTADO'
  else if (FrmRegra_ICMS.RGTipo_Recolhimento.ItemIndex = 1) then
    GetTipo_Recolhimento := 'ST'
  else if (FrmRegra_ICMS.RGTipo_Recolhimento.ItemIndex = 2) then
    GetTipo_Recolhimento := 'NT'
  else if (FrmRegra_ICMS.RGTipo_Recolhimento.ItemIndex = 3) then
    GetTipo_Recolhimento := 'I';
end;

procedure TRegra_ICMS.Inserir(var Registro: TRegra_ICMS);
var
  qAux: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Insert into Regra_ICMS (Data_Cadastro, Descricao, Aliquota, Tipo_Recolhimento, Tipo_Calculo_BC_ICMS, Tipo_Calculo_BC_ICMS_ST,');
        add('Base_Reduzida, Percentual_BC_Reduzida, Base_Acrescida, Percentual_BC_Acrescida, ');
        add('Codigo_Situacao_Tributaria, CFOP_D, CFOP_F) values ');
        add('(:Data_Cadastro, :Descricao, :Aliquota, :Tipo_Recolhimento, :Tipo_Calculo_BC_ICMS, :Tipo_Calculo_BC_ICMS_ST,');
        add(':Base_Reduzida, :Percentual_BC_Reduzida, :Base_Acrescida, :Percentual_BC_Acrescida, ');
        add(':Codigo_Situacao_Tributaria, :CFOP_D, :CFOP_F)');
        // Parameters.ParamByName('Codigo').Value:= Registro.Cod;
        Parameters.ParamByName('Data_Cadastro').Value := Registro.Data_Cad;
        Parameters.ParamByName('Descricao').Value := Registro.Desc;
        Parameters.ParamByName('Aliquota').Value := Registro.Aliq;
        Parameters.ParamByName('Tipo_Recolhimento').Value := Registro.Tipo_Rec;
        Parameters.ParamByName('Tipo_Calculo_BC_ICMS').Value :=
          FrmRegra_ICMS.CBModalidade_BC_ICMS.Text;
        Parameters.ParamByName('Tipo_Calculo_BC_ICMS_ST').Value :=
          FrmRegra_ICMS.CBModalidade_BC_ICMS_ST.Text;
        Parameters.ParamByName('Base_Reduzida').Value := Registro.Base_Red;
        Parameters.ParamByName('Percentual_BC_Reduzida').Value :=
          Registro.Perc_Base_Red;
        Parameters.ParamByName('Base_Acrescida').Value := Registro.Base_Acre;
        Parameters.ParamByName('Percentual_BC_Acrescida').Value :=
          Registro.Perc_Base_Acre;
        Parameters.ParamByName('Codigo_Situacao_Tributaria').Value :=
          Registro.Cod_Situacao_Tributaria;
        Parameters.ParamByName('CFOP_D').Value := Registro.CFOP_V_DD;
        Parameters.ParamByName('CFOP_F').Value := Registro.CFOP_V_FF;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Insere;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TTratamento_ICMS }

procedure TTratamento_ICMS.Alterar(var Registro: TTratamento_ICMS;
  Conexao: TADOConnection);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := Conexao;
        add('Update Tratamento_ICMS set Descricao = :Descricao, Data_Cadastro = :Data_Cadastro');
        add('where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        Parameters.ParamByName('Descricao').Value := Registro.Desc;
        Parameters.ParamByName('Data_Cadastro').Value := Registro.Data_Cad;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Altera;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TTratamento_ICMS.Excluir(var Registro: TTratamento_ICMS;
  Conexao: TADOConnection);
var
  qAux: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := Conexao;
        add('Delete from Tratamento_ICMS where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        // lrControle:= Exclui;
        // UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

function TTratamento_ICMS.GetCodigo: integer;
begin
  GetCodigo := StrToInt(FrmTratamento_ICMS.EdtCodigo.Text);
end;

function TTratamento_ICMS.GetData_Cadastro: Tdate;
begin
  GetData_Cadastro := StrToDateTime(FrmTratamento_ICMS.MEdtData_Cadastro.Text);
end;

function TTratamento_ICMS.GetDescricao: string;
begin
  GetDescricao := FrmTratamento_ICMS.EdtDescricao.Text;
end;

procedure TTratamento_ICMS.Inserir(var Registro: TTratamento_ICMS;
  Conexao: TADOConnection);
var
  qAux: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := Conexao;
        add('Insert into Tratamento_ICMS (Codigo, Descricao, Data_Cadastro) values ');
        add('(:Codigo, :Descricao, :Data_Cadastro)');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        Parameters.ParamByName('Descricao').Value := Registro.Desc;
        Parameters.ParamByName('Data_Cadastro').Value := Registro.Data_Cad;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Insere;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TCadastro_Grupo_Produto_Tributacao }

procedure TCadastro_Grupo_Produto_Tributacao.Alterar(var Registro
  : TCadastro_Grupo_Produto_Tributacao);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Update Grupo_Produto_Tributacao set Descricao = :Descricao, ');
        add('Codigo_Tratamento_ICMS = :Codigo_Tratamento_ICMS, Data_Cadastro = :Data_Cadastro');
        add('where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        Parameters.ParamByName('Descricao').Value := Registro.Desc;
        Parameters.ParamByName('Codigo_Tratamento_ICMS').Value :=
          Registro.Cod_Tratamento;
        Parameters.ParamByName('Data_Cadastro').Value := Registro.Data;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Altera;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TCadastro_Grupo_Produto_Tributacao.Excluir(var Registro
  : TCadastro_Grupo_Produto_Tributacao);
var
  qAux: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Delete from Grupo_Produto_Tributacao where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Exclui;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

function TCadastro_Grupo_Produto_Tributacao.GetCodigo: integer;
begin
  GetCodigo := StrToInt(FrmCadastro_Grupo_Produto_Tributacao.EdtCodigo.Text);
end;

function TCadastro_Grupo_Produto_Tributacao.GetCodigo_Tratamento: integer;
begin
  GetCodigo_Tratamento :=
    StrToInt(FrmCadastro_Grupo_Produto_Tributacao.
    EdtCodigo_Tratamento_ICMS.Text);
end;

function TCadastro_Grupo_Produto_Tributacao.GetData_Cadastro: Tdate;
begin
  GetData_Cadastro := StrToDateTime
    (FrmCadastro_Grupo_Produto_Tributacao.MEdtData_Cadastro.Text);
end;

function TCadastro_Grupo_Produto_Tributacao.GetDesc: string;
begin
  GetDesc := FrmCadastro_Grupo_Produto_Tributacao.EdtDescricao.Text;
end;

procedure TCadastro_Grupo_Produto_Tributacao.Inserir(var Registro
  : TCadastro_Grupo_Produto_Tributacao);
var
  qAux: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Insert into Grupo_Produto_Tributacao (Descricao, Codigo_Tratamento_ICMS, Data_Cadastro)');
        add(' values ');
        add('(:Descricao, :Codigo_Tratamento_ICMS, :Data_Cadastro)');
        // Parameters.ParamByName('Codigo').Value:= Registro.Cod;
        Parameters.ParamByName('Descricao').Value := Registro.Desc;
        Parameters.ParamByName('Codigo_Tratamento_ICMS').Value :=
          Registro.Cod_Tratamento;
        Parameters.ParamByName('Data_Cadastro').Value := Registro.Data;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Insere;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TRegra_PIS }

procedure TRegra_PIS.Alterar(var Registro: TRegra_PIS);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Update Regra_PIS set Data_Cadastro = :Data_Cadastro, ');
        add('Descricao = :Descricao, Aliquota = :Aliquota, Tipo_Calculo = :Tipo_Calculo, Tipo_Recolhimento = :Tipo_Recolhimento,');
        add('Base_Reduzida = :Base_Reduzida, Percentual_BC_Reduzida = :Percentual_BC_Reduzida,');
        add('Base_Acrescida = :Base_Acrescida, Percentual_BC_Acrescida = :Percentual_BC_Acrescida,');
        add('Codigo_Situacao_Tributaria = :Codigo_Situacao_Tributaria');
        add('where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        Parameters.ParamByName('Data_Cadastro').Value := Registro.Data_Cad;
        Parameters.ParamByName('Descricao').Value := Registro.Desc;
        Parameters.ParamByName('Aliquota').Value := Registro.Aliq;
        Parameters.ParamByName('Tipo_Calculo').Value :=
          FrmRegra_PIS.CBTipo_Calculo.Text;
        Parameters.ParamByName('Tipo_Recolhimento').Value := Registro.Tipo_Rec;
        Parameters.ParamByName('Base_Reduzida').Value := Registro.Base_Red;
        Parameters.ParamByName('Percentual_BC_Reduzida').Value :=
          Registro.Perc_Base_Red;
        Parameters.ParamByName('Base_Acrescida').Value := Registro.Base_Acre;
        Parameters.ParamByName('Percentual_BC_Acrescida').Value :=
          Registro.Perc_Base_Acre;
        Parameters.ParamByName('Codigo_Situacao_Tributaria').Value :=
          Registro.Cod_Situacao_Tributaria;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Altera;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TRegra_PIS.Excluir(var Registro: TRegra_PIS);
var
  qAux: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Delete from Regra_PIS where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Exclui;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

function TRegra_PIS.GetAliquota: string;
begin
  GetAliquota := FrmRegra_PIS.EdtAliquota.Text;
end;

function TRegra_PIS.GetBase_Acrescida: string;
begin
  if (FrmRegra_PIS.RGBase_Acrescida.ItemIndex = 0) then
    GetBase_Acrescida := 'SIM'
  else
    GetBase_Acrescida := 'NO';
end;

function TRegra_PIS.GetBase_Reduzida: string;
begin
  if (FrmRegra_PIS.RGBase_Reduzida.ItemIndex = 0) then
    GetBase_Reduzida := 'SIM'
  else
    GetBase_Reduzida := 'NO';
end;

function TRegra_PIS.GetCodigo: integer;
begin
  GetCodigo := StrToInt(FrmRegra_PIS.EdtCodigo.Text);
end;

function TRegra_PIS.GetCodigo_Situacao_Tributaria: integer;
begin
  GetCodigo_Situacao_Tributaria :=
    StrToInt(FrmRegra_PIS.EdtCodigo_Situacao_Tributaria.Text);
end;

function TRegra_PIS.GetData_Cadastro: Tdate;
begin
  GetData_Cadastro := StrToDateTime(FrmRegra_PIS.MEdtData_Cadastro.Text);
end;

function TRegra_PIS.GetDescricao: string;
begin
  GetDescricao := FrmRegra_PIS.EdtDescricao.Text;
end;

function TRegra_PIS.GetPercentual_BC_Acrescida: string;
begin
  GetPercentual_BC_Acrescida :=
    FrmRegra_PIS.EdtPercentual_Base_Calculo_Acrescida.Text;
end;

function TRegra_PIS.GetPercentual_BC_Reduzida: string;
begin
  GetPercentual_BC_Reduzida :=
    FrmRegra_PIS.EdtPercentual_Base_Calculo_Reduzida.Text;
end;

function TRegra_PIS.GetTipo_Recolhimento: string;
begin
  if (FrmRegra_PIS.RGTipo_Recolhimento.ItemIndex = 0) then
    GetTipo_Recolhimento := 'NORMAL'
  else
    GetTipo_Recolhimento := 'ST';
end;

procedure TRegra_PIS.Inserir(var Registro: TRegra_PIS);
var
  qAux: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Insert into Regra_PIS (Data_Cadastro, Descricao, Aliquota, Tipo_Calculo, Tipo_Recolhimento, ');
        add('Base_Reduzida, Percentual_BC_Reduzida, Base_Acrescida, Percentual_BC_Acrescida, ');
        add('Codigo_Situacao_Tributaria) values ');
        add('(:Data_Cadastro, :Descricao, :Aliquota, :Tipo_Calculo, :Tipo_Recolhimento, ');
        add(':Base_Reduzida, :Percentual_BC_Reduzida, :Base_Acrescida, :Percentual_BC_Acrescida, ');
        add(':Codigo_Situacao_Tributaria)');
        // Parameters.ParamByName('Codigo').Value:= Registro.Cod;
        Parameters.ParamByName('Data_Cadastro').Value := Registro.Data_Cad;
        Parameters.ParamByName('Descricao').Value := Registro.Desc;
        Parameters.ParamByName('Aliquota').Value := Registro.Aliq;
        Parameters.ParamByName('Tipo_Calculo').Value :=
          FrmRegra_PIS.CBTipo_Calculo.Text;
        Parameters.ParamByName('Tipo_Recolhimento').Value := Registro.Tipo_Rec;
        Parameters.ParamByName('Base_Reduzida').Value := Registro.Base_Red;
        Parameters.ParamByName('Percentual_BC_Reduzida').Value :=
          Registro.Perc_Base_Red;
        Parameters.ParamByName('Base_Acrescida').Value := Registro.Base_Acre;
        Parameters.ParamByName('Percentual_BC_Acrescida').Value :=
          Registro.Perc_Base_Acre;
        Parameters.ParamByName('Codigo_Situacao_Tributaria').Value :=
          Registro.Cod_Situacao_Tributaria;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Insere;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TTratamento_PIS }

procedure TTratamento_PIS.Alterar(var Registro: TTratamento_PIS);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Update Tratamento_PIS set Descricao = :Descricao, Data_Cadastro = :Data_Cadastro');
        add('where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        Parameters.ParamByName('Descricao').Value := Registro.Desc;
        Parameters.ParamByName('Data_Cadastro').Value := Registro.Data_Cad;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        // lrControle:= Altera;
        // UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TTratamento_PIS.Excluir(var Registro: TTratamento_PIS);
var
  qAux: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Delete from Tratamento_PIS where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        // lrControle:= Exclui;
        // UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

function TTratamento_PIS.GetCodigo: integer;
begin
  GetCodigo := StrToInt(FrmTratamento_PIS.EdtCodigo.Text);
end;

function TTratamento_PIS.GetData_Cadastro: Tdate;
begin
  GetData_Cadastro := StrToDateTime(FrmTratamento_PIS.MEdtData_Cadastro.Text);
end;

function TTratamento_PIS.GetDescricao: string;
begin
  GetDescricao := FrmTratamento_PIS.EdtDescricao.Text;
end;

procedure TTratamento_PIS.Inserir(var Registro: TTratamento_PIS);
var
  qAux: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Insert into Tratamento_PIS (Codigo, Descricao, Data_Cadastro) values ');
        add('(:Codigo, :Descricao, :Data_Cadastro)');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        Parameters.ParamByName('Descricao').Value := Registro.Desc;
        Parameters.ParamByName('Data_Cadastro').Value := Registro.Data_Cad;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        // lrControle:= Insere;
        // UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TCadastro_Grupo_Produto_Tributacao_PIS }

procedure TCadastro_Grupo_Produto_Tributacao_PIS.Alterar
  (var Registro: TCadastro_Grupo_Produto_Tributacao_PIS);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Update Grupo_Produto_Tributacao_PIS set Descricao = :Descricao, ');
        add('Codigo_Tratamento_PIS = :Codigo_Tratamento_PIS, Data_Cadastro = :Data_Cadastro');
        add('where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        Parameters.ParamByName('Descricao').Value := Registro.Desc;
        Parameters.ParamByName('Codigo_Tratamento_PIS').Value :=
          Registro.Cod_Tratamento;
        Parameters.ParamByName('Data_Cadastro').Value := Registro.Data;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Altera;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TCadastro_Grupo_Produto_Tributacao_PIS.Excluir
  (var Registro: TCadastro_Grupo_Produto_Tributacao_PIS);
var
  qAux: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Delete from Grupo_Produto_Tributacao_PIS where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Exclui;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

function TCadastro_Grupo_Produto_Tributacao_PIS.GetCodigo: integer;
begin
  GetCodigo := StrToInt(FrmCadastro_Grupo_Produto_Tributacao_PIS.
    EdtCodigo.Text);
end;

function TCadastro_Grupo_Produto_Tributacao_PIS.GetCodigo_Tratamento: integer;
begin
  GetCodigo_Tratamento :=
    StrToInt(FrmCadastro_Grupo_Produto_Tributacao_PIS.
    EdtCodigo_Tratamento_PIS.Text);
end;

function TCadastro_Grupo_Produto_Tributacao_PIS.GetData_Cadastro: Tdate;
begin
  GetData_Cadastro := StrToDateTime
    (FrmCadastro_Grupo_Produto_Tributacao_PIS.MEdtData_Cadastro.Text);
end;

function TCadastro_Grupo_Produto_Tributacao_PIS.GetDesc: string;
begin
  GetDesc := FrmCadastro_Grupo_Produto_Tributacao_PIS.EdtDescricao.Text;
end;

procedure TCadastro_Grupo_Produto_Tributacao_PIS.Inserir
  (var Registro: TCadastro_Grupo_Produto_Tributacao_PIS);
var
  qAux: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Insert into Grupo_Produto_Tributacao_PIS (Descricao, Codigo_Tratamento_PIS, Data_Cadastro)');
        add(' values ');
        add('(:Descricao, :Codigo_Tratamento_PIS, :Data_Cadastro)');
        // Parameters.ParamByName('Codigo').Value:= Registro.Cod;
        Parameters.ParamByName('Descricao').Value := Registro.Desc;
        Parameters.ParamByName('Codigo_Tratamento_PIS').Value :=
          Registro.Cod_Tratamento;
        Parameters.ParamByName('Data_Cadastro').Value := Registro.Data;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Insere;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TRegra_COFINS }

procedure TRegra_COFINS.Alterar(var Registro: TRegra_COFINS);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Update Regra_COFINS set Data_Cadastro = :Data_Cadastro, ');
        add('Descricao = :Descricao, Aliquota = :Aliquota, Tipo_Calculo = :Tipo_Calculo, Tipo_Recolhimento = :Tipo_Recolhimento,');
        add('Base_Reduzida = :Base_Reduzida, Percentual_BC_Reduzida = :Percentual_BC_Reduzida,');
        add('Base_Acrescida = :Base_Acrescida, Percentual_BC_Acrescida = :Percentual_BC_Acrescida,');
        add('Codigo_Situacao_Tributaria = :Codigo_Situacao_Tributaria');
        add('where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        Parameters.ParamByName('Data_Cadastro').Value := Registro.Data_Cad;
        Parameters.ParamByName('Descricao').Value := Registro.Desc;
        Parameters.ParamByName('Aliquota').Value := Registro.Aliq;
        Parameters.ParamByName('Tipo_Calculo').Value :=
          FrmRegra_COFINS.CBTipo_Calculo.Text;
        Parameters.ParamByName('Tipo_Recolhimento').Value := Registro.Tipo_Rec;
        Parameters.ParamByName('Base_Reduzida').Value := Registro.Base_Red;
        Parameters.ParamByName('Percentual_BC_Reduzida').Value :=
          Registro.Perc_Base_Red;
        Parameters.ParamByName('Base_Acrescida').Value := Registro.Base_Acre;
        Parameters.ParamByName('Percentual_BC_Acrescida').Value :=
          Registro.Perc_Base_Acre;
        Parameters.ParamByName('Codigo_Situacao_Tributaria').Value :=
          Registro.Cod_Situacao_Tributaria;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Altera;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TRegra_COFINS.Excluir(var Registro: TRegra_COFINS);
var
  qAux: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Delete from Regra_COFINS where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Exclui;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

function TRegra_COFINS.GetAliquota: string;
begin
  GetAliquota := FrmRegra_COFINS.EdtAliquota.Text;
end;

function TRegra_COFINS.GetBase_Acrescida: string;
begin
  if (FrmRegra_COFINS.RGBase_Acrescida.ItemIndex = 0) then
    GetBase_Acrescida := 'SIM'
  else
    GetBase_Acrescida := 'NO';
end;

function TRegra_COFINS.GetBase_Reduzida: string;
begin
  if (FrmRegra_COFINS.RGBase_Reduzida.ItemIndex = 0) then
    GetBase_Reduzida := 'SIM'
  else
    GetBase_Reduzida := 'NO';
end;

function TRegra_COFINS.GetCodigo: integer;
begin
  GetCodigo := StrToInt(FrmRegra_COFINS.EdtCodigo.Text);
end;

function TRegra_COFINS.GetCodigo_Situacao_Tributaria: integer;
begin
  GetCodigo_Situacao_Tributaria :=
    StrToInt(FrmRegra_COFINS.EdtCodigo_Situacao_Tributaria.Text);
end;

function TRegra_COFINS.GetData_Cadastro: Tdate;
begin
  GetData_Cadastro := StrToDateTime(FrmRegra_COFINS.MEdtData_Cadastro.Text);
end;

function TRegra_COFINS.GetDescricao: string;
begin
  GetDescricao := FrmRegra_COFINS.EdtDescricao.Text;
end;

function TRegra_COFINS.GetPercentual_BC_Acrescida: string;
begin
  GetPercentual_BC_Acrescida :=
    FrmRegra_COFINS.EdtPercentual_Base_Calculo_Acrescida.Text;
end;

function TRegra_COFINS.GetPercentual_BC_Reduzida: string;
begin
  GetPercentual_BC_Reduzida :=
    FrmRegra_COFINS.EdtPercentual_Base_Calculo_Reduzida.Text;
end;

function TRegra_COFINS.GetTipo_Recolhimento: string;
begin
  if (FrmRegra_COFINS.RGTipo_Recolhimento.ItemIndex = 0) then
    GetTipo_Recolhimento := 'NORMAL'
  else
    GetTipo_Recolhimento := 'ST';
end;

procedure TRegra_COFINS.Inserir(var Registro: TRegra_COFINS);
var
  qAux: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Insert into Regra_COFINS (Data_Cadastro, Descricao, Aliquota, Tipo_Calculo, Tipo_Recolhimento, ');
        add('Base_Reduzida, Percentual_BC_Reduzida, Base_Acrescida, Percentual_BC_Acrescida, ');
        add('Codigo_Situacao_Tributaria) values ');
        add('(:Data_Cadastro, :Descricao, :Aliquota, :Tipo_Calculo, :Tipo_Recolhimento, ');
        add(':Base_Reduzida, :Percentual_BC_Reduzida, :Base_Acrescida, :Percentual_BC_Acrescida, ');
        add(':Codigo_Situacao_Tributaria)');
        // Parameters.ParamByName('Codigo').Value:= Registro.Cod;
        Parameters.ParamByName('Data_Cadastro').Value := Registro.Data_Cad;
        Parameters.ParamByName('Descricao').Value := Registro.Desc;
        Parameters.ParamByName('Aliquota').Value := Registro.Aliq;
        Parameters.ParamByName('Tipo_Calculo').Value :=
          FrmRegra_COFINS.CBTipo_Calculo.Text;
        Parameters.ParamByName('Tipo_Recolhimento').Value := Registro.Tipo_Rec;
        Parameters.ParamByName('Base_Reduzida').Value := Registro.Base_Red;
        Parameters.ParamByName('Percentual_BC_Reduzida').Value :=
          Registro.Perc_Base_Red;
        Parameters.ParamByName('Base_Acrescida').Value := Registro.Base_Acre;
        Parameters.ParamByName('Percentual_BC_Acrescida').Value :=
          Registro.Perc_Base_Acre;
        Parameters.ParamByName('Codigo_Situacao_Tributaria').Value :=
          Registro.Cod_Situacao_Tributaria;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Insere;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TTratamento_COFINS }

procedure TTratamento_COFINS.Alterar(var Registro: TTratamento_COFINS);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Update Tratamento_COFINS set Descricao = :Descricao, Data_Cadastro = :Data_Cadastro');
        add('where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        Parameters.ParamByName('Descricao').Value := Registro.Desc;
        Parameters.ParamByName('Data_Cadastro').Value := Registro.Data_Cad;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        // lrControle:= Altera;
        // UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TTratamento_COFINS.Excluir(var Registro: TTratamento_COFINS);
var
  qAux: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Delete from Tratamento_COFINS where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        // lrControle:= Exclui;
        // UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

function TTratamento_COFINS.GetCodigo: integer;
begin
  GetCodigo := StrToInt(FrmTratamento_COFINS.EdtCodigo.Text);
end;

function TTratamento_COFINS.GetData_Cadastro: Tdate;
begin
  GetData_Cadastro := StrToDateTime
    (FrmTratamento_COFINS.MEdtData_Cadastro.Text);
end;

function TTratamento_COFINS.GetDescricao: string;
begin
  GetDescricao := FrmTratamento_COFINS.EdtDescricao.Text;
end;

procedure TTratamento_COFINS.Inserir(var Registro: TTratamento_COFINS);
var
  qAux: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Insert into Tratamento_COFINS (Codigo, Descricao, Data_Cadastro) values ');
        add('(:Codigo, :Descricao, :Data_Cadastro)');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        Parameters.ParamByName('Descricao').Value := Registro.Desc;
        Parameters.ParamByName('Data_Cadastro').Value := Registro.Data_Cad;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        // lrControle:= Insere;
        // UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TCadastro_Grupo_Produto_Tributacao_COFINS }

procedure TCadastro_Grupo_Produto_Tributacao_COFINS.Alterar
  (var Registro: TCadastro_Grupo_Produto_Tributacao_COFINS);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Update Grupo_Produto_Tributacao_COFINS set Descricao = :Descricao, ');
        add('Codigo_Tratamento_COFINS = :Codigo_Tratamento_COFINS, Data_Cadastro = :Data_Cadastro');
        add('where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        Parameters.ParamByName('Descricao').Value := Registro.Desc;
        Parameters.ParamByName('Codigo_Tratamento_COFINS').Value :=
          Registro.Cod_Tratamento;
        Parameters.ParamByName('Data_Cadastro').Value := Registro.Data;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Altera;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TCadastro_Grupo_Produto_Tributacao_COFINS.Excluir
  (var Registro: TCadastro_Grupo_Produto_Tributacao_COFINS);
var
  qAux: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Delete from Grupo_Produto_Tributacao_COFINS where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Exclui;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

function TCadastro_Grupo_Produto_Tributacao_COFINS.GetCodigo: integer;
begin
  GetCodigo := StrToInt(FrmCadastro_Grupo_Produto_Tributacao_COFINS.
    EdtCodigo.Text);
end;

function TCadastro_Grupo_Produto_Tributacao_COFINS.GetCodigo_Tratamento
  : integer;
begin
  GetCodigo_Tratamento :=
    StrToInt(FrmCadastro_Grupo_Produto_Tributacao_COFINS.
    EdtCodigo_Tratamento_COFINS.Text);
end;

function TCadastro_Grupo_Produto_Tributacao_COFINS.GetData_Cadastro: Tdate;
begin
  GetData_Cadastro := StrToDateTime
    (FrmCadastro_Grupo_Produto_Tributacao_COFINS.MEdtData_Cadastro.Text);
end;

function TCadastro_Grupo_Produto_Tributacao_COFINS.GetDesc: string;
begin
  GetDesc := FrmCadastro_Grupo_Produto_Tributacao_COFINS.EdtDescricao.Text;
end;

procedure TCadastro_Grupo_Produto_Tributacao_COFINS.Inserir
  (var Registro: TCadastro_Grupo_Produto_Tributacao_COFINS);
var
  qAux: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Insert into Grupo_Produto_Tributacao_COFINS (Descricao, Codigo_Tratamento_COFINS, Data_Cadastro)');
        add(' values ');
        add('(:Descricao, :Codigo_Tratamento_COFINS, :Data_Cadastro)');
        // Parameters.ParamByName('Codigo').Value:= Registro.Cod;
        Parameters.ParamByName('Descricao').Value := Registro.Desc;
        Parameters.ParamByName('Codigo_Tratamento_COFINS').Value :=
          Registro.Cod_Tratamento;
        Parameters.ParamByName('Data_Cadastro').Value := Registro.Data;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Insere;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TRegra_IPI }

procedure TRegra_IPI.Alterar(var Registro: TRegra_IPI);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Update Regra_IPI set Data_Cadastro = :Data_Cadastro, ');
        add('Descricao = :Descricao, Aliquota = :Aliquota, Tipo_Calculo = :Tipo_Calculo, Tipo_Recolhimento = :Tipo_Recolhimento,');
        add('Base_Reduzida = :Base_Reduzida, Percentual_BC_Reduzida = :Percentual_BC_Reduzida,');
        add('Base_Acrescida = :Base_Acrescida, Percentual_BC_Acrescida = :Percentual_BC_Acrescida,');
        add('Codigo_Situacao_Tributaria = :Codigo_Situacao_Tributaria');
        add('where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        Parameters.ParamByName('Data_Cadastro').Value := Registro.Data_Cad;
        Parameters.ParamByName('Descricao').Value := Registro.Desc;
        Parameters.ParamByName('Aliquota').Value := Registro.Aliq;
        Parameters.ParamByName('Tipo_Calculo').Value :=
          FrmRegra_IPI.CBTipo_Calculo.Text;
        Parameters.ParamByName('Tipo_Recolhimento').Value := Registro.Tipo_Rec;
        Parameters.ParamByName('Base_Reduzida').Value := Registro.Base_Red;
        Parameters.ParamByName('Percentual_BC_Reduzida').Value :=
          Registro.Perc_Base_Red;
        Parameters.ParamByName('Base_Acrescida').Value := Registro.Base_Acre;
        Parameters.ParamByName('Percentual_BC_Acrescida').Value :=
          Registro.Perc_Base_Acre;
        Parameters.ParamByName('Codigo_Situacao_Tributaria').Value :=
          Registro.Cod_Situacao_Tributaria;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Altera;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TRegra_IPI.Excluir(var Registro: TRegra_IPI);
var
  qAux: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Delete from Regra_IPI where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Exclui;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

function TRegra_IPI.GetAliquota: string;
begin
  GetAliquota := FrmRegra_IPI.EdtAliquota.Text;
end;

function TRegra_IPI.GetBase_Acrescida: string;
begin
  if (FrmRegra_IPI.RGBase_Acrescida.ItemIndex = 0) then
    GetBase_Acrescida := 'SIM'
  else
    GetBase_Acrescida := 'NO';
end;

function TRegra_IPI.GetBase_Reduzida: string;
begin
  if (FrmRegra_IPI.RGBase_Reduzida.ItemIndex = 0) then
    GetBase_Reduzida := 'SIM'
  else
    GetBase_Reduzida := 'NO';
end;

function TRegra_IPI.GetCodigo: integer;
begin
  GetCodigo := StrToInt(FrmRegra_IPI.EdtCodigo.Text);
end;

function TRegra_IPI.GetCodigo_Situacao_Tributaria: integer;
begin
  GetCodigo_Situacao_Tributaria :=
    StrToInt(FrmRegra_IPI.EdtCodigo_Situacao_Tributaria.Text);
end;

function TRegra_IPI.GetData_Cadastro: Tdate;
begin
  GetData_Cadastro := StrToDateTime(FrmRegra_IPI.MEdtData_Cadastro.Text);
end;

function TRegra_IPI.GetDescricao: string;
begin
  GetDescricao := FrmRegra_IPI.EdtDescricao.Text;
end;

function TRegra_IPI.GetPercentual_BC_Acrescida: string;
begin
  GetPercentual_BC_Acrescida :=
    FrmRegra_IPI.EdtPercentual_Base_Calculo_Acrescida.Text;
end;

function TRegra_IPI.GetPercentual_BC_Reduzida: string;
begin
  GetPercentual_BC_Reduzida :=
    FrmRegra_IPI.EdtPercentual_Base_Calculo_Reduzida.Text;
end;

function TRegra_IPI.GetTipo_Recolhimento: string;
begin
  if (FrmRegra_IPI.RGTipo_Recolhimento.ItemIndex = 0) then
    GetTipo_Recolhimento := 'NORMAL'
  else
    GetTipo_Recolhimento := 'ST';
end;

procedure TRegra_IPI.Inserir(var Registro: TRegra_IPI);
var
  qAux: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Insert into Regra_IPI (Data_Cadastro, Descricao, Aliquota, Tipo_Calculo, Tipo_Recolhimento, ');
        add('Base_Reduzida, Percentual_BC_Reduzida, Base_Acrescida, Percentual_BC_Acrescida, ');
        add('Codigo_Situacao_Tributaria) values ');
        add('(:Data_Cadastro, :Descricao, :Aliquota, :Tipo_Calculo, :Tipo_Recolhimento, ');
        add(':Base_Reduzida, :Percentual_BC_Reduzida, :Base_Acrescida, :Percentual_BC_Acrescida, ');
        add(':Codigo_Situacao_Tributaria)');
        // Parameters.ParamByName('Codigo').Value:= Registro.Cod;
        Parameters.ParamByName('Data_Cadastro').Value := Registro.Data_Cad;
        Parameters.ParamByName('Descricao').Value := Registro.Desc;
        Parameters.ParamByName('Aliquota').Value := Registro.Aliq;
        Parameters.ParamByName('Tipo_Calculo').Value :=
          FrmRegra_IPI.CBTipo_Calculo.Text;
        Parameters.ParamByName('Tipo_Recolhimento').Value := Registro.Tipo_Rec;
        Parameters.ParamByName('Base_Reduzida').Value := Registro.Base_Red;
        Parameters.ParamByName('Percentual_BC_Reduzida').Value :=
          Registro.Perc_Base_Red;
        Parameters.ParamByName('Base_Acrescida').Value := Registro.Base_Acre;
        Parameters.ParamByName('Percentual_BC_Acrescida').Value :=
          Registro.Perc_Base_Acre;
        Parameters.ParamByName('Codigo_Situacao_Tributaria').Value :=
          Registro.Cod_Situacao_Tributaria;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Insere;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TTratamento_IPI }

procedure TTratamento_IPI.Alterar(var Registro: TTratamento_IPI);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Update Tratamento_IPI set Descricao = :Descricao, Data_Cadastro = :Data_Cadastro');
        add('where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        Parameters.ParamByName('Descricao').Value := Registro.Desc;
        Parameters.ParamByName('Data_Cadastro').Value := Registro.Data_Cad;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        // lrControle:= Altera;
        // UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TTratamento_IPI.Excluir(var Registro: TTratamento_IPI);
var
  qAux: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Delete from Tratamento_IPI where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        // lrControle:= Exclui;
        // UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

function TTratamento_IPI.GetCodigo: integer;
begin
  GetCodigo := StrToInt(FrmTratamento_IPI.EdtCodigo.Text);
end;

function TTratamento_IPI.GetData_Cadastro: Tdate;
begin
  GetData_Cadastro := StrToDateTime(FrmTratamento_IPI.MEdtData_Cadastro.Text);
end;

function TTratamento_IPI.GetDescricao: string;
begin
  GetDescricao := FrmTratamento_IPI.EdtDescricao.Text;
end;

procedure TTratamento_IPI.Inserir(var Registro: TTratamento_IPI);
var
  qAux: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Insert into Tratamento_IPI (Codigo, Descricao, Data_Cadastro) values ');
        add('(:Codigo, :Descricao, :Data_Cadastro)');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        Parameters.ParamByName('Descricao').Value := Registro.Desc;
        Parameters.ParamByName('Data_Cadastro').Value := Registro.Data_Cad;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        // lrControle:= Insere;
        // UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TCadastro_Grupo_Produto_Tributacao_IPI }

procedure TCadastro_Grupo_Produto_Tributacao_IPI.Alterar
  (var Registro: TCadastro_Grupo_Produto_Tributacao_IPI);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Update Grupo_Produto_Tributacao_IPI set Descricao = :Descricao, ');
        add('Codigo_Tratamento_IPI = :Codigo_Tratamento_IPI, Data_Cadastro = :Data_Cadastro');
        add('where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        Parameters.ParamByName('Descricao').Value := Registro.Desc;
        Parameters.ParamByName('Codigo_Tratamento_IPI').Value :=
          Registro.Cod_Tratamento;
        Parameters.ParamByName('Data_Cadastro').Value := Registro.Data;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Altera;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TCadastro_Grupo_Produto_Tributacao_IPI.Excluir
  (var Registro: TCadastro_Grupo_Produto_Tributacao_IPI);
var
  qAux: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Delete from Grupo_Produto_Tributacao_IPI where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Exclui;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

function TCadastro_Grupo_Produto_Tributacao_IPI.GetCodigo: integer;
begin
  GetCodigo := StrToInt(FrmCadastro_Grupo_Produto_Tributacao_IPI.
    EdtCodigo.Text);
end;

function TCadastro_Grupo_Produto_Tributacao_IPI.GetCodigo_Tratamento: integer;
begin
  GetCodigo_Tratamento :=
    StrToInt(FrmCadastro_Grupo_Produto_Tributacao_IPI.
    EdtCodigo_Tratamento_IPI.Text);
end;

function TCadastro_Grupo_Produto_Tributacao_IPI.GetData_Cadastro: Tdate;
begin
  GetData_Cadastro := StrToDateTime
    (FrmCadastro_Grupo_Produto_Tributacao_IPI.MEdtData_Cadastro.Text);
end;

function TCadastro_Grupo_Produto_Tributacao_IPI.GetDesc: string;
begin
  GetDesc := FrmCadastro_Grupo_Produto_Tributacao_IPI.EdtDescricao.Text;
end;

procedure TCadastro_Grupo_Produto_Tributacao_IPI.Inserir
  (var Registro: TCadastro_Grupo_Produto_Tributacao_IPI);
var
  qAux: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Insert into Grupo_Produto_Tributacao_IPI (Descricao, Codigo_Tratamento_IPI, Data_Cadastro)');
        add(' values ');
        add('(:Descricao, :Codigo_Tratamento_IPI, :Data_Cadastro)');
        // Parameters.ParamByName('Codigo').Value:= Registro.Cod;
        Parameters.ParamByName('Descricao').Value := Registro.Desc;
        Parameters.ParamByName('Codigo_Tratamento_IPI').Value :=
          Registro.Cod_Tratamento;
        Parameters.ParamByName('Data_Cadastro').Value := Registro.Data;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Insere;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TRegra_ISSQN }

procedure TRegra_ISSQN.Alterar(var Registro: TRegra_ISSQN);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Update Regra_ISSQN set Data_Cadastro = :Data_Cadastro, ');
        add('Descricao = :Descricao, Aliquota = :Aliquota, Tributacao = :Tributacao,');
        add('Base_Reduzida = :Base_Reduzida, Percentual_BC_Reduzida = :Percentual_BC_Reduzida,');
        add('Base_Acrescida = :Base_Acrescida, Percentual_BC_Acrescida = :Percentual_BC_Acrescida');
        add('where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        Parameters.ParamByName('Data_Cadastro').Value := Registro.Data_Cad;
        Parameters.ParamByName('Descricao').Value := Registro.Desc;
        Parameters.ParamByName('Aliquota').Value := Registro.Aliq;
        Parameters.ParamByName('Tributacao').Value := Registro.Trib;
        Parameters.ParamByName('Base_Reduzida').Value := Registro.Base_Red;
        Parameters.ParamByName('Percentual_BC_Reduzida').Value :=
          Registro.Perc_Base_Red;
        Parameters.ParamByName('Base_Acrescida').Value := Registro.Base_Acre;
        Parameters.ParamByName('Percentual_BC_Acrescida').Value :=
          Registro.Perc_Base_Acre;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Altera;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TRegra_ISSQN.Excluir(var Registro: TRegra_ISSQN);
var
  qAux: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Delete from Regra_ISSQN where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Exclui;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

function TRegra_ISSQN.GetAliquota: string;
begin
  GetAliquota := FrmRegra_ISSQN.EdtAliquota.Text;
end;

function TRegra_ISSQN.GetBase_Acrescida: string;
begin
  if (FrmRegra_ISSQN.RGBase_Acrescida.ItemIndex = 0) then
    GetBase_Acrescida := 'SIM'
  else
    GetBase_Acrescida := 'NO';
end;

function TRegra_ISSQN.GetBase_Reduzida: string;
begin
  if (FrmRegra_ISSQN.RGBase_Reduzida.ItemIndex = 0) then
    GetBase_Reduzida := 'SIM'
  else
    GetBase_Reduzida := 'NO';
end;

function TRegra_ISSQN.GetCodigo: integer;
begin
  GetCodigo := StrToInt(FrmRegra_ISSQN.EdtCodigo.Text);
end;

function TRegra_ISSQN.GetData_Cadastro: Tdate;
begin
  GetData_Cadastro := StrToDateTime(FrmRegra_ISSQN.MEdtData_Cadastro.Text);
end;

function TRegra_ISSQN.GetDescricao: string;
begin
  GetDescricao := FrmRegra_ISSQN.EdtDescricao.Text;
end;

function TRegra_ISSQN.GetPercentual_BC_Acrescida: string;
begin
  GetPercentual_BC_Acrescida :=
    FrmRegra_ISSQN.EdtPercentual_Base_Calculo_Acrescida.Text;
end;

function TRegra_ISSQN.GetPercentual_BC_Reduzida: string;
begin
  GetPercentual_BC_Reduzida :=
    FrmRegra_ISSQN.EdtPercentual_Base_Calculo_Reduzida.Text;
end;

function TRegra_ISSQN.GetTributacao: string;
begin
  if (FrmRegra_ISSQN.RGTributacao.ItemIndex = 0) then
    GetTributacao := 'NORMAL'
  else if (FrmRegra_ISSQN.RGTributacao.ItemIndex = 1) then
    GetTributacao := 'RETIDA'
  else if (FrmRegra_ISSQN.RGTributacao.ItemIndex = 2) then
    GetTributacao := 'SUBSTITUTA'
  else if (FrmRegra_ISSQN.RGTributacao.ItemIndex = 3) then
    GetTributacao := 'ISENTA';
end;

procedure TRegra_ISSQN.Inserir(var Registro: TRegra_ISSQN);
var
  qAux: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Insert into Regra_ISSQN (Data_Cadastro, Descricao, Aliquota, Tributacao, ');
        add('Base_Reduzida, Percentual_BC_Reduzida, Base_Acrescida, Percentual_BC_Acrescida) values ');
        add('(:Data_Cadastro, :Descricao, :Aliquota, :Tributacao, ');
        add(':Base_Reduzida, :Percentual_BC_Reduzida, :Base_Acrescida, :Percentual_BC_Acrescida)');
        // Parameters.ParamByName('Codigo').Value:= Registro.Cod;
        Parameters.ParamByName('Data_Cadastro').Value := Registro.Data_Cad;
        Parameters.ParamByName('Descricao').Value := Registro.Desc;
        Parameters.ParamByName('Aliquota').Value := Registro.Aliq;
        Parameters.ParamByName('Tributacao').Value := Registro.Trib;
        Parameters.ParamByName('Base_Reduzida').Value := Registro.Base_Red;
        Parameters.ParamByName('Percentual_BC_Reduzida').Value :=
          Registro.Perc_Base_Red;
        Parameters.ParamByName('Base_Acrescida').Value := Registro.Base_Acre;
        Parameters.ParamByName('Percentual_BC_Acrescida').Value :=
          Registro.Perc_Base_Acre;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Insere;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TTratamento_ISSQN }

procedure TTratamento_ISSQN.Alterar(var Registro: TTratamento_ISSQN);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Update Tratamento_ISSQN set Descricao = :Descricao, ');
        add('Origem = :Origem, Destino = :Destino, Entrada_Regra_EN = :Entrada_Regra_EN,');
        add('Entrada_Regra_EPP = :Entrada_Regra_EPP, Entrada_Regra_ME = :Entrada_Regra_ME,');
        add('Saida_Regra_EN = :Saida_Regra_EN, Saida_Regra_EPP = :Saida_Regra_EPP,');
        add('Saida_Regra_ME = :Saida_Regra_ME,');
        add('Regra_Nao_Contribuinte = :Regra_Nao_Contribuinte, Data_Cadastro = :Data_Cadastro');
        add('where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        Parameters.ParamByName('Descricao').Value := Registro.Desc;
        Parameters.ParamByName('Origem').Value := Registro.Orig;
        Parameters.ParamByName('Destino').Value := Registro.Dest;
        Parameters.ParamByName('Entrada_Regra_EN').Value :=
          Registro.Entrada_Reg_EN;
        Parameters.ParamByName('Entrada_Regra_EPP').Value :=
          Registro.Entrada_Reg_EPP;
        Parameters.ParamByName('Entrada_Regra_ME').Value :=
          Registro.Entrada_Reg_ME;
        Parameters.ParamByName('Saida_Regra_EN').Value := Registro.Saida_Reg_EN;
        Parameters.ParamByName('Saida_Regra_EPP').Value :=
          Registro.Saida_Reg_EPP;
        Parameters.ParamByName('Saida_Regra_ME').Value := Registro.Saida_Reg_ME;
        Parameters.ParamByName('Regra_Nao_Contribuinte').Value :=
          Registro.Reg_Nao_Contribuinte;
        Parameters.ParamByName('Data_Cadastro').Value := Registro.Data_Cad;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Altera;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TTratamento_ISSQN.Excluir(var Registro: TTratamento_ISSQN);
var
  qAux: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Delete from Tratamento_ISSQN where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Exclui;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

function TTratamento_ISSQN.GetCodigo: integer;
begin
  GetCodigo := StrToInt(FrmTratamento_ISSQN.EdtCodigo.Text);
end;

function TTratamento_ISSQN.GetData_Cadastro: Tdate;
begin
  GetData_Cadastro := StrToDateTime(FrmTratamento_ISSQN.MEdtData_Cadastro.Text);
end;

function TTratamento_ISSQN.GetDescricao: string;
begin
  GetDescricao := FrmTratamento_ISSQN.EdtDescricao.Text;
end;

function TTratamento_ISSQN.GetDestino: string;
begin
  GetDestino := FrmTratamento_ISSQN.CmbDestino.Text;
end;

function TTratamento_ISSQN.GetEntrada_Regra_EN: integer;
begin
  GetEntrada_Regra_EN :=
    StrToInt(FrmTratamento_ISSQN.EdtCodigo_Regra_ICMS_EN_Entrada.Text);
end;

function TTratamento_ISSQN.GetEntrada_Regra_EPP: integer;
begin
  GetEntrada_Regra_EPP :=
    StrToInt(FrmTratamento_ISSQN.EdtCodigo_Regra_ICMS_EPP_Entrada.Text);
end;

function TTratamento_ISSQN.GetEntrada_Regra_ME: integer;
begin
  GetEntrada_Regra_ME :=
    StrToInt(FrmTratamento_ISSQN.EdtCodigo_Regra_ICMS_ME_Entrada.Text);
end;

function TTratamento_ISSQN.GetOrigem: string;
begin
  GetOrigem := FrmTratamento_ISSQN.CmbOrigem.Text;
end;

function TTratamento_ISSQN.GetRegra_Nao_Contribuinte: integer;
begin
  GetRegra_Nao_Contribuinte :=
    StrToInt(FrmTratamento_ISSQN.EdtCodigo_Regra_ICMS_Nao_Contribuinte.Text);
end;

function TTratamento_ISSQN.GetSaida_Regra_EN: integer;
begin
  GetSaida_Regra_EN :=
    StrToInt(FrmTratamento_ISSQN.EdtCodigo_Regra_ICMS_EN_Saida.Text);
end;

function TTratamento_ISSQN.GetSaida_Regra_EPP: integer;
begin
  GetSaida_Regra_EPP :=
    StrToInt(FrmTratamento_ISSQN.EdtCodigo_Regra_ICMS_EPP_Saida.Text);
end;

function TTratamento_ISSQN.GetSaida_Regra_ME: integer;
begin
  GetSaida_Regra_ME :=
    StrToInt(FrmTratamento_ISSQN.EdtCodigo_Regra_ICMS_ME_Saida.Text);
end;

procedure TTratamento_ISSQN.Inserir(var Registro: TTratamento_ISSQN);
var
  qAux: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Insert into Tratamento_ISSQN (Descricao, Origem, Destino, Entrada_Regra_EN, ');
        add('Entrada_Regra_EPP, Entrada_Regra_ME, Saida_Regra_EN, Saida_Regra_EPP, ');
        add('Saida_Regra_ME, Regra_Nao_Contribuinte, Data_Cadastro) values ');
        add('(:Descricao, :Origem, :Destino, :Entrada_Regra_EN, ');
        add(':Entrada_Regra_EPP, :Entrada_Regra_ME, :Saida_Regra_EN, :Saida_Regra_EPP, ');
        add(':Saida_Regra_ME, :Regra_Nao_Contribuinte, :Data_Cadastro)');
        // Parameters.ParamByName('Codigo').Value:= Registro.Cod;
        Parameters.ParamByName('Descricao').Value := Registro.Desc;
        Parameters.ParamByName('Origem').Value := Registro.Orig;
        Parameters.ParamByName('Destino').Value := Registro.Dest;
        Parameters.ParamByName('Entrada_Regra_EN').Value :=
          Registro.Entrada_Reg_EN;
        Parameters.ParamByName('Entrada_Regra_EPP').Value :=
          Registro.Entrada_Reg_EPP;
        Parameters.ParamByName('Entrada_Regra_ME').Value :=
          Registro.Entrada_Reg_ME;
        Parameters.ParamByName('Saida_Regra_EN').Value := Registro.Saida_Reg_EN;
        Parameters.ParamByName('Saida_Regra_EPP').Value :=
          Registro.Saida_Reg_EPP;
        Parameters.ParamByName('Saida_Regra_ME').Value := Registro.Saida_Reg_ME;
        Parameters.ParamByName('Regra_Nao_Contribuinte').Value :=
          Registro.Reg_Nao_Contribuinte;
        Parameters.ParamByName('Data_Cadastro').Value := Registro.Data_Cad;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Insere;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TItens_Tratamento_ICMS }

procedure TItens_Tratamento_ICMS.Alterar(var Registro: TItens_Tratamento_ICMS;
  Conexao: TADOConnection);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := Conexao;
        add('Update Itens_Tratamento_ICMS set ');
        add('Entrada_Regra_EN = :Entrada_Regra_EN,');
        add('Entrada_Regra_EPP = :Entrada_Regra_EPP, Entrada_Regra_ME = :Entrada_Regra_ME,');
        add('Saida_Regra_EN = :Saida_Regra_EN, Saida_Regra_EPP = :Saida_Regra_EPP,');
        add('Saida_Regra_ME = :Saida_Regra_ME,');
        add('Regra_Nao_Contribuinte = :Regra_Nao_Contribuinte');
        add('where Codigo = :Codigo and Origem = :Origem and Destino = :Destino');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        Parameters.ParamByName('Origem').Value := Registro.Orig;
        Parameters.ParamByName('Destino').Value := Registro.Dest;
        Parameters.ParamByName('Entrada_Regra_EN').Value :=
          Registro.Entrada_Reg_EN;
        Parameters.ParamByName('Entrada_Regra_EPP').Value :=
          Registro.Entrada_Reg_EPP;
        Parameters.ParamByName('Entrada_Regra_ME').Value :=
          Registro.Entrada_Reg_ME;
        Parameters.ParamByName('Saida_Regra_EN').Value := Registro.Saida_Reg_EN;
        Parameters.ParamByName('Saida_Regra_EPP').Value :=
          Registro.Saida_Reg_EPP;
        Parameters.ParamByName('Saida_Regra_ME').Value := Registro.Saida_Reg_ME;
        Parameters.ParamByName('Regra_Nao_Contribuinte').Value :=
          Registro.Reg_Nao_Contribuinte;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Altera;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TItens_Tratamento_ICMS.Excluir(var Registro: TItens_Tratamento_ICMS;
  Conexao: TADOConnection);
var
  qAux: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := Conexao;
        add('Delete from Itens_Tratamento_ICMS where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Exclui;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TItens_Tratamento_ICMS.Excluir_Item(var Registro
  : TItens_Tratamento_ICMS; Conexao: TADOConnection);
var
  qAux: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := Conexao;
        add('Delete from Itens_Tratamento_ICMS where Codigo = :Codigo and Origem = :Origem and ');
        add('Destino = :Destino');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        Parameters.ParamByName('Origem').Value := Registro.Orig;
        Parameters.ParamByName('Destino').Value := Registro.Dest;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Exclui;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

function TItens_Tratamento_ICMS.GetCodigo: integer;
begin
  GetCodigo := StrToInt(FrmTratamento_ICMS.EdtCodigo.Text);
end;

function TItens_Tratamento_ICMS.GetDestino: string;
begin
  GetDestino := FrmTratamento_ICMS.CmbDestino.Text;
end;

function TItens_Tratamento_ICMS.GetEntrada_Regra_EN: integer;
begin
  GetEntrada_Regra_EN :=
    StrToInt(FrmTratamento_ICMS.EdtCodigo_Regra_ICMS_EN_Entrada.Text);
end;

function TItens_Tratamento_ICMS.GetEntrada_Regra_EPP: integer;
begin
  GetEntrada_Regra_EPP :=
    StrToInt(FrmTratamento_ICMS.EdtCodigo_Regra_ICMS_EPP_Entrada.Text);
end;

function TItens_Tratamento_ICMS.GetEntrada_Regra_ME: integer;
begin
  GetEntrada_Regra_ME :=
    StrToInt(FrmTratamento_ICMS.EdtCodigo_Regra_ICMS_ME_Entrada.Text);
end;

function TItens_Tratamento_ICMS.GetOrigem: string;
begin
  GetOrigem := FrmTratamento_ICMS.CmbOrigem.Text;
end;

function TItens_Tratamento_ICMS.GetRegra_Nao_Contribuinte: integer;
begin
  GetRegra_Nao_Contribuinte :=
    StrToInt(FrmTratamento_ICMS.EdtCodigo_Regra_ICMS_Nao_Contribuinte.Text);
end;

function TItens_Tratamento_ICMS.GetSaida_Regra_EN: integer;
begin
  GetSaida_Regra_EN :=
    StrToInt(FrmTratamento_ICMS.EdtCodigo_Regra_ICMS_EN_Saida.Text);
end;

function TItens_Tratamento_ICMS.GetSaida_Regra_EPP: integer;
begin
  GetSaida_Regra_EPP :=
    StrToInt(FrmTratamento_ICMS.EdtCodigo_Regra_ICMS_EPP_Saida.Text);
end;

function TItens_Tratamento_ICMS.GetSaida_Regra_ME: integer;
begin
  GetSaida_Regra_ME :=
    StrToInt(FrmTratamento_ICMS.EdtCodigo_Regra_ICMS_ME_Saida.Text);
end;

procedure TItens_Tratamento_ICMS.Inserir(var Registro: TItens_Tratamento_ICMS;
  Conexao: TADOConnection);
var
  qAux: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := Conexao;
        add('Insert into Itens_Tratamento_ICMS (Codigo, Origem, Destino, Entrada_Regra_EN, ');
        add('Entrada_Regra_EPP, Entrada_Regra_ME, Saida_Regra_EN, Saida_Regra_EPP, ');
        add('Saida_Regra_ME, Regra_Nao_Contribuinte) values ');
        add('(:Codigo, :Origem, :Destino, :Entrada_Regra_EN, ');
        add(':Entrada_Regra_EPP, :Entrada_Regra_ME, :Saida_Regra_EN, :Saida_Regra_EPP, ');
        add(':Saida_Regra_ME, :Regra_Nao_Contribuinte)');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        Parameters.ParamByName('Origem').Value := Registro.Orig;
        Parameters.ParamByName('Destino').Value := Registro.Dest;
        Parameters.ParamByName('Entrada_Regra_EN').Value :=
          Registro.Entrada_Reg_EN;
        Parameters.ParamByName('Entrada_Regra_EPP').Value :=
          Registro.Entrada_Reg_EPP;
        Parameters.ParamByName('Entrada_Regra_ME').Value :=
          Registro.Entrada_Reg_ME;
        Parameters.ParamByName('Saida_Regra_EN').Value := Registro.Saida_Reg_EN;
        Parameters.ParamByName('Saida_Regra_EPP').Value :=
          Registro.Saida_Reg_EPP;
        Parameters.ParamByName('Saida_Regra_ME').Value := Registro.Saida_Reg_ME;
        Parameters.ParamByName('Regra_Nao_Contribuinte').Value :=
          Registro.Reg_Nao_Contribuinte;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Item;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TItens_Tratamento_PIS }

procedure TItens_Tratamento_PIS.Alterar(var Registro: TItens_Tratamento_PIS);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Update Itens_Tratamento_PIS set ');
        add('Entrada_Regra_EN = :Entrada_Regra_EN,');
        add('Entrada_Regra_EPP = :Entrada_Regra_EPP, Entrada_Regra_ME = :Entrada_Regra_ME,');
        add('Saida_Regra_EN = :Saida_Regra_EN, Saida_Regra_EPP = :Saida_Regra_EPP,');
        add('Saida_Regra_ME = :Saida_Regra_ME');
        add('where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        // Parameters.ParamByName('Origem').Value:= Registro.Orig;
        // Parameters.ParamByName('Destino').Value:= Registro.Dest;
        Parameters.ParamByName('Entrada_Regra_EN').Value :=
          Registro.Entrada_Reg_EN;
        Parameters.ParamByName('Entrada_Regra_EPP').Value :=
          Registro.Entrada_Reg_EPP;
        Parameters.ParamByName('Entrada_Regra_ME').Value :=
          Registro.Entrada_Reg_ME;
        Parameters.ParamByName('Saida_Regra_EN').Value := Registro.Saida_Reg_EN;
        Parameters.ParamByName('Saida_Regra_EPP').Value :=
          Registro.Saida_Reg_EPP;
        Parameters.ParamByName('Saida_Regra_ME').Value := Registro.Saida_Reg_ME;
        // Parameters.ParamByName('Regra_Nao_Contribuinte').Value:= Registro.Reg_Nao_Contribuinte;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Altera;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TItens_Tratamento_PIS.Excluir(var Registro: TItens_Tratamento_PIS);
var
  qAux: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Delete from Itens_Tratamento_PIS where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Exclui;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TItens_Tratamento_PIS.Excluir_Item(var Registro
  : TItens_Tratamento_PIS);
var
  qAux: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Delete from Itens_Tratamento_PIS where Codigo = :Codigo and Origem = :Origem and ');
        add('Destino = :Destino');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        Parameters.ParamByName('Origem').Value := Registro.Orig;
        Parameters.ParamByName('Destino').Value := Registro.Dest;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Exclui;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

function TItens_Tratamento_PIS.GetCodigo: integer;
begin
  GetCodigo := StrToInt(FrmTratamento_PIS.EdtCodigo.Text);
end;

function TItens_Tratamento_PIS.GetDestino: string;
begin
  // GetDestino:= FrmTratamento_PIS.CmbDestino.Text;
end;

function TItens_Tratamento_PIS.GetEntrada_Regra_EN: integer;
begin
  GetEntrada_Regra_EN :=
    StrToInt(FrmTratamento_PIS.EdtCodigo_Regra_PIS_EN_Entrada.Text);
end;

function TItens_Tratamento_PIS.GetEntrada_Regra_EPP: integer;
begin
  GetEntrada_Regra_EPP :=
    StrToInt(FrmTratamento_PIS.EdtCodigo_Regra_PIS_EPP_Entrada.Text);
end;

function TItens_Tratamento_PIS.GetEntrada_Regra_ME: integer;
begin
  GetEntrada_Regra_ME :=
    StrToInt(FrmTratamento_PIS.EdtCodigo_Regra_PIS_ME_Entrada.Text);
end;

function TItens_Tratamento_PIS.GetOrigem: string;
begin
  // GetOrigem:= FrmTratamento_PIS.CmbOrigem.Text;
end;

function TItens_Tratamento_PIS.GetRegra_Nao_Contribuinte: integer;
begin
  // GetRegra_Nao_Contribuinte:= StrToInt(FrmTratamento_PIS.EdtCodigo_Regra_PIS_Nao_Contribuinte.Text);
end;

function TItens_Tratamento_PIS.GetSaida_Regra_EN: integer;
begin
  GetSaida_Regra_EN :=
    StrToInt(FrmTratamento_PIS.EdtCodigo_Regra_PIS_EN_Saida.Text);
end;

function TItens_Tratamento_PIS.GetSaida_Regra_EPP: integer;
begin
  GetSaida_Regra_EPP :=
    StrToInt(FrmTratamento_PIS.EdtCodigo_Regra_PIS_EPP_Saida.Text);
end;

function TItens_Tratamento_PIS.GetSaida_Regra_ME: integer;
begin
  GetSaida_Regra_ME :=
    StrToInt(FrmTratamento_PIS.EdtCodigo_Regra_PIS_ME_Saida.Text);
end;

procedure TItens_Tratamento_PIS.Inserir(var Registro: TItens_Tratamento_PIS);
var
  qAux: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Insert into Itens_Tratamento_PIS (Codigo, Entrada_Regra_EN, ');
        add('Entrada_Regra_EPP, Entrada_Regra_ME, Saida_Regra_EN, Saida_Regra_EPP, ');
        add('Saida_Regra_ME) values ');
        add('(:Codigo, :Entrada_Regra_EN, ');
        add(':Entrada_Regra_EPP, :Entrada_Regra_ME, :Saida_Regra_EN, :Saida_Regra_EPP, ');
        add(':Saida_Regra_ME)');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        // Parameters.ParamByName('Origem').Value:= Registro.Orig;
        // Parameters.ParamByName('Destino').Value:= Registro.Dest;
        Parameters.ParamByName('Entrada_Regra_EN').Value :=
          Registro.Entrada_Reg_EN;
        Parameters.ParamByName('Entrada_Regra_EPP').Value :=
          Registro.Entrada_Reg_EPP;
        Parameters.ParamByName('Entrada_Regra_ME').Value :=
          Registro.Entrada_Reg_ME;
        Parameters.ParamByName('Saida_Regra_EN').Value := Registro.Saida_Reg_EN;
        Parameters.ParamByName('Saida_Regra_EPP').Value :=
          Registro.Saida_Reg_EPP;
        Parameters.ParamByName('Saida_Regra_ME').Value := Registro.Saida_Reg_ME;
        // Parameters.ParamByName('Regra_Nao_Contribuinte').Value:= Registro.Reg_Nao_Contribuinte;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Insere;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TItens_Tratamento_IPI }

procedure TItens_Tratamento_IPI.Alterar(var Registro: TItens_Tratamento_IPI);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Update Itens_Tratamento_IPI set ');
        add('Entrada_Regra_EN = :Entrada_Regra_EN,');
        add('Entrada_Regra_EPP = :Entrada_Regra_EPP, Entrada_Regra_ME = :Entrada_Regra_ME,');
        add('Saida_Regra_EN = :Saida_Regra_EN, Saida_Regra_EPP = :Saida_Regra_EPP,');
        add('Saida_Regra_ME = :Saida_Regra_ME');
        add('where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        // Parameters.ParamByName('Origem').Value:= Registro.Orig;
        // Parameters.ParamByName('Destino').Value:= Registro.Dest;
        Parameters.ParamByName('Entrada_Regra_EN').Value :=
          Registro.Entrada_Reg_EN;
        Parameters.ParamByName('Entrada_Regra_EPP').Value :=
          Registro.Entrada_Reg_EPP;
        Parameters.ParamByName('Entrada_Regra_ME').Value :=
          Registro.Entrada_Reg_ME;
        Parameters.ParamByName('Saida_Regra_EN').Value := Registro.Saida_Reg_EN;
        Parameters.ParamByName('Saida_Regra_EPP').Value :=
          Registro.Saida_Reg_EPP;
        Parameters.ParamByName('Saida_Regra_ME').Value := Registro.Saida_Reg_ME;
        // Parameters.ParamByName('Regra_Nao_Contribuinte').Value:= Registro.Reg_Nao_Contribuinte;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Altera;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TItens_Tratamento_IPI.Excluir(var Registro: TItens_Tratamento_IPI);
var
  qAux: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Delete from Itens_Tratamento_IPI where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Exclui;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TItens_Tratamento_IPI.Excluir_Item(var Registro
  : TItens_Tratamento_IPI);
var
  qAux: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Delete from Itens_Tratamento_IPI where Codigo = :Codigo and Origem = :Origem and ');
        add('Destino = :Destino');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        Parameters.ParamByName('Origem').Value := Registro.Orig;
        Parameters.ParamByName('Destino').Value := Registro.Dest;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Exclui;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

function TItens_Tratamento_IPI.GetCodigo: integer;
begin
  GetCodigo := StrToInt(FrmTratamento_IPI.EdtCodigo.Text);
end;

function TItens_Tratamento_IPI.GetDestino: string;
begin
  // GetDestino:= FrmTratamento_IPI.CmbDestino.Text;
end;

function TItens_Tratamento_IPI.GetEntrada_Regra_EN: integer;
begin
  GetEntrada_Regra_EN :=
    StrToInt(FrmTratamento_IPI.EdtCodigo_Regra_IPI_EN_Entrada.Text);
end;

function TItens_Tratamento_IPI.GetEntrada_Regra_EPP: integer;
begin
  GetEntrada_Regra_EPP :=
    StrToInt(FrmTratamento_IPI.EdtCodigo_Regra_IPI_EPP_Entrada.Text);
end;

function TItens_Tratamento_IPI.GetEntrada_Regra_ME: integer;
begin
  GetEntrada_Regra_ME :=
    StrToInt(FrmTratamento_IPI.EdtCodigo_Regra_IPI_ME_Entrada.Text);
end;

function TItens_Tratamento_IPI.GetOrigem: string;
begin
  // GetOrigem:= FrmTratamento_IPI.CmbOrigem.Text;
end;

function TItens_Tratamento_IPI.GetRegra_Nao_Contribuinte: integer;
begin
  // GetRegra_Nao_Contribuinte:= StrToInt(FrmTratamento_IPI.EdtCodigo_Regra_IPI_Nao_Contribuinte.Text);
end;

function TItens_Tratamento_IPI.GetSaida_Regra_EN: integer;
begin
  GetSaida_Regra_EN :=
    StrToInt(FrmTratamento_IPI.EdtCodigo_Regra_IPI_EN_Saida.Text);
end;

function TItens_Tratamento_IPI.GetSaida_Regra_EPP: integer;
begin
  GetSaida_Regra_EPP :=
    StrToInt(FrmTratamento_IPI.EdtCodigo_Regra_IPI_EPP_Saida.Text);
end;

function TItens_Tratamento_IPI.GetSaida_Regra_ME: integer;
begin
  GetSaida_Regra_ME :=
    StrToInt(FrmTratamento_IPI.EdtCodigo_Regra_IPI_ME_Saida.Text);
end;

procedure TItens_Tratamento_IPI.Inserir(var Registro: TItens_Tratamento_IPI);
var
  qAux: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Insert into Itens_Tratamento_IPI (Codigo, Entrada_Regra_EN, ');
        add('Entrada_Regra_EPP, Entrada_Regra_ME, Saida_Regra_EN, Saida_Regra_EPP, ');
        add('Saida_Regra_ME) values ');
        add('(:Codigo, :Entrada_Regra_EN, ');
        add(':Entrada_Regra_EPP, :Entrada_Regra_ME, :Saida_Regra_EN, :Saida_Regra_EPP, ');
        add(':Saida_Regra_ME)');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        // Parameters.ParamByName('Origem').Value:= Registro.Orig;
        // Parameters.ParamByName('Destino').Value:= Registro.Dest;
        Parameters.ParamByName('Entrada_Regra_EN').Value :=
          Registro.Entrada_Reg_EN;
        Parameters.ParamByName('Entrada_Regra_EPP').Value :=
          Registro.Entrada_Reg_EPP;
        Parameters.ParamByName('Entrada_Regra_ME').Value :=
          Registro.Entrada_Reg_ME;
        Parameters.ParamByName('Saida_Regra_EN').Value := Registro.Saida_Reg_EN;
        Parameters.ParamByName('Saida_Regra_EPP').Value :=
          Registro.Saida_Reg_EPP;
        Parameters.ParamByName('Saida_Regra_ME').Value := Registro.Saida_Reg_ME;
        // Parameters.ParamByName('Regra_Nao_Contribuinte').Value:= Registro.Reg_Nao_Contribuinte;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Insere;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TItens_Tratamento_COFINS }

procedure TItens_Tratamento_COFINS.Alterar(var Registro
  : TItens_Tratamento_COFINS);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Update Itens_Tratamento_COFINS set ');
        add('Entrada_Regra_EN = :Entrada_Regra_EN,');
        add('Entrada_Regra_EPP = :Entrada_Regra_EPP, Entrada_Regra_ME = :Entrada_Regra_ME,');
        add('Saida_Regra_EN = :Saida_Regra_EN, Saida_Regra_EPP = :Saida_Regra_EPP,');
        add('Saida_Regra_ME = :Saida_Regra_ME');
        add('where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        // Parameters.ParamByName('Origem').Value:= Registro.Orig;
        // Parameters.ParamByName('Destino').Value:= Registro.Dest;
        Parameters.ParamByName('Entrada_Regra_EN').Value :=
          Registro.Entrada_Reg_EN;
        Parameters.ParamByName('Entrada_Regra_EPP').Value :=
          Registro.Entrada_Reg_EPP;
        Parameters.ParamByName('Entrada_Regra_ME').Value :=
          Registro.Entrada_Reg_ME;
        Parameters.ParamByName('Saida_Regra_EN').Value := Registro.Saida_Reg_EN;
        Parameters.ParamByName('Saida_Regra_EPP').Value :=
          Registro.Saida_Reg_EPP;
        Parameters.ParamByName('Saida_Regra_ME').Value := Registro.Saida_Reg_ME;
        // Parameters.ParamByName('Regra_Nao_Contribuinte').Value:= Registro.Reg_Nao_Contribuinte;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Altera;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TItens_Tratamento_COFINS.Excluir(var Registro
  : TItens_Tratamento_COFINS);
var
  qAux: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Delete from Itens_Tratamento_COFINS where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Exclui;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TItens_Tratamento_COFINS.Excluir_Item(var Registro
  : TItens_Tratamento_COFINS);
var
  qAux: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Delete from Itens_Tratamento_COFINS where Codigo = :Codigo and Origem = :Origem and ');
        add('Destino = :Destino');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        Parameters.ParamByName('Origem').Value := Registro.Orig;
        Parameters.ParamByName('Destino').Value := Registro.Dest;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Exclui;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

function TItens_Tratamento_COFINS.GetCodigo: integer;
begin
  GetCodigo := StrToInt(FrmTratamento_COFINS.EdtCodigo.Text);
end;

function TItens_Tratamento_COFINS.GetDestino: string;
begin
  // GetDestino:= FrmTratamento_COFINS.CmbDestino.Text;
end;

function TItens_Tratamento_COFINS.GetEntrada_Regra_EN: integer;
begin
  GetEntrada_Regra_EN :=
    StrToInt(FrmTratamento_COFINS.EdtCodigo_Regra_COFINS_EN_Entrada.Text);
end;

function TItens_Tratamento_COFINS.GetEntrada_Regra_EPP: integer;
begin
  GetEntrada_Regra_EPP :=
    StrToInt(FrmTratamento_COFINS.EdtCodigo_Regra_COFINS_EPP_Entrada.Text);
end;

function TItens_Tratamento_COFINS.GetEntrada_Regra_ME: integer;
begin
  GetEntrada_Regra_ME :=
    StrToInt(FrmTratamento_COFINS.EdtCodigo_Regra_COFINS_ME_Entrada.Text);
end;

function TItens_Tratamento_COFINS.GetOrigem: string;
begin
  // GetOrigem:= FrmTratamento_COFINS.CmbOrigem.Text;
end;

function TItens_Tratamento_COFINS.GetRegra_Nao_Contribuinte: integer;
begin
  // GetRegra_Nao_Contribuinte:= StrToInt(FrmTratamento_COFINS.EdtCodigo_Regra_COFINS_Nao_Contribuinte.Text);
end;

function TItens_Tratamento_COFINS.GetSaida_Regra_EN: integer;
begin
  GetSaida_Regra_EN :=
    StrToInt(FrmTratamento_COFINS.EdtCodigo_Regra_COFINS_EN_Saida.Text);
end;

function TItens_Tratamento_COFINS.GetSaida_Regra_EPP: integer;
begin
  GetSaida_Regra_EPP :=
    StrToInt(FrmTratamento_COFINS.EdtCodigo_Regra_COFINS_EPP_Saida.Text);
end;

function TItens_Tratamento_COFINS.GetSaida_Regra_ME: integer;
begin
  GetSaida_Regra_ME :=
    StrToInt(FrmTratamento_COFINS.EdtCodigo_Regra_COFINS_ME_Saida.Text);
end;

procedure TItens_Tratamento_COFINS.Inserir(var Registro
  : TItens_Tratamento_COFINS);
var
  qAux: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Insert into Itens_Tratamento_COFINS (Codigo, Entrada_Regra_EN, ');
        add('Entrada_Regra_EPP, Entrada_Regra_ME, Saida_Regra_EN, Saida_Regra_EPP, ');
        add('Saida_Regra_ME) values ');
        add('(:Codigo, :Entrada_Regra_EN, ');
        add(':Entrada_Regra_EPP, :Entrada_Regra_ME, :Saida_Regra_EN, :Saida_Regra_EPP, ');
        add(':Saida_Regra_ME)');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        // Parameters.ParamByName('Origem').Value:= Registro.Orig;
        // Parameters.ParamByName('Destino').Value:= Registro.Dest;
        Parameters.ParamByName('Entrada_Regra_EN').Value :=
          Registro.Entrada_Reg_EN;
        Parameters.ParamByName('Entrada_Regra_EPP').Value :=
          Registro.Entrada_Reg_EPP;
        Parameters.ParamByName('Entrada_Regra_ME').Value :=
          Registro.Entrada_Reg_ME;
        Parameters.ParamByName('Saida_Regra_EN').Value := Registro.Saida_Reg_EN;
        Parameters.ParamByName('Saida_Regra_EPP').Value :=
          Registro.Saida_Reg_EPP;
        Parameters.ParamByName('Saida_Regra_ME').Value := Registro.Saida_Reg_ME;
        // Parameters.ParamByName('Regra_Nao_Contribuinte').Value:= Registro.Reg_Nao_Contribuinte;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Insere;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TWebService_1_Producao }

procedure TWebService_1_Producao.Alterar(var Registro: TWebService_1_Producao);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Update WebService_1_Producao set ');
        add('Recepcao = :Recepcao, Retorno = :Retorno,');
        add('Status = :Status, Cancelamento = :Cancelamento,');
        add('Inutilizacao = :Inutilizacao, Consulta = :Consulta,');
        add('Consulta_Cadastro = :Consulta_Cadastro');
        add('where WebService_UF = :WebService_UF and Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        Parameters.ParamByName('WebService_UF').Value := Registro.WebServ_UF;
        Parameters.ParamByName('Recepcao').Value := Registro.Recep;
        Parameters.ParamByName('Retorno').Value := Registro.Ret;
        Parameters.ParamByName('Status').Value := Registro.Stat;
        Parameters.ParamByName('Cancelamento').Value := Registro.Canc;
        Parameters.ParamByName('Inutilizacao').Value := Registro.Inut;
        Parameters.ParamByName('Consulta').Value := Registro.Cons;
        Parameters.ParamByName('Consulta_Cadastro').Value :=
          Registro.Cons_Cadastro;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Altera;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TWebService_1_Producao.Excluir(var Registro: TWebService_1_Producao);
var
  qAux: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Delete from WebService_1_Producao where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        // lrControle:= Exclui;
        // UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TWebService_1_Producao.Excluir_Item(var Registro
  : TWebService_1_Producao);
var
  qAux: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Delete from WebService_1_Producao where Codigo = :Codigo and WebService_UF = :WebService_UF');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        Parameters.ParamByName('WebService_UF').Value := Registro.WebServ_UF;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Exclui;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

function TWebService_1_Producao.GetCancelamento: string;
begin
  // GetCancelamento := FrmConfiguracao_Sistema.EdtCancelamento_1_Producao.Text;
end;

function TWebService_1_Producao.GetCodigo: integer;
begin
  GetCodigo := Codigo_Empresa;
end;

function TWebService_1_Producao.GetConsulta: string;
begin
  // GetConsulta := FrmConfiguracao_Sistema.EdtConsulta_1_Producao.Text;
end;

function TWebService_1_Producao.GetConsulta_Cadastro: string;
begin
  // GetConsulta_Cadastro :=
  // FrmConfiguracao_Sistema.EdtConsulta_Cadastro_1_Producao.Text;
end;

function TWebService_1_Producao.GetInutilizacao: string;
begin
  // GetInutilizacao := FrmConfiguracao_Sistema.EdtInutilizacao_1_Producao.Text;
end;

function TWebService_1_Producao.GetRecepcao: string;
begin
  // GetRecepcao := FrmConfiguracao_Sistema.EdtRecepcao_1_Producao.Text;
end;

function TWebService_1_Producao.GetRetorno: string;
begin
  // GetRetorno := FrmConfiguracao_Sistema.EdtRetorno_1_Producao.Text;
end;

function TWebService_1_Producao.GetStatus: string;
begin
  // GetStatus := FrmConfiguracao_Sistema.EdtStatus_1_Producao.Text;
end;

function TWebService_1_Producao.GetWebService_UF: string;
begin
  /// GetWebService_UF := FrmConfiguracao_Sistema.EdtWebService_UF_1_Producao.Text;
end;

procedure TWebService_1_Producao.Inserir(var Registro: TWebService_1_Producao);
var
  qAux: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Insert into WebService_1_Producao (Codigo, WebService_UF, Recepcao, Retorno, ');
        add('Status, Cancelamento, Inutilizacao, Consulta, Consulta_Cadastro)');
        add('values ');
        add('(:Codigo, :WebService_UF, :Recepcao, :Retorno, ');
        add(':Status, :Cancelamento, :Inutilizacao, :Consulta, :Consulta_Cadastro)');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        Parameters.ParamByName('WebService_UF').Value := Registro.WebServ_UF;
        Parameters.ParamByName('Recepcao').Value := Registro.Recep;
        Parameters.ParamByName('Retorno').Value := Registro.Ret;
        Parameters.ParamByName('Status').Value := Registro.Stat;
        Parameters.ParamByName('Cancelamento').Value := Registro.Canc;
        Parameters.ParamByName('Inutilizacao').Value := Registro.Inut;
        Parameters.ParamByName('Consulta').Value := Registro.Cons;
        Parameters.ParamByName('Consulta_Cadastro').Value :=
          Registro.Cons_Cadastro;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Insere;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TWebService_1_Homologacao }

procedure TWebService_1_Homologacao.Alterar(var Registro
  : TWebService_1_Homologacao);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Update WebService_1_Homologacao set ');
        add('Recepcao = :Recepcao, Retorno = :Retorno,');
        add('Status = :Status, Cancelamento = :Cancelamento,');
        add('Inutilizacao = :Inutilizacao, Consulta = :Consulta,');
        add('Consulta_Cadastro = :Consulta_Cadastro');
        add('where WebService_UF = :WebService_UF and Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        Parameters.ParamByName('WebService_UF').Value := Registro.WebServ_UF;
        Parameters.ParamByName('Recepcao').Value := Registro.Recep;
        Parameters.ParamByName('Retorno').Value := Registro.Ret;
        Parameters.ParamByName('Status').Value := Registro.Stat;
        Parameters.ParamByName('Cancelamento').Value := Registro.Canc;
        Parameters.ParamByName('Inutilizacao').Value := Registro.Inut;
        Parameters.ParamByName('Consulta').Value := Registro.Cons;
        Parameters.ParamByName('Consulta_Cadastro').Value :=
          Registro.Cons_Cadastro;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Altera;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TWebService_1_Homologacao.Excluir(var Registro
  : TWebService_1_Homologacao);
var
  qAux: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Delete from WebService_1_Homologacao where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        // lrControle:= Exclui;
        // UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TWebService_1_Homologacao.Excluir_Item(var Registro
  : TWebService_1_Homologacao);
var
  qAux: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Delete from WebService_1_Homologacao where Codigo = :Codigo and WebService_UF = :WebService_UF');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        Parameters.ParamByName('WebService_UF').Value := Registro.WebServ_UF;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Exclui;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

function TWebService_1_Homologacao.GetCancelamento: string;
begin
  // GetCancelamento := FrmConfiguracao_Sistema.EdtCancelamento_1_Homologacao.Text;
end;

function TWebService_1_Homologacao.GetCodigo: integer;
begin
  GetCodigo := Codigo_Empresa;
end;

function TWebService_1_Homologacao.GetConsulta: string;
begin
  // GetConsulta := FrmConfiguracao_Sistema.EdtConsulta_1_Homologacao.Text;
end;

function TWebService_1_Homologacao.GetConsulta_Cadastro: string;
begin
  // GetConsulta_Cadastro :=
  // FrmConfiguracao_Sistema.EdtConsulta_Cadastro_1_Homologacao.Text;
end;

function TWebService_1_Homologacao.GetInutilizacao: string;
begin
  // GetInutilizacao := FrmConfiguracao_Sistema.EdtInutilizacao_1_Homologacao.Text;
end;

function TWebService_1_Homologacao.GetRecepcao: string;
begin
  // GetRecepcao := FrmConfiguracao_Sistema.EdtRecepcao_1_Homologacao.Text;
end;

function TWebService_1_Homologacao.GetRetorno: string;
begin
  // GetRetorno := FrmConfiguracao_Sistema.EdtRetorno_1_Homologacao.Text;
end;

function TWebService_1_Homologacao.GetStatus: string;
begin
  // GetStatus := FrmConfiguracao_Sistema.EdtStatus_1_Homologacao.Text;
end;

function TWebService_1_Homologacao.GetWebService_UF: string;
begin
  // GetWebService_UF :=
  // FrmConfiguracao_Sistema.EdtWebService_UF_1_Homologacao.Text;
end;

procedure TWebService_1_Homologacao.Inserir(var Registro
  : TWebService_1_Homologacao);
var
  qAux: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Insert into WebService_1_Homologacao (Codigo, WebService_UF, Recepcao, Retorno, ');
        add('Status, Cancelamento, Inutilizacao, Consulta, Consulta_Cadastro)');
        add('values ');
        add('(:Codigo, :WebService_UF, :Recepcao, :Retorno, ');
        add(':Status, :Cancelamento, :Inutilizacao, :Consulta, :Consulta_Cadastro)');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        Parameters.ParamByName('WebService_UF').Value := Registro.WebServ_UF;
        Parameters.ParamByName('Recepcao').Value := Registro.Recep;
        Parameters.ParamByName('Retorno').Value := Registro.Ret;
        Parameters.ParamByName('Status').Value := Registro.Stat;
        Parameters.ParamByName('Cancelamento').Value := Registro.Canc;
        Parameters.ParamByName('Inutilizacao').Value := Registro.Inut;
        Parameters.ParamByName('Consulta').Value := Registro.Cons;
        Parameters.ParamByName('Consulta_Cadastro').Value :=
          Registro.Cons_Cadastro;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Insere;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TWebService_2_Producao }

procedure TWebService_2_Producao.Alterar(var Registro: TWebService_2_Producao);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Update WebService_2_Producao set ');
        add('Recepcao = :Recepcao, Retorno = :Retorno,');
        add('Status = :Status, Cancelamento = :Cancelamento,');
        add('Inutilizacao = :Inutilizacao, Consulta = :Consulta,');
        add('Consulta_Cadastro = :Consulta_Cadastro');
        add('where WebService_UF = :WebService_UF and Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        Parameters.ParamByName('WebService_UF').Value := Registro.WebServ_UF;
        Parameters.ParamByName('Recepcao').Value := Registro.Recep;
        Parameters.ParamByName('Retorno').Value := Registro.Ret;
        Parameters.ParamByName('Status').Value := Registro.Stat;
        Parameters.ParamByName('Cancelamento').Value := Registro.Canc;
        Parameters.ParamByName('Inutilizacao').Value := Registro.Inut;
        Parameters.ParamByName('Consulta').Value := Registro.Cons;
        Parameters.ParamByName('Consulta_Cadastro').Value :=
          Registro.Cons_Cadastro;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Altera;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TWebService_2_Producao.Excluir(var Registro: TWebService_2_Producao);
var
  qAux: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Delete from WebService_2_Producao where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        // lrControle:= Exclui;
        // UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TWebService_2_Producao.Excluir_Item(var Registro
  : TWebService_2_Producao);
var
  qAux: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Delete from WebService_2_Producao where Codigo = :Codigo and WebService_UF = :WebService_UF');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        Parameters.ParamByName('WebService_UF').Value := Registro.WebServ_UF;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Exclui;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

function TWebService_2_Producao.GetCancelamento: string;
begin
  // GetCancelamento := FrmConfiguracao_Sistema.EdtCancelamento_2_Producao.Text;
end;

function TWebService_2_Producao.GetCodigo: integer;
begin
  GetCodigo := Codigo_Empresa;
end;

function TWebService_2_Producao.GetConsulta: string;
begin
  // GetConsulta := FrmConfiguracao_Sistema.EdtConsulta_2_Producao.Text;
end;

function TWebService_2_Producao.GetConsulta_Cadastro: string;
begin
  // GetConsulta_Cadastro :=
  // FrmConfiguracao_Sistema.EdtConsulta_Cadastro_2_Producao.Text;
end;

function TWebService_2_Producao.GetInutilizacao: string;
begin
  // GetInutilizacao := FrmConfiguracao_Sistema.EdtInutilizacao_2_Producao.Text;
end;

function TWebService_2_Producao.GetRecepcao: string;
begin
  // GetRecepcao := FrmConfiguracao_Sistema.EdtRecepcao_2_Producao.Text;
end;

function TWebService_2_Producao.GetRetorno: string;
begin
  // GetRetorno := FrmConfiguracao_Sistema.EdtRetorno_2_Producao.Text;
end;

function TWebService_2_Producao.GetStatus: string;
begin
  // GetStatus := FrmConfiguracao_Sistema.EdtStatus_2_Producao.Text;
end;

function TWebService_2_Producao.GetWebService_UF: string;
begin
  // GetWebService_UF := FrmConfiguracao_Sistema.EdtWebService_UF_2_Producao.Text;
end;

procedure TWebService_2_Producao.Inserir(var Registro: TWebService_2_Producao);
var
  qAux: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Insert into WebService_2_Producao (Codigo, WebService_UF, Recepcao, Retorno, ');
        add('Status, Cancelamento, Inutilizacao, Consulta, Consulta_Cadastro)');
        add('values ');
        add('(:Codigo, :WebService_UF, :Recepcao, :Retorno, ');
        add(':Status, :Cancelamento, :Inutilizacao, :Consulta, :Consulta_Cadastro)');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        Parameters.ParamByName('WebService_UF').Value := Registro.WebServ_UF;
        Parameters.ParamByName('Recepcao').Value := Registro.Recep;
        Parameters.ParamByName('Retorno').Value := Registro.Ret;
        Parameters.ParamByName('Status').Value := Registro.Stat;
        Parameters.ParamByName('Cancelamento').Value := Registro.Canc;
        Parameters.ParamByName('Inutilizacao').Value := Registro.Inut;
        Parameters.ParamByName('Consulta').Value := Registro.Cons;
        Parameters.ParamByName('Consulta_Cadastro').Value :=
          Registro.Cons_Cadastro;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Insere;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TWebService_2_Homologacao }

procedure TWebService_2_Homologacao.Alterar(var Registro
  : TWebService_2_Homologacao);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Update WebService_2_Homologacao set ');
        add('Recepcao = :Recepcao, Retorno = :Retorno,');
        add('Status = :Status, Cancelamento = :Cancelamento,');
        add('Inutilizacao = :Inutilizacao, Consulta = :Consulta,');
        add('Consulta_Cadastro = :Consulta_Cadastro');
        add('where WebService_UF = :WebService_UF and Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        Parameters.ParamByName('WebService_UF').Value := Registro.WebServ_UF;
        Parameters.ParamByName('Recepcao').Value := Registro.Recep;
        Parameters.ParamByName('Retorno').Value := Registro.Ret;
        Parameters.ParamByName('Status').Value := Registro.Stat;
        Parameters.ParamByName('Cancelamento').Value := Registro.Canc;
        Parameters.ParamByName('Inutilizacao').Value := Registro.Inut;
        Parameters.ParamByName('Consulta').Value := Registro.Cons;
        Parameters.ParamByName('Consulta_Cadastro').Value :=
          Registro.Cons_Cadastro;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Altera;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TWebService_2_Homologacao.Excluir(var Registro
  : TWebService_2_Homologacao);
var
  qAux: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Delete from WebService_2_Homologacao where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        // lrControle:= Exclui;
        // UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TWebService_2_Homologacao.Excluir_Item(var Registro
  : TWebService_2_Homologacao);
var
  qAux: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Delete from WebService_2_Homologacao where Codigo = :Codigo and WebService_UF = :WebService_UF');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        Parameters.ParamByName('WebService_UF').Value := Registro.WebServ_UF;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Exclui;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

function TWebService_2_Homologacao.GetCancelamento: string;
begin
  // GetCancelamento := FrmConfiguracao_Sistema.EdtCancelamento_2_Homologacao.Text;
end;

function TWebService_2_Homologacao.GetCodigo: integer;
begin
  GetCodigo := Codigo_Empresa;
end;

function TWebService_2_Homologacao.GetConsulta: string;
begin
  // GetConsulta := FrmConfiguracao_Sistema.EdtConsulta_2_Homologacao.Text;
end;

function TWebService_2_Homologacao.GetConsulta_Cadastro: string;
begin
  // GetConsulta_Cadastro :=
  // FrmConfiguracao_Sistema.EdtConsulta_Cadastro_2_Homologacao.Text;
end;

function TWebService_2_Homologacao.GetInutilizacao: string;
begin
  // GetInutilizacao := FrmConfiguracao_Sistema.EdtInutilizacao_2_Homologacao.Text;
end;

function TWebService_2_Homologacao.GetRecepcao: string;
begin
  // GetRecepcao := FrmConfiguracao_Sistema.EdtRecepcao_2_Homologacao.Text;
end;

function TWebService_2_Homologacao.GetRetorno: string;
begin
  // GetRetorno := FrmConfiguracao_Sistema.EdtRetorno_2_Homologacao.Text;
end;

function TWebService_2_Homologacao.GetStatus: string;
begin
  // GetStatus := FrmConfiguracao_Sistema.EdtStatus_2_Homologacao.Text;
end;

function TWebService_2_Homologacao.GetWebService_UF: string;
begin
  // GetWebService_UF :=
  // FrmConfiguracao_Sistema.EdtWebService_UF_2_Homologacao.Text;
end;

procedure TWebService_2_Homologacao.Inserir(var Registro
  : TWebService_2_Homologacao);
var
  qAux: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Insert into WebService_2_Homologacao (Codigo, WebService_UF, Recepcao, Retorno, ');
        add('Status, Cancelamento, Inutilizacao, Consulta, Consulta_Cadastro)');
        add('values ');
        add('(:Codigo, :WebService_UF, :Recepcao, :Retorno, ');
        add(':Status, :Cancelamento, :Inutilizacao, :Consulta, :Consulta_Cadastro)');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        Parameters.ParamByName('WebService_UF').Value := Registro.WebServ_UF;
        Parameters.ParamByName('Recepcao').Value := Registro.Recep;
        Parameters.ParamByName('Retorno').Value := Registro.Ret;
        Parameters.ParamByName('Status').Value := Registro.Stat;
        Parameters.ParamByName('Cancelamento').Value := Registro.Canc;
        Parameters.ParamByName('Inutilizacao').Value := Registro.Inut;
        Parameters.ParamByName('Consulta').Value := Registro.Cons;
        Parameters.ParamByName('Consulta_Cadastro').Value :=
          Registro.Cons_Cadastro;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Insere;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;
{ TCadastro_Usuario }

procedure TCadastro_Usuario.Alterar(var Registro: TCadastro_Usuario;
  var Conexao: TADOConnection);
var
  qAux, qaux2: TADOQuery;
begin
  // try
  // DM.ADOConnection1.BeginTrans;
  try
    qAux := TADOQuery.Create(nil);
    with qAux, SQL do
    begin
      close;
      clear;
      Connection := Conexao;
      add('Update Cadastro_Usuario set ');
      add('Nome = :Nome, Login = :Login,');
      add('Senha = :Senha, ');
      add('Administrador = :Administrador,');
      // add('Bloqueia_Cliente = :Bloqueia_Cliente,');
      add('Codigo_Perfil = :Codigo_Perfil, Data_Cadastro = :Data_Cadastro,');
      add('Atualiza_Preco_Orcamento = :Atualiza_Preco_Orcamento, Saldo_Atual = :Saldo_Atual');
      add('where Codigo = :Codigo');
      Parameters.ParamByName('Codigo').Value := Registro.Cod;
      Parameters.ParamByName('Nome').Value := Registro.Nom;
      Parameters.ParamByName('Login').Value := Registro.Log;
      Parameters.ParamByName('Senha').Value := Registro.Sen;
      Parameters.ParamByName('Administrador').Value := Registro.Adm;

      Parameters.ParamByName('Codigo_Perfil').Value := Registro.Cod_Perfil;
      Parameters.ParamByName('Data_Cadastro').Value := Registro.Data;

      if (FrmCadastro_Funcionarios.CBAtualiza_Preco_Orcamento.Checked) then
        Parameters.ParamByName('Atualiza_Preco_Orcamento').Value := 'SIM'
      else
        Parameters.ParamByName('Atualiza_Preco_Orcamento').Value := 'NO';

      Parameters.ParamByName('Saldo_Atual').Value :=
        StrToFloat(FrmCadastro_Funcionarios.EdtSaldo_Atual.Text);

      ExecSQL;
      // DM.ADOConnection1.CommitTrans;
      lrControle := Altera;
      UGeral.Mensagem_Padrao(lrControle);
    end;
  finally
    qAux.close;
    FreeAndNil(qAux);
  end;

  { except
    on E: Exception do
    begin
    //DM.ADOConnection1.RollbackTrans;
    Operacao_Nao_Completada(E.Message);
    end;
    end; }
end;

procedure TCadastro_Usuario.Excluir(var Registro: TCadastro_Usuario;
  var Conexao: TADOConnection);
var
  qAux: TADOQuery;
begin
  // try
  // DM.ADOConnection1.BeginTrans;
  try
    qAux := TADOQuery.Create(nil);
    with qAux, SQL do
    begin
      close;
      clear;
      Connection := Conexao;
      add('Delete from Cadastro_Usuario where Codigo = :Codigo');
      Parameters.ParamByName('Codigo').Value := Registro.Cod;
      ExecSQL;
      // DM.ADOConnection1.CommitTrans;
      lrControle := Exclui;
      UGeral.Mensagem_Padrao(lrControle);
    end;
  finally
    qAux.close;
    FreeAndNil(qAux);
  end;

  { except
    on E: Exception do
    begin
    //DM.ADOConnection1.RollbackTrans;
    Operacao_Nao_Completada(E.Message);
    end;
    end; }
end;

function TCadastro_Usuario.GetAdministrador: string;
begin
  if (FrmCadastro_Funcionarios.CBADM.Checked) then
    GetAdministrador := 'SIM'
  else
    GetAdministrador := 'NO';
end;

function TCadastro_Usuario.GetCodigo: integer;
begin
  GetCodigo := StrToInt(FrmCadastro_Funcionarios.EdtCodigo.Text);
end;

function TCadastro_Usuario.GetCodigo_Perfil: integer;
begin
  if (FrmCadastro_Funcionarios.EdtCodigo_Perfil.Text <> '') then
    GetCodigo_Perfil := StrToInt(FrmCadastro_Funcionarios.EdtCodigo_Perfil.Text)
  else
    GetCodigo_Perfil := 0;
end;

function TCadastro_Usuario.GetData_Cadastro: Tdate;
begin
  GetData_Cadastro := StrToDateTime
    (FrmCadastro_Funcionarios.MEdtData_Cadastro.Text);
end;

function TCadastro_Usuario.GetLogin: string;
begin
  GetLogin := FrmCadastro_Funcionarios.EdtLogin.Text;
end;

function TCadastro_Usuario.GetNome: string;
begin
  GetNome := FrmCadastro_Funcionarios.EdtNome.Text;
end;

function TCadastro_Usuario.GetSenha: string;
begin
  GetSenha := FrmCadastro_Funcionarios.EdtSenha.Text;
end;

procedure TCadastro_Usuario.Inserir(var Registro: TCadastro_Usuario;
  var Conexao: TADOConnection);
var
  qAux: TADOQuery;
begin
  // try
  // DM.ADOConnection1.BeginTrans;
  try
    qAux := TADOQuery.Create(nil);
    with qAux, SQL do
    begin
      close;
      clear;
      Connection := Conexao;
      add('Insert into Cadastro_Usuario (Codigo, Nome, Login, Senha, Administrador, Codigo_Perfil, Data_Cadastro, Atualiza_Preco_Orcamento, Saldo_Atual)');
      add('values ');
      add('(:Codigo, :Nome, :Login, :Senha, :Administrador, :Codigo_Perfil, :Data_Cadastro, :Atualiza_Preco_Orcamento, :Saldo_Atual)');
      Parameters.ParamByName('Codigo').Value := Registro.Cod;
      Parameters.ParamByName('Nome').Value := Registro.Nom;
      Parameters.ParamByName('Login').Value := Registro.Log;
      Parameters.ParamByName('Senha').Value := Registro.Sen;
      Parameters.ParamByName('Administrador').Value := Registro.Adm;

      Parameters.ParamByName('Codigo_Perfil').Value := Registro.Cod_Perfil;
      Parameters.ParamByName('Data_Cadastro').Value := Registro.Data;

      if (FrmCadastro_Funcionarios.CBAtualiza_Preco_Orcamento.Checked) then
        Parameters.ParamByName('Atualiza_Preco_Orcamento').Value := 'SIM'
      else
        Parameters.ParamByName('Atualiza_Preco_Orcamento').Value := 'NO';
      Parameters.ParamByName('Saldo_Atual').Value :=
        StrToFloat(FrmCadastro_Funcionarios.EdtSaldo_Atual.Text);
      ExecSQL;
      // DM.ADOConnection1.CommitTrans;
      lrControle := Insere;
      UGeral.Mensagem_Padrao(lrControle);
    end;
  finally
    qAux.close;
    FreeAndNil(qAux);
  end;

  { except
    on E: Exception do
    begin
    //DM.ADOConnection1.RollbackTrans;
    Operacao_Nao_Completada(E.Message);
    end;
    end; }
end;

{ TAbertura_Caixa }

procedure TAbertura_Caixa.Alterar(var Registro: TAbertura_Caixa);
begin
  //
end;

procedure TAbertura_Caixa.Excluir(var Registro: TAbertura_Caixa);
var
  qAux: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Delete from Abertura_Caixa where Data_Abertura = :Data_Abertura');
        Parameters.ParamByName('Data_Abertura').Value := Registro.Data_Ab;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Exclui;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

function TAbertura_Caixa.GetCodigo_Forma_Pagamento: integer;
begin
  GetCodigo_Forma_Pagamento := 1
end;

function TAbertura_Caixa.GetCodigo_Usuario: integer;
begin
  GetCodigo_Usuario := UDeclaracao.codigo_usu;
end;

function TAbertura_Caixa.GetAcerto: integer;
begin
  GetAcerto := 0;
end;

function TAbertura_Caixa.GetCodigo_Caixa: integer;
begin
  GetCodigo_Caixa := UDeclaracao.codigo_usu
end;

function TAbertura_Caixa.GetData_Abertura: TDateTime;
begin
  if (tipo_local = '0101') then
    GetData_Abertura := StrToDate(dataf)
  else
    GetData_Abertura := date;
end;

function TAbertura_Caixa.GetValor: double;
begin
  if (FrmAbertura_Caixa <> nil) and (FrmAbertura_Caixa.ativo = true) then
    GetValor := StrToFloat(FrmAbertura_Caixa.EdtValor.Text)

  else if (FrmAltera_Caixa <> nil) and (FrmAltera_Caixa.ativo = true) then
    GetValor := StrToFloat(FrmAltera_Caixa.EdtValor.Text);
end;

procedure TAbertura_Caixa.Inserir(var Registro: TAbertura_Caixa);
var
  qAux: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Insert into Abertura_Caixa ( Data_Abertura, Codigo_Forma_Pagamento, Codigo_Caixa, Codigo_Usuario, Valor, Acerto)');
        add('values ');
        add('(:Data_Abertura, :Codigo_Forma_Pagamento, :Codigo_Caixa, :Codigo_Usuario, :Valor, :Acerto)');
        Parameters.ParamByName('Data_Abertura').Value := Registro.Data_Ab;
        Parameters.ParamByName('Codigo_Forma_Pagamento').Value :=
          Registro.Cod_Forma_Pagamento;
        Parameters.ParamByName('Codigo_Caixa').Value := Registro.Cod_Caixa;
        Parameters.ParamByName('Codigo_Usuario').Value := Registro.Cod_Usuario;
        Parameters.ParamByName('Valor').Value := Registro.Val;
        Parameters.ParamByName('Acerto').Value := Registro.Acert;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        // lrControle:= Insere;
        // UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TFechamento_Caixa }

procedure TFechamento_Caixa.Alterar(var Registro: TFechamento_Caixa);
begin
  //
end;

procedure TFechamento_Caixa.Excluir(var Registro: TFechamento_Caixa);
var
  qAux: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Delete from Fechamento_Caixa where Data_Fechamento = :Data_Fechamento');
        Parameters.ParamByName('Data_Fechamento').Value := Registro.Data_Fec;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Exclui;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

function TFechamento_Caixa.GetCodigo_Caixa: integer;
begin
  GetCodigo_Caixa := UDeclaracao.Codigo_Caixa;
end;

function TFechamento_Caixa.GetCodigo_Usuario: integer;
begin
  GetCodigo_Usuario := UDeclaracao.codigo_usu;
end;

function TFechamento_Caixa.GetData_Abertura: TDateTime;
begin
  GetData_Abertura := FrmAcerto_Caixa.qryaberturaData_Abertura.AsDateTime;
end;

function TFechamento_Caixa.GetData_Fechamento: TDateTime;
begin
  GetData_Fechamento := date;
end;

function TFechamento_Caixa.GetForma_Pagamento: string;
begin
  GetForma_Pagamento := FrmAcerto_Caixa.qryfechamentoForma_Pagamento.AsString;
end;

function TFechamento_Caixa.GetTipo_Documento: string;
begin
  GetTipo_Documento := FrmAcerto_Caixa.qryfechamentoTipo_Documento.AsString;
end;

function TFechamento_Caixa.GetValor_Abertura: double;
begin
  GetValor_Abertura := FrmAcerto_Caixa.qryaberturaValor.AsFloat;
end;

function TFechamento_Caixa.GetValor_Fechamento: double;
begin
  GetValor_Fechamento := FrmAcerto_Caixa.qryfechamentoValor.AsFloat;
end;

procedure TFechamento_Caixa.Inserir(var Registro: TFechamento_Caixa);
var
  qAux: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        Connection := DM.ADOConnection1;
        clear;
        add('Insert into Fechamento_Caixa ( Data_Abertura, Data_Fechamento, Forma_Pagamento, Codigo_Caixa, ');
        add('Codigo_Usuario, Valor_Abertura, Valor_Fechamento, Tipo_Documento, MD5)');
        add('values ');
        add('(:Data_Abertura, :Data_Fechamento, :Forma_Pagamento, :Codigo_Caixa, ');
        add(':Codigo_Usuario, :Valor_Abertura, :Valor_Fechamento, :Tipo_Documento, :MD5)');

        Parameters.ParamByName('Data_Abertura').Value := Registro.Data_Ab;
        Parameters.ParamByName('Data_Fechamento').Value := Registro.Data_Fec;
        Parameters.ParamByName('Forma_Pagamento').Value := Registro.Forma_Pag;
        Parameters.ParamByName('Codigo_Caixa').Value := Registro.Cod_Caixa;
        Parameters.ParamByName('Codigo_Usuario').Value := Registro.Cod_Usuario;
        Parameters.ParamByName('Valor_Abertura').Value := Registro.Valor_Ab;
        Parameters.ParamByName('Valor_Fechamento').Value := Registro.Valor_Fec;
        Parameters.ParamByName('Tipo_Documento').Value := Registro.Tipo_Doc;
        Parameters.ParamByName('MD5').Value := GeraMD5([Registro.Tipo_Doc, FloatToStr(Registro.Valor_Fec)]);
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        // lrControle:= Insere;
        // UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TCadastro_Tabela_Preco }

procedure TCadastro_Tabela_Preco.Alterar(var Registro: TCadastro_Tabela_Preco;
  Conexao: TADOConnection);
var
  qAux, qaux2: TADOQuery;
begin
  // try
  /// /DM.ADOConnection1.BeginTrans;
  try
    qAux := TADOQuery.Create(nil);
    qaux2 := TADOQuery.Create(nil);
    with qAux, SQL do
    begin
      close;
      Connection := DM.ADOConnection1;
      clear;
      add('Update Tabela_Preco set Codigo_Empresa = :Codigo_Empresa, Descricao = :Descricao, Data_Validade = :Data_Validade, Tipo = :Tipo,');
      add('Tipo_Calculo = :Tipo_Calculo, Percentual_Vista = :Percentual_Vista, Percentual_Prazo = :Percentual_Prazo, Atalho = :Atalho, Tipo_Valor = :Tipo_Valor where Codigo = :Codigo');
      Parameters.ParamByName('Codigo').Value := Registro.Cod;
      Parameters.ParamByName('Codigo_Empresa').Value := Registro.Cod_Empresa;
      Parameters.ParamByName('Descricao').Value := Registro.Desc;
      Parameters.ParamByName('Data_Validade').Value := Registro.Data_Val;
      Parameters.ParamByName('Tipo').Value := Registro.Tip;
      Parameters.ParamByName('Tipo_Calculo').Value := Registro.Tip_Calc;
      Parameters.ParamByName('Percentual_Vista').Value := Registro.Perc_Vista;
      Parameters.ParamByName('Percentual_Prazo').Value := Registro.Perc_Prazo;
      Parameters.ParamByName('Atalho').Value := Registro.Ata;
      Parameters.ParamByName('Tipo_Valor').Value :=
        FrmCadastro_Tabela_Preco.RGValor.ItemIndex;
      ExecSQL;
      // DM.ADOConnection1.CommitTrans;
      lrControle := Altera;
      UGeral.Mensagem_Padrao(lrControle);
    end;
  finally
    qAux.close;
    FreeAndNil(qAux);
  end;

  { except
    on E: Exception do
    begin
    //DM.ADOConnection1.RollbackTrans;
    Operacao_Nao_Completada(E.Message);
    end;
    end; }
end;

procedure TCadastro_Tabela_Preco.Excluir(var Registro: TCadastro_Tabela_Preco;
  Conexao: TADOConnection);
var
  qAux, qaux2: TADOQuery;
begin
  // try
  /// /DM.ADOConnection1.BeginTrans;
  try
    qAux := TADOQuery.Create(nil);
    qaux2 := TADOQuery.Create(nil);
    with qAux, SQL do
    begin
      close;
      clear;
      Connection := Conexao;
      add('Delete from Tabela_Preco where Codigo = :Codigo');
      Parameters.ParamByName('Codigo').Value := Registro.Cod;
      ExecSQL;
      // DM.ADOConnection1.CommitTrans;
      lrControle := Exclui;
      UGeral.Mensagem_Padrao(lrControle);
    end;
  finally
    qAux.close;
    FreeAndNil(qAux);
  end;

  { except
    on E: Exception do
    begin
    ////DM.ADOConnection1.RollbackTrans;
    Operacao_Nao_Completada(E.Message);
    end;
    end; }
end;

procedure TCadastro_Tabela_Preco.Excluir_Itens_Tabela
  (var Registro: TCadastro_Tabela_Preco; Conexao: TADOConnection);
var
  qAux, qaux2: TADOQuery;
begin
  // try
  /// /DM.ADOConnection1.BeginTrans;
  try
    qAux := TADOQuery.Create(nil);
    qaux2 := TADOQuery.Create(nil);
    with qAux, SQL do
    begin
      close;
      clear;
      Connection := Conexao;
      add('Delete from Itens_Tabela_Preco where Codigo = :Codigo');
      Parameters.ParamByName('Codigo').Value := Registro.Cod;
      ExecSQL;
      /// /DM.ADOConnection1.CommitTrans;
      // lrControle:= Exclui;
      // UGeral.Mensagem_Padrao(lrControle);
    end;
  finally
    qAux.close;
    FreeAndNil(qAux);
  end;

  { except
    on E: Exception do
    begin
    ////DM.ADOConnection1.RollbackTrans;
    Operacao_Nao_Completada(E.Message);
    end;
    end; }
end;

procedure TCadastro_Tabela_Preco.Excluir_Produto_Tabela
  (var Registro: TCadastro_Tabela_Preco; Conexao: TADOConnection);
var
  qAux, qaux2: TADOQuery;
begin
  // try
  /// /DM.ADOConnection1.BeginTrans;
  try
    qAux := TADOQuery.Create(nil);
    qaux2 := TADOQuery.Create(nil);
    with qAux, SQL do
    begin
      close;
      clear;
      Connection := Conexao;
      add('Delete from Itens_Tabela_Preco where Codigo_Produto = :Codigo');
      Parameters.ParamByName('Codigo').Value := Registro.Cod_Prod;
      ExecSQL;
    end;

    with qAux, SQL do
    begin
      close;
      clear;
      Connection := Conexao;
      add('Delete from Itens_Tabela_Preco_Aux where Codigo_Produto = :Codigo');
      Parameters.ParamByName('Codigo').Value := Registro.Cod_Prod;
      ExecSQL;
    end;

    /// /DM.ADOConnection1.CommitTrans;
  finally
    qAux.close;
    FreeAndNil(qAux);
  end;

  { except
    on E: Exception do
    begin
    ////DM.ADOConnection1.RollbackTrans;
    Operacao_Nao_Completada(E.Message);
    end;
    end; }
end;

function TCadastro_Tabela_Preco.GetAtalho: string;
begin
  GetAtalho := FrmCadastro_Tabela_Preco.EdtAtalho.Text;
end;

function TCadastro_Tabela_Preco.GetCodigo: integer;
begin
  GetCodigo := StrToInt(FrmCadastro_Tabela_Preco.EdtCodigo.Text);
end;

function TCadastro_Tabela_Preco.GetCodigo_Empresa: integer;
begin
  GetCodigo_Empresa := UDeclaracao.Codigo_Empresa;
end;

function TCadastro_Tabela_Preco.GetCodigo_Produto: integer;
begin
  GetCodigo_Produto := StrToInt(FrmCadastro_Produto.EdtCodigo.Text);
end;

function TCadastro_Tabela_Preco.GetData_Cadastro: Tdate;
begin
  GetData_Cadastro := StrToDateTime
    (FrmCadastro_Tabela_Preco.MEdtData_Cadastro.Text);
end;

function TCadastro_Tabela_Preco.GetData_Validade: Tdate;
begin
  GetData_Validade := StrToDateTime
    (FrmCadastro_Tabela_Preco.MEdtData_Validade.Text);
end;

function TCadastro_Tabela_Preco.GetDesc: string;
begin
  GetDesc := FrmCadastro_Tabela_Preco.EdtDescricao.Text;
end;

function TCadastro_Tabela_Preco.GetPercentual_Prazo: double;
begin
  GetPercentual_Prazo :=
    StrToFloat(FrmCadastro_Tabela_Preco.EdtPercentual_Prazo.Text);
end;

function TCadastro_Tabela_Preco.GetPercentual_Vista: double;
begin
  GetPercentual_Vista :=
    StrToFloat(FrmCadastro_Tabela_Preco.EdtPercentual_Vista.Text);
end;

function TCadastro_Tabela_Preco.GetTipo: string;
begin
  if (FrmCadastro_Tabela_Preco.RGTipo.ItemIndex = 0) then
    GetTipo := 'TUDO'
  else if (FrmCadastro_Tabela_Preco.RGTipo.ItemIndex = 1) then
    GetTipo := 'PRODUTO'
  else if (FrmCadastro_Tabela_Preco.RGTipo.ItemIndex = 2) then
    GetTipo := 'SERVIO';
end;

function TCadastro_Tabela_Preco.GetTipo_Calculo: string;
begin
  if (FrmCadastro_Tabela_Preco.RGTipo_Calculo.ItemIndex = 0) then
    GetTipo_Calculo := 'MARGEM BRUTA'
  else if (FrmCadastro_Tabela_Preco.RGTipo_Calculo.ItemIndex = 1) then
    GetTipo_Calculo := 'MARGEM LIQUIDA';
end;

procedure TCadastro_Tabela_Preco.Inserir(var Registro: TCadastro_Tabela_Preco;
  Conexao: TADOConnection);
var
  qAux, qaux2: TADOQuery;
begin
  // try
  /// /DM.ADOConnection1.BeginTrans;
  try
    qAux := TADOQuery.Create(nil);
    qaux2 := TADOQuery.Create(nil);
    with qAux, SQL do
    begin
      close;
      clear;
      Connection := DM.ADOConnection1;
      add('insert into Tabela_Preco (Codigo, Codigo_Empresa, Descricao, Data_Cadastro, Data_Validade, Tipo, Tipo_Calculo, Percentual_Vista, Percentual_Prazo, Atalho, Tipo_Valor)');
      add('values (:Codigo, :Codigo_Empresa, :Descricao, :Data_Cadastro, :Data_Validade, :Tipo, :Tipo_Calculo, :Percentual_Vista, :Percentual_Prazo, :Atalho, :Tipo_Valor)');
      Parameters.ParamByName('Codigo').Value := Registro.Cod;
      Parameters.ParamByName('Codigo_Empresa').Value := Registro.Cod_Empresa;
      Parameters.ParamByName('Descricao').Value := Registro.Desc;
      Parameters.ParamByName('Data_Cadastro').Value := Registro.Data;
      Parameters.ParamByName('Data_Validade').Value := Registro.Data_Val;
      Parameters.ParamByName('Tipo').Value := Registro.Tip;
      Parameters.ParamByName('Tipo_Calculo').Value := Registro.Tip_Calc;
      Parameters.ParamByName('Percentual_Vista').Value := Registro.Perc_Vista;
      Parameters.ParamByName('Percentual_Prazo').Value := Registro.Perc_Prazo;
      Parameters.ParamByName('Atalho').Value := Registro.Ata;
      Parameters.ParamByName('Tipo_Valor').Value :=
        FrmCadastro_Tabela_Preco.RGValor.ItemIndex;
      ExecSQL;
      // DM.ADOConnection1.CommitTrans;
      lrControle := Insere;
      UGeral.Mensagem_Padrao(lrControle);
    end;
  finally
    qAux.close;
    FreeAndNil(qAux);
  end;

  { except
    on E: Exception do
    begin
    //DM.ADOConnection1.RollbackTrans;
    Operacao_Nao_Completada(E.Message);
    end;
    end; }
end;

{ TCotacao }

procedure TCotacao.Alterar(var Registro: TCotacao);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Update Cotacao_Preco_Produto set Codigo_Empresa = :Codigo_Empresa, Codigo_Funcionario = :Codigo_Funcionario,');
        add('Data_Cotacao = :Data_Cotacao, Hora_Cotacao = :Hora_Cotacao, Data_Vencimento = :Data_Vencimento,');
        add('Qtde_Itens = :Qtde_Itens');
        add('where N_Cotacao = :N_Cotacao');
        Parameters.ParamByName('N_Cotacao').Value := Registro.N_Cot;
        Parameters.ParamByName('Codigo_Empresa').Value := Registro.Cod_Empresa;
        Parameters.ParamByName('Codigo_Funcionario').Value :=
          Registro.Cod_Funcionario;
        Parameters.ParamByName('Data_Cotacao').Value := Registro.Data_Cot;
        Parameters.ParamByName('Hora_Cotacao').Value := Registro.Hora_Cot;
        Parameters.ParamByName('Data_Vencimento').Value := Registro.Data_Venc;
        Parameters.ParamByName('Qtde_Itens').Value := Registro.Qtde;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Altera;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TCotacao.Excluir(var Registro: TCotacao);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Delete from Cotacao_Preco_Produto where N_Cotacao = :N_Cotacao');
        Parameters.ParamByName('N_Cotacao').Value := Registro.N_Cot;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Exclui;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

function TCotacao.GetCodigo_Empresa: integer;
begin
  GetCodigo_Empresa := UDeclaracao.Codigo_Empresa;
end;

function TCotacao.GetCodigo_Funcionario: integer;
begin
  GetCodigo_Funcionario :=
    StrToInt(FrmCotacao_Preco_Produto.EdtCodigo_Funcionario.Text);
end;

function TCotacao.GetData_Cotacao: Tdate;
begin
  GetData_Cotacao := StrToDateTime
    (FrmCotacao_Preco_Produto.MEdtData_Cotacao.Text);
end;

function TCotacao.GetData_Vencimento: Tdate;
begin
  GetData_Vencimento := StrToDateTime
    (FrmCotacao_Preco_Produto.MEdtData_Vencimento.Text);
end;

function TCotacao.GetHora_Cotacao: string;
begin
  GetHora_Cotacao := FrmCotacao_Preco_Produto.MEdtHora_Pedido.Text;
end;

function TCotacao.GetN_Cotacao: integer;
begin
  GetN_Cotacao := StrToInt(FrmCotacao_Preco_Produto.EdtN_Cotacao.Text);
end;

function TCotacao.GetQtde_Itens: double;
begin
  GetQtde_Itens := StrToInt(FrmCotacao_Preco_Produto.EdtQuantidade_Itens.Text);
end;

procedure TCotacao.Inserir(var Registro: TCotacao);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('insert into Cotacao_Preco_Produto (N_Cotacao, Codigo_Empresa, Codigo_Funcionario, Data_Cotacao, Hora_Cotacao,');
        add('Data_Vencimento, Qtde_Itens)');
        add('values (:N_Cotacao, :Codigo_Empresa, :Codigo_Funcionario, :Data_Cotacao, :Hora_Cotacao, ');
        add(':Data_Vencimento, :Qtde_Itens)');
        Parameters.ParamByName('N_Cotacao').Value := Registro.N_Cot;
        Parameters.ParamByName('Codigo_Empresa').Value := Registro.Cod_Empresa;
        Parameters.ParamByName('Codigo_Funcionario').Value :=
          Registro.Cod_Funcionario;
        Parameters.ParamByName('Data_Cotacao').Value := Registro.Data_Cot;
        Parameters.ParamByName('Hora_Cotacao').Value := Registro.Hora_Cot;
        Parameters.ParamByName('Data_Vencimento').Value := Registro.Data_Venc;
        Parameters.ParamByName('Qtde_Itens').Value := Registro.Qtde;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Insere;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TItens_Cotacao }

procedure TItens_Cotacao.Excluir(var Registro: TItens_Cotacao);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Delete from Itens_Cotacao_Preco_Produto where N_Cotacao = :N_Cotacao');
        Parameters.ParamByName('N_Cotacao').Value := Registro.N_Cot;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        // lrControle:= Exclui;
        // UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TItens_Cotacao.Excluir_Selecionado(var Registro: TItens_Cotacao);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Delete from Itens_Cotacao_Preco_Produto where N_Cotacao = :N_Cotacao and Codigo_Produto = :Produto');
        Parameters.ParamByName('N_Cotacao').Value := Registro.N_Cot;
        Parameters.ParamByName('Produto').Value := Registro.Cod_Prod_Sel;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Exclui;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

function TItens_Cotacao.GetCodigo_Produto: integer;
begin
  GetCodigo_Produto := StrToInt(FrmCotacao_Preco_Produto.LblProduto.Caption);
end;

function TItens_Cotacao.GetCodigo_Produto_Selecionado: integer;
begin
  GetCodigo_Produto_Selecionado :=
    FrmCotacao_Preco_Produto.qryitens_cotacaoCodigo_Produto.AsInteger;
end;

function TItens_Cotacao.GetN_Cotacao: integer;
begin
  GetN_Cotacao := StrToInt(FrmCotacao_Preco_Produto.EdtN_Cotacao.Text);
end;

function TItens_Cotacao.GetQtde: double;
begin
  GetQtde := StrToFloat(FrmCotacao_Preco_Produto.EdtQuantidade.Text);
end;

procedure TItens_Cotacao.Inserir(var Registro: TItens_Cotacao);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('insert into Itens_Cotacao_Preco_Produto (N_Cotacao, Codigo_Produto, Qtde)');
        add('values (:N_Cotacao, :Codigo_Produto, :Qtde)');
        Parameters.ParamByName('N_Cotacao').Value := Registro.N_Cot;
        Parameters.ParamByName('Codigo_Produto').Value := Registro.Cod_Prod;
        Parameters.ParamByName('Qtde').Value := Registro.Qtd;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Insere;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TRetorno_Cotacao }

procedure TRetorno_Cotacao.Alterar(var Registro: TRetorno_Cotacao);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      begin
        with qAux, SQL do
        begin
          close;
          Connection := DM.ADOConnection1;
          clear;
          add('Update Retorno_Cotacao_Preco set Data_Cotacao = :Data_Cotacao, Data_Retorno = :Data_Retorno,');
          add('Prazo_Entrega = :Prazo_Entrega, Codigo_Fornecedor = :Codigo_Fornecedor,');
          add('Codigo_Condicao_Pagamento = :Codigo_Condicao_Pagamento, Codigo_Funcionario = :Codigo_Funcionario,');
          add('Codigo_Empresa = :Codigo_Empresa, Tipo_Frete = :Tipo_Frete, Valor_Frete = :Valor_Frete, Outras_Despesas = :Outras_Despesas,');
          add('Qtde_Itens = :Qtde_Itens, Total_Produtos = :Total_Produtos, Peso_Total = :Peso_Total,');
          add('Desconto = :Desconto, Tipo_Desconto = :Tipo_Desconto, Total_Pedido = :Total_Pedido,');
          add('Observacoes = :Observacoes');
          add('where Codigo = :Codigo and N_Cotacao = :N_Cotacao');
          Parameters.ParamByName('Codigo').Value := Registro.Cod;
          Parameters.ParamByName('N_Cotacao').Value := Registro.N_Cot;
          Parameters.ParamByName('Data_Cotacao').Value := Registro.Data_Cot;
          Parameters.ParamByName('Data_Retorno').Value := Registro.Data_Ret;
          Parameters.ParamByName('Prazo_Entrega').Value := Registro.Pr_Entrega;
          Parameters.ParamByName('Codigo_Fornecedor').Value :=
            Registro.Cod_Forn;
          Parameters.ParamByName('Codigo_Condicao_Pagamento').Value :=
            Registro.Cod_Cond_Pag;
          Parameters.ParamByName('Codigo_Funcionario').Value :=
            Registro.Cod_Fun;
          Parameters.ParamByName('Codigo_Empresa').Value :=
            Registro.Cod_Empresa;
          Parameters.ParamByName('Tipo_Frete').Value := Registro.Tipo_Fre;
          Parameters.ParamByName('Valor_Frete').Value := Registro.Valor_Fre;
          Parameters.ParamByName('Outras_Despesas').Value :=
            Registro.Outras_Desp;
          Parameters.ParamByName('Qtde_Itens').Value := Registro.Qtde_It;
          Parameters.ParamByName('Total_Produtos').Value := Registro.Total_Prod;
          Parameters.ParamByName('Peso_Total').Value := Registro.Peso_Tot;
          Parameters.ParamByName('Desconto').Value := Registro.Desc;
          Parameters.ParamByName('Tipo_Desconto').Value := Registro.Tipo_Desc;
          Parameters.ParamByName('Total_Pedido').Value := Registro.Total_Ped;
          Parameters.ParamByName('Observacoes').Value := Registro.Obs;
          ExecSQL;
        end;
      end;
    finally
      // DM.ADOConnection1.CommitTrans;
      qAux.close;
      FreeAndNil(qAux);
      lrControle := Altera;
      UGeral.Mensagem_Padrao(lrControle);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TRetorno_Cotacao.Excluir(var Registro: TRetorno_Cotacao);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Delete from Retorno_Cotacao_Preco where Codigo = :Codigo and N_Cotacao = :N_Cotacao');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        Parameters.ParamByName('N_Cotacao').Value := Registro.N_Cot;
        ExecSQL;
      end;
    finally
      // DM.ADOConnection1.CommitTrans;
      lrControle := Exclui;
      UGeral.Mensagem_Padrao(lrControle);
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

function TRetorno_Cotacao.GetCodigo: integer;
begin
  GetCodigo := StrToInt(FrmRetorno_Cotacao.EdtCodigo.Text);
end;

function TRetorno_Cotacao.GetCodigo_Condicao_Pagamento: integer;
begin
  GetCodigo_Condicao_Pagamento :=
    StrToInt(FrmRetorno_Cotacao.EdtCodigo_Condicao_Pagamento.Text);
end;

function TRetorno_Cotacao.GetCodigo_Empresa: integer;
begin
  GetCodigo_Empresa := UDeclaracao.Codigo_Empresa;
end;

function TRetorno_Cotacao.GetCodigo_Fornecedor: integer;
begin
  GetCodigo_Fornecedor :=
    StrToInt(FrmRetorno_Cotacao.EdtCodigo_Fornecedor.Text);
end;

function TRetorno_Cotacao.GetCodigo_Funcionario: integer;
begin
  GetCodigo_Funcionario :=
    StrToInt(FrmRetorno_Cotacao.EdtCodigo_Funcionario.Text);
end;

function TRetorno_Cotacao.GetData_Cotacao: Tdate;
begin
  GetData_Cotacao := StrToDateTime(FrmRetorno_Cotacao.MEdtData_Cotacao.Text);
end;

function TRetorno_Cotacao.GetData_Retorno: Tdate;
begin
  GetData_Retorno := StrToDateTime(FrmRetorno_Cotacao.MEdtData_Retorno.Text);
end;

function TRetorno_Cotacao.GetDesconto: double;
begin
  GetDesconto := StrToFloat(FrmRetorno_Cotacao.EdtDesconto.Text);
end;

function TRetorno_Cotacao.GetPrazo_Entrega: integer;
begin
  GetPrazo_Entrega := StrToInt(FrmRetorno_Cotacao.EdtPrazo_Entrega.Text);
end;

function TRetorno_Cotacao.GetN_Cotacao: integer;
begin
  GetN_Cotacao := StrToInt(FrmRetorno_Cotacao.EdtN_Cotacao.Text);
end;

function TRetorno_Cotacao.GetObservacoes: string;
begin
  GetObservacoes := FrmRetorno_Cotacao.MmoObservacao.Text;
end;

function TRetorno_Cotacao.GetOutras_Despesas: double;
begin
  GetOutras_Despesas := StrToFloat(FrmRetorno_Cotacao.EdtOutras_Despesas.Text);
end;

function TRetorno_Cotacao.GetPeso_Total: double;
begin
  GetPeso_Total := StrToFloat(FrmRetorno_Cotacao.EdtPeso_Total.Text);
end;

function TRetorno_Cotacao.GetQtde_Itens: integer;
begin
  GetQtde_Itens := StrToInt(FrmRetorno_Cotacao.EdtQuantidade_Itens.Text);
end;

function TRetorno_Cotacao.GetTipo_Desconto: string;
begin
  if (FrmRetorno_Cotacao.RGDesconto.ItemIndex = 0) then
    GetTipo_Desconto := '%'
  else
    GetTipo_Desconto := '$';
end;

function TRetorno_Cotacao.GetTipo_Frete: string;
begin
  if (FrmRetorno_Cotacao.RGTipo_Frete.ItemIndex = 0) then
    GetTipo_Frete := 'CIF'
  else if (FrmRetorno_Cotacao.RGTipo_Frete.ItemIndex = 1) then
    GetTipo_Frete := 'FOB'
  else if (FrmRetorno_Cotacao.RGTipo_Frete.ItemIndex = 2) then
    GetTipo_Frete := 'TERCEIROS'
  else if (FrmRetorno_Cotacao.RGTipo_Frete.ItemIndex = 3) then
    GetTipo_Frete := 'ISENTO';
end;

function TRetorno_Cotacao.GetTotal_Pedido: double;
begin
  GetTotal_Pedido := StrToFloat(FrmRetorno_Cotacao.EdtTotal_Pedido.Text);
end;

function TRetorno_Cotacao.GetTotal_Produtos: double;
begin
  GetTotal_Produtos := StrToFloat(FrmRetorno_Cotacao.EdtTotal_Produtos.Text);
end;

function TRetorno_Cotacao.GetValor_Frete: double;
begin
  GetValor_Frete := StrToFloat(FrmRetorno_Cotacao.EdtValor_Frete.Text);
end;

procedure TRetorno_Cotacao.Inserir(var Registro: TRetorno_Cotacao);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      begin
        with qAux, SQL do
        begin
          close;
          Connection := DM.ADOConnection1;
          clear;
          add('Insert into Retorno_Cotacao_Preco (Codigo, N_Cotacao, Data_Cotacao, Data_Retorno, Prazo_Entrega, Codigo_Fornecedor,');
          add('Codigo_Condicao_Pagamento, Codigo_Funcionario, Codigo_Empresa, Tipo_Frete, Valor_Frete, Outras_Despesas,');
          add('Qtde_Itens, Total_Produtos, Peso_Total, Desconto, Tipo_Desconto, Total_Pedido, ');
          add('Observacoes)');
          add('values (:Codigo, :N_Cotacao, :Data_Cotacao, :Data_Retorno, :Prazo_Entrega, :Codigo_Fornecedor,');
          add(':Codigo_Condicao_Pagamento, :Codigo_Funcionario, :Codigo_Empresa, :Tipo_Frete, :Valor_Frete, :Outras_Despesas,');
          add(':Qtde_Itens, :Total_Produtos, :Peso_Total, :Desconto, :Tipo_Desconto, :Total_Pedido, ');
          add(':Observacoes)');
          Parameters.ParamByName('Codigo').Value := Registro.Cod;
          Parameters.ParamByName('N_Cotacao').Value := Registro.N_Cot;
          Parameters.ParamByName('Data_Cotacao').Value := Registro.Data_Cot;
          Parameters.ParamByName('Data_Retorno').Value := Registro.Data_Ret;
          Parameters.ParamByName('Prazo_Entrega').Value := Registro.Pr_Entrega;
          Parameters.ParamByName('Codigo_Fornecedor').Value :=
            Registro.Cod_Forn;
          Parameters.ParamByName('Codigo_Condicao_Pagamento').Value :=
            Registro.Cod_Cond_Pag;
          Parameters.ParamByName('Codigo_Funcionario').Value :=
            Registro.Cod_Fun;
          Parameters.ParamByName('Codigo_Empresa').Value :=
            Registro.Cod_Empresa;
          Parameters.ParamByName('Tipo_Frete').Value := Registro.Tipo_Fre;
          Parameters.ParamByName('Valor_Frete').Value := Registro.Valor_Fre;
          Parameters.ParamByName('Outras_Despesas').Value :=
            Registro.Outras_Desp;
          Parameters.ParamByName('Qtde_Itens').Value := Registro.Qtde_It;
          Parameters.ParamByName('Total_Produtos').Value := Registro.Total_Prod;
          Parameters.ParamByName('Peso_Total').Value := Registro.Peso_Tot;
          Parameters.ParamByName('Desconto').Value := Registro.Desc;
          Parameters.ParamByName('Tipo_Desconto').Value := Registro.Tipo_Desc;
          Parameters.ParamByName('Total_Pedido').Value := Registro.Total_Ped;
          Parameters.ParamByName('Observacoes').Value := Registro.Obs;
          ExecSQL;
        end;
      end;
    finally
      // DM.ADOConnection1.CommitTrans;
      qAux.close;
      FreeAndNil(qAux);
      lrControle := Insere;
      UGeral.Mensagem_Padrao(lrControle);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TItens_Retorno_Cotacao }

procedure TItens_Retorno_Cotacao.Excluir(var Registro: TItens_Retorno_Cotacao);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Delete from Itens_Retorno_Cotacao_Preco where N_Cotacao = :N_Cotacao and Codigo = :Codigo');
        Parameters.ParamByName('N_Cotacao').Value := Registro.N_Cot;
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        ExecSQL;
      end;
    finally
      // DM.ADOConnection1.CommitTrans;
      // lrControle:= Exclui;
      // UGeral.Mensagem_Padrao(lrControle);
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TItens_Retorno_Cotacao.Excluir_Selecionado(var Registro
  : TItens_Retorno_Cotacao);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Delete from Itens_Retorno_Cotacao_Preco where N_Cotacao = :N_Cotacao and ');
        add('Codigo_Produto = :Produto and Codigo = :Codigo');
        Parameters.ParamByName('N_Cotacao').Value := Registro.N_Cot;
        Parameters.ParamByName('Produto').Value := Registro.Cod_Prod;
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        ExecSQL;
      end;
    finally
      // DM.ADOConnection1.CommitTrans;
      lrControle := Exclui;
      UGeral.Mensagem_Padrao(lrControle);
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

function TItens_Retorno_Cotacao.GetCodigo: integer;
begin
  GetCodigo := StrToInt(FrmRetorno_Cotacao.EdtCodigo.Text);
end;

function TItens_Retorno_Cotacao.GetCodigo_Produto: integer;
begin
  GetCodigo_Produto :=
    FrmRetorno_Cotacao.qryitens_retorno_cotacaoCodigo_Produto.AsInteger;
end;

function TItens_Retorno_Cotacao.GetDesconto: double;
begin
  // GetDesconto:= StrToFloat(FrmRetorno_Cotacao.EdtDesconto_Item.Text);
end;

function TItens_Retorno_Cotacao.GetN_Cotacao: integer;
begin
  GetN_Cotacao := StrToInt(FrmRetorno_Cotacao.EdtN_Cotacao.Text);
end;

function TItens_Retorno_Cotacao.GetQtde: double;
begin
  // GetQtde:= StrToFloat(FrmRetorno_Cotacao.EdtQuantidade.Text);
end;

function TItens_Retorno_Cotacao.GetSub_Total: double;
begin
  // GetSub_Total:= StrToFloat(FrmRetorno_Cotacao.EdtValor_Total.Text);
end;

function TItens_Retorno_Cotacao.GetTipo_Desconto: string;
begin

end;

function TItens_Retorno_Cotacao.GetValor_Unitario: double;
begin

end;

procedure TItens_Retorno_Cotacao.Inserir(var Registro: TItens_Retorno_Cotacao);
begin

end;

{ TFabricacao_Propria }

procedure TFabricacao_Propria.Alterar(var Registro: TFabricacao_Propria);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      begin
        with qAux, SQL do
        begin
          close;
          clear;
          Connection := DM.ADOConnection1;
          add('Update Fabricacao_Propria set Codigo_Empresa = :Codigo_Empresa, Data_Fabricacao = :Data_Fabricacao,');
          add('Data_Validade = :Data_Validade, Codigo_Produto = :Codigo_Produto, Qtde = :Qtde');
          add('where Codigo = :Codigo');
          Parameters.ParamByName('Codigo').Value := Registro.Cod;
          Parameters.ParamByName('Codigo_Empresa').Value :=
            Registro.Cod_Empresa;
          Parameters.ParamByName('Data_Fabricacao').Value := Registro.Data_Fab;
          Parameters.ParamByName('Data_Validade').Value := Registro.Data_Val;
          Parameters.ParamByName('Codigo_Produto').Value :=
            Registro.Cod_Produto;
          Parameters.ParamByName('Qtde').Value := Registro.Qtdee;
          ExecSQL;
        end;
      end;
    finally
      // DM.ADOConnection1.CommitTrans;
      qAux.close;
      FreeAndNil(qAux);
      lrControle := Altera;
      UGeral.Mensagem_Padrao(lrControle);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TFabricacao_Propria.Excluir(var Registro: TFabricacao_Propria);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Delete from Fabricacao_Propria where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        ExecSQL;
      end;
    finally
      // DM.ADOConnection1.CommitTrans;
      // lrControle:= Exclui;
      // UGeral.Mensagem_Padrao(lrControle);
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

function TFabricacao_Propria.GetCodigo: integer;
begin
  GetCodigo := StrToInt(FrmFabricacao_Propria.EdtCodigo.Text);
end;

function TFabricacao_Propria.GetCodigo_Empresa: integer;
begin
  GetCodigo_Empresa := UDeclaracao.Codigo_Empresa;
end;

function TFabricacao_Propria.GetCodigo_Produto: integer;
begin
  GetCodigo_Produto := StrToInt(FrmFabricacao_Propria.LblProd.Caption);
end;

function TFabricacao_Propria.GetData_Fabricacao: Tdate;
begin
  GetData_Fabricacao :=
    StrToDate(FrmFabricacao_Propria.MEdtData_Fabricacao.Text);
end;

function TFabricacao_Propria.GetData_Validade: Tdate;
begin
  GetData_Validade := StrToDate(FrmFabricacao_Propria.MEdtData_Validade.Text);
end;

function TFabricacao_Propria.GetQtde: double;
begin
  GetQtde := StrToFloat(FrmFabricacao_Propria.EdtQtde.Text);
end;

procedure TFabricacao_Propria.Inserir(var Registro: TFabricacao_Propria);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      begin
        with qAux, SQL do
        begin
          close;
          clear;
          Connection := DM.ADOConnection1;
          add('Insert into Fabricacao_Propria (Codigo, Codigo_Empresa, Data_Fabricacao, Data_Validade, Codigo_Produto, Qtde)');
          add('values (:Codigo, :Codigo_Empresa, :Data_Fabricacao, :Data_Validade, :Codigo_Produto, :Qtde)');
          Parameters.ParamByName('Codigo').Value := Registro.Cod;
          Parameters.ParamByName('Codigo_Empresa').Value :=
            Registro.Cod_Empresa;
          Parameters.ParamByName('Data_Fabricacao').Value := Registro.Data_Fab;
          Parameters.ParamByName('Data_Validade').Value := Registro.Data_Val;
          Parameters.ParamByName('Codigo_Produto').Value :=
            Registro.Cod_Produto;
          Parameters.ParamByName('Qtde').Value := Registro.Qtdee;
          ExecSQL;
        end;
      end;
    finally
      // DM.ADOConnection1.CommitTrans;
      qAux.close;
      FreeAndNil(qAux);
      lrControle := Insere;
      UGeral.Mensagem_Padrao(lrControle);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TItens_Fabricacao_Propria }

procedure TItens_Fabricacao_Propria.Alterar(var Registro
  : TItens_Fabricacao_Propria);
begin
  //
end;

procedure TItens_Fabricacao_Propria.Excluir(var Registro
  : TItens_Fabricacao_Propria);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Delete from Itens_Fabricacao_Propria where Codigo = :Codigo and Codigo_Insumo = :Produto');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        Parameters.ParamByName('Produto').Value := Registro.Cod_Insum_Sel;
        ExecSQL;
      end;
    finally
      // DM.ADOConnection1.CommitTrans;
      // lrControle:= Exclui;
      // UGeral.Mensagem_Padrao(lrControle);
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TItens_Fabricacao_Propria.Excluir_Tudo(var Registro
  : TItens_Fabricacao_Propria);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Delete from Itens_Fabricacao_Propria where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        ExecSQL;
      end;
    finally
      // DM.ADOConnection1.CommitTrans;
      // lrControle:= Exclui;
      // UGeral.Mensagem_Padrao(lrControle);
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

function TItens_Fabricacao_Propria.GetCodigo: integer;
begin
  GetCodigo := StrToInt(FrmFabricacao_Propria.EdtCodigo.Text);
end;

function TItens_Fabricacao_Propria.GetCodigo_Insumo: integer;
begin
  // GetCodigo_Insumo:= StrToInt(FrmFabricacao_Propria.LblInsumo.Caption);
end;

function TItens_Fabricacao_Propria.GetCodigo_Insumo_Selecionado: integer;
begin
  // GetCodigo_Insumo_Selecionado:= FrmFabricacao_Propria.qryitens_fabricacaoCodigo_Insumo.AsInteger;
end;

function TItens_Fabricacao_Propria.GetQtde: double;
begin
  // GetQtde:= StrToFloat(FrmFabricacao_Propria.EdtQuantidade.Text);
end;

function TItens_Fabricacao_Propria.GetUnidade: string;
begin
  // GetUnidade:= FrmFabricacao_Propria.EdtUnidade.Text;
end;

procedure TItens_Fabricacao_Propria.Inserir(var Registro
  : TItens_Fabricacao_Propria);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      begin
        with qAux, SQL do
        begin
          close;
          clear;
          Connection := DM.ADOConnection1;
          add('Insert into Itens_Fabricacao_Propria (Codigo, Codigo_Insumo, Unidade, Qtde)');
          add('values (:Codigo, :Codigo_Insumo, :Unidade, :Qtde)');
          Parameters.ParamByName('Codigo').Value := Registro.Cod;
          Parameters.ParamByName('Codigo_Insumo').Value := Registro.Cod_Insum;
          Parameters.ParamByName('Unidade').Value := Registro.Un;
          Parameters.ParamByName('Qtde').Value := Registro.Qtdee;
          ExecSQL;
        end;
      end;
    finally
      // DM.ADOConnection1.CommitTrans;
      qAux.close;
      FreeAndNil(qAux);
      lrControle := Insere;
      UGeral.Mensagem_Padrao(lrControle);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TReceita }

procedure TReceita.Alterar(var Registro: TReceita; var Conexao : TADOConnection);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      begin
        with qAux, SQL do
        begin
          close;
          clear;
          Connection := Conexao;
          add('Update Receita set Codigo_Empresa = :Codigo_Empresa, Codigo_Produto = :Codigo_Produto,');
          add('Data_Cadastro = :Data_Cadastro');
          add('where Codigo = :Codigo');
          Parameters.ParamByName('Codigo').Value := Registro.Cod;
          Parameters.ParamByName('Codigo_Empresa').Value :=
            Registro.Cod_Empresa;
          Parameters.ParamByName('Codigo_Produto').Value :=
            Registro.Cod_Produto;
          Parameters.ParamByName('Data_Cadastro').Value := Registro.Data_Cad;
          ExecSQL;
        end;
      end;
    finally
      // DM.ADOConnection1.CommitTrans;
      qAux.close;
      FreeAndNil(qAux);
      lrControle := Altera;
      UGeral.Mensagem_Padrao(lrControle);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TReceita.Excluir(var Registro: TReceita; var Conexao : TADOConnection);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := Conexao;
        add('Delete from Receita where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        ExecSQL;
      end;
    finally
      // DM.ADOConnection1.CommitTrans;
      lrControle := Exclui;
      UGeral.Mensagem_Padrao(lrControle);
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

function TReceita.GetCodigo: integer;
begin
  GetCodigo := StrToInt(FrmCadastro_Receita.EdtCodigo.Text);
end;

function TReceita.GetCodigo_Empresa: integer;
begin
  GetCodigo_Empresa := UDeclaracao.Codigo_Empresa;
end;

function TReceita.GetCodigo_Produto: integer;
begin
  GetCodigo_Produto := StrToInt(FrmCadastro_Receita.LblProd.Caption);
end;

function TReceita.GetData_Cadastro: Tdate;
begin
  GetData_Cadastro := StrToDateTime(FrmCadastro_Receita.MEdtData_Cadastro.Text);
end;


procedure TReceita.Inserir(var Registro: TReceita; var Conexao : TADOConnection);
var
  qAux: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      begin
        with qAux, SQL do
        begin
          close;
          clear;
          Connection := Conexao;
          add('Insert into Receita (Codigo, Codigo_Empresa, Codigo_Produto, Data_Cadastro)');
          add('values (:Codigo, :Codigo_Empresa, :Codigo_Produto, :Data_Cadastro)');
          Parameters.ParamByName('Codigo').Value := Registro.Cod;
          Parameters.ParamByName('Codigo_Empresa').Value :=
            Registro.Cod_Empresa;
          Parameters.ParamByName('Codigo_Produto').Value :=
            Registro.Cod_Produto;
          Parameters.ParamByName('Data_Cadastro').Value := Registro.Data_Cad;
          ExecSQL;
        end;
      end;
    finally
      // DM.ADOConnection1.CommitTrans;
      qAux.close;
      FreeAndNil(qAux);
      lrControle := Insere;
      UGeral.Mensagem_Padrao(lrControle);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TItens_Receita }

procedure TItens_Receita.Alterar(var Registro: TItens_Receita; var Conexao : TADOConnection);
begin
  //
end;

procedure TItens_Receita.Excluir(var Registro: TItens_Receita; var Conexao : TADOConnection);
var
  qAux: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        Connection := Conexao;
        clear;
        add('Delete from Itens_Receita where Codigo = :Codigo and Codigo_Insumo = :Produto');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        Parameters.ParamByName('Produto').Value := Registro.Cod_Insum_Sel;
        ExecSQL;
      end;
    finally
      // DM.ADOConnection1.CommitTrans;
      // lrControle:= Exclui;
      // UGeral.Mensagem_Padrao(lrControle);
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TItens_Receita.Excluir_Tudo(var Registro: TItens_Receita; var Conexao : TADOConnection);
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := Conexao;
        add('Delete from Itens_Receita where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value := Registro.Cod;
        ExecSQL;
      end;
    finally
      // DM.ADOConnection1.CommitTrans;
      // lrControle:= Exclui;
      // UGeral.Mensagem_Padrao(lrControle);
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

function TItens_Receita.GetCodigo: integer;
begin
  GetCodigo := StrToInt(FrmCadastro_Receita.EdtCodigo.Text);
end;

function TItens_Receita.GetCodigo_Insumo: integer;
begin
  GetCodigo_Insumo := StrToInt(FrmCadastro_Receita.LblInsumo.Caption);
end;

function TItens_Receita.GetCodigo_Insumo_Selecionado: integer;
begin
  GetCodigo_Insumo_Selecionado :=
    FrmCadastro_Receita.qryitens_receitaCodigo_Insumo.AsInteger;
end;

function TItens_Receita.GetQtde: double;
begin
  GetQtde := StrToFloat(FrmCadastro_Receita.EdtQuantidade.Text);
end;

function TItens_Receita.GetUnidade: string;
begin
  GetUnidade := FrmCadastro_Receita.EdtUnidade.Text;
end;

procedure TItens_Receita.Inserir(var Registro: TItens_Receita; var Conexao : TADOConnection);
var
  qAuxInserir: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAuxInserir := TADOQuery.Create(nil);
      begin
        with qAuxInserir, SQL do
        begin
          close;
          Connection := Conexao;
          clear;
          add('Insert into Itens_Receita (Codigo, Codigo_Insumo, Unidade, Qtde)');
          add('values (:Codigo, :Codigo_Insumo, :Unidade, :Qtde)');
          Parameters.ParamByName('Codigo').Value := Registro.Cod;
          Parameters.ParamByName('Codigo_Insumo').Value := Registro.Cod_Insum;
          Parameters.ParamByName('Unidade').Value := Registro.Un;
          Parameters.ParamByName('Qtde').Value := Registro.Qtdee;
          ExecSQL;
        end;
      end;
    finally
      // DM.ADOConnection1.CommitTrans;
      qAuxInserir.close;
      FreeAndNil(qAuxInserir);
      lrControle := Insere;
      UGeral.Mensagem_Padrao(lrControle);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TPerfil_Usuario }

procedure TPerfil_Usuario.Alterar;
var
  qAux, qaux2: TADOQuery;
  i: integer;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      begin
        with qAux, SQL do
        begin
          close;
          clear;
          Connection := DM.ADOConnection1;
          add('Update Perfil_Usuario set Perfil = :Perfil, Codigo_Empresa = :Codigo_Empresa, ');
          add('Adicao_Aliquota_Tributaria = :Adicao_Aliquota_Tributaria, Altera_Simbolo_Moeda = :Altera_Simbolo_Moeda, ');
          add('Horario_Verao = :Horario_Verao, Programa_Arredondamento = :Programa_Arredondamento, ');
          add('Programa_Truncamento = :Programa_Truncamento, Mapa_Resumo = :Mapa_Resumo,');

          add('Cadastro_Empresa = :Cadastro_Empresa, Cadastro_Produto = :Cadastro_Produto, ');
          add('Cadastro_Grupo_Produto = :Cadastro_Grupo_Produto, Cadastro_Unidade_Medida = :Cadastro_Unidade_Medida,');
          add('Cadastro_Localidade = :Cadastro_Localidade, Cadastro_Tabela_Preco = :Cadastro_Tabela_Preco, Alteracao_Produto = :Alteracao_Produto,');
          add('Cadastro_Receita = :Cadastro_Receita, Cadastro_Fornecedor = :Cadastro_Fornecedor,');
          add('Cadastro_Transportadora = :Cadastro_Transportadora, Cadastro_CFOP = :Cadastro_CFOP,');
          add('Cadastro_Situacao_Tributaria = :Cadastro_Situacao_Tributaria, Cadastro_Cliente = :Cadastro_Cliente,');
          add('Cadastro_Grupo_Cliente = :Cadastro_Grupo_Cliente, Cadastro_Funcionario = :Cadastro_Funcionario,');
          add('Cadastro_Cargo = :Cadastro_Cargo, Cadastro_Departamento = :Cadastro_Departamento,');
          add('Cadastro_Tipo_Documento = :Cadastro_Tipo_Documento, Cadastro_Plano_Financeiro = :Cadastro_Plano_Financeiro,');
          add('Cadastro_Banco = :Cadastro_Banco,');
          add('Cadastro_Conta_Corrente = :Cadastro_Conta_Corrente, Cadastro_Operacao_Bancaria = :Cadastro_Operacao_Bancaria,');
          add('Cadastro_Condicao_Pagamento = :Cadastro_Condicao_Pagamento, ');
          add('Cadastro_Itens_Folha_Pagamento = :Cadastro_Itens_Folha_Pagamento, Cadastro_Cidade = :Cadastro_Cidade,');
          add('Cadastro_Setor = :Cadastro_Setor, Cadastro_Logradouro = :Cadastro_Logradouro, ');
          add('Cadastro_Pais = :Cadastro_Pais, Cadastro_Veiculo = :Cadastro_Veiculo, Cadastro_Marca = :Cadastro_Marca, ');
          add('Cadastro_Etiqueta = :Cadastro_Etiqueta, Cadastro_Regra_ICMS = :Cadastro_Regra_ICMS, Cadastro_Tratamento_ICMS = :Cadastro_Tratamento_ICMS,');
          add('Cadastro_Observacao_Fiscal = :Cadastro_Observacao_Fiscal, ');
          add('Cadastro_Regra_PIS = :Cadastro_Regra_PIS, Cadastro_Tratamento_PIS = :Cadastro_Tratamento_PIS, ');
          add('Cadastro_Regra_COFINS = :Cadastro_Regra_COFINS, Cadastro_Tratamento_COFINS = :Cadastro_Tratamento_COFINS, ');
          add('Cadastro_Regra_IPI = :Cadastro_Regra_IPI, Cadastro_Tratamento_IPI = :Cadastro_Tratamento_IPI, ');
          add('Cadastro_NCM = :Cadastro_NCM,');
          add('Cadastro_Regra_ISSQN = :Cadastro_Regra_ISSQN, ');
          add('Cadastro_Perfil_Usuario = :Cadastro_Perfil_Usuario, ');

          add('Mov_Entrada_Produto = :Mov_Entrada_Produto, ');
          add('Mov_Pedido_Producao = :Mov_Pedido_Producao, Mov_Fechamento_Estoque = :Mov_Fechamento_Estoque,');
          add('Mov_Lancamento_Manual = :Mov_Lancamento_Manual, Mov_Cupom_Fiscal = :Mov_Cupom_Fiscal, ');
          add('Mov_Gerar_DAV = :Mov_Gerar_DAV, ');
          add('Mov_Reimpressao_DAV = :Mov_Reimpressao_DAV, ');

          add('Abertura_Caixa = :Abertura_Caixa, ');
          add('Acerto_Caixa = :Acerto_Caixa, Altera_Caixa = :Altera_Caixa, ');
          add('Suprimento = :Suprimento, Sangria = :Sangria, Recebimento = :Recebimento,');

          add('Lancamento_Financeiro = :Lancamento_Financeiro, Baixar_Titulo = :Baixar_Titulo,');
          add('Lancamento_Bancario = :Lancamento_Bancario, Conciliacao = :Conciliacao, Cheque = :Cheque, ');
          add('Baixar_Cheque = :Baixar_Cheque, Folha_Pagamento = :Folha_Pagamento,');

          add('Consulta_Posicao_Estoque = :Consulta_Posicao_Estoque, Consulta_Reposicao_Estoque = :Consulta_Reposicao_Estoque,');
          add('Consulta_Saldo_Estoque = :Consulta_Saldo_Estoque, Consulta_Tabela_Preco = :Consulta_Tabela_Preco,');
          add('Contagem_Estoque = :Contagem_Estoque, Consulta_Lucro_Produto = :Consulta_Lucro_Produto,');
          add('Consulta_Lucro_Grupo = :Consulta_Lucro_Grupo, Consulta_Lucro_Marca = :Consulta_Lucro_Marca, ');
          add('Consulta_Entrada = :Consulta_Entrada,');
          add('Consulta_Venda = :Consulta_Venda, Consulta_Ordem_Servico = :Consulta_Ordem_Servico, ');
          add('Consulta_Lancamento_Financeiro = :Consulta_Lancamento_Financeiro, Consulta_Conta_Fixa = :Consulta_Conta_Fixa,');
          add('Consulta_Folha_Pagamento = :Consulta_Folha_Pagamento, Consulta_Lancamento_Bancario = :Consulta_Lancamento_Bancario,');
          add('Consulta_Cheque = :Consulta_Cheque, Consulta_Saldo_Bancario = :Consulta_Saldo_Bancario,');
          add('Consulta_Acerto_Caixa = :Consulta_Acerto_Caixa, Consulta_Fechamento_Caixa = :Consulta_Fechamento_Caixa, ');

          add('Configuracao_Sistema = :Configuracao_Sistema, Historico = :Historico, Revalida_Sistema = :Revalida_Sistema,');
          add('Gera_Etiqueta_Cliente = :Gera_Etiqueta_Cliente, Gera_Etiqueta_Produto = :Gera_Etiqueta_Produto, Inventario_Estoque = :Inventario_Estoque,');
          add('Agenda_Telefonica = :Agenda_Telefonica, Consulta_Historico_Movimentacao = :Consulta_Historico_Movimentacao, Mov_NFe = :Mov_NFe, Cadastro_Status = :Cadastro_Status,');
          add('Cadastro_Tipo_Ocorrencia = :Cadastro_Tipo_Ocorrencia, Registro_Ocorrencia = :Registro_Ocorrencia, Consulta_Ocorrencia = :Consulta_Ocorrencia,');
          add('Cadastro_Tipo_Bem = :Cadastro_Tipo_Bem, Cadastro_Patrimonio = :Cadastro_Patrimonio, Consulta_Patrimonio = :Consulta_Patrimonio, Consulta_Ficha_Cliente = :Consulta_Ficha_Cliente,');
          add('Ocorrencia_Cobranca = :Ocorrencia_Cobranca');

          add('where Codigo = :Codigo');
          // parametros

          Parameters.ParamByName('Codigo').Value :=
            StrToInt(FrmCadastro_Perfil_Usuario.EdtCodigo.Text);
          Parameters.ParamByName('Perfil').Value :=
            FrmCadastro_Perfil_Usuario.EdtPerfil.Text;
          Parameters.ParamByName('Codigo_Empresa').Value :=
            UDeclaracao.Codigo_Empresa;

          // Menu
          // Funes ECF
          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Funes ECF').Item[0].StateIndex = 1 then
            Parameters.ParamByName('Adicao_Aliquota_Tributaria').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Funes ECF').Item[0].StateIndex = 2 then
            Parameters.ParamByName('Adicao_Aliquota_Tributaria').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Funes ECF').Item[1].StateIndex = 1 then
            Parameters.ParamByName('Altera_Simbolo_Moeda').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Funes ECF').Item[1].StateIndex = 2 then
            Parameters.ParamByName('Altera_Simbolo_Moeda').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Funes ECF').Item[2].StateIndex = 1 then
            Parameters.ParamByName('Horario_Verao').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Funes ECF').Item[2].StateIndex = 2 then
            Parameters.ParamByName('Horario_Verao').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Funes ECF').Item[3].StateIndex = 1 then
            Parameters.ParamByName('Programa_Arredondamento').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Funes ECF').Item[3].StateIndex = 2 then
            Parameters.ParamByName('Programa_Arredondamento').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Funes ECF').Item[4].StateIndex = 1 then
            Parameters.ParamByName('Programa_Truncamento').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Funes ECF').Item[4].StateIndex = 2 then
            Parameters.ParamByName('Programa_Truncamento').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Funes ECF').Item[5].StateIndex = 1 then
            Parameters.ParamByName('Mapa_Resumo').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Funes ECF').Item[5].StateIndex = 2 then
            Parameters.ParamByName('Mapa_Resumo').Value := 2;

          // Cadastros
          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Cadastros')
            .Item[0].StateIndex = 1 then
            Parameters.ParamByName('Cadastro_Empresa').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Cadastros').Item[0].StateIndex = 2 then
            Parameters.ParamByName('Cadastro_Empresa').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Cadastros')
            .Item[1].Item[0].StateIndex = 1 then
            Parameters.ParamByName('Cadastro_Produto').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Cadastros').Item[1].Item[0].StateIndex = 2 then
            Parameters.ParamByName('Cadastro_Produto').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Cadastros')
            .Item[1].Item[1].StateIndex = 1 then
            Parameters.ParamByName('Cadastro_Grupo_Produto').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Cadastros').Item[1].Item[1].StateIndex = 2 then
            Parameters.ParamByName('Cadastro_Grupo_Produto').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Cadastros')
            .Item[1].Item[2].StateIndex = 1 then
            Parameters.ParamByName('Cadastro_Unidade_Medida').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Cadastros').Item[1].Item[2].StateIndex = 2 then
            Parameters.ParamByName('Cadastro_Unidade_Medida').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Cadastros')
            .Item[1].Item[3].StateIndex = 1 then
            Parameters.ParamByName('Cadastro_Localidade').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Cadastros').Item[1].Item[3].StateIndex = 2 then
            Parameters.ParamByName('Cadastro_Localidade').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Cadastros')
            .Item[1].Item[4].StateIndex = 1 then
            Parameters.ParamByName('Cadastro_Tabela_Preco').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Cadastros').Item[1].Item[4].StateIndex = 2 then
            Parameters.ParamByName('Cadastro_Tabela_Preco').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Cadastros')
            .Item[1].Item[5].StateIndex = 1 then
            Parameters.ParamByName('Alteracao_Produto').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Cadastros').Item[1].Item[5].StateIndex = 2 then
            Parameters.ParamByName('Alteracao_Produto').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Cadastros')
            .Item[2].StateIndex = 1 then
            Parameters.ParamByName('Cadastro_Receita').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Cadastros').Item[2].StateIndex = 2 then
            Parameters.ParamByName('Cadastro_Receita').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Cadastros')
            .Item[3].StateIndex = 1 then
            Parameters.ParamByName('Cadastro_Fornecedor').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Cadastros').Item[3].StateIndex = 2 then
            Parameters.ParamByName('Cadastro_Fornecedor').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Cadastros')
            .Item[4].StateIndex = 1 then
            Parameters.ParamByName('Cadastro_Transportadora').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Cadastros').Item[4].StateIndex = 2 then
            Parameters.ParamByName('Cadastro_Transportadora').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Cadastros')
            .Item[5].StateIndex = 1 then
            Parameters.ParamByName('Cadastro_CFOP').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Cadastros').Item[5].StateIndex = 2 then
            Parameters.ParamByName('Cadastro_CFOP').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Cadastros')
            .Item[6].StateIndex = 1 then
            Parameters.ParamByName('Cadastro_Situacao_Tributaria').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Cadastros').Item[6].StateIndex = 2 then
            Parameters.ParamByName('Cadastro_Situacao_Tributaria').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Cadastros')
            .Item[7].Item[0].StateIndex = 1 then
            Parameters.ParamByName('Cadastro_Cliente').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Cadastros').Item[7].Item[0].StateIndex = 2 then
            Parameters.ParamByName('Cadastro_Cliente').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Cadastros')
            .Item[7].Item[1].StateIndex = 1 then
            Parameters.ParamByName('Cadastro_Grupo_Cliente').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Cadastros').Item[7].Item[1].StateIndex = 2 then
            Parameters.ParamByName('Cadastro_Grupo_Cliente').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Cadastros')
            .Item[8].Item[0].StateIndex = 1 then
            Parameters.ParamByName('Cadastro_Funcionario').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Cadastros').Item[8].Item[0].StateIndex = 2 then
            Parameters.ParamByName('Cadastro_Funcionario').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Cadastros')
            .Item[8].Item[1].StateIndex = 1 then
            Parameters.ParamByName('Cadastro_Cargo').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Cadastros').Item[8].Item[1].StateIndex = 2 then
            Parameters.ParamByName('Cadastro_Cargo').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Cadastros')
            .Item[8].Item[2].StateIndex = 1 then
            Parameters.ParamByName('Cadastro_Departamento').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Cadastros').Item[8].Item[2].StateIndex = 2 then
            Parameters.ParamByName('Cadastro_Departamento').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Cadastros')
            .Item[9].Item[0].StateIndex = 1 then
            Parameters.ParamByName('Cadastro_Tipo_Documento').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Cadastros').Item[9].Item[0].StateIndex = 2 then
            Parameters.ParamByName('Cadastro_Tipo_Documento').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Cadastros')
            .Item[9].Item[1].StateIndex = 1 then
            Parameters.ParamByName('Cadastro_Plano_Financeiro').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Cadastros').Item[9].Item[1].StateIndex = 2 then
            Parameters.ParamByName('Cadastro_Plano_Financeiro').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Cadastros')
            .Item[9].Item[2].StateIndex = 1 then
            Parameters.ParamByName('Cadastro_Banco').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Cadastros').Item[9].Item[2].StateIndex = 2 then
            Parameters.ParamByName('Cadastro_Banco').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Cadastros')
            .Item[9].Item[3].StateIndex = 1 then
            Parameters.ParamByName('Cadastro_Conta_Corrente').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Cadastros').Item[9].Item[3].StateIndex = 2 then
            Parameters.ParamByName('Cadastro_Conta_Corrente').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Cadastros')
            .Item[9].Item[4].StateIndex = 1 then
            Parameters.ParamByName('Cadastro_Operacao_Bancaria').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Cadastros').Item[9].Item[4].StateIndex = 2 then
            Parameters.ParamByName('Cadastro_Operacao_Bancaria').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Cadastros')
            .Item[9].Item[5].StateIndex = 1 then
            Parameters.ParamByName('Cadastro_Condicao_Pagamento').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Cadastros').Item[9].Item[5].StateIndex = 2 then
            Parameters.ParamByName('Cadastro_Condicao_Pagamento').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Cadastros')
            .Item[9].Item[6].StateIndex = 1 then
            Parameters.ParamByName('Cadastro_Itens_Folha_Pagamento').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Cadastros').Item[9].Item[6].StateIndex = 2 then
            Parameters.ParamByName('Cadastro_Itens_Folha_Pagamento').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Cadastros')
            .Item[10].Item[0].StateIndex = 1 then
            Parameters.ParamByName('Cadastro_Cidade').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Cadastros').Item[10].Item[0].StateIndex = 2 then
            Parameters.ParamByName('Cadastro_Cidade').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Cadastros')
            .Item[10].Item[1].StateIndex = 1 then
            Parameters.ParamByName('Cadastro_Setor').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Cadastros').Item[10].Item[1].StateIndex = 2 then
            Parameters.ParamByName('Cadastro_Setor').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Cadastros')
            .Item[10].Item[2].StateIndex = 1 then
            Parameters.ParamByName('Cadastro_Logradouro').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Cadastros').Item[10].Item[2].StateIndex = 2 then
            Parameters.ParamByName('Cadastro_Logradouro').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Cadastros')
            .Item[10].Item[3].StateIndex = 1 then
            Parameters.ParamByName('Cadastro_Pais').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Cadastros').Item[10].Item[3].StateIndex = 2 then
            Parameters.ParamByName('Cadastro_Pais').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Cadastros')
            .Item[10].Item[4].StateIndex = 1 then
            Parameters.ParamByName('Cadastro_Veiculo').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Cadastros').Item[10].Item[4].StateIndex = 2 then
            Parameters.ParamByName('Cadastro_Veiculo').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Cadastros')
            .Item[10].Item[5].StateIndex = 1 then
            Parameters.ParamByName('Cadastro_Marca').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Cadastros').Item[10].Item[5].StateIndex = 2 then
            Parameters.ParamByName('Cadastro_Marca').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Cadastros')
            .Item[10].Item[6].StateIndex = 1 then
            Parameters.ParamByName('Cadastro_Etiqueta').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Cadastros').Item[10].Item[6].StateIndex = 2 then
            Parameters.ParamByName('Cadastro_Etiqueta').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Cadastros')
            .Item[10].Item[7].StateIndex = 1 then
            Parameters.ParamByName('Cadastro_Status').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Cadastros').Item[10].Item[7].StateIndex = 2 then
            Parameters.ParamByName('Cadastro_Status').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Cadastros')
            .Item[10].Item[8].StateIndex = 1 then
            Parameters.ParamByName('Cadastro_Tipo_Ocorrencia').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Cadastros').Item[10].Item[8].StateIndex = 2 then
            Parameters.ParamByName('Cadastro_Tipo_Ocorrencia').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Cadastros')
            .Item[11].Item[0].StateIndex = 1 then
            Parameters.ParamByName('Cadastro_Regra_ICMS').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Cadastros').Item[11].Item[0].StateIndex = 2 then
            Parameters.ParamByName('Cadastro_Regra_ICMS').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Cadastros')
            .Item[11].Item[1].StateIndex = 1 then
            Parameters.ParamByName('Cadastro_Tratamento_ICMS').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Cadastros').Item[11].Item[1].StateIndex = 2 then
            Parameters.ParamByName('Cadastro_Tratamento_ICMS').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Cadastros')
            .Item[11].Item[2].StateIndex = 1 then
            Parameters.ParamByName('Cadastro_Observacao_Fiscal').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Cadastros').Item[11].Item[2].StateIndex = 2 then
            Parameters.ParamByName('Cadastro_Observacao_Fiscal').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Cadastros')
            .Item[12].Item[0].StateIndex = 1 then
            Parameters.ParamByName('Cadastro_Regra_PIS').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Cadastros').Item[12].Item[0].StateIndex = 2 then
            Parameters.ParamByName('Cadastro_Regra_PIS').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Cadastros')
            .Item[12].Item[1].StateIndex = 1 then
            Parameters.ParamByName('Cadastro_Tratamento_PIS').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Cadastros').Item[12].Item[1].StateIndex = 2 then
            Parameters.ParamByName('Cadastro_Tratamento_PIS').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Cadastros')
            .Item[13].Item[0].StateIndex = 1 then
            Parameters.ParamByName('Cadastro_Regra_COFINS').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Cadastros').Item[13].Item[0].StateIndex = 2 then
            Parameters.ParamByName('Cadastro_Regra_COFINS').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Cadastros')
            .Item[13].Item[1].StateIndex = 1 then
            Parameters.ParamByName('Cadastro_Tratamento_COFINS').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Cadastros').Item[13].Item[1].StateIndex = 2 then
            Parameters.ParamByName('Cadastro_Tratamento_COFINS').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Cadastros')
            .Item[14].Item[0].StateIndex = 1 then
            Parameters.ParamByName('Cadastro_Regra_IPI').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Cadastros').Item[14].Item[0].StateIndex = 2 then
            Parameters.ParamByName('Cadastro_Regra_IPI').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Cadastros')
            .Item[14].Item[1].StateIndex = 1 then
            Parameters.ParamByName('Cadastro_Tratamento_IPI').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Cadastros').Item[14].Item[1].StateIndex = 2 then
            Parameters.ParamByName('Cadastro_Tratamento_IPI').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Cadastros')
            .Item[14].Item[2].StateIndex = 1 then
            Parameters.ParamByName('Cadastro_NCM').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Cadastros').Item[14].Item[2].StateIndex = 2 then
            Parameters.ParamByName('Cadastro_NCM').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Cadastros')
            .Item[15].Item[0].StateIndex = 1 then
            Parameters.ParamByName('Cadastro_Regra_ISSQN').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Cadastros').Item[15].Item[0].StateIndex = 2 then
            Parameters.ParamByName('Cadastro_Regra_ISSQN').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Cadastros')
            .Item[16].StateIndex = 1 then
            Parameters.ParamByName('Cadastro_Perfil_Usuario').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Cadastros').Item[16].StateIndex = 2 then
            Parameters.ParamByName('Cadastro_Perfil_Usuario').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Cadastros')
            .Item[17].Item[0].StateIndex = 1 then
            Parameters.ParamByName('Cadastro_Tipo_Bem').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Cadastros').Item[17].Item[0].StateIndex = 2 then
            Parameters.ParamByName('Cadastro_Tipo_Bem').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Cadastros')
            .Item[17].Item[1].StateIndex = 1 then
            Parameters.ParamByName('Cadastro_Patrimonio').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Cadastros').Item[17].Item[1].StateIndex = 2 then
            Parameters.ParamByName('Cadastro_Patrimonio').Value := 2;


          // movimentao

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Movimentao').Item[0].StateIndex = 1 then
            Parameters.ParamByName('Mov_Entrada_Produto').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Movimentao').Item[0].StateIndex = 2 then
            Parameters.ParamByName('Mov_Entrada_Produto').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Movimentao').Item[1].StateIndex = 1 then
            Parameters.ParamByName('Mov_Pedido_Producao').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Movimentao').Item[1].StateIndex = 2 then
            Parameters.ParamByName('Mov_Pedido_Producao').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Movimentao').Item[2].StateIndex = 1 then
            Parameters.ParamByName('Mov_Fechamento_Estoque').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Movimentao').Item[2].StateIndex = 2 then
            Parameters.ParamByName('Mov_Fechamento_Estoque').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Movimentao').Item[3].StateIndex = 1 then
            Parameters.ParamByName('Mov_Lancamento_Manual').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Movimentao').Item[3].StateIndex = 2 then
            Parameters.ParamByName('Mov_Lancamento_Manual').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Movimentao').Item[4].StateIndex = 1 then
            Parameters.ParamByName('Mov_Cupom_Fiscal').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Movimentao').Item[4].StateIndex = 2 then
            Parameters.ParamByName('Mov_Cupom_Fiscal').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Movimentao').Item[5].StateIndex = 1 then
            Parameters.ParamByName('Mov_Gerar_DAV').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Movimentao').Item[5].StateIndex = 2 then
            Parameters.ParamByName('Mov_Gerar_DAV').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Movimentao').Item[6].StateIndex = 1 then
            Parameters.ParamByName('Mov_NFe').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Movimentao').Item[6].StateIndex = 2 then
            Parameters.ParamByName('Mov_NFe').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Movimentao').Item[7].StateIndex = 1 then
            Parameters.ParamByName('Mov_Reimpressao_DAV').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Movimentao').Item[7].StateIndex = 2 then
            Parameters.ParamByName('Mov_Reimpressao_DAV').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Movimentao').Item[8].StateIndex = 1 then
            Parameters.ParamByName('Registro_Ocorrencia').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Movimentao').Item[8].StateIndex = 2 then
            Parameters.ParamByName('Registro_Ocorrencia').Value := 2;

          // caixa
          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Caixa')
            .Item[0].StateIndex = 1 then
            Parameters.ParamByName('Abertura_Caixa').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Caixa')
            .Item[0].StateIndex = 2 then
            Parameters.ParamByName('Abertura_Caixa').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Caixa')
            .Item[1].StateIndex = 1 then
            Parameters.ParamByName('Acerto_Caixa').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Caixa')
            .Item[1].StateIndex = 2 then
            Parameters.ParamByName('Acerto_Caixa').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Caixa')
            .Item[2].StateIndex = 1 then
            Parameters.ParamByName('Altera_Caixa').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Caixa')
            .Item[2].StateIndex = 2 then
            Parameters.ParamByName('Altera_Caixa').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Caixa')
            .Item[3].StateIndex = 1 then
            Parameters.ParamByName('Suprimento').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Caixa')
            .Item[3].StateIndex = 2 then
            Parameters.ParamByName('Suprimento').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Caixa')
            .Item[4].StateIndex = 1 then
            Parameters.ParamByName('Sangria').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Caixa')
            .Item[4].StateIndex = 2 then
            Parameters.ParamByName('Sangria').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Caixa')
            .Item[5].StateIndex = 1 then
            Parameters.ParamByName('Recebimento').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Caixa')
            .Item[5].StateIndex = 2 then
            Parameters.ParamByName('Recebimento').Value := 2;



          // financeiro

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Financeiro')
            .Item[0].StateIndex = 1 then
            Parameters.ParamByName('Lancamento_Financeiro').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Financeiro').Item[0].StateIndex = 2 then
            Parameters.ParamByName('Lancamento_Financeiro').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Financeiro')
            .Item[1].StateIndex = 1 then
            Parameters.ParamByName('Baixar_Titulo').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Financeiro').Item[1].StateIndex = 2 then
            Parameters.ParamByName('Baixar_Titulo').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Financeiro')
            .Item[2].StateIndex = 1 then
            Parameters.ParamByName('Lancamento_Bancario').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Financeiro').Item[2].StateIndex = 2 then
            Parameters.ParamByName('Lancamento_Bancario').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Financeiro')
            .Item[3].StateIndex = 1 then
            Parameters.ParamByName('Conciliacao').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Financeiro').Item[3].StateIndex = 2 then
            Parameters.ParamByName('Conciliacao').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Financeiro')
            .Item[4].StateIndex = 1 then
            Parameters.ParamByName('Cheque').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Financeiro').Item[4].StateIndex = 2 then
            Parameters.ParamByName('Cheque').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Financeiro')
            .Item[5].StateIndex = 1 then
            Parameters.ParamByName('Baixar_Cheque').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Financeiro').Item[5].StateIndex = 2 then
            Parameters.ParamByName('Baixar_Cheque').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Financeiro')
            .Item[6].StateIndex = 1 then
            Parameters.ParamByName('Folha_Pagamento').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Financeiro').Item[6].StateIndex = 2 then
            Parameters.ParamByName('Folha_Pagamento').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Financeiro')
            .Item[7].StateIndex = 1 then
            Parameters.ParamByName('Ocorrencia_Cobranca').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Financeiro').Item[7].StateIndex = 2 then
            Parameters.ParamByName('Ocorrencia_Cobranca').Value := 2;

          // Consulta
          i := 0;
          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Relatrios')
            .Item[i].StateIndex = 1 then
            Parameters.ParamByName('Consulta_Posicao_Estoque').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Relatrios').Item[i].StateIndex = 2 then
            Parameters.ParamByName('Consulta_Posicao_Estoque').Value := 2;
          inc(i);
          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Relatrios')
            .Item[i].StateIndex = 1 then
            Parameters.ParamByName('Consulta_Reposicao_Estoque').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Relatrios').Item[i].StateIndex = 2 then
            Parameters.ParamByName('Consulta_Reposicao_Estoque').Value := 2;
          inc(i);
          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Relatrios')
            .Item[i].StateIndex = 1 then
            Parameters.ParamByName('Consulta_Saldo_Estoque').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Relatrios').Item[i].StateIndex = 2 then
            Parameters.ParamByName('Consulta_Saldo_Estoque').Value := 2;
          inc(i);
          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Relatrios')
            .Item[i].StateIndex = 1 then
            Parameters.ParamByName('Contagem_Estoque').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Relatrios').Item[i].StateIndex = 2 then
            Parameters.ParamByName('Contagem_Estoque').Value := 2;
          inc(i);
          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Relatrios')
            .Item[i].StateIndex = 1 then
            Parameters.ParamByName('Consulta_Historico_Movimentacao').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Relatrios').Item[i].StateIndex = 2 then
            Parameters.ParamByName('Consulta_Historico_Movimentacao')
              .Value := 2;
          inc(i);
          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Relatrios')
            .Item[i].StateIndex = 1 then
            Parameters.ParamByName('Consulta_Tabela_Preco').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Relatrios').Item[i].StateIndex = 2 then
            Parameters.ParamByName('Consulta_Tabela_Preco').Value := 2;
          inc(i);
          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Relatrios')
            .Item[i].StateIndex = 1 then
            Parameters.ParamByName('Consulta_Lucro_Produto').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Relatrios').Item[i].StateIndex = 2 then
            Parameters.ParamByName('Consulta_Lucro_Produto').Value := 2;
          inc(i);
          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Relatrios')
            .Item[i].StateIndex = 1 then
            Parameters.ParamByName('Consulta_Lucro_Grupo').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Relatrios').Item[i].StateIndex = 2 then
            Parameters.ParamByName('Consulta_Lucro_Grupo').Value := 2;
          inc(i);
          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Relatrios')
            .Item[i].StateIndex = 1 then
            Parameters.ParamByName('Consulta_Lucro_Marca').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Relatrios').Item[i].StateIndex = 2 then
            Parameters.ParamByName('Consulta_Lucro_Marca').Value := 2;
          inc(i);
          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Relatrios')
            .Item[i].StateIndex = 1 then
            Parameters.ParamByName('Consulta_Entrada').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Relatrios').Item[i].StateIndex = 2 then
            Parameters.ParamByName('Consulta_Entrada').Value := 2;
          inc(i);
          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Relatrios')
            .Item[i].StateIndex = 1 then
            Parameters.ParamByName('Consulta_Venda').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Relatrios').Item[i].StateIndex = 2 then
            Parameters.ParamByName('Consulta_Venda').Value := 2;
          inc(i);
          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Relatrios')
            .Item[i].StateIndex = 1 then
            Parameters.ParamByName('Consulta_Ordem_Servico').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Relatrios').Item[i].StateIndex = 2 then
            Parameters.ParamByName('Consulta_Ordem_Servico').Value := 2;
          inc(i);
          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Relatrios')
            .Item[i].StateIndex = 1 then
            Parameters.ParamByName('Consulta_Ocorrencia').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Relatrios').Item[i].StateIndex = 2 then
            Parameters.ParamByName('Consulta_Ocorrencia').Value := 2;
          inc(i);
          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Relatrios')
            .Item[i].StateIndex = 1 then
            Parameters.ParamByName('Consulta_Lancamento_Financeiro').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Relatrios').Item[i].StateIndex = 2 then
            Parameters.ParamByName('Consulta_Lancamento_Financeiro').Value := 2;
          inc(i);
          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Relatrios')
            .Item[i].StateIndex = 1 then
            Parameters.ParamByName('Consulta_Conta_Fixa').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Relatrios').Item[i].StateIndex = 2 then
            Parameters.ParamByName('Consulta_Conta_Fixa').Value := 2;
          inc(i);
          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Relatrios')
            .Item[i].StateIndex = 1 then
            Parameters.ParamByName('Consulta_Folha_Pagamento').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Relatrios').Item[i].StateIndex = 2 then
            Parameters.ParamByName('Consulta_Folha_Pagamento').Value := 2;
          inc(i);
          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Relatrios')
            .Item[i].StateIndex = 1 then
            Parameters.ParamByName('Consulta_Lancamento_Bancario').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Relatrios').Item[i].StateIndex = 2 then
            Parameters.ParamByName('Consulta_Lancamento_Bancario').Value := 2;
          inc(i);
          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Relatrios')
            .Item[i].StateIndex = 1 then
            Parameters.ParamByName('Consulta_Cheque').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Relatrios').Item[i].StateIndex = 2 then
            Parameters.ParamByName('Consulta_Cheque').Value := 2;
          inc(i);
          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Relatrios')
            .Item[i].StateIndex = 1 then
            Parameters.ParamByName('Consulta_Saldo_Bancario').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Relatrios').Item[i].StateIndex = 2 then
            Parameters.ParamByName('Consulta_Saldo_Bancario').Value := 2;
          inc(i);
          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Relatrios')
            .Item[i].StateIndex = 1 then
            Parameters.ParamByName('Consulta_Acerto_Caixa').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Relatrios').Item[i].StateIndex = 2 then
            Parameters.ParamByName('Consulta_Acerto_Caixa').Value := 2;
          inc(i);
          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Relatrios')
            .Item[i].StateIndex = 1 then
            Parameters.ParamByName('Consulta_Fechamento_Caixa').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Relatrios').Item[i].StateIndex = 2 then
            Parameters.ParamByName('Consulta_Fechamento_Caixa').Value := 2;
          inc(i);
          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Relatrios')
            .Item[i].StateIndex = 1 then
            Parameters.ParamByName('Consulta_Patrimonio').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Relatrios').Item[i].StateIndex = 2 then
            Parameters.ParamByName('Consulta_Patrimonio').Value := 2;
          inc(i);
          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Relatrios')
            .Item[i].StateIndex = 1 then
            Parameters.ParamByName('Consulta_Ficha_Cliente').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Relatrios').Item[i].StateIndex = 2 then
            Parameters.ParamByName('Consulta_Ficha_Cliente').Value := 2;

          // Ferramentas

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Ferramentas').Item[0].StateIndex = 1 then
            Parameters.ParamByName('Configuracao_Sistema').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Ferramentas').Item[0].StateIndex = 2 then
            Parameters.ParamByName('Configuracao_Sistema').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Ferramentas').Item[1].StateIndex = 1 then
            Parameters.ParamByName('Historico').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Ferramentas').Item[1].StateIndex = 2 then
            Parameters.ParamByName('Historico').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Ferramentas').Item[2].StateIndex = 1 then
            Parameters.ParamByName('Revalida_Sistema').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Ferramentas').Item[2].StateIndex = 2 then
            Parameters.ParamByName('Revalida_Sistema').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Ferramentas').Item[3].StateIndex = 1 then
            Parameters.ParamByName('Gera_Etiqueta_Cliente').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Ferramentas').Item[3].StateIndex = 2 then
            Parameters.ParamByName('Gera_Etiqueta_Cliente').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Ferramentas').Item[4].StateIndex = 1 then
            Parameters.ParamByName('Gera_Etiqueta_Produto').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Ferramentas').Item[4].StateIndex = 2 then
            Parameters.ParamByName('Gera_Etiqueta_Produto').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Ferramentas').Item[5].StateIndex = 1 then
            Parameters.ParamByName('Inventario_Estoque').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Ferramentas').Item[5].StateIndex = 2 then
            Parameters.ParamByName('Inventario_Estoque').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Ferramentas').Item[6].StateIndex = 1 then
            Parameters.ParamByName('Agenda_Telefonica').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Ferramentas').Item[6].StateIndex = 2 then
            Parameters.ParamByName('Agenda_Telefonica').Value := 2;

          ExecSQL;
        end;
      end;
    finally
      // DM.ADOConnection1.CommitTrans;
      qAux.close;
      FreeAndNil(qAux);
      lrControle := Altera;
      UGeral.Mensagem_Padrao(lrControle);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TPerfil_Usuario.Excluir;
var
  qAux, qaux2: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      qaux2 := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Delete from Perfil_Usuario where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value :=
          StrToInt(FrmCadastro_Perfil_Usuario.EdtCodigo.Text);
        ExecSQL;
      end;
    finally
      // DM.ADOConnection1.CommitTrans;
      lrControle := Exclui;
      UGeral.Mensagem_Padrao(lrControle);
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TPerfil_Usuario.Inserir;
var
  qAux, qaux2: TADOQuery;
  i: integer;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      begin
        with qAux, SQL do
        begin
          close;
          clear;
          Connection := DM.ADOConnection1;
          add('Insert into Perfil_Usuario (Codigo, Perfil, Codigo_Empresa, Adicao_Aliquota_Tributaria,');
          add('Altera_Simbolo_Moeda, Horario_Verao, Programa_Arredondamento, Programa_Truncamento, Mapa_Resumo,');

          add('Cadastro_Empresa, Cadastro_Produto, Cadastro_Grupo_Produto, Cadastro_Unidade_Medida,');
          add('Cadastro_Localidade, Cadastro_Tabela_Preco, Alteracao_Produto, Cadastro_Receita, Cadastro_Fornecedor,');
          add('Cadastro_Transportadora, Cadastro_CFOP, Cadastro_Situacao_Tributaria, Cadastro_Cliente,');
          add('Cadastro_Grupo_Cliente, Cadastro_Funcionario, Cadastro_Cargo, Cadastro_Departamento,');
          add('Cadastro_Tipo_Documento, Cadastro_Plano_Financeiro, Cadastro_Banco,');
          add('Cadastro_Conta_Corrente, Cadastro_Operacao_Bancaria, Cadastro_Condicao_Pagamento,');
          add('Cadastro_Itens_Folha_Pagamento, Cadastro_Cidade, Cadastro_Setor,');
          add('Cadastro_Logradouro, Cadastro_Pais, Cadastro_Veiculo, Cadastro_Marca, Cadastro_Etiqueta, Cadastro_Regra_ICMS,');
          add('Cadastro_Tratamento_ICMS, Cadastro_Observacao_Fiscal, ');
          add('Cadastro_Regra_PIS, Cadastro_Tratamento_PIS, ');
          add('Cadastro_Regra_COFINS, Cadastro_Tratamento_COFINS, ');
          add('Cadastro_Regra_IPI, Cadastro_Tratamento_IPI, Cadastro_NCM,');
          add('Cadastro_Regra_ISSQN, Cadastro_Perfil_Usuario, ');

          add(' Mov_Entrada_Produto, Mov_Pedido_Producao, Mov_Fechamento_Estoque,');
          add('Mov_Lancamento_Manual, Mov_Cupom_Fiscal, Mov_Gerar_DAV, ');
          add('Mov_Reimpressao_DAV, ');

          add('Abertura_Caixa, Acerto_Caixa, Altera_Caixa, ');

          add('Suprimento, Sangria, Recebimento,');
          add('Lancamento_Financeiro, Baixar_Titulo, Lancamento_Bancario, Conciliacao, Cheque, Baixar_Cheque,');
          add('Folha_Pagamento,');

          add('Consulta_Posicao_Estoque,');
          add('Consulta_Reposicao_Estoque, Consulta_Saldo_Estoque,');
          add('Contagem_Estoque,Consulta_Tabela_Preco,');
          add('Consulta_Lucro_Produto, Consulta_Lucro_Grupo, Consulta_Lucro_Marca,');
          add('Consulta_Entrada,');
          add('Consulta_Venda, Consulta_Ordem_Servico, Consulta_Lancamento_Financeiro, Consulta_Conta_Fixa,');
          add('Consulta_Folha_Pagamento, Consulta_Lancamento_Bancario, Consulta_Cheque, Consulta_Saldo_Bancario,');
          add('Consulta_Acerto_Caixa, Consulta_Fechamento_Caixa,');

          add('Configuracao_Sistema, Historico, Revalida_Sistema, Gera_Etiqueta_Cliente, Gera_Etiqueta_Produto, Inventario_Estoque,');
          add('Agenda_Telefonica, Consulta_Historico_Movimentacao, Mov_NFe, Cadastro_Status, Cadastro_Tipo_Ocorrencia,');
          add('Registro_Ocorrencia, Consulta_Ocorrencia, Cadastro_Tipo_Bem, Cadastro_Patrimonio, Consulta_Patrimonio, Consulta_Ficha_Cliente, Ocorrencia_Cobranca) values');

          // parametros

          add('(:Codigo, :Perfil, :Codigo_Empresa, :Adicao_Aliquota_Tributaria,');
          add(':Altera_Simbolo_Moeda, :Horario_Verao, :Programa_Arredondamento, :Programa_Truncamento, :Mapa_Resumo,');

          add(':Cadastro_Empresa, :Cadastro_Produto, :Cadastro_Grupo_Produto, :Cadastro_Unidade_Medida,');
          add(':Cadastro_Localidade, :Cadastro_Tabela_Preco, :Alteracao_Produto, :Cadastro_Receita, :Cadastro_Fornecedor,');
          add(':Cadastro_Transportadora, :Cadastro_CFOP, :Cadastro_Situacao_Tributaria, :Cadastro_Cliente,');
          add(':Cadastro_Grupo_Cliente, :Cadastro_Funcionario, :Cadastro_Cargo, :Cadastro_Departamento,');
          add(':Cadastro_Tipo_Documento, :Cadastro_Plano_Financeiro, :Cadastro_Banco,');
          add(':Cadastro_Conta_Corrente, :Cadastro_Operacao_Bancaria, :Cadastro_Condicao_Pagamento,');
          add(':Cadastro_Itens_Folha_Pagamento, :Cadastro_Cidade, :Cadastro_Setor,');
          add(':Cadastro_Logradouro, :Cadastro_Pais, :Cadastro_Veiculo, :Cadastro_Marca, :Cadastro_Etiqueta, :Cadastro_Regra_ICMS,');
          add(':Cadastro_Tratamento_ICMS, :Cadastro_Observacao_Fiscal,');
          add(':Cadastro_Regra_PIS, :Cadastro_Tratamento_PIS, ');
          add(':Cadastro_Regra_COFINS, :Cadastro_Tratamento_COFINS, ');
          add(':Cadastro_Regra_IPI, :Cadastro_Tratamento_IPI, :Cadastro_NCM,');
          add(':Cadastro_Regra_ISSQN, :Cadastro_Perfil_Usuario, ');

          add(':Mov_Entrada_Produto, :Mov_Pedido_Producao, :Mov_Fechamento_Estoque,');
          add(':Mov_Lancamento_Manual, :Mov_Cupom_Fiscal, :Mov_Gerar_DAV, ');
          add(':Mov_Reimpressao_DAV, ');

          add(':Abertura_Caixa, :Acerto_Caixa, :Altera_Caixa, ');

          add(':Suprimento, :Sangria, :Recebimento,');
          add(':Lancamento_Financeiro, :Baixar_Titulo, :Lancamento_Bancario, :Conciliacao, :Cheque, :Baixar_Cheque,');
          add(':Folha_Pagamento,');

          add(':Consulta_Posicao_Estoque,');
          add(':Consulta_Reposicao_Estoque, :Consulta_Saldo_Estoque,');
          add(':Contagem_Estoque, :Consulta_Tabela_Preco,');
          add(':Consulta_Lucro_Produto, :Consulta_Lucro_Grupo, :Consulta_Lucro_Marca,');
          add(':Consulta_Entrada,');
          add(':Consulta_Venda, :Consulta_Ordem_Servico, :Consulta_Lancamento_Financeiro, :Consulta_Conta_Fixa,');
          add(':Consulta_Folha_Pagamento, :Consulta_Lancamento_Bancario, :Consulta_Cheque, :Consulta_Saldo_Bancario,');
          add(':Consulta_Acerto_Caixa, :Consulta_Fechamento_Caixa,');

          add(':Configuracao_Sistema, :Historico, :Revalida_Sistema, :Gera_Etiqueta_Cliente, :Gera_Etiqueta_Produto, :Inventario_Estoque,');
          add(':Agenda_Telefonica, :Consulta_Historico_Movimentacao, :Mov_NFe, :Cadastro_Status, :Cadastro_Tipo_Ocorrencia,');
          add(':Registro_Ocorrencia, :Consulta_Ocorrencia, :Cadastro_Tipo_Bem, :Cadastro_Patrimonio, :Consulta_Patrimonio, :Consulta_Ficha_Cliente, :Ocorrencia_Cobranca)');

          Parameters.ParamByName('Codigo').Value :=
            StrToInt(FrmCadastro_Perfil_Usuario.EdtCodigo.Text);
          Parameters.ParamByName('Perfil').Value :=
            FrmCadastro_Perfil_Usuario.EdtPerfil.Text;
          Parameters.ParamByName('Codigo_Empresa').Value :=
            UDeclaracao.Codigo_Empresa;

          // Menu
          // Funes ECF
          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Funes ECF').Item[0].StateIndex = 1 then
            Parameters.ParamByName('Adicao_Aliquota_Tributaria').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Funes ECF').Item[0].StateIndex = 2 then
            Parameters.ParamByName('Adicao_Aliquota_Tributaria').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Funes ECF').Item[1].StateIndex = 1 then
            Parameters.ParamByName('Altera_Simbolo_Moeda').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Funes ECF').Item[1].StateIndex = 2 then
            Parameters.ParamByName('Altera_Simbolo_Moeda').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Funes ECF').Item[2].StateIndex = 1 then
            Parameters.ParamByName('Horario_Verao').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Funes ECF').Item[2].StateIndex = 2 then
            Parameters.ParamByName('Horario_Verao').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Funes ECF').Item[3].StateIndex = 1 then
            Parameters.ParamByName('Programa_Arredondamento').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Funes ECF').Item[3].StateIndex = 2 then
            Parameters.ParamByName('Programa_Arredondamento').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Funes ECF').Item[4].StateIndex = 1 then
            Parameters.ParamByName('Programa_Truncamento').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Funes ECF').Item[4].StateIndex = 2 then
            Parameters.ParamByName('Programa_Truncamento').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Funes ECF').Item[5].StateIndex = 1 then
            Parameters.ParamByName('Mapa_Resumo').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Funes ECF').Item[5].StateIndex = 2 then
            Parameters.ParamByName('Mapa_Resumo').Value := 2;

          // Cadastros
          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Cadastros')
            .Item[0].StateIndex = 1 then
            Parameters.ParamByName('Cadastro_Empresa').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Cadastros').Item[0].StateIndex = 2 then
            Parameters.ParamByName('Cadastro_Empresa').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Cadastros')
            .Item[1].Item[0].StateIndex = 1 then
            Parameters.ParamByName('Cadastro_Produto').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Cadastros').Item[1].Item[0].StateIndex = 2 then
            Parameters.ParamByName('Cadastro_Produto').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Cadastros')
            .Item[1].Item[1].StateIndex = 1 then
            Parameters.ParamByName('Cadastro_Grupo_Produto').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Cadastros').Item[1].Item[1].StateIndex = 2 then
            Parameters.ParamByName('Cadastro_Grupo_Produto').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Cadastros')
            .Item[1].Item[2].StateIndex = 1 then
            Parameters.ParamByName('Cadastro_Unidade_Medida').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Cadastros').Item[1].Item[2].StateIndex = 2 then
            Parameters.ParamByName('Cadastro_Unidade_Medida').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Cadastros')
            .Item[1].Item[3].StateIndex = 1 then
            Parameters.ParamByName('Cadastro_Localidade').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Cadastros').Item[1].Item[3].StateIndex = 2 then
            Parameters.ParamByName('Cadastro_Localidade').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Cadastros')
            .Item[1].Item[4].StateIndex = 1 then
            Parameters.ParamByName('Cadastro_Tabela_Preco').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Cadastros').Item[1].Item[4].StateIndex = 2 then
            Parameters.ParamByName('Cadastro_Tabela_Preco').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Cadastros')
            .Item[1].Item[5].StateIndex = 1 then
            Parameters.ParamByName('Alteracao_Produto').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Cadastros').Item[1].Item[5].StateIndex = 2 then
            Parameters.ParamByName('Alteracao_Produto').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Cadastros')
            .Item[2].StateIndex = 1 then
            Parameters.ParamByName('Cadastro_Receita').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Cadastros').Item[2].StateIndex = 2 then
            Parameters.ParamByName('Cadastro_Receita').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Cadastros')
            .Item[3].StateIndex = 1 then
            Parameters.ParamByName('Cadastro_Fornecedor').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Cadastros').Item[3].StateIndex = 2 then
            Parameters.ParamByName('Cadastro_Fornecedor').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Cadastros')
            .Item[4].StateIndex = 1 then
            Parameters.ParamByName('Cadastro_Transportadora').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Cadastros').Item[4].StateIndex = 2 then
            Parameters.ParamByName('Cadastro_Transportadora').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Cadastros')
            .Item[5].StateIndex = 1 then
            Parameters.ParamByName('Cadastro_CFOP').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Cadastros').Item[5].StateIndex = 2 then
            Parameters.ParamByName('Cadastro_CFOP').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Cadastros')
            .Item[6].StateIndex = 1 then
            Parameters.ParamByName('Cadastro_Situacao_Tributaria').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Cadastros').Item[6].StateIndex = 2 then
            Parameters.ParamByName('Cadastro_Situacao_Tributaria').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Cadastros')
            .Item[7].Item[0].StateIndex = 1 then
            Parameters.ParamByName('Cadastro_Cliente').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Cadastros').Item[7].Item[0].StateIndex = 2 then
            Parameters.ParamByName('Cadastro_Cliente').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Cadastros')
            .Item[7].Item[1].StateIndex = 1 then
            Parameters.ParamByName('Cadastro_Grupo_Cliente').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Cadastros').Item[7].Item[1].StateIndex = 2 then
            Parameters.ParamByName('Cadastro_Grupo_Cliente').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Cadastros')
            .Item[8].Item[0].StateIndex = 1 then
            Parameters.ParamByName('Cadastro_Funcionario').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Cadastros').Item[8].Item[0].StateIndex = 2 then
            Parameters.ParamByName('Cadastro_Funcionario').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Cadastros')
            .Item[8].Item[1].StateIndex = 1 then
            Parameters.ParamByName('Cadastro_Cargo').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Cadastros').Item[8].Item[1].StateIndex = 2 then
            Parameters.ParamByName('Cadastro_Cargo').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Cadastros')
            .Item[8].Item[2].StateIndex = 1 then
            Parameters.ParamByName('Cadastro_Departamento').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Cadastros').Item[8].Item[2].StateIndex = 2 then
            Parameters.ParamByName('Cadastro_Departamento').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Cadastros')
            .Item[9].Item[0].StateIndex = 1 then
            Parameters.ParamByName('Cadastro_Tipo_Documento').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Cadastros').Item[9].Item[0].StateIndex = 2 then
            Parameters.ParamByName('Cadastro_Tipo_Documento').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Cadastros')
            .Item[9].Item[1].StateIndex = 1 then
            Parameters.ParamByName('Cadastro_Plano_Financeiro').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Cadastros').Item[9].Item[1].StateIndex = 2 then
            Parameters.ParamByName('Cadastro_Plano_Financeiro').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Cadastros')
            .Item[9].Item[2].StateIndex = 1 then
            Parameters.ParamByName('Cadastro_Banco').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Cadastros').Item[9].Item[2].StateIndex = 2 then
            Parameters.ParamByName('Cadastro_Banco').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Cadastros')
            .Item[9].Item[3].StateIndex = 1 then
            Parameters.ParamByName('Cadastro_Conta_Corrente').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Cadastros').Item[9].Item[3].StateIndex = 2 then
            Parameters.ParamByName('Cadastro_Conta_Corrente').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Cadastros')
            .Item[9].Item[4].StateIndex = 1 then
            Parameters.ParamByName('Cadastro_Operacao_Bancaria').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Cadastros').Item[9].Item[4].StateIndex = 2 then
            Parameters.ParamByName('Cadastro_Operacao_Bancaria').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Cadastros')
            .Item[9].Item[5].StateIndex = 1 then
            Parameters.ParamByName('Cadastro_Condicao_Pagamento').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Cadastros').Item[9].Item[5].StateIndex = 2 then
            Parameters.ParamByName('Cadastro_Condicao_Pagamento').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Cadastros')
            .Item[9].Item[6].StateIndex = 1 then
            Parameters.ParamByName('Cadastro_Itens_Folha_Pagamento').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Cadastros').Item[9].Item[6].StateIndex = 2 then
            Parameters.ParamByName('Cadastro_Itens_Folha_Pagamento').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Cadastros')
            .Item[10].Item[0].StateIndex = 1 then
            Parameters.ParamByName('Cadastro_Cidade').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Cadastros').Item[10].Item[0].StateIndex = 2 then
            Parameters.ParamByName('Cadastro_Cidade').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Cadastros')
            .Item[10].Item[1].StateIndex = 1 then
            Parameters.ParamByName('Cadastro_Setor').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Cadastros').Item[10].Item[1].StateIndex = 2 then
            Parameters.ParamByName('Cadastro_Setor').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Cadastros')
            .Item[10].Item[2].StateIndex = 1 then
            Parameters.ParamByName('Cadastro_Logradouro').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Cadastros').Item[10].Item[2].StateIndex = 2 then
            Parameters.ParamByName('Cadastro_Logradouro').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Cadastros')
            .Item[10].Item[3].StateIndex = 1 then
            Parameters.ParamByName('Cadastro_Pais').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Cadastros').Item[10].Item[3].StateIndex = 2 then
            Parameters.ParamByName('Cadastro_Pais').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Cadastros')
            .Item[10].Item[4].StateIndex = 1 then
            Parameters.ParamByName('Cadastro_Veiculo').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Cadastros').Item[10].Item[4].StateIndex = 2 then
            Parameters.ParamByName('Cadastro_Veiculo').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Cadastros')
            .Item[10].Item[5].StateIndex = 1 then
            Parameters.ParamByName('Cadastro_Marca').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Cadastros').Item[10].Item[5].StateIndex = 2 then
            Parameters.ParamByName('Cadastro_Marca').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Cadastros')
            .Item[10].Item[6].StateIndex = 1 then
            Parameters.ParamByName('Cadastro_Etiqueta').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Cadastros').Item[10].Item[6].StateIndex = 2 then
            Parameters.ParamByName('Cadastro_Etiqueta').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Cadastros')
            .Item[10].Item[7].StateIndex = 1 then
            Parameters.ParamByName('Cadastro_Status').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Cadastros').Item[10].Item[7].StateIndex = 2 then
            Parameters.ParamByName('Cadastro_Status').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Cadastros')
            .Item[10].Item[8].StateIndex = 1 then
            Parameters.ParamByName('Cadastro_Tipo_Ocorrencia').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Cadastros').Item[10].Item[8].StateIndex = 2 then
            Parameters.ParamByName('Cadastro_Tipo_Ocorrencia').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Cadastros')
            .Item[11].Item[0].StateIndex = 1 then
            Parameters.ParamByName('Cadastro_Regra_ICMS').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Cadastros').Item[11].Item[0].StateIndex = 2 then
            Parameters.ParamByName('Cadastro_Regra_ICMS').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Cadastros')
            .Item[11].Item[1].StateIndex = 1 then
            Parameters.ParamByName('Cadastro_Tratamento_ICMS').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Cadastros').Item[11].Item[1].StateIndex = 2 then
            Parameters.ParamByName('Cadastro_Tratamento_ICMS').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Cadastros')
            .Item[11].Item[2].StateIndex = 1 then
            Parameters.ParamByName('Cadastro_Observacao_Fiscal').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Cadastros').Item[11].Item[2].StateIndex = 2 then
            Parameters.ParamByName('Cadastro_Observacao_Fiscal').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Cadastros')
            .Item[12].Item[0].StateIndex = 1 then
            Parameters.ParamByName('Cadastro_Regra_PIS').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Cadastros').Item[12].Item[0].StateIndex = 2 then
            Parameters.ParamByName('Cadastro_Regra_PIS').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Cadastros')
            .Item[12].Item[1].StateIndex = 1 then
            Parameters.ParamByName('Cadastro_Tratamento_PIS').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Cadastros').Item[12].Item[1].StateIndex = 2 then
            Parameters.ParamByName('Cadastro_Tratamento_PIS').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Cadastros')
            .Item[13].Item[0].StateIndex = 1 then
            Parameters.ParamByName('Cadastro_Regra_COFINS').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Cadastros').Item[13].Item[0].StateIndex = 2 then
            Parameters.ParamByName('Cadastro_Regra_COFINS').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Cadastros')
            .Item[13].Item[1].StateIndex = 1 then
            Parameters.ParamByName('Cadastro_Tratamento_COFINS').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Cadastros').Item[13].Item[1].StateIndex = 2 then
            Parameters.ParamByName('Cadastro_Tratamento_COFINS').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Cadastros')
            .Item[14].Item[0].StateIndex = 1 then
            Parameters.ParamByName('Cadastro_Regra_IPI').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Cadastros').Item[14].Item[0].StateIndex = 2 then
            Parameters.ParamByName('Cadastro_Regra_IPI').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Cadastros')
            .Item[14].Item[1].StateIndex = 1 then
            Parameters.ParamByName('Cadastro_Tratamento_IPI').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Cadastros').Item[14].Item[1].StateIndex = 2 then
            Parameters.ParamByName('Cadastro_Tratamento_IPI').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Cadastros')
            .Item[14].Item[2].StateIndex = 1 then
            Parameters.ParamByName('Cadastro_NCM').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Cadastros').Item[14].Item[2].StateIndex = 2 then
            Parameters.ParamByName('Cadastro_NCM').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Cadastros')
            .Item[15].Item[0].StateIndex = 1 then
            Parameters.ParamByName('Cadastro_Regra_ISSQN').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Cadastros').Item[15].Item[0].StateIndex = 2 then
            Parameters.ParamByName('Cadastro_Regra_ISSQN').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Cadastros')
            .Item[16].StateIndex = 1 then
            Parameters.ParamByName('Cadastro_Perfil_Usuario').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Cadastros').Item[16].StateIndex = 2 then
            Parameters.ParamByName('Cadastro_Perfil_Usuario').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Cadastros')
            .Item[17].Item[0].StateIndex = 1 then
            Parameters.ParamByName('Cadastro_Tipo_Bem').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Cadastros').Item[17].Item[0].StateIndex = 2 then
            Parameters.ParamByName('Cadastro_Tipo_Bem').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Cadastros')
            .Item[17].Item[1].StateIndex = 1 then
            Parameters.ParamByName('Cadastro_Patrimonio').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Cadastros').Item[17].Item[1].StateIndex = 2 then
            Parameters.ParamByName('Cadastro_Patrimonio').Value := 2;


          // movimentao

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Movimentao').Item[0].StateIndex = 1 then
            Parameters.ParamByName('Mov_Entrada_Produto').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Movimentao').Item[0].StateIndex = 2 then
            Parameters.ParamByName('Mov_Entrada_Produto').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Movimentao').Item[1].StateIndex = 1 then
            Parameters.ParamByName('Mov_Pedido_Producao').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Movimentao').Item[1].StateIndex = 2 then
            Parameters.ParamByName('Mov_Pedido_Producao').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Movimentao').Item[2].StateIndex = 1 then
            Parameters.ParamByName('Mov_Fechamento_Estoque').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Movimentao').Item[2].StateIndex = 2 then
            Parameters.ParamByName('Mov_Fechamento_Estoque').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Movimentao').Item[3].StateIndex = 1 then
            Parameters.ParamByName('Mov_Lancamento_Manual').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Movimentao').Item[3].StateIndex = 2 then
            Parameters.ParamByName('Mov_Lancamento_Manual').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Movimentao').Item[4].StateIndex = 1 then
            Parameters.ParamByName('Mov_Cupom_Fiscal').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Movimentao').Item[4].StateIndex = 2 then
            Parameters.ParamByName('Mov_Cupom_Fiscal').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Movimentao').Item[5].StateIndex = 1 then
            Parameters.ParamByName('Mov_Gerar_DAV').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Movimentao').Item[5].StateIndex = 2 then
            Parameters.ParamByName('Mov_Gerar_DAV').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Movimentao').Item[6].StateIndex = 1 then
            Parameters.ParamByName('Mov_NFe').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Movimentao').Item[6].StateIndex = 2 then
            Parameters.ParamByName('Mov_NFe').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Movimentao').Item[7].StateIndex = 1 then
            Parameters.ParamByName('Mov_Reimpressao_DAV').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Movimentao').Item[7].StateIndex = 2 then
            Parameters.ParamByName('Mov_Reimpressao_DAV').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Movimentao').Item[8].StateIndex = 1 then
            Parameters.ParamByName('Registro_Ocorrencia').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Movimentao').Item[8].StateIndex = 2 then
            Parameters.ParamByName('Registro_Ocorrencia').Value := 2;

          // caixa
          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Caixa')
            .Item[0].StateIndex = 1 then
            Parameters.ParamByName('Abertura_Caixa').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Caixa')
            .Item[0].StateIndex = 2 then
            Parameters.ParamByName('Abertura_Caixa').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Caixa')
            .Item[1].StateIndex = 1 then
            Parameters.ParamByName('Acerto_Caixa').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Caixa')
            .Item[1].StateIndex = 2 then
            Parameters.ParamByName('Acerto_Caixa').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Caixa')
            .Item[2].StateIndex = 1 then
            Parameters.ParamByName('Altera_Caixa').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Caixa')
            .Item[2].StateIndex = 2 then
            Parameters.ParamByName('Altera_Caixa').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Caixa')
            .Item[3].StateIndex = 1 then
            Parameters.ParamByName('Suprimento').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Caixa')
            .Item[3].StateIndex = 2 then
            Parameters.ParamByName('Suprimento').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Caixa')
            .Item[4].StateIndex = 1 then
            Parameters.ParamByName('Sangria').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Caixa')
            .Item[4].StateIndex = 2 then
            Parameters.ParamByName('Sangria').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Caixa')
            .Item[5].StateIndex = 1 then
            Parameters.ParamByName('Recebimento').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Caixa')
            .Item[5].StateIndex = 2 then
            Parameters.ParamByName('Recebimento').Value := 2;



          // financeiro

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Financeiro')
            .Item[0].StateIndex = 1 then
            Parameters.ParamByName('Lancamento_Financeiro').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Financeiro').Item[0].StateIndex = 2 then
            Parameters.ParamByName('Lancamento_Financeiro').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Financeiro')
            .Item[1].StateIndex = 1 then
            Parameters.ParamByName('Baixar_Titulo').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Financeiro').Item[1].StateIndex = 2 then
            Parameters.ParamByName('Baixar_Titulo').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Financeiro')
            .Item[2].StateIndex = 1 then
            Parameters.ParamByName('Lancamento_Bancario').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Financeiro').Item[2].StateIndex = 2 then
            Parameters.ParamByName('Lancamento_Bancario').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Financeiro')
            .Item[3].StateIndex = 1 then
            Parameters.ParamByName('Conciliacao').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Financeiro').Item[3].StateIndex = 2 then
            Parameters.ParamByName('Conciliacao').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Financeiro')
            .Item[4].StateIndex = 1 then
            Parameters.ParamByName('Cheque').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Financeiro').Item[4].StateIndex = 2 then
            Parameters.ParamByName('Cheque').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Financeiro')
            .Item[5].StateIndex = 1 then
            Parameters.ParamByName('Baixar_Cheque').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Financeiro').Item[5].StateIndex = 2 then
            Parameters.ParamByName('Baixar_Cheque').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Financeiro')
            .Item[6].StateIndex = 1 then
            Parameters.ParamByName('Folha_Pagamento').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Financeiro').Item[6].StateIndex = 2 then
            Parameters.ParamByName('Folha_Pagamento').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Financeiro')
            .Item[7].StateIndex = 1 then
            Parameters.ParamByName('Ocorrencia_Cobranca').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Financeiro').Item[7].StateIndex = 2 then
            Parameters.ParamByName('Ocorrencia_Cobranca').Value := 2;

          // Consulta
          i := 0;
          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Relatrios')
            .Item[i].StateIndex = 1 then
            Parameters.ParamByName('Consulta_Posicao_Estoque').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Relatrios').Item[i].StateIndex = 2 then
            Parameters.ParamByName('Consulta_Posicao_Estoque').Value := 2;
          inc(i);
          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Relatrios')
            .Item[i].StateIndex = 1 then
            Parameters.ParamByName('Consulta_Reposicao_Estoque').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Relatrios').Item[i].StateIndex = 2 then
            Parameters.ParamByName('Consulta_Reposicao_Estoque').Value := 2;
          inc(i);
          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Relatrios')
            .Item[i].StateIndex = 1 then
            Parameters.ParamByName('Consulta_Saldo_Estoque').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Relatrios').Item[i].StateIndex = 2 then
            Parameters.ParamByName('Consulta_Saldo_Estoque').Value := 2;
          inc(i);
          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Relatrios')
            .Item[i].StateIndex = 1 then
            Parameters.ParamByName('Contagem_Estoque').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Relatrios').Item[i].StateIndex = 2 then
            Parameters.ParamByName('Contagem_Estoque').Value := 2;
          inc(i);
          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Relatrios')
            .Item[i].StateIndex = 1 then
            Parameters.ParamByName('Consulta_Historico_Movimentacao').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Relatrios').Item[i].StateIndex = 2 then
            Parameters.ParamByName('Consulta_Historico_Movimentacao')
              .Value := 2;
          inc(i);
          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Relatrios')
            .Item[i].StateIndex = 1 then
            Parameters.ParamByName('Consulta_Tabela_Preco').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Relatrios').Item[i].StateIndex = 2 then
            Parameters.ParamByName('Consulta_Tabela_Preco').Value := 2;
          inc(i);
          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Relatrios')
            .Item[i].StateIndex = 1 then
            Parameters.ParamByName('Consulta_Lucro_Produto').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Relatrios').Item[i].StateIndex = 2 then
            Parameters.ParamByName('Consulta_Lucro_Produto').Value := 2;
          inc(i);
          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Relatrios')
            .Item[i].StateIndex = 1 then
            Parameters.ParamByName('Consulta_Lucro_Grupo').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Relatrios').Item[i].StateIndex = 2 then
            Parameters.ParamByName('Consulta_Lucro_Grupo').Value := 2;
          inc(i);
          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Relatrios')
            .Item[i].StateIndex = 1 then
            Parameters.ParamByName('Consulta_Lucro_Marca').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Relatrios').Item[i].StateIndex = 2 then
            Parameters.ParamByName('Consulta_Lucro_Marca').Value := 2;
          inc(i);
          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Relatrios')
            .Item[i].StateIndex = 1 then
            Parameters.ParamByName('Consulta_Entrada').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Relatrios').Item[i].StateIndex = 2 then
            Parameters.ParamByName('Consulta_Entrada').Value := 2;
          inc(i);
          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Relatrios')
            .Item[i].StateIndex = 1 then
            Parameters.ParamByName('Consulta_Venda').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Relatrios').Item[i].StateIndex = 2 then
            Parameters.ParamByName('Consulta_Venda').Value := 2;
          inc(i);
          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Relatrios')
            .Item[i].StateIndex = 1 then
            Parameters.ParamByName('Consulta_Ordem_Servico').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Relatrios').Item[i].StateIndex = 2 then
            Parameters.ParamByName('Consulta_Ordem_Servico').Value := 2;
          inc(i);
          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Relatrios')
            .Item[i].StateIndex = 1 then
            Parameters.ParamByName('Consulta_Ocorrencia').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Relatrios').Item[i].StateIndex = 2 then
            Parameters.ParamByName('Consulta_Ocorrencia').Value := 2;
          inc(i);
          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Relatrios')
            .Item[i].StateIndex = 1 then
            Parameters.ParamByName('Consulta_Lancamento_Financeiro').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Relatrios').Item[i].StateIndex = 2 then
            Parameters.ParamByName('Consulta_Lancamento_Financeiro').Value := 2;
          inc(i);
          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Relatrios')
            .Item[i].StateIndex = 1 then
            Parameters.ParamByName('Consulta_Conta_Fixa').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Relatrios').Item[i].StateIndex = 2 then
            Parameters.ParamByName('Consulta_Conta_Fixa').Value := 2;
          inc(i);
          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Relatrios')
            .Item[i].StateIndex = 1 then
            Parameters.ParamByName('Consulta_Folha_Pagamento').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Relatrios').Item[i].StateIndex = 2 then
            Parameters.ParamByName('Consulta_Folha_Pagamento').Value := 2;
          inc(i);
          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Relatrios')
            .Item[i].StateIndex = 1 then
            Parameters.ParamByName('Consulta_Lancamento_Bancario').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Relatrios').Item[i].StateIndex = 2 then
            Parameters.ParamByName('Consulta_Lancamento_Bancario').Value := 2;
          inc(i);
          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Relatrios')
            .Item[i].StateIndex = 1 then
            Parameters.ParamByName('Consulta_Cheque').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Relatrios').Item[i].StateIndex = 2 then
            Parameters.ParamByName('Consulta_Cheque').Value := 2;
          inc(i);
          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Relatrios')
            .Item[i].StateIndex = 1 then
            Parameters.ParamByName('Consulta_Saldo_Bancario').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Relatrios').Item[i].StateIndex = 2 then
            Parameters.ParamByName('Consulta_Saldo_Bancario').Value := 2;
          inc(i);
          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Relatrios')
            .Item[i].StateIndex = 1 then
            Parameters.ParamByName('Consulta_Acerto_Caixa').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Relatrios').Item[i].StateIndex = 2 then
            Parameters.ParamByName('Consulta_Acerto_Caixa').Value := 2;
          inc(i);
          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Relatrios')
            .Item[i].StateIndex = 1 then
            Parameters.ParamByName('Consulta_Fechamento_Caixa').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Relatrios').Item[i].StateIndex = 2 then
            Parameters.ParamByName('Consulta_Fechamento_Caixa').Value := 2;
          inc(i);
          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Relatrios')
            .Item[i].StateIndex = 1 then
            Parameters.ParamByName('Consulta_Patrimonio').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Relatrios').Item[i].StateIndex = 2 then
            Parameters.ParamByName('Consulta_Patrimonio').Value := 2;
          inc(i);
          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1, 'Relatrios')
            .Item[i].StateIndex = 1 then
            Parameters.ParamByName('Consulta_Ficha_Cliente').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Relatrios').Item[i].StateIndex = 2 then
            Parameters.ParamByName('Consulta_Ficha_Cliente').Value := 2;

          // Ferramentas

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Ferramentas').Item[0].StateIndex = 1 then
            Parameters.ParamByName('Configuracao_Sistema').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Ferramentas').Item[0].StateIndex = 2 then
            Parameters.ParamByName('Configuracao_Sistema').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Ferramentas').Item[1].StateIndex = 1 then
            Parameters.ParamByName('Historico').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Ferramentas').Item[1].StateIndex = 2 then
            Parameters.ParamByName('Historico').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Ferramentas').Item[2].StateIndex = 1 then
            Parameters.ParamByName('Revalida_Sistema').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Ferramentas').Item[2].StateIndex = 2 then
            Parameters.ParamByName('Revalida_Sistema').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Ferramentas').Item[3].StateIndex = 1 then
            Parameters.ParamByName('Gera_Etiqueta_Cliente').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Ferramentas').Item[3].StateIndex = 2 then
            Parameters.ParamByName('Gera_Etiqueta_Cliente').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Ferramentas').Item[4].StateIndex = 1 then
            Parameters.ParamByName('Gera_Etiqueta_Produto').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Ferramentas').Item[4].StateIndex = 2 then
            Parameters.ParamByName('Gera_Etiqueta_Produto').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Ferramentas').Item[5].StateIndex = 1 then
            Parameters.ParamByName('Inventario_Estoque').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Ferramentas').Item[5].StateIndex = 2 then
            Parameters.ParamByName('Inventario_Estoque').Value := 2;

          if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Ferramentas').Item[6].StateIndex = 1 then
            Parameters.ParamByName('Agenda_Telefonica').Value := 1
          else if obterMenuNivel1(FrmCadastro_Perfil_Usuario.TreeView1,
            'Ferramentas').Item[6].StateIndex = 2 then
            Parameters.ParamByName('Agenda_Telefonica').Value := 2;

          ExecSQL;
        end;
      end;
    finally
      // DM.ADOConnection1.CommitTrans;
      qAux.close;
      FreeAndNil(qAux);
      lrControle := Insere;
      UGeral.Mensagem_Padrao(lrControle);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TAcerto_Caixa }

procedure TAcerto_Caixa.Alterar(var Registro: TAcerto_Caixa);
begin
  //
end;

procedure TAcerto_Caixa.Excluir(var Registro: TAcerto_Caixa);
begin
  //
end;

function TAcerto_Caixa.GetAcerto: double;
begin
  GetAcerto := StrToFloat(FrmAcerto_Caixa.EdtAcerto.Text);
end;

function TAcerto_Caixa.GetCodigo_Caixa: integer;
begin
  GetCodigo_Caixa := UDeclaracao.Codigo_Caixa;
end;

function TAcerto_Caixa.GetCodigo_Usuario: integer;
begin
  GetCodigo_Usuario := UDeclaracao.codigo_usu;
end;

function TAcerto_Caixa.GetData_Abertura: TDateTime;
begin
  GetData_Abertura := FrmAcerto_Caixa.qryaberturaData_Abertura.AsDateTime;
end;

function TAcerto_Caixa.GetData_Fechamento: TDateTime;
begin
  GetData_Fechamento := date;
end;

function TAcerto_Caixa.GetEntrada: double;
begin
  GetEntrada := StrToFloat(FrmAcerto_Caixa.EdtEntrada.Text);
end;

function TAcerto_Caixa.GetFechamento: double;
begin
  GetFechamento := StrToFloat(FrmAcerto_Caixa.EdtFechamento.Text);
end;

function TAcerto_Caixa.GetSaida: double;
begin
  GetSaida := StrToFloat(FrmAcerto_Caixa.EdtSaida.Text);
end;

function TAcerto_Caixa.GetSaldo: double;
begin
  GetSaldo := StrToFloat(FrmAcerto_Caixa.EdtSaldo.Text);
end;

function TAcerto_Caixa.GetValor_Abertura: double;
begin
  GetValor_Abertura := FrmAcerto_Caixa.qryaberturaValor.AsFloat;
end;

procedure TAcerto_Caixa.Inserir(var Registro: TAcerto_Caixa);
var
  qAux: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        Connection := DM.ADOConnection1;
        clear;
        add('Insert into Acerto_Caixa ( Data_Abertura, Data_Fechamento, Codigo_Caixa, Codigo_Usuario, Valor_Abertura,');
        add('Entrada, Saida, Saldo, Acerto, Fechamento)');
        add('values ');
        add('(:Data_Abertura, :Data_Fechamento, :Codigo_Caixa, :Codigo_Usuario, :Valor_Abertura,');
        add(':Entrada, :Saida, :Saldo, :Acerto, :Fechamento)');

        Parameters.ParamByName('Data_Abertura').Value := Registro.Data_Ab;
        Parameters.ParamByName('Data_Fechamento').Value := Registro.Data_Fec;
        Parameters.ParamByName('Codigo_Caixa').Value := Registro.Cod_Caixa;
        Parameters.ParamByName('Codigo_Usuario').Value := Registro.Cod_Usuario;
        Parameters.ParamByName('Valor_Abertura').Value := Registro.Valor_Ab;
        Parameters.ParamByName('Entrada').Value := Registro.Ent;
        Parameters.ParamByName('Saida').Value := Registro.Sai;
        Parameters.ParamByName('Saldo').Value := Registro.Sal;
        Parameters.ParamByName('Acerto').Value := Registro.Acer;
        Parameters.ParamByName('Fechamento').Value := Registro.Fec;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TTransporte_Entrada }

procedure TTransporte_Entrada.Alterar;
var
  qAux: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        Connection := DM.ADOConnection1;
        clear;
        add('update Transporte_Entrada set');
        add('   N_Nota_Fiscal = :N_Nota_Fiscal');
        add('   ,Codigo_Transportadora = :Codigo_Transportadora');
        add('   ,Codigo_Veiculo = :Codigo_Veiculo');
        add('   ,Quantidade = :Quantidade');
        add('   ,Especie = :Especie');
        add('   ,Marca = :Marca');
        add('   ,Numero = :Numero');
        add('   ,Peso_Bruto = :Peso_Bruto');
        add('   ,Peso_Liquido = :Peso_Liquido');
        add('where Codigo = :Codigo');

        Parameters.ParamByName('Codigo').Value :=
          FrmEntrada_Produtos.EdtCodigo.Text;
        Parameters.ParamByName('N_Nota_Fiscal').Value :=
          FrmEntrada_Produtos.EdtN_Nota_Fiscal.Text;

        if (FrmEntrada_Produtos.EdtCodigo_Transportadora.Text = '') then
          Parameters.ParamByName('Codigo_Transportadora').Value := 0
        else
          Parameters.ParamByName('Codigo_Transportadora').Value :=
            StrToInt(FrmEntrada_Produtos.EdtCodigo_Transportadora.Text);

        if (FrmEntrada_Produtos.EdtCodigo_Veiculo.Text = '') then
          Parameters.ParamByName('Codigo_Veiculo').Value := 0
        else
          Parameters.ParamByName('Codigo_Veiculo').Value :=
            StrToInt(FrmEntrada_Produtos.EdtCodigo_Veiculo.Text);

        Parameters.ParamByName('Quantidade').Value :=
          StrToFloat(FrmEntrada_Produtos.EdtQuantidade_Transportada.Text);
        Parameters.ParamByName('Especie').Value :=
          FrmEntrada_Produtos.EdtEspecie.Text;
        Parameters.ParamByName('Marca').Value :=
          FrmEntrada_Produtos.EdtMarca.Text;
        Parameters.ParamByName('Numero').Value :=
          FrmEntrada_Produtos.EdtNumero_Transportado.Text;
        Parameters.ParamByName('Peso_Bruto').Value :=
          StrToFloat(FrmEntrada_Produtos.EdtPeso_Bruto.Text);
        Parameters.ParamByName('Peso_Liquido').Value :=
          StrToFloat(FrmEntrada_Produtos.EdtPeso_Liquido.Text);
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        // lrControle := Insere;
        // UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TTransporte_Entrada.Excluir;
var
  qAux: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        Connection := DM.ADOConnection1;
        clear;
        add('Delete from Transporte_Entrada');
        add('where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value :=
          FrmEntrada_Produtos.EdtCodigo.Text;
        // DM.ADOConnection1.CommitTrans;
        ExecSQL;
        // lrControle := Insere;
        // UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TTransporte_Entrada.Inserir;
var
  qAux: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        Connection := DM.ADOConnection1;
        clear;
        add('INSERT INTO Transporte_Entrada');
        add('   (Codigo');
        add('   ,N_Nota_Fiscal');
        add('   ,Codigo_Transportadora');
        add('   ,Codigo_Veiculo');
        add('   ,Quantidade');
        add('   ,Especie');
        add('   ,Marca');
        add('   ,Numero');
        add('   ,Peso_Bruto');
        add('   ,Peso_Liquido)');
        add('VALUES');
        add('   (:Codigo');
        add('   ,:N_Nota_Fiscal');
        add('   ,:Codigo_Transportadora');
        add('   ,:Codigo_Veiculo');
        add('   ,:Quantidade');
        add('   ,:Especie');
        add('   ,:Marca');
        add('   ,:Numero');
        add('   ,:Peso_Bruto');
        add('   ,:Peso_Liquido)');

        Parameters.ParamByName('Codigo').Value :=
          StrToInt(FrmEntrada_Produtos.EdtCodigo.Text);
        Parameters.ParamByName('N_Nota_Fiscal').Value :=
          FrmEntrada_Produtos.EdtN_Nota_Fiscal.Text;

        if (FrmEntrada_Produtos.EdtCodigo_Transportadora.Text = '') then
          Parameters.ParamByName('Codigo_Transportadora').Value := 0
        else
          Parameters.ParamByName('Codigo_Transportadora').Value :=
            StrToInt(FrmEntrada_Produtos.EdtCodigo_Transportadora.Text);

        if (FrmEntrada_Produtos.EdtCodigo_Veiculo.Text = '') then
          Parameters.ParamByName('Codigo_Veiculo').Value := 0
        else
          Parameters.ParamByName('Codigo_Veiculo').Value :=
            StrToInt(FrmEntrada_Produtos.EdtCodigo_Veiculo.Text);

        Parameters.ParamByName('Quantidade').Value :=
          StrToFloat(FrmEntrada_Produtos.EdtQuantidade_Transportada.Text);
        Parameters.ParamByName('Especie').Value :=
          FrmEntrada_Produtos.EdtEspecie.Text;
        Parameters.ParamByName('Marca').Value :=
          FrmEntrada_Produtos.EdtMarca.Text;
        Parameters.ParamByName('Numero').Value :=
          FrmEntrada_Produtos.EdtNumero_Transportado.Text;
        Parameters.ParamByName('Peso_Bruto').Value :=
          StrToFloat(FrmEntrada_Produtos.EdtPeso_Bruto.Text);
        Parameters.ParamByName('Peso_Liquido').Value :=
          StrToFloat(FrmEntrada_Produtos.EdtPeso_Liquido.Text);
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        // lrControle := Insere;
        // UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TTransporte_Entrada.Inserir_Copia;
var
  qAux: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        Connection := DM.ADOConnection1;
        clear;
        add('INSERT INTO Transporte_Entrada');
        add('   (Codigo');
        add('   ,N_Nota_Fiscal');
        add('   ,Codigo_Transportadora');
        add('   ,Codigo_Veiculo');
        add('   ,Quantidade');
        add('   ,Especie');
        add('   ,Marca');
        add('   ,Numero');
        add('   ,Peso_Bruto');
        add('   ,Peso_Liquido)');
        add('VALUES');
        add('   (:Codigo');
        add('   ,:N_Nota_Fiscal');
        add('   ,:Codigo_Transportadora');
        add('   ,:Codigo_Veiculo');
        add('   ,:Quantidade');
        add('   ,:Especie');
        add('   ,:Marca');
        add('   ,:Numero');
        add('   ,:Peso_Bruto');
        add('   ,:Peso_Liquido)');

        Parameters.ParamByName('Codigo').Value :=
          StrToInt(FrmEntrada_Produtos.EdtCodigo.Text);
        Parameters.ParamByName('N_Nota_Fiscal').Value :=
          FrmInforma_NNF.EdtNota_Destino.Text;

        if (FrmEntrada_Produtos.EdtCodigo_Transportadora.Text = '') then
          Parameters.ParamByName('Codigo_Transportadora').Value := 0
        else
          Parameters.ParamByName('Codigo_Transportadora').Value :=
            StrToInt(FrmEntrada_Produtos.EdtCodigo_Transportadora.Text);

        if (FrmEntrada_Produtos.EdtCodigo_Veiculo.Text = '') then
          Parameters.ParamByName('Codigo_Veiculo').Value := 0
        else
          Parameters.ParamByName('Codigo_Veiculo').Value :=
            StrToInt(FrmEntrada_Produtos.EdtCodigo_Veiculo.Text);

        Parameters.ParamByName('Quantidade').Value :=
          StrToFloat(FrmEntrada_Produtos.EdtQuantidade_Transportada.Text);
        Parameters.ParamByName('Especie').Value :=
          FrmEntrada_Produtos.EdtEspecie.Text;
        Parameters.ParamByName('Marca').Value :=
          FrmEntrada_Produtos.EdtMarca.Text;
        Parameters.ParamByName('Numero').Value :=
          FrmEntrada_Produtos.EdtNumero_Transportado.Text;
        Parameters.ParamByName('Peso_Bruto').Value :=
          StrToFloat(FrmEntrada_Produtos.EdtPeso_Bruto.Text);
        Parameters.ParamByName('Peso_Liquido').Value :=
          StrToFloat(FrmEntrada_Produtos.EdtPeso_Liquido.Text);
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        // lrControle := Insere;
        // UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TDados_Adicionais_Cliente }

procedure TDados_Adicionais_Cliente.Excluir(var Registro
  : TDados_Adicionais_Cliente; var Conexao: TADOConnection);
var
  qAux: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        Connection := Conexao;
        clear;
        add('Delete from Dados_Adicionais_Cliente');
        add('where Codigo_Registro = :Codigo_Registro');
        Parameters.ParamByName('Codigo_Registro').Value :=
          FrmCadastro_Cliente.qrydados_adicionaisCodigo_Registro.AsInteger;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        // lrControle := Exclui;
        // UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TDados_Adicionais_Cliente.Excluir_Tudo(var Registro
  : TDados_Adicionais_Cliente; var Conexao: TADOConnection);
var
  qAux: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        Connection := Conexao;
        clear;
        add('Delete from Dados_Adicionais_Cliente');
        add('where Codigo_Cliente = :Codigo_Cliente');
        Parameters.ParamByName('Codigo_Cliente').Value := Cod_Cliente;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

function TDados_Adicionais_Cliente.GetCodigo_Cliente: integer;
begin
  GetCodigo_Cliente := StrToInt(FrmCadastro_Cliente.EdtCodigo.Text);
end;

function TDados_Adicionais_Cliente.GetCodigo_Cliente_Selecionado: integer;
begin
  // GetCodigo_Cliente_Selecionado :=FrmCadastro_Cliente.ADOQuery3Codigo_Cliente.AsInteger;
end;

function TDados_Adicionais_Cliente.GetEmpresa: string;
begin
  GetEmpresa := FrmCadastro_Cliente.EdtEmpresa.Text;
end;

function TDados_Adicionais_Cliente.GetEmpresa_Selecionado: string;
begin
  // GetEmpresa_Selecionado := FrmCadastro_Cliente.ADOQuery3Empresa.AsString;
end;

function TDados_Adicionais_Cliente.GetInscricao: string;
begin
  GetInscricao := FrmCadastro_Cliente.EdtInscricao_Empresa.Text;
end;

function TDados_Adicionais_Cliente.GetInscricao_Selecionado: string;
begin
  // GetInscricao_Selecionado := FrmCadastro_Cliente.ADOQuery3Inscricao.AsString;
end;

procedure TDados_Adicionais_Cliente.Inserir(var Registro
  : TDados_Adicionais_Cliente; var Conexao: TADOConnection);
var
  qAux: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        Connection := Conexao;
        clear;
        add('INSERT INTO Dados_Adicionais_Cliente');
        add('   (Codigo_Cliente');
        add('   ,Empresa');
        add('   ,Inscricao');
        add('   ,Endereco');
        add('   ,Numero');
        add('   ,CEP');
        add('   ,Complemento');
        add('   ,Codigo_Setor');
        add('   ,Codigo_Cidade)');
        add('VALUES');
        add('   (:Codigo_Cliente');
        add('   ,:Empresa');
        add('   ,:Inscricao');
        add('   ,:Endereco');
        add('   ,:Numero');
        add('   ,:CEP');
        add('   ,:Complemento');
        add('   ,:Codigo_Setor');
        add('   ,:Codigo_Cidade)');

        Parameters.ParamByName('Codigo_Cliente').Value := Cod_Cliente;
        Parameters.ParamByName('Empresa').Value := Empres;
        Parameters.ParamByName('Inscricao').Value := Insc;
        Parameters.ParamByName('Endereco').Value :=
          FrmCadastro_Cliente.EdtEndereco_DAC.Text;
        Parameters.ParamByName('Numero').Value :=
          FrmCadastro_Cliente.EdtNumero_DAC.Text;
        Parameters.ParamByName('CEP').Value :=
          FrmCadastro_Cliente.EdtCEP_DAC.Text;
        Parameters.ParamByName('Complemento').Value :=
          FrmCadastro_Cliente.EdtComplemento_DAC.Text;

        if (FrmCadastro_Cliente.EdtCodigo_Setor_DAC.Text <> '') then
          Parameters.ParamByName('Codigo_Setor').Value :=
            FrmCadastro_Cliente.EdtCodigo_Setor_DAC.Text
        else
          Parameters.ParamByName('Codigo_Setor').Value := 0;

        if (FrmCadastro_Cliente.EdtCodigo_Cidade_DAC.Text <> '') then
          Parameters.ParamByName('Codigo_Cidade').Value :=
            FrmCadastro_Cliente.EdtCodigo_Cidade_DAC.Text
        else
          Parameters.ParamByName('Codigo_Cidade').Value := 0;

        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Insere;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TCadastro_Etiqueta }

procedure TCadastro_Etiqueta.Alterar(Tipo: integer);
var
  QExe: TADOQuery;
begin
  QExe := TADOQuery.Create(Nil);
  Try
    with QExe, SQL do
    begin
      close;
      Connection := DM.ADOConnection1;
      clear;

      if (Tipo = 0) then
      begin
        add('UPDATE Cadastro_Etiqueta');
        add('   SET Descricao = :Descricao');
        add('      ,Margem_Superior = :Margem_Superior');
        add('      ,Margem_Inferior = :Margem_Inferior');
        add('      ,Margem_Esquerda = :Margem_Esquerda');
        add('      ,Margem_Direita = :Margem_Direita');
        add('      ,Distancia_Vertical = :Distancia_Vertical');
        add('      ,Distancia_Horizontal = :Distancia_Horizontal');
        add('      ,Altura_Etiqueta = :Altura_Etiqueta');
        add('      ,Largura_Etiqueta = :Largura_Etiqueta');
        add('      ,Tamanho_Fonte = :Tamanho_Fonte');
        add('      ,Largura_Pagina = :Largura_Pagina');
        add('      ,Altura_Pagina = :Altura_Pagina');
        add('      ,Etiqueta_Linha = :Etiqueta_Linha');
        add('      ,Linha_Pagina = :Linha_Pagina');
        add('      WHERE Codigo = :Codigo');

        Parameters.ParamByName('Codigo').Value :=
          StrToInt(FrmCadastro_Etiqueta.EdtCodigo.Text);
        Parameters.ParamByName('Descricao').Value :=
          FrmCadastro_Etiqueta.EdtDescricao.Text;
        Parameters.ParamByName('Margem_Superior').Value :=
          StrToFloat(FrmCadastro_Etiqueta.EdtMargem_Superior.Text);
        Parameters.ParamByName('Margem_Inferior').Value :=
          StrToFloat(FrmCadastro_Etiqueta.EdtMargem_Inferior.Text);
        Parameters.ParamByName('Margem_Esquerda').Value :=
          StrToFloat(FrmCadastro_Etiqueta.EdtMargem_Esquerda.Text);
        Parameters.ParamByName('Margem_Direita').Value :=
          StrToFloat(FrmCadastro_Etiqueta.EdtMargem_Direita.Text);
        Parameters.ParamByName('Distancia_Vertical').Value :=
          StrToFloat(FrmCadastro_Etiqueta.EdtDistancia_Vertical.Text);
        Parameters.ParamByName('Distancia_Horizontal').Value :=
          StrToFloat(FrmCadastro_Etiqueta.EdtDistancia_Horizontal.Text);
        Parameters.ParamByName('Altura_Etiqueta').Value :=
          StrToFloat(FrmCadastro_Etiqueta.EdtAltura_Etiqueta.Text);
        Parameters.ParamByName('Largura_Etiqueta').Value :=
          StrToFloat(FrmCadastro_Etiqueta.EdtLargura_Etiqueta.Text);
        Parameters.ParamByName('Tamanho_Fonte').Value :=
          StrToFloat(FrmCadastro_Etiqueta.EdtTamanho_Fonte.Text);
        Parameters.ParamByName('Largura_Pagina').Value :=
          StrToFloat(FrmCadastro_Etiqueta.EdtLargura_Pagina.Text);
        Parameters.ParamByName('Altura_Pagina').Value :=
          StrToFloat(FrmCadastro_Etiqueta.EdtAltura_Pagina.Text);
        Parameters.ParamByName('Etiqueta_Linha').Value :=
          StrToFloat(FrmCadastro_Etiqueta.EdtEtiqueta_Linha.Text);
        Parameters.ParamByName('Linha_Pagina').Value :=
          StrToFloat(FrmCadastro_Etiqueta.EdtLinha_Pagina.Text);
      end
      else if (Tipo = 1) then
      begin
        add('UPDATE Etiquetadora SET Descricao = :Descricao');
        add('           ,Tipo_Barra_Etiqueta = :Tipo_Barra_Etiqueta');
        add('           ,Largura_Barra_Larga = :Largura_Barra_Larga');
        add('           ,Largura_Barra_Fina = :Largura_Barra_Fina');
        add('           ,Distancia_Horizontal_Etiqueta = :Distancia_Horizontal_Etiqueta');
        add('           ,Distancia_Vertical_Etiqueta = :Distancia_Vertical_Etiqueta');
        add('           ,Altura_Codigo = :Altura_Codigo');
        add('           ,Horizontal_Barra_Etiqueta = :Horizontal_Barra_Etiqueta');
        add('           ,Vertical_Barra_Etiqueta = :Vertical_Barra_Etiqueta');
        add('           ,Orientacao_Impressao_Texto_Etiqueta = :Orientacao_Impressao_Texto_Etiqueta');
        add('           ,Tamanho_Fonte_Texto_Etiqueta_Campo_1 = :Tamanho_Fonte_Texto_Etiqueta_Campo_1');
        add('           ,Multiplicador_V_Texto_Etiqueta_Campo_1 = :Multiplicador_V_Texto_Etiqueta_Campo_1');
        add('           ,Multiplicador_H_Texto_Etiqueta_Campo_1 = :Multiplicador_H_Texto_Etiqueta_Campo_1');
        add('           ,Horizontal_Texto_Etiqueta_Campo_1 = :Horizontal_Texto_Etiqueta_Campo_1');
        add('           ,Vertical_Texto_Etiqueta_Campo_1 = :Vertical_Texto_Etiqueta_Campo_1');
        add('           ,Tamanho_Fonte_Texto_Etiqueta_Campo_2 = :Tamanho_Fonte_Texto_Etiqueta_Campo_2');
        add('           ,Multiplicador_V_Texto_Etiqueta_Campo_2 = :Multiplicador_V_Texto_Etiqueta_Campo_2');
        add('           ,Multiplicador_H_Texto_Etiqueta_Campo_2 = :Multiplicador_H_Texto_Etiqueta_Campo_2');
        add('           ,Horizontal_Texto_Etiqueta_Campo_2 = :Horizontal_Texto_Etiqueta_Campo_2');
        add('           ,Vertical_Texto_Etiqueta_Campo_2 = :Vertical_Texto_Etiqueta_Campo_2');
        add('           ,Tamanho_Fonte_Texto_Etiqueta_Campo_3 = :Tamanho_Fonte_Texto_Etiqueta_Campo_3');
        add('           ,Multiplicador_V_Texto_Etiqueta_Campo_3 = :Multiplicador_V_Texto_Etiqueta_Campo_3');
        add('           ,Multiplicador_H_Texto_Etiqueta_Campo_3 = :Multiplicador_H_Texto_Etiqueta_Campo_3');
        add('           ,Horizontal_Texto_Etiqueta_Campo_3 = :Horizontal_Texto_Etiqueta_Campo_3');
        add('           ,Vertical_Texto_Etiqueta_Campo_3 = :Vertical_Texto_Etiqueta_Campo_3');
        add('           ,Tamanho_Fonte_Texto_Etiqueta_Campo_4 = :Tamanho_Fonte_Texto_Etiqueta_Campo_4');
        add('           ,Multiplicador_V_Texto_Etiqueta_Campo_4 = :Multiplicador_V_Texto_Etiqueta_Campo_4');
        add('           ,Multiplicador_H_Texto_Etiqueta_Campo_4 = :Multiplicador_H_Texto_Etiqueta_Campo_4');
        add('           ,Horizontal_Texto_Etiqueta_Campo_4 = :Horizontal_Texto_Etiqueta_Campo_4');
        add('           ,Vertical_Texto_Etiqueta_Campo_4 = :Vertical_Texto_Etiqueta_Campo_4');
        add('           ,Tamanho_Fonte_Texto_Etiqueta_Campo_5 = :Tamanho_Fonte_Texto_Etiqueta_Campo_5');
        add('           ,Multiplicador_V_Texto_Etiqueta_Campo_5 = :Multiplicador_V_Texto_Etiqueta_Campo_5');
        add('           ,Multiplicador_H_Texto_Etiqueta_Campo_5 = :Multiplicador_H_Texto_Etiqueta_Campo_5');
        add('           ,Horizontal_Texto_Etiqueta_Campo_5 = :Horizontal_Texto_Etiqueta_Campo_5');
        add('           ,Vertical_Texto_Etiqueta_Campo_5 = :Vertical_Texto_Etiqueta_Campo_5');
        add('           WHERE Codigo = :Codigo');

        Parameters.ParamByName('Codigo').Value :=
          StrToInt(FrmCadastro_Etiqueta.edtCodCompleta.Text);
        Parameters.ParamByName('Descricao').Value :=
          FrmCadastro_Etiqueta.EdtDescricaoCompleta.Text;
        Parameters.ParamByName('Tipo_Barra_Etiqueta').Value :=
          StrToFloat(FrmCadastro_Etiqueta.EdtTipo_Barra.Text);
        Parameters.ParamByName('Largura_Barra_Larga').Value :=
          StrToFloat(FrmCadastro_Etiqueta.EdtLargura_Barra_Larga.Text);
        Parameters.ParamByName('Largura_Barra_Fina').Value :=
          StrToFloat(FrmCadastro_Etiqueta.EdtLargura_Barra_Fina.Text);
        Parameters.ParamByName('Distancia_Horizontal_Etiqueta').Value :=
          StrToFloat(FrmCadastro_Etiqueta.EdtDistHoriz.Text);
        Parameters.ParamByName('Distancia_Vertical_Etiqueta').Value :=
          StrToFloat(FrmCadastro_Etiqueta.EdtDistVert.Text);
        Parameters.ParamByName('Altura_Codigo').Value :=
          StrToFloat(FrmCadastro_Etiqueta.EdtAltura_Codigo.Text);
        Parameters.ParamByName('Horizontal_Barra_Etiqueta').Value :=
          StrToFloat(FrmCadastro_Etiqueta.EdtHorizontal_Barra.Text);
        Parameters.ParamByName('Vertical_Barra_Etiqueta').Value :=
          StrToFloat(FrmCadastro_Etiqueta.EdtVertical_Barra.Text);
        Parameters.ParamByName('Orientacao_Impressao_Texto_Etiqueta').Value :=
          FrmCadastro_Etiqueta.CBOrientacao.Text;

        Parameters.ParamByName('Tamanho_Fonte_Texto_Etiqueta_Campo_1').Value :=
          StrToFloat
          (FrmCadastro_Etiqueta.EdtTamanho_Fonte_Etiqueta_Campo_1.Text);
        Parameters.ParamByName('Multiplicador_V_Texto_Etiqueta_Campo_1').Value
          := StrToFloat(FrmCadastro_Etiqueta.EdtMultiplicador_V_Campo_1.Text);
        Parameters.ParamByName('Multiplicador_H_Texto_Etiqueta_Campo_1').Value
          := StrToFloat(FrmCadastro_Etiqueta.EdtMultiplicador_H_Campo_1.Text);
        Parameters.ParamByName('Horizontal_Texto_Etiqueta_Campo_1').Value :=
          StrToFloat(FrmCadastro_Etiqueta.EdtHorizontal_Texto_Campo_1.Text);
        Parameters.ParamByName('Vertical_Texto_Etiqueta_Campo_1').Value :=
          StrToFloat(FrmCadastro_Etiqueta.EdtVertical_Texto_Campo_1.Text);

        Parameters.ParamByName('Tamanho_Fonte_Texto_Etiqueta_Campo_2').Value :=
          StrToFloat
          (FrmCadastro_Etiqueta.EdtTamanho_Fonte_Etiqueta_Campo_2.Text);
        Parameters.ParamByName('Multiplicador_V_Texto_Etiqueta_Campo_2').Value
          := StrToFloat(FrmCadastro_Etiqueta.EdtMultiplicador_V_Campo_2.Text);
        Parameters.ParamByName('Multiplicador_H_Texto_Etiqueta_Campo_2').Value
          := StrToFloat(FrmCadastro_Etiqueta.EdtMultiplicador_H_Campo_2.Text);
        Parameters.ParamByName('Horizontal_Texto_Etiqueta_Campo_2').Value :=
          StrToFloat(FrmCadastro_Etiqueta.EdtHorizontal_Texto_Campo_2.Text);
        Parameters.ParamByName('Vertical_Texto_Etiqueta_Campo_2').Value :=
          StrToFloat(FrmCadastro_Etiqueta.EdtVertical_Texto_Campo_2.Text);

        Parameters.ParamByName('Tamanho_Fonte_Texto_Etiqueta_Campo_3').Value :=
          StrToFloat
          (FrmCadastro_Etiqueta.EdtTamanho_Fonte_Etiqueta_Campo_3.Text);
        Parameters.ParamByName('Multiplicador_V_Texto_Etiqueta_Campo_3').Value
          := StrToFloat(FrmCadastro_Etiqueta.EdtMultiplicador_V_Campo_3.Text);
        Parameters.ParamByName('Multiplicador_H_Texto_Etiqueta_Campo_3').Value
          := StrToFloat(FrmCadastro_Etiqueta.EdtMultiplicador_H_Campo_3.Text);
        Parameters.ParamByName('Horizontal_Texto_Etiqueta_Campo_3').Value :=
          StrToFloat(FrmCadastro_Etiqueta.EdtHorizontal_Texto_Campo_3.Text);
        Parameters.ParamByName('Vertical_Texto_Etiqueta_Campo_3').Value :=
          StrToFloat(FrmCadastro_Etiqueta.EdtVertical_Texto_Campo_3.Text);

        Parameters.ParamByName('Tamanho_Fonte_Texto_Etiqueta_Campo_4').Value :=
          StrToFloat
          (FrmCadastro_Etiqueta.EdtTamanho_Fonte_Etiqueta_Campo_4.Text);
        Parameters.ParamByName('Multiplicador_V_Texto_Etiqueta_Campo_4').Value
          := StrToFloat(FrmCadastro_Etiqueta.EdtMultiplicador_V_Campo_4.Text);
        Parameters.ParamByName('Multiplicador_H_Texto_Etiqueta_Campo_4').Value
          := StrToFloat(FrmCadastro_Etiqueta.EdtMultiplicador_H_Campo_4.Text);
        Parameters.ParamByName('Horizontal_Texto_Etiqueta_Campo_4').Value :=
          StrToFloat(FrmCadastro_Etiqueta.EdtHorizontal_Texto_Campo_4.Text);
        Parameters.ParamByName('Vertical_Texto_Etiqueta_Campo_4').Value :=
          StrToFloat(FrmCadastro_Etiqueta.EdtVertical_Texto_Campo_4.Text);

        Parameters.ParamByName('Tamanho_Fonte_Texto_Etiqueta_Campo_5').Value :=
          StrToFloat
          (FrmCadastro_Etiqueta.EdtTamanho_Fonte_Etiqueta_Campo_5.Text);
        Parameters.ParamByName('Multiplicador_V_Texto_Etiqueta_Campo_5').Value
          := StrToFloat(FrmCadastro_Etiqueta.EdtMultiplicador_V_Campo_5.Text);
        Parameters.ParamByName('Multiplicador_H_Texto_Etiqueta_Campo_5').Value
          := StrToFloat(FrmCadastro_Etiqueta.EdtMultiplicador_H_Campo_5.Text);
        Parameters.ParamByName('Horizontal_Texto_Etiqueta_Campo_5').Value :=
          StrToFloat(FrmCadastro_Etiqueta.EdtHorizontal_Texto_Campo_5.Text);
        Parameters.ParamByName('Vertical_Texto_Etiqueta_Campo_5').Value :=
          StrToFloat(FrmCadastro_Etiqueta.EdtVertical_Texto_Campo_5.Text);

      end;
      ExecSQL;
      lrControle := Altera;
      UGeral.Mensagem_Padrao(lrControle);
    end;
  Finally
    FreeAndNil(QExe);
  End;
end;

procedure TCadastro_Etiqueta.Excluir;
var
  QExe: TADOQuery;
begin
  QExe := TADOQuery.Create(Nil);
  Try
    with QExe, SQL do
    begin
      close;
      Connection := DM.ADOConnection1;
      clear;
      add('Delete from Cadastro_Etiqueta where Codigo = :Codigo');

      Parameters.ParamByName('Codigo').Value :=
        StrToInt(FrmCadastro_Etiqueta.EdtCodigo.Text);
      ExecSQL;
      lrControle := Exclui;
      UGeral.Mensagem_Padrao(lrControle);
    end;
  Finally
    FreeAndNil(QExe);
  End;
end;

procedure TCadastro_Etiqueta.Excluir_Etiquetadora;
var
  QExe: TADOQuery;
begin
  QExe := TADOQuery.Create(Nil);
  Try
    with QExe, SQL do
    begin
      close;
      Connection := DM.ADOConnection1;
      clear;
      add('Delete from Etiquetadora where Codigo = :Codigo');

      Parameters.ParamByName('Codigo').Value :=
        StrToInt(FrmCadastro_Etiqueta.edtCodCompleta.Text);
      ExecSQL;
      lrControle := Exclui;
      UGeral.Mensagem_Padrao(lrControle);
    end;
  Finally
    FreeAndNil(QExe);
  End;
end;
procedure TCadastro_Etiqueta.Inserir(tipoEtiqueta: integer);
var
  QExe: TADOQuery;
begin
  QExe := TADOQuery.Create(Nil);
  Try
    with QExe, SQL do
    begin
      close;
      Connection := DM.ADOConnection1;
      clear;

      if (tipoEtiqueta = 0) then
      begin
        add('INSERT INTO Cadastro_Etiqueta');
        add('           (Codigo');
        add('           ,Descricao');
        add('           ,Margem_Superior');
        add('           ,Margem_Inferior');
        add('           ,Margem_Esquerda');
        add('           ,Margem_Direita');
        add('           ,Distancia_Vertical');
        add('           ,Distancia_Horizontal');
        add('           ,Altura_Etiqueta');
        add('           ,Largura_Etiqueta');
        add('           ,Tamanho_Fonte');
        add('           ,Largura_Pagina');
        add('           ,Altura_Pagina');
        add('           ,Etiqueta_Linha');
        add('           ,Linha_Pagina');
        add('           ,Data_Cadastro)');
        add('     VALUES');
        add('           (:Codigo');
        add('           ,:Descricao');
        add('           ,:Margem_Superior');
        add('           ,:Margem_Inferior');
        add('           ,:Margem_Esquerda');
        add('           ,:Margem_Direita');
        add('           ,:Distancia_Vertical');
        add('           ,:Distancia_Horizontal');
        add('           ,:Altura_Etiqueta');
        add('           ,:Largura_Etiqueta');
        add('           ,:Tamanho_Fonte');
        add('           ,:Largura_Pagina');
        add('           ,:Altura_Pagina');
        add('           ,:Etiqueta_Linha');
        add('           ,:Linha_Pagina');
        add('           ,:Data_Cadastro)');

        Parameters.ParamByName('Codigo').Value :=
          StrToInt(FrmCadastro_Etiqueta.EdtCodigo.Text);
        Parameters.ParamByName('Descricao').Value :=
          FrmCadastro_Etiqueta.EdtDescricao.Text;
        Parameters.ParamByName('Margem_Superior').Value :=
          StrToFloat(FrmCadastro_Etiqueta.EdtMargem_Superior.Text);
        Parameters.ParamByName('Margem_Inferior').Value :=
          StrToFloat(FrmCadastro_Etiqueta.EdtMargem_Inferior.Text);
        Parameters.ParamByName('Margem_Esquerda').Value :=
          StrToFloat(FrmCadastro_Etiqueta.EdtMargem_Esquerda.Text);
        Parameters.ParamByName('Margem_Direita').Value :=
          StrToFloat(FrmCadastro_Etiqueta.EdtMargem_Direita.Text);
        Parameters.ParamByName('Distancia_Vertical').Value :=
          StrToFloat(FrmCadastro_Etiqueta.EdtDistancia_Vertical.Text);
        Parameters.ParamByName('Distancia_Horizontal').Value :=
          StrToFloat(FrmCadastro_Etiqueta.EdtDistancia_Horizontal.Text);
        Parameters.ParamByName('Altura_Etiqueta').Value :=
          StrToFloat(FrmCadastro_Etiqueta.EdtAltura_Etiqueta.Text);
        Parameters.ParamByName('Largura_Etiqueta').Value :=
          StrToFloat(FrmCadastro_Etiqueta.EdtLargura_Etiqueta.Text);
        Parameters.ParamByName('Tamanho_Fonte').Value :=
          StrToFloat(FrmCadastro_Etiqueta.EdtTamanho_Fonte.Text);
        Parameters.ParamByName('Largura_Pagina').Value :=
          StrToFloat(FrmCadastro_Etiqueta.EdtLargura_Pagina.Text);
        Parameters.ParamByName('Altura_Pagina').Value :=
          StrToFloat(FrmCadastro_Etiqueta.EdtAltura_Pagina.Text);
        Parameters.ParamByName('Etiqueta_Linha').Value :=
          StrToFloat(FrmCadastro_Etiqueta.EdtEtiqueta_Linha.Text);
        Parameters.ParamByName('Linha_Pagina').Value :=
          StrToFloat(FrmCadastro_Etiqueta.EdtLinha_Pagina.Text);
        Parameters.ParamByName('Data_Cadastro').Value :=
          StrToDateTime(FrmCadastro_Etiqueta.MEdtData_Cadastro.Text);

      end
      else
      begin
        add('INSERT INTO Etiquetadora');
        add('           (Codigo');
        add('           ,Data_Cadastro');
        add('           ,Descricao');
        add('           ,Tipo_Barra_Etiqueta');
        add('           ,Largura_Barra_Larga');
        add('           ,Largura_Barra_Fina');
        add('           ,Distancia_Horizontal_Etiqueta');
        add('           ,Distancia_Vertical_Etiqueta');
        add('           ,Altura_Codigo');
        add('           ,Horizontal_Barra_Etiqueta');
        add('           ,Vertical_Barra_Etiqueta');
        add('           ,Orientacao_Impressao_Texto_Etiqueta');
        add('           ,Tamanho_Fonte_Texto_Etiqueta_Campo_1');
        add('           ,Multiplicador_V_Texto_Etiqueta_Campo_1');
        add('           ,Multiplicador_H_Texto_Etiqueta_Campo_1');
        add('           ,Horizontal_Texto_Etiqueta_Campo_1');
        add('           ,Vertical_Texto_Etiqueta_Campo_1');
        add('           ,Tamanho_Fonte_Texto_Etiqueta_Campo_2');
        add('           ,Multiplicador_V_Texto_Etiqueta_Campo_2');
        add('           ,Multiplicador_H_Texto_Etiqueta_Campo_2');
        add('           ,Horizontal_Texto_Etiqueta_Campo_2');
        add('           ,Vertical_Texto_Etiqueta_Campo_2');
        add('           ,Tamanho_Fonte_Texto_Etiqueta_Campo_3');
        add('           ,Multiplicador_V_Texto_Etiqueta_Campo_3');
        add('           ,Multiplicador_H_Texto_Etiqueta_Campo_3');
        add('           ,Horizontal_Texto_Etiqueta_Campo_3');
        add('           ,Vertical_Texto_Etiqueta_Campo_3');
        add('           ,Tamanho_Fonte_Texto_Etiqueta_Campo_4');
        add('           ,Multiplicador_V_Texto_Etiqueta_Campo_4');
        add('           ,Multiplicador_H_Texto_Etiqueta_Campo_4');
        add('           ,Horizontal_Texto_Etiqueta_Campo_4');
        add('           ,Vertical_Texto_Etiqueta_Campo_4');
        add('           ,Tamanho_Fonte_Texto_Etiqueta_Campo_5');
        add('           ,Multiplicador_V_Texto_Etiqueta_Campo_5');
        add('           ,Multiplicador_H_Texto_Etiqueta_Campo_5');
        add('           ,Horizontal_Texto_Etiqueta_Campo_5');
        add('           ,Vertical_Texto_Etiqueta_Campo_5)');
        add('     VALUES');
        add('           (:Codigo');
        add('           ,:Data_Cadastro');
        add('           ,:Descricao');
        add('           ,:Tipo_Barra_Etiqueta');
        add('           ,:Largura_Barra_Larga');
        add('           ,:Largura_Barra_Fina');
        add('           ,:Distancia_Horizontal_Etiqueta');
        add('           ,:Distancia_Vertical_Etiqueta');
        add('           ,:Altura_Codigo');
        add('           ,:Horizontal_Barra_Etiqueta');
        add('           ,:Vertical_Barra_Etiqueta');
        add('           ,:Orientacao_Impressao_Texto_Etiqueta');
        add('           ,:Tamanho_Fonte_Texto_Etiqueta_Campo_1');
        add('           ,:Multiplicador_V_Texto_Etiqueta_Campo_1');
        add('           ,:Multiplicador_H_Texto_Etiqueta_Campo_1');
        add('           ,:Horizontal_Texto_Etiqueta_Campo_1');
        add('           ,:Vertical_Texto_Etiqueta_Campo_1');
        add('           ,:Tamanho_Fonte_Texto_Etiqueta_Campo_2');
        add('           ,:Multiplicador_V_Texto_Etiqueta_Campo_2');
        add('           ,:Multiplicador_H_Texto_Etiqueta_Campo_2');
        add('           ,:Horizontal_Texto_Etiqueta_Campo_2');
        add('           ,:Vertical_Texto_Etiqueta_Campo_2');
        add('           ,:Tamanho_Fonte_Texto_Etiqueta_Campo_3');
        add('           ,:Multiplicador_V_Texto_Etiqueta_Campo_3');
        add('           ,:Multiplicador_H_Texto_Etiqueta_Campo_3');
        add('           ,:Horizontal_Texto_Etiqueta_Campo_3');
        add('           ,:Vertical_Texto_Etiqueta_Campo_3');
        add('           ,:Tamanho_Fonte_Texto_Etiqueta_Campo_4');
        add('           ,:Multiplicador_V_Texto_Etiqueta_Campo_4');
        add('           ,:Multiplicador_H_Texto_Etiqueta_Campo_4');
        add('           ,:Horizontal_Texto_Etiqueta_Campo_4');
        add('           ,:Vertical_Texto_Etiqueta_Campo_4');
        add('           ,:Tamanho_Fonte_Texto_Etiqueta_Campo_5');
        add('           ,:Multiplicador_V_Texto_Etiqueta_Campo_5');
        add('           ,:Multiplicador_H_Texto_Etiqueta_Campo_5');
        add('           ,:Horizontal_Texto_Etiqueta_Campo_5');
        add('           ,:Vertical_Texto_Etiqueta_Campo_5)');

        Parameters.ParamByName('Codigo').Value :=
          StrToInt(FrmCadastro_Etiqueta.edtCodCompleta.Text);
        Parameters.ParamByName('Data_Cadastro').Value :=
          StrToDateTime(FrmCadastro_Etiqueta.edtDataCompleta.Text);
        Parameters.ParamByName('Descricao').Value :=
          FrmCadastro_Etiqueta.EdtDescricaoCompleta.Text;
        Parameters.ParamByName('Tipo_Barra_Etiqueta').Value :=
          StrToFloat(FrmCadastro_Etiqueta.EdtTipo_Barra.Text);
        Parameters.ParamByName('Largura_Barra_Larga').Value :=
          StrToFloat(FrmCadastro_Etiqueta.EdtLargura_Barra_Larga.Text);
        Parameters.ParamByName('Largura_Barra_Fina').Value :=
          StrToFloat(FrmCadastro_Etiqueta.EdtLargura_Barra_Fina.Text);
        Parameters.ParamByName('Distancia_Horizontal_Etiqueta').Value :=
          StrToFloat(FrmCadastro_Etiqueta.EdtDistHoriz.Text);
        Parameters.ParamByName('Distancia_Vertical_Etiqueta').Value :=
          StrToFloat(FrmCadastro_Etiqueta.EdtDistVert.Text);
        Parameters.ParamByName('Altura_Codigo').Value :=
          StrToFloat(FrmCadastro_Etiqueta.EdtAltura_Codigo.Text);
        Parameters.ParamByName('Horizontal_Barra_Etiqueta').Value :=
          StrToFloat(FrmCadastro_Etiqueta.EdtHorizontal_Barra.Text);
        Parameters.ParamByName('Vertical_Barra_Etiqueta').Value :=
          StrToFloat(FrmCadastro_Etiqueta.EdtVertical_Barra.Text);
        Parameters.ParamByName('Orientacao_Impressao_Texto_Etiqueta').Value :=
          StrToFloat(FrmCadastro_Etiqueta.CBOrientacao.Text);

        Parameters.ParamByName('Tamanho_Fonte_Texto_Etiqueta_Campo_1').Value :=
          StrToFloat
          (FrmCadastro_Etiqueta.EdtTamanho_Fonte_Etiqueta_Campo_1.Text);
        Parameters.ParamByName('Multiplicador_V_Texto_Etiqueta_Campo_1').Value
          := StrToFloat(FrmCadastro_Etiqueta.EdtMultiplicador_V_Campo_1.Text);
        Parameters.ParamByName('Multiplicador_H_Texto_Etiqueta_Campo_1').Value
          := StrToFloat(FrmCadastro_Etiqueta.EdtMultiplicador_H_Campo_1.Text);
        Parameters.ParamByName('Horizontal_Texto_Etiqueta_Campo_1').Value :=
          StrToFloat(FrmCadastro_Etiqueta.EdtHorizontal_Texto_Campo_1.Text);
        Parameters.ParamByName('Vertical_Texto_Etiqueta_Campo_1').Value :=
          StrToFloat(FrmCadastro_Etiqueta.EdtVertical_Texto_Campo_1.Text);

        Parameters.ParamByName('Tamanho_Fonte_Texto_Etiqueta_Campo_2').Value :=
          StrToFloat
          (FrmCadastro_Etiqueta.EdtTamanho_Fonte_Etiqueta_Campo_2.Text);
        Parameters.ParamByName('Multiplicador_V_Texto_Etiqueta_Campo_2').Value
          := StrToFloat(FrmCadastro_Etiqueta.EdtMultiplicador_V_Campo_2.Text);
        Parameters.ParamByName('Multiplicador_H_Texto_Etiqueta_Campo_2').Value
          := StrToFloat(FrmCadastro_Etiqueta.EdtMultiplicador_H_Campo_2.Text);
        Parameters.ParamByName('Horizontal_Texto_Etiqueta_Campo_2').Value :=
          StrToFloat(FrmCadastro_Etiqueta.EdtHorizontal_Texto_Campo_2.Text);
        Parameters.ParamByName('Vertical_Texto_Etiqueta_Campo_2').Value :=
          StrToFloat(FrmCadastro_Etiqueta.EdtVertical_Texto_Campo_2.Text);

        Parameters.ParamByName('Tamanho_Fonte_Texto_Etiqueta_Campo_3').Value :=
          StrToFloat
          (FrmCadastro_Etiqueta.EdtTamanho_Fonte_Etiqueta_Campo_3.Text);
        Parameters.ParamByName('Multiplicador_V_Texto_Etiqueta_Campo_3').Value
          := StrToFloat(FrmCadastro_Etiqueta.EdtMultiplicador_V_Campo_3.Text);
        Parameters.ParamByName('Multiplicador_H_Texto_Etiqueta_Campo_3').Value
          := StrToFloat(FrmCadastro_Etiqueta.EdtMultiplicador_H_Campo_3.Text);
        Parameters.ParamByName('Horizontal_Texto_Etiqueta_Campo_3').Value :=
          StrToFloat(FrmCadastro_Etiqueta.EdtHorizontal_Texto_Campo_3.Text);
        Parameters.ParamByName('Vertical_Texto_Etiqueta_Campo_3').Value :=
          StrToFloat(FrmCadastro_Etiqueta.EdtVertical_Texto_Campo_3.Text);

        Parameters.ParamByName('Tamanho_Fonte_Texto_Etiqueta_Campo_4').Value :=
          StrToFloat
          (FrmCadastro_Etiqueta.EdtTamanho_Fonte_Etiqueta_Campo_4.Text);
        Parameters.ParamByName('Multiplicador_V_Texto_Etiqueta_Campo_4').Value
          := StrToFloat(FrmCadastro_Etiqueta.EdtMultiplicador_V_Campo_4.Text);
        Parameters.ParamByName('Multiplicador_H_Texto_Etiqueta_Campo_4').Value
          := StrToFloat(FrmCadastro_Etiqueta.EdtMultiplicador_H_Campo_4.Text);
        Parameters.ParamByName('Horizontal_Texto_Etiqueta_Campo_4').Value :=
          StrToFloat(FrmCadastro_Etiqueta.EdtHorizontal_Texto_Campo_4.Text);
        Parameters.ParamByName('Vertical_Texto_Etiqueta_Campo_4').Value :=
          StrToFloat(FrmCadastro_Etiqueta.EdtVertical_Texto_Campo_4.Text);

        Parameters.ParamByName('Tamanho_Fonte_Texto_Etiqueta_Campo_5').Value :=
          StrToFloat
          (FrmCadastro_Etiqueta.EdtTamanho_Fonte_Etiqueta_Campo_5.Text);
        Parameters.ParamByName('Multiplicador_V_Texto_Etiqueta_Campo_5').Value
          := StrToFloat(FrmCadastro_Etiqueta.EdtMultiplicador_V_Campo_5.Text);
        Parameters.ParamByName('Multiplicador_H_Texto_Etiqueta_Campo_5').Value
          := StrToFloat(FrmCadastro_Etiqueta.EdtMultiplicador_H_Campo_5.Text);
        Parameters.ParamByName('Horizontal_Texto_Etiqueta_Campo_5').Value :=
          StrToFloat(FrmCadastro_Etiqueta.EdtHorizontal_Texto_Campo_5.Text);
        Parameters.ParamByName('Vertical_Texto_Etiqueta_Campo_5').Value :=
          StrToFloat(FrmCadastro_Etiqueta.EdtVertical_Texto_Campo_5.Text);

      end;

      ExecSQL;
      lrControle := Insere;
      UGeral.Mensagem_Padrao(lrControle);
    end;
  Finally
    FreeAndNil(QExe);
  End;
end;

{ TNFE }

procedure TNFE.Inserir;
var
  qAux: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('INSERT INTO NF');
        add('(N_Nota_Fiscal');
        add(',Data_Emissao');
        add(',Data_Ent_Sai');
        add(',Hora');
        add(',Tipo_Operacao');
        add(',Codigo_CFOP');
        add(',Tipo_Nota');
        add(',Forma_Pagamento');
        add(',Modelo');
        add(',Serie');
        add(',Chave_Acesso');
        add(',Codigo_Pedido)');

        add(' VALUES ');

        add('(:N_Nota_Fiscal');
        add(',:Data_Emissao');
        add(',:Data_Ent_Sai');
        add(',:Hora');
        add(',:Tipo_Operacao');
        add(',:Codigo_CFOP');
        add(',:Tipo_Nota');
        add(',:Forma_Pagamento');
        add(',:Modelo');
        add(',:Serie');
        add(',:Chave_Acesso');
        add(',:Codigo_Pedido)');

        Parameters.ParamByName('N_Nota_Fiscal').Value :=
          FrmNFE.EdtN_Nota_Fiscal.Text;
        Parameters.ParamByName('Data_Emissao').Value :=
          StrToDateTime(FrmNFE.MEdtData_Emissao.Text);
        Parameters.ParamByName('Data_Ent_Sai').Value :=
          StrToDateTime(FrmNFE.MEdtData_Entrada_Saida.Text);
        Parameters.ParamByName('Hora').Value :=
          FrmNFE.MEdtHora_Entrada_Saida.Text;

        if (FrmNFE.RGTipo_Operacao.ItemIndex = 0) then
          Parameters.ParamByName('Tipo_Operacao').Value := 'ENTRADA'
        else
          Parameters.ParamByName('Tipo_Operacao').Value := 'SAIDA';

        Parameters.ParamByName('Codigo_CFOP').Value :=
          StrToInt(FrmNFE.EdtCodigo_CFOP.Text);
        Parameters.ParamByName('Tipo_Nota').Value := FrmNFE.CMBTipo_Nota.Text;
        Parameters.ParamByName('Forma_Pagamento').Value :=
          FrmNFE.CmbForma_Pagamento.Text;
        Parameters.ParamByName('Modelo').Value := FrmNFE.EdtModelo.Text;
        Parameters.ParamByName('Serie').Value := FrmNFE.EdtSerie.Text;
        Parameters.ParamByName('Chave_Acesso').Value :=
          FrmNFE.EdtChave_Acesso.Text;
        Parameters.ParamByName('Codigo_Pedido').Value := FrmNFE.qrypedido_pendenteCodigo.AsInteger;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        // lrControle := Insere;
        // UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TLocal_Entrega_NFE }

procedure TLocal_Entrega_NFE.Inserir;
var
  qAux: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('INSERT INTO Local_Entrega_NF');
        add('(N_Nota_Fiscal');
        add(',CNPJ');
        add(',CPF');
        add(',Logradouro');
        add(',Numero');
        add(',Complemento');
        add(',Setor');
        add(',Codigo_Municipio');
        add(',Municipio');
        add(',UF)');
        add('VALUES');
        add('(:N_Nota_Fiscal');
        add(',:CNPJ');
        add(',:CPF');
        add(',:Logradouro');
        add(',:Numero');
        add(',:Complemento');
        add(',:Setor');
        add(',:Codigo_Municipio');
        add(',:Municipio');
        add(',:UF)');
        Parameters.ParamByName('N_Nota_Fiscal').Value :=
          FrmNFE.EdtN_Nota_Fiscal.Text;
        Parameters.ParamByName('CNPJ').Value := cnpj_emitente;
        Parameters.ParamByName('CPF').Value := cnpj_emitente;
        Parameters.ParamByName('Logradouro').Value := endereco_emitente;
        Parameters.ParamByName('Numero').Value := numero_emitente;
        Parameters.ParamByName('Complemento').Value := complemento_emitente;
        Parameters.ParamByName('Setor').Value := setor_emitente;
        Parameters.ParamByName('Codigo_Municipio').Value :=
          codigo_municipio_emitente;
        Parameters.ParamByName('Municipio').Value := municipio_emitente;
        Parameters.ParamByName('UF').Value := uf_emitente;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        // lrControle := Insere;
        // UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TLocal_Retirada_NFE }

procedure TLocal_Retirada_NFE.Inserir;
var
  qAux: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('INSERT INTO Local_Retirada_NF');
        add('(N_Nota_Fiscal');
        add(',CNPJ');
        add(',CPF');
        add(',Logradouro');
        add(',Numero');
        add(',Complemento');
        add(',Setor');
        add(',Codigo_Municipio');
        add(',Municipio');
        add(',UF)');
        add('VALUES');
        add('(:N_Nota_Fiscal');
        add(',:CNPJ');
        add(',:CPF');
        add(',:Logradouro');
        add(',:Numero');
        add(',:Complemento');
        add(',:Setor');
        add(',:Codigo_Municipio');
        add(',:Municipio');
        add(',:UF)');
        Parameters.ParamByName('N_Nota_Fiscal').Value :=
          FrmNFE.EdtN_Nota_Fiscal.Text;
        Parameters.ParamByName('CNPJ').Value := cnpj_destinatario;
        Parameters.ParamByName('CPF').Value := cnpj_destinatario;
        Parameters.ParamByName('Logradouro').Value :=
          endereco_destinatario;
        Parameters.ParamByName('Numero').Value := numero_destinatario;
        Parameters.ParamByName('Complemento').Value :=
          complemento_destinatario;
        Parameters.ParamByName('Setor').Value := setor_destinatario;
        Parameters.ParamByName('Codigo_Municipio').Value :=
          codigo_municipio_destinatario;
        Parameters.ParamByName('Municipio').Value :=
          municipio_destinatario;
        Parameters.ParamByName('UF').Value := uf_destinatario;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        // lrControle := Insere;
        // UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TImpostos_NFE }

procedure TImpostos_NFE.Inserir;
var
  qAux: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('INSERT INTO Impostos_NF');
        add('   (N_Nota_Fiscal');
        add('   ,Base_ICMS');
        add('   ,Valor_ICMS');
        add('   ,Base_ICMS_Subs');
        add('   ,Valor_ICMS_Subs');
        add('   ,Total_Produtos');
        add('   ,Valor_Frete');
        add('   ,Valor_Seguro');
        add('   ,Desconto');
        add('   ,Total_IPI');
        add('   ,Total_PIS');
        add('   ,Total_COFINS');
        add('   ,Outras_Despesas');
        add('   ,Total_Nota)');
        add('VALUES');
        add('   (:N_Nota_Fiscal');
        add('   ,:Base_ICMS');
        add('   ,:Valor_ICMS');
        add('   ,:Base_ICMS_Subs');
        add('   ,:Valor_ICMS_Subs');
        add('   ,:Total_Produtos');
        add('   ,:Valor_Frete');
        add('   ,:Valor_Seguro');
        add('   ,:Desconto');
        add('   ,:Total_IPI');
        add('   ,:Total_PIS');
        add('   ,:Total_COFINS');
        add('   ,:Outras_Despesas');
        add('   ,:Total_Nota)');
        Parameters.ParamByName('N_Nota_Fiscal').Value :=
          FrmNFE.EdtN_Nota_Fiscal.Text;
        Parameters.ParamByName('Base_ICMS').Value :=
          StrToFloat(FrmNFE.EdtBase_Calculo_ICMS.Text);
        Parameters.ParamByName('Valor_ICMS').Value :=
          StrToFloat(FrmNFE.EdtValor_ICMS.Text);
        Parameters.ParamByName('Base_ICMS_Subs').Value :=
          StrToFloat(FrmNFE.EdtBase_Calculo_ICMS_Substituicao.Text);
        Parameters.ParamByName('Valor_ICMS_Subs').Value :=
          StrToFloat(FrmNFE.EdtValor_ICMS_Substituicao.Text);
        Parameters.ParamByName('Total_Produtos').Value :=
          StrToFloat(FrmNFE.EdtValor_Total_Produtos.Text);
        Parameters.ParamByName('Valor_Frete').Value :=
          StrToFloat(FrmNFE.EdtValor_Frete.Text);
        Parameters.ParamByName('Valor_Seguro').Value :=
          StrToFloat(FrmNFE.EdtValor_Seguro.Text);
        Parameters.ParamByName('Desconto').Value :=
          StrToFloat(FrmNFE.EdtDesconto_Nota.Text);
        Parameters.ParamByName('Total_IPI').Value :=
          StrToFloat(FrmNFE.EdtValor_Total_IPI.Text);
        Parameters.ParamByName('Total_PIS').Value :=
          StrToFloat(FrmNFE.EdtValor_Total_PIS.Text);
        Parameters.ParamByName('Total_COFINS').Value :=
          StrToFloat(FrmNFE.EdtValor_Total_COFINS.Text);
        Parameters.ParamByName('Outras_Despesas').Value :=
          StrToFloat(FrmNFE.EdtOutras_Despesas.Text);
        Parameters.ParamByName('Total_Nota').Value :=
          StrToFloat(FrmNFE.EdtValor_Total_Nota.Text);
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        // lrControle := Insere;
        // UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TTransporte_NFE }

procedure TTransporte_NFE.Inserir;
var
  qAux: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('INSERT INTO Transporte_NF');
        add('   (N_Nota_Fiscal');
        add('   ,Codigo_Transportadora');
        add('   ,Codigo_Veiculo');
        add('   ,Codigo_Reboque');
        add('   ,UF');
        add('   ,Tipo_Frete');
        add('   ,Quantidade');
        add('   ,Especie');
        add('   ,Marca');
        add('   ,Numero');
        add('   ,Peso_Bruto');
        add('   ,Peso_Liquido');
        add('   ,Codigo_Pedido)');
        add('VALUES');
        add('   (:N_Nota_Fiscal');
        add('   ,:Codigo_Transportadora');
        add('   ,:Codigo_Veiculo');
        add('   ,:Codigo_Reboque');
        add('   ,:UF');
        add('   ,:Tipo_Frete');
        add('   ,:Quantidade');
        add('   ,:Especie');
        add('   ,:Marca');
        add('   ,:Numero');
        add('   ,:Peso_Bruto');
        add('   ,:Peso_Liquido');
        add('   ,:Codigo_Pedido)');
        Parameters.ParamByName('N_Nota_Fiscal').Value :=
          FrmNFE.EdtN_Nota_Fiscal.Text;

        if (FrmNFE.EdtCodigo_Transportadora.Text <> '') then
          Parameters.ParamByName('Codigo_Transportadora').Value :=
            StrToInt(FrmNFE.EdtCodigo_Transportadora.Text)
        else
          Parameters.ParamByName('Codigo_Transportadora').Value := 0;

        if (FrmNFE.EdtCodigo_Veiculo.Text <> '') then
          Parameters.ParamByName('Codigo_Veiculo').Value :=
            StrToInt(FrmNFE.EdtCodigo_Veiculo.Text)
        else
          Parameters.ParamByName('Codigo_Veiculo').Value := 0;

        if (FrmNFE.EdtCodigo_Reboque.Text <> '') then
          Parameters.ParamByName('Codigo_Reboque').Value :=
            StrToInt(FrmNFE.EdtCodigo_Reboque.Text)
        else
          Parameters.ParamByName('Codigo_Reboque').Value := 0;

        Parameters.ParamByName('UF').Value := FrmNFE.EdtUF_Reboque.Text;

        if (FrmNFE.RGFrete.ItemIndex = 0) then
          Parameters.ParamByName('Tipo_Frete').Value := 'EMITENTE'
        else if (FrmNFE.RGFrete.ItemIndex = 1) then
          Parameters.ParamByName('Tipo_Frete').Value := 'DEST./REM.'
        else if (FrmNFE.RGFrete.ItemIndex = 2) then
          Parameters.ParamByName('Tipo_Frete').Value := 'TERCEIROS'
        else if (FrmNFE.RGFrete.ItemIndex = 3) then
          Parameters.ParamByName('Tipo_Frete').Value := 'SEM FRETE';

        if (FrmNFE.EdtQuantidade_Transportada.Text <> '') then
          Parameters.ParamByName('Quantidade').Value :=
            StrToInt(FrmNFE.EdtQuantidade_Transportada.Text)
        else
          Parameters.ParamByName('Quantidade').Value := 0;

        Parameters.ParamByName('Especie').Value := FrmNFE.EdtEspecie.Text;
        Parameters.ParamByName('Marca').Value := FrmNFE.EdtMarca.Text;
        Parameters.ParamByName('Numero').Value :=
          FrmNFE.EdtNumero_Transportado.Text;

        if (FrmNFE.EdtPeso_Bruto.Text <> '') then
          Parameters.ParamByName('Peso_Bruto').Value :=
            StrToFloat(FrmNFE.EdtPeso_Bruto.Text)
        else
          Parameters.ParamByName('Peso_Bruto').Value := 0;

        if (FrmNFE.EdtPeso_Liquido.Text <> '') then
          Parameters.ParamByName('Peso_Liquido').Value :=
            StrToFloat(FrmNFE.EdtPeso_Liquido.Text)
        else
          Parameters.ParamByName('Peso_Liquido').Value := 0;

        Parameters.ParamByName('Codigo_Pedido').Value := FrmNFE.qrypedido_pendenteCodigo.AsInteger;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        // lrControle := Insere;
        // UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TEmitente_NFE }

procedure TEmitente_NFE.Inserir;
var
  qAux: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('INSERT INTO Emitente_NF');
        add('   (N_Nota_Fiscal');
        add('   ,CNPJ_Emitente');
        add('   ,CPF_Remetente');
        add('   ,Razao_Social');
        add('   ,Nome_Fantasia');
        add('   ,Logradouro');
        add('   ,Numero');
        add('   ,Complemento');
        add('   ,Setor');
        add('   ,Codigo_Municipio');
        add('   ,Municipio');
        add('   ,UF');
        add('   ,CEP');
        add('   ,Codigo_Pais');
        add('   ,Pais');
        add('   ,Telefone');
        add('   ,IE');
        add('   ,IE_Substituto_Tributario');
        add('   ,Inscricao_Municipal');
        add('   ,CNAE_Fiscal');
        add('   ,Regime_Tributario)');
        add('VALUES');
        add('   (:N_Nota_Fiscal');
        add('   ,:CNPJ_Emitente');
        add('   ,:CPF_Remetente');
        add('   ,:Razao_Social');
        add('   ,:Nome_Fantasia');
        add('   ,:Logradouro');
        add('   ,:Numero');
        add('   ,:Complemento');
        add('   ,:Setor');
        add('   ,:Codigo_Municipio');
        add('   ,:Municipio');
        add('   ,:UF');
        add('   ,:CEP');
        add('   ,:Codigo_Pais');
        add('   ,:Pais');
        add('   ,:Telefone');
        add('   ,:IE');
        add('   ,:IE_Substituto_Tributario');
        add('   ,:Inscricao_Municipal');
        add('   ,:CNAE_Fiscal');
        add('   ,:Regime_Tributario)');
        Parameters.ParamByName('N_Nota_Fiscal').Value :=
          FrmNFE.EdtN_Nota_Fiscal.Text;
        Parameters.ParamByName('CNPJ_Emitente').Value := cnpj_emitente;
        Parameters.ParamByName('CPF_Remetente').Value := cnpj_emitente;
        // conferir
        Parameters.ParamByName('Razao_Social').Value := razao_social_emitente;
        Parameters.ParamByName('Nome_Fantasia').Value := Nome_Fantasia;
        Parameters.ParamByName('Logradouro').Value := endereco_emitente;
        Parameters.ParamByName('Numero').Value := numero_emitente;
        Parameters.ParamByName('Complemento').Value := complemento_emitente;
        Parameters.ParamByName('Setor').Value := setor_emitente;
        Parameters.ParamByName('Codigo_Municipio').Value :=
          codigo_municipio_emitente;
        Parameters.ParamByName('Municipio').Value := municipio_emitente;
        Parameters.ParamByName('UF').Value := uf_emitente;
        Parameters.ParamByName('CEP').Value := cep_emitente;
        Parameters.ParamByName('Codigo_Pais').Value := '1058';
        Parameters.ParamByName('Pais').Value := 'BRASIL';
        Parameters.ParamByName('Telefone').Value := telefone_emitente;
        Parameters.ParamByName('IE').Value := ie_emitente;
        Parameters.ParamByName('IE_Substituto_Tributario').Value := '';
        Parameters.ParamByName('Inscricao_Municipal').Value := im_emitente;
        Parameters.ParamByName('CNAE_Fiscal').Value := cnae_fiscal_emitente;
        Parameters.ParamByName('Regime_Tributario').Value :=
          regime_tributario_emitente;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        // lrControle := Insere;
        // UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TDestinatario_NFE }

procedure TDestinatario_NFE.Inserir;
var
  qAux: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('INSERT INTO Destinatario_NF');
        add('   (N_Nota_Fiscal');
        add('   ,CNPJ_Destinatario');
        add('   ,CPF_Destinatario');
        add('   ,Razao_Social');
        add('   ,Logradouro');
        add('   ,Numero');
        add('   ,Complemento');
        add('   ,Setor');
        add('   ,Codigo_Municipio');
        add('   ,Municipio');
        add('   ,UF');
        add('   ,CEP');
        add('   ,Codigo_Pais');
        add('   ,Pais');
        add('   ,Telefone');
        add('   ,IE');
        add('   ,Suframa');
        add('   ,Inscricao_Municipal');
        add('   ,EMail)');
        add('VALUES');
        add('   (:N_Nota_Fiscal');
        add('   ,:CNPJ_Destinatario');
        add('   ,:CPF_Destinatario');
        add('   ,:Razao_Social');
        add('   ,:Logradouro');
        add('   ,:Numero');
        add('   ,:Complemento');
        add('   ,:Setor');
        add('   ,:Codigo_Municipio');
        add('   ,:Municipio');
        add('   ,:UF');
        add('   ,:CEP');
        add('   ,:Codigo_Pais');
        add('   ,:Pais');
        add('   ,:Telefone');
        add('   ,:IE');
        add('   ,:Suframa');
        add('   ,:Inscricao_Municipal');
        add('   ,:EMail)');
        Parameters.ParamByName('N_Nota_Fiscal').Value :=
          FrmNFE.EdtN_Nota_Fiscal.Text;
        Parameters.ParamByName('CNPJ_Destinatario').Value :=
          cnpj_destinatario;
        Parameters.ParamByName('CPF_Destinatario').Value :=
          cnpj_destinatario;
        Parameters.ParamByName('Razao_Social').Value :=
          razao_social_destinatario;
        Parameters.ParamByName('Logradouro').Value :=
          endereco_destinatario;
        Parameters.ParamByName('Numero').Value := numero_destinatario;
        Parameters.ParamByName('Complemento').Value :=
          complemento_destinatario;
        Parameters.ParamByName('Setor').Value := setor_destinatario;
        Parameters.ParamByName('Codigo_Municipio').Value :=
          codigo_municipio_destinatario;
        Parameters.ParamByName('Municipio').Value :=
          municipio_destinatario;
        Parameters.ParamByName('UF').Value := uf_destinatario;
        Parameters.ParamByName('CEP').Value := cep_destinatario;
        Parameters.ParamByName('Codigo_Pais').Value := '1058';
        Parameters.ParamByName('Pais').Value := 'BRASIL';
        Parameters.ParamByName('Telefone').Value :=
          telefone_destinatario;
        Parameters.ParamByName('IE').Value := ie_destinatario;
        Parameters.ParamByName('Suframa').Value := suframa_destinatario;
        Parameters.ParamByName('Inscricao_Municipal').Value :=
          im_destinatario;
        Parameters.ParamByName('EMail').Value := email_destinatario;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        // lrControle := Insere;
        // UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TAgenda_Telefonica }

procedure TAgenda_Telefonica.Alterar;
var
  QExe: TADOQuery;
begin
  QExe := TADOQuery.Create(Nil);
  Try
    with QExe, SQL do
    begin
      close;
      Connection := DM.ADOConnection1;
      clear;
      add('update Agenda_Telefonica set Nome = :Nome, Telefone1 = :Telefone1, ');
      add('Telefone2 = :Telefone2, Telefone3 = :Telefone3 where Codigo = :Codigo');

      Parameters.ParamByName('Codigo').Value :=
        StrToInt(FrmAgenda_Telefonica.EdtCodigo.Text);
      Parameters.ParamByName('Nome').Value := FrmAgenda_Telefonica.EdtNome.Text;
      Parameters.ParamByName('Telefone1').Value :=
        FrmAgenda_Telefonica.MEdtTelefone1.Text;
      Parameters.ParamByName('Telefone2').Value :=
        FrmAgenda_Telefonica.MEdtTelefone2.Text;
      Parameters.ParamByName('Telefone3').Value :=
        FrmAgenda_Telefonica.MEdtTelefone3.Text;
      ExecSQL;
      lrControle := Altera;
      UGeral.Mensagem_Padrao(lrControle);
    end;
  Finally
    FreeAndNil(QExe);
  End;
end;

procedure TAgenda_Telefonica.Excluir;
var
  QExe: TADOQuery;
begin
  QExe := TADOQuery.Create(Nil);
  Try
    with QExe, SQL do
    begin
      close;
      Connection := DM.ADOConnection1;
      clear;
      add('Delete from Agenda_Telefonica where Codigo = :Codigo');

      Parameters.ParamByName('Codigo').Value :=
        StrToInt(FrmAgenda_Telefonica.EdtCodigo.Text);
      ExecSQL;
      lrControle := Exclui;
      UGeral.Mensagem_Padrao(lrControle);
    end;
  Finally
    FreeAndNil(QExe);
  End;
end;

procedure TAgenda_Telefonica.Inserir;
var
  QExe: TADOQuery;
begin
  QExe := TADOQuery.Create(Nil);
  Try
    with QExe, SQL do
    begin
      close;
      Connection := DM.ADOConnection1;
      clear;
      add('Insert into Agenda_Telefonica (Codigo, Nome, Telefone1, Telefone2, Telefone3, Data_Cadastro)');
      add('Values');
      add('(:Codigo, :Nome, :Telefone1, :Telefone2, :Telefone3, :Data_Cadastro)');

      Parameters.ParamByName('Codigo').Value :=
        StrToInt(FrmAgenda_Telefonica.EdtCodigo.Text);
      Parameters.ParamByName('Nome').Value := FrmAgenda_Telefonica.EdtNome.Text;
      Parameters.ParamByName('Telefone1').Value :=
        FrmAgenda_Telefonica.MEdtTelefone1.Text;
      Parameters.ParamByName('Telefone2').Value :=
        FrmAgenda_Telefonica.MEdtTelefone2.Text;
      Parameters.ParamByName('Telefone3').Value :=
        FrmAgenda_Telefonica.MEdtTelefone3.Text;
      Parameters.ParamByName('Data_Cadastro').Value :=
        StrToDateTime(FrmAgenda_Telefonica.MEdtData_Cadastro.Text);
      ExecSQL;
      lrControle := Insere;
      UGeral.Mensagem_Padrao(lrControle);
    end;
  Finally
    FreeAndNil(QExe);
  End;
end;

{ TTelefone_Cliente }

procedure TTelefone_Cliente.Alterar(var Conexao: TADOConnection);
var
  qAux: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := Conexao;
        add('UPDATE Telefone_Cliente');
        add('   SET Telefone = :Telefone');
        add('      ,Tipo = :Tipo');
        add('where Codigo_Cliente = :Codigo_Cliente and ');
        add('Codigo_Telefone = :Codigo_Telefone');

        Parameters.ParamByName('Codigo_Cliente').Value :=
          StrToInt(FrmCadastro_Cliente.EdtCodigo.Text);
        Parameters.ParamByName('Codigo_Telefone').Value :=
          FrmCadastro_Cliente.qrytelefoneCodigo_Telefone.AsInteger;
        Parameters.ParamByName('Telefone').Value :=
          FrmCadastro_Cliente.MEdtTelefone_Adicional.Text;
        Parameters.ParamByName('Tipo').Value :=
          FrmCadastro_Cliente.CmbTipo_Telefone.Text;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Altera;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TTelefone_Cliente.Excluir(var Conexao: TADOConnection);
var
  qAux: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := Conexao;
        add('Delete from Telefone_Cliente where Codigo_Cliente = :Codigo_Cliente and ');
        add('Codigo_Telefone = :Codigo_Telefone');
        Parameters.ParamByName('Codigo_Cliente').Value :=
          StrToInt(FrmCadastro_Cliente.EdtCodigo.Text);
        Parameters.ParamByName('Codigo_Telefone').Value :=
          FrmCadastro_Cliente.qrytelefoneCodigo_Telefone.AsInteger;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Exclui;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TTelefone_Cliente.Excluir_Tudo(var Conexao: TADOConnection);
var
  qAux: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := Conexao;
        add('Delete from Telefone_Cliente where Codigo_Cliente = :Codigo_Cliente');
        Parameters.ParamByName('Codigo_Cliente').Value :=
          StrToInt(FrmCadastro_Cliente.EdtCodigo.Text);
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Exclui;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TTelefone_Cliente.Inserir(var Conexao: TADOConnection);
var
  qAux: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := Conexao;
        add('Insert into Telefone_Cliente (Codigo_Cliente, Codigo_Telefone, Telefone, Tipo) values');
        add('(:Codigo_Cliente, :Codigo_Telefone, :Telefone, :Tipo)');
        Parameters.ParamByName('Codigo_Cliente').Value :=
          StrToInt(FrmCadastro_Cliente.EdtCodigo.Text);
        Parameters.ParamByName('Codigo_Telefone').Value :=
          FrmCadastro_Cliente.codigo_telefone;
        Parameters.ParamByName('Telefone').Value :=
          FrmCadastro_Cliente.MEdtTelefone_Adicional.Text;
        Parameters.ParamByName('Tipo').Value :=
          FrmCadastro_Cliente.CmbTipo_Telefone.Text;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Insere;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TCadastro_Status }

procedure TCadastro_Status.Alterar;
var
  qAux: TADOQuery;
begin
  try
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('UPDATE Cadastro_Status');
        add('   SET Descricao = :Descricao, Encerrado = :Encerrado');
        add('where Codigo = :Codigo');

        Parameters.ParamByName('Codigo').Value :=
          StrToInt(FrmCadastro_Status.EdtCodigo.Text);
        Parameters.ParamByName('Descricao').Value :=
          FrmCadastro_Status.EdtDescricao.Text;

        if (FrmCadastro_Status.CBEncerrado.Checked) then
          Parameters.ParamByName('Encerrado').Value := 0
        else
          Parameters.ParamByName('Encerrado').Value := 1;

        ExecSQL;
        lrControle := Altera;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TCadastro_Status.Excluir;
var
  qAux: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Delete from Cadastro_Status where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value :=
          StrToInt(FrmCadastro_Status.EdtCodigo.Text);
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Exclui;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TCadastro_Status.Inserir;
var
  qAux: TADOQuery;
begin
  try
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Insert into Cadastro_Status (Descricao, Data_Cadastro, Encerrado) values');
        add('(:Descricao, :Data_Cadastro, :Encerrado)');
        Parameters.ParamByName('Descricao').Value :=
          FrmCadastro_Status.EdtDescricao.Text;
        Parameters.ParamByName('Data_Cadastro').Value :=
          StrToDateTime(FrmCadastro_Status.MEdtData_Cadastro.Text);

        if (FrmCadastro_Status.CBEncerrado.Checked) then
          Parameters.ParamByName('Encerrado').Value := 0
        else
          Parameters.ParamByName('Encerrado').Value := 1;

        ExecSQL;
        lrControle := Insere;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TCadastro_Tipo_Ocorrencia }

procedure TCadastro_Tipo_Ocorrencia.Alterar;
var
  qAux: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('UPDATE Tipo_Ocorrencia');
        add('   SET Descricao = :Descricao');
        add('where Codigo = :Codigo');

        Parameters.ParamByName('Codigo').Value :=
          StrToInt(FrmCadastro_Tipo_Ocorrencia.EdtCodigo.Text);
        Parameters.ParamByName('Descricao').Value :=
          FrmCadastro_Tipo_Ocorrencia.EdtDescricao.Text;
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Altera;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TCadastro_Tipo_Ocorrencia.Excluir;
var
  qAux: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Delete from Tipo_Ocorrencia where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value :=
          StrToInt(FrmCadastro_Tipo_Ocorrencia.EdtCodigo.Text);
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Exclui;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TCadastro_Tipo_Ocorrencia.Inserir;
var
  qAux: TADOQuery;
begin
  try
    // DM.ADOConnection1.BeginTrans;
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Insert into Tipo_Ocorrencia (Descricao, Data_Cadastro) values');
        add('(:Descricao, :Data_Cadastro)');
        Parameters.ParamByName('Descricao').Value :=
          FrmCadastro_Tipo_Ocorrencia.EdtDescricao.Text;
        Parameters.ParamByName('Data_Cadastro').Value :=
          StrToDateTime(FrmCadastro_Tipo_Ocorrencia.MEdtData_Cadastro.Text);
        ExecSQL;
        // DM.ADOConnection1.CommitTrans;
        lrControle := Insere;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // DM.ADOConnection1.RollbackTrans;
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TRegistro_Ocorrencia }

procedure TRegistro_Ocorrencia.Alterar;
var
  qAux: TADOQuery;
begin
  try
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('UPDATE Ocorrencia');
        add('   SET Codigo_Funcionario = :Codigo_Funcionario,');
        add('       Codigo_Tipo_Ocorrencia = :Codigo_Tipo_Ocorrencia,');
        add('       Observacao = :Observacao,');
        add('       Data_Ocorrencia = :Data_Ocorrencia,');
        add('       Data_Cadastro = :Data_Cadastro');
        add('where Codigo = :Codigo');

        Parameters.ParamByName('Codigo').Value :=
          StrToInt(FrmOcorrencia.EdtCodigo.Text);
        Parameters.ParamByName('Codigo_Funcionario').Value :=
          StrToInt(FrmOcorrencia.EdtCodigo_Funcionario.Text);
        Parameters.ParamByName('Codigo_Tipo_Ocorrencia').Value :=
          StrToInt(FrmOcorrencia.EdtCodigo_Tipo_Ocorrencia.Text);
        Parameters.ParamByName('Observacao').Value :=
          FrmOcorrencia.MmoObservacoes.Text;
        Parameters.ParamByName('Data_Ocorrencia').Value :=
          StrToDateTime(FrmOcorrencia.MEdtData_Ocorrencia.Text);
        Parameters.ParamByName('Data_Cadastro').Value :=
          StrToDateTime(FrmOcorrencia.MEdtData_Cadastro.Text);
        ExecSQL;
        lrControle := Altera;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TRegistro_Ocorrencia.Excluir;
var
  qAux: TADOQuery;
begin
  try
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Delete from Ocorrencia where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value :=
          StrToInt(FrmOcorrencia.EdtCodigo.Text);
        ExecSQL;
        lrControle := Exclui;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TRegistro_Ocorrencia.Inserir;
var
  qAux: TADOQuery;
begin
  try
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Insert into Ocorrencia (Codigo_Funcionario, Codigo_Tipo_Ocorrencia, Observacao, Data_Ocorrencia, Data_Cadastro) values');
        add('(:Codigo_Funcionario, :Codigo_Tipo_Ocorrencia, :Observacao, :Data_Ocorrencia, :Data_Cadastro)');
        Parameters.ParamByName('Codigo_Funcionario').Value :=
          StrToInt(FrmOcorrencia.EdtCodigo_Funcionario.Text);
        Parameters.ParamByName('Codigo_Tipo_Ocorrencia').Value :=
          StrToInt(FrmOcorrencia.EdtCodigo_Tipo_Ocorrencia.Text);
        Parameters.ParamByName('Observacao').Value :=
          FrmOcorrencia.MmoObservacoes.Text;
        Parameters.ParamByName('Data_Ocorrencia').Value :=
          StrToDateTime(FrmOcorrencia.MEdtData_Ocorrencia.Text);
        Parameters.ParamByName('Data_Cadastro').Value :=
          StrToDateTime(FrmOcorrencia.MEdtData_Cadastro.Text);
        ExecSQL;
        lrControle := Insere;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TFuncionario_Outros }

procedure TFuncionario_Outros.Excluir(var Conexao: TADOConnection);
var
  qAux: TADOQuery;
begin
  // try
  try
    qAux := TADOQuery.Create(nil);
    with qAux, SQL do
    begin
      close;
      clear;
      Connection := Conexao;
      add('Delete from Funcionario_Outros where Codigo = :Codigo');
      Parameters.ParamByName('Codigo').Value :=
        StrToInt(FrmCadastro_Funcionarios.EdtCodigo.Text);
      ExecSQL;
    end;
  finally
    qAux.close;
    FreeAndNil(qAux);
  end;

  { except
    on E: Exception do
    begin
    Operacao_Nao_Completada(E.Message);
    end;
    end; }
end;

{ TFuncionario_Alteracao_Salarial }

procedure TFuncionario_Alteracao_Salarial.Excluir(var Conexao: TADOConnection);
var
  qAux: TADOQuery;
begin
  // try
  try
    qAux := TADOQuery.Create(nil);
    with qAux, SQL do
    begin
      close;
      clear;
      Connection := Conexao;
      add('Delete from Funcionario_Alteracao_Salarial where Codigo = :Codigo');
      Parameters.ParamByName('Codigo').Value :=
        StrToInt(FrmCadastro_Funcionarios.EdtCodigo.Text);
      ExecSQL;
    end;
  finally
    qAux.close;
    FreeAndNil(qAux);
  end;

  { except
    on E: Exception do
    begin
    Operacao_Nao_Completada(E.Message);
    end;
    end; }
end;

{ TFuncionario_Alteracao_Cargo }

procedure TFuncionario_Alteracao_Cargo.Excluir(var Conexao: TADOConnection);
var
  qAux: TADOQuery;
begin
  // try
  try
    qAux := TADOQuery.Create(nil);
    with qAux, SQL do
    begin
      close;
      clear;
      Connection := Conexao;
      add('Delete from Funcionario_Alteracao_Cargo where Codigo = :Codigo');
      Parameters.ParamByName('Codigo').Value :=
        StrToInt(FrmCadastro_Funcionarios.EdtCodigo.Text);
      ExecSQL;
    end;
  finally
    qAux.close;
    FreeAndNil(qAux);
  end;

  { except
    on E: Exception do
    begin
    Operacao_Nao_Completada(E.Message);
    end;
    end; }
end;

{ TFuncionario_Ferias }

procedure TFuncionario_Ferias.Excluir(var Conexao: TADOConnection);
var
  qAux: TADOQuery;
begin
  // try
  try
    qAux := TADOQuery.Create(nil);
    with qAux, SQL do
    begin
      close;
      clear;
      Connection := Conexao;
      add('Delete from Funcionario_Ferias where Codigo = :Codigo');
      Parameters.ParamByName('Codigo').Value :=
        StrToInt(FrmCadastro_Funcionarios.EdtCodigo.Text);
      ExecSQL;
    end;
  finally
    qAux.close;
    FreeAndNil(qAux);
  end;

  { except
    on E: Exception do
    begin
    Operacao_Nao_Completada(E.Message);
    end;
    end; }
end;

{ TFuncionario_Ocorrencia }

procedure TFuncionario_Ocorrencia.Excluir(var Conexao: TADOConnection);
var
  qAux: TADOQuery;
begin
  // try
  try
    qAux := TADOQuery.Create(nil);
    with qAux, SQL do
    begin
      close;
      clear;
      Connection := Conexao;
      add('Delete from Ocorrencia where Codigo = :Codigo');
      Parameters.ParamByName('Codigo').Value :=
        StrToInt(FrmCadastro_Funcionarios.EdtCodigo.Text);
      ExecSQL;
    end;
  finally
    qAux.close;
    FreeAndNil(qAux);
  end;

  { except
    on E: Exception do
    begin
    Operacao_Nao_Completada(E.Message);
    end;
    end; }
end;

{ TCadastro_Tipo_Bem_Patrimonial }

procedure TCadastro_Tipo_Bem_Patrimonial.Alterar;
var
  qAux: TADOQuery;
begin
  try
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('UPDATE Tipo_Bem_Patrimonial');
        add('   SET Descricao = :Descricao,');
        add('       Data_Cadastro = :Data_Cadastro');
        add('where Codigo = :Codigo');

        Parameters.ParamByName('Codigo').Value :=
          StrToInt(FrmCadastro_Tipo_Bem_Patrimonial.EdtCodigo.Text);
        Parameters.ParamByName('Descricao').Value :=
          FrmCadastro_Tipo_Bem_Patrimonial.EdtDescricao.Text;
        Parameters.ParamByName('Data_Cadastro').Value :=
          StrToDateTime
          (FrmCadastro_Tipo_Bem_Patrimonial.MEdtData_Cadastro.Text);
        ExecSQL;
        lrControle := Altera;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TCadastro_Tipo_Bem_Patrimonial.Excluir;
var
  qAux: TADOQuery;
begin
  try
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Delete from Tipo_Bem_Patrimonial where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value :=
          StrToInt(FrmCadastro_Tipo_Bem_Patrimonial.EdtCodigo.Text);
        ExecSQL;
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TCadastro_Tipo_Bem_Patrimonial.Inserir;
var
  qAux: TADOQuery;
begin
  try
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Insert into Tipo_Bem_Patrimonial (Descricao, Data_Cadastro) values');
        add('(:Descricao, :Data_Cadastro)');
        Parameters.ParamByName('Descricao').Value :=
          FrmCadastro_Tipo_Bem_Patrimonial.EdtDescricao.Text;
        Parameters.ParamByName('Data_Cadastro').Value :=
          StrToDateTime
          (FrmCadastro_Tipo_Bem_Patrimonial.MEdtData_Cadastro.Text);
        ExecSQL;
        lrControle := Insere;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      ShowMessage('Erro: ' + E.Message);
      // Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TPatrimonio }

procedure TPatrimonio.Alterar;
var
  qAux: TADOQuery;
begin
  try
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('UPDATE Patrimonio');
        add('   SET N_Bem = :N_Bem,');
        add('       N_Identificacao = :N_Identificacao,');
        add('       Descricao = :Descricao,');
        add('       Codigo_Marca = :Codigo_Marca,');
        add('       Modelo = :Modelo,');
        add('       Codigo_Tipo_Bem = :Codigo_Tipo_Bem,');
        add('       Codigo_Local_Bem = :Codigo_Local_Bem,');
        add('       Data_Aquisicao = :Data_Aquisicao,');
        add('       Data_Baixa = :Data_Baixa,');
        add('       Valor_Bem = :Valor_Bem,');
        add('       Codigo_Status = :Codigo_Status,');
        add('       Observacao = :Observacao,');
        add('       Data_Cadastro = :Data_Cadastro');
        add('where Codigo = :Codigo');

        Parameters.ParamByName('Codigo').Value :=
          StrToInt(FrmCadastro_Patrimonio.EdtCodigo.Text);
        Parameters.ParamByName('N_Bem').Value :=
          FrmCadastro_Patrimonio.EdtN_Bem.Text;
        Parameters.ParamByName('N_Identificacao').Value :=
          FrmCadastro_Patrimonio.EdtN_Identificacao.Text;
        Parameters.ParamByName('Descricao').Value :=
          FrmCadastro_Patrimonio.EdtDescricao.Text;

        if (FrmCadastro_Patrimonio.EdtCodigo_Marca.Text = '') then
          Parameters.ParamByName('Codigo_Marca').Value := 0
        else
          Parameters.ParamByName('Codigo_Marca').Value :=
            StrToInt(FrmCadastro_Patrimonio.EdtCodigo_Marca.Text);

        Parameters.ParamByName('Modelo').Value :=
          FrmCadastro_Patrimonio.EdtModelo.Text;

        if (FrmCadastro_Patrimonio.EdtCodigo_Tipo_Bem.Text = '') then
          Parameters.ParamByName('Codigo_Tipo_Bem').Value := 0
        else
          Parameters.ParamByName('Codigo_Tipo_Bem').Value :=
            StrToInt(FrmCadastro_Patrimonio.EdtCodigo_Tipo_Bem.Text);

        if (FrmCadastro_Patrimonio.EdtCodigo_Local.Text = '') then
          Parameters.ParamByName('Codigo_Local_Bem').Value := 0
        else
          Parameters.ParamByName('Codigo_Local_Bem').Value :=
            StrToInt(FrmCadastro_Patrimonio.EdtCodigo_Local.Text);

        if (FrmCadastro_Patrimonio.MEdtData_Aquisicao.Text = '  /  /    ') then
          Parameters.ParamByName('Data_Aquisicao').Value := NULL
        else
          Parameters.ParamByName('Data_Aquisicao').Value :=
            StrToDateTime(FrmCadastro_Patrimonio.MEdtData_Aquisicao.Text);

        if (FrmCadastro_Patrimonio.MEdtData_Baixa.Text = '  /  /    ') then
          Parameters.ParamByName('Data_Baixa').Value := NULL
        else
          Parameters.ParamByName('Data_Baixa').Value :=
            StrToDateTime(FrmCadastro_Patrimonio.MEdtData_Baixa.Text);

        Parameters.ParamByName('Valor_Bem').Value :=
          StrToFloat(FrmCadastro_Patrimonio.EdtValor.Text);

        if (FrmCadastro_Patrimonio.EdtCodigo_Status.Text = '') then
          Parameters.ParamByName('Codigo_Status').Value := 0
        else
          Parameters.ParamByName('Codigo_Status').Value :=
            StrToInt(FrmCadastro_Patrimonio.EdtCodigo_Status.Text);

        Parameters.ParamByName('Observacao').Value :=
          FrmCadastro_Patrimonio.MmoObservacoes.Text;
        Parameters.ParamByName('Data_Cadastro').Value :=
          StrToDateTime(FrmCadastro_Patrimonio.MEdtData_Cadastro.Text);
        ExecSQL;
        lrControle := Altera;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TPatrimonio.Excluir;
var
  qAux: TADOQuery;
begin
  try
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Delete from Patrimonio where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value :=
          StrToInt(FrmCadastro_Patrimonio.EdtCodigo.Text);
        ExecSQL;
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TPatrimonio.Inserir;
var
  qAux: TADOQuery;
begin
  try
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := DM.ADOConnection1;
        add('Insert into Patrimonio (N_Bem, N_Identificacao, Descricao, Codigo_Marca, Modelo, ');
        add('Codigo_Tipo_Bem, Codigo_Local_Bem, Data_Aquisicao, Data_Baixa, Valor_Bem, Codigo_Status, Observacao, Data_Cadastro) values');
        add('(:N_Bem, :N_Identificacao, :Descricao, :Codigo_Marca, :Modelo, ');
        add(':Codigo_Tipo_Bem, :Codigo_Local_Bem, :Data_Aquisicao, :Data_Baixa, :Valor_Bem, :Codigo_Status, :Observacao, :Data_Cadastro)');

        Parameters.ParamByName('N_Bem').Value :=
          FrmCadastro_Patrimonio.EdtN_Bem.Text;
        Parameters.ParamByName('N_Identificacao').Value :=
          FrmCadastro_Patrimonio.EdtN_Identificacao.Text;
        Parameters.ParamByName('Descricao').Value :=
          FrmCadastro_Patrimonio.EdtDescricao.Text;

        if (FrmCadastro_Patrimonio.EdtCodigo_Marca.Text = '') then
          Parameters.ParamByName('Codigo_Marca').Value := 0
        else
          Parameters.ParamByName('Codigo_Marca').Value :=
            StrToInt(FrmCadastro_Patrimonio.EdtCodigo_Marca.Text);

        Parameters.ParamByName('Modelo').Value :=
          FrmCadastro_Patrimonio.EdtModelo.Text;

        if (FrmCadastro_Patrimonio.EdtCodigo_Tipo_Bem.Text = '') then
          Parameters.ParamByName('Codigo_Tipo_Bem').Value := 0
        else
          Parameters.ParamByName('Codigo_Tipo_Bem').Value :=
            StrToInt(FrmCadastro_Patrimonio.EdtCodigo_Tipo_Bem.Text);

        if (FrmCadastro_Patrimonio.EdtCodigo_Local.Text = '') then
          Parameters.ParamByName('Codigo_Local_Bem').Value := 0
        else
          Parameters.ParamByName('Codigo_Local_Bem').Value :=
            StrToInt(FrmCadastro_Patrimonio.EdtCodigo_Local.Text);

        if (FrmCadastro_Patrimonio.MEdtData_Aquisicao.Text = '  /  /    ') then
          Parameters.ParamByName('Data_Aquisicao').Value := NULL
        else
          Parameters.ParamByName('Data_Aquisicao').Value :=
            StrToDateTime(FrmCadastro_Patrimonio.MEdtData_Aquisicao.Text);

        if (FrmCadastro_Patrimonio.MEdtData_Baixa.Text = '  /  /    ') then
          Parameters.ParamByName('Data_Baixa').Value := NULL
        else
          Parameters.ParamByName('Data_Baixa').Value :=
            StrToDateTime(FrmCadastro_Patrimonio.MEdtData_Baixa.Text);

        Parameters.ParamByName('Valor_Bem').Value :=
          StrToFloat(FrmCadastro_Patrimonio.EdtValor.Text);

        if (FrmCadastro_Patrimonio.EdtCodigo_Status.Text = '') then
          Parameters.ParamByName('Codigo_Status').Value := 0
        else
          Parameters.ParamByName('Codigo_Status').Value :=
            StrToInt(FrmCadastro_Patrimonio.EdtCodigo_Status.Text);

        Parameters.ParamByName('Observacao').Value :=
          FrmCadastro_Patrimonio.MmoObservacoes.Text;
        Parameters.ParamByName('Data_Cadastro').Value :=
          StrToDateTime(FrmCadastro_Patrimonio.MEdtData_Cadastro.Text);
        ExecSQL;
        lrControle := Insere;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      ShowMessage('Erro: ' + E.Message);
      // Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TCliente_Outros }

procedure TCliente_Outros.Alterar(var Conexao: TADOConnection);
var
  qAux: TADOQuery;
begin
  // try
  try
    qAux := TADOQuery.Create(nil);
    with qAux, SQL do
    begin
      close;
      clear;
      Connection := Conexao;
      add('UPDATE Cliente_Outros');
      add('   SET Nome_Pai = :Nome_Pai,');
      add('       Nome_Mae = :Nome_Mae,');
      add('       Nacionalidade = :Nacionalidade,');
      add('       Naturalidade = :Naturalidade,');
      add('       Conjuge = :Conjuge,');
      add('       Grau_Instrucao = :Grau_Instrucao');
      add('where Codigo = :Codigo');

      Parameters.ParamByName('Codigo').Value :=
        FrmCadastro_Cliente.EdtCodigo.Text;
      Parameters.ParamByName('Nome_Pai').Value :=
        FrmCadastro_Cliente.EdtPai.Text;
      Parameters.ParamByName('Nome_Mae').Value :=
        FrmCadastro_Cliente.EdtMae.Text;
      Parameters.ParamByName('Nacionalidade').Value :=
        FrmCadastro_Cliente.EdtNacionalidade.Text;
      Parameters.ParamByName('Naturalidade').Value :=
        FrmCadastro_Cliente.EdtNaturalidade.Text;
      Parameters.ParamByName('Conjuge').Value :=
        FrmCadastro_Cliente.EdtConjuge.Text;
      Parameters.ParamByName('Grau_Instrucao').Value :=
        FrmCadastro_Cliente.EdtGrau_Instrucao.Text;
      ExecSQL;
      // lrControle := Insere;
      // UGeral.Mensagem_Padrao(lrControle);
    end;
  finally
    qAux.close;
    FreeAndNil(qAux);
  end;

  { except
    on E: Exception do
    begin
    ShowMessage('Erro: '+E.Message);
    //Operacao_Nao_Completada(E.Message);
    end;
    end; }
end;

procedure TCliente_Outros.Excluir(var Conexao: TADOConnection);
var
  qAux: TADOQuery;
begin
  // try
  try
    qAux := TADOQuery.Create(nil);
    with qAux, SQL do
    begin
      close;
      clear;
      Connection := Conexao;
      add('Delete from Cliente_Outros where Codigo = :Codigo');
      Parameters.ParamByName('Codigo').Value :=
        StrToInt(FrmCadastro_Cliente.EdtCodigo.Text);
      ExecSQL;
    end;
  finally
    qAux.close;
    FreeAndNil(qAux);
  end;

  { except
    on E: Exception do
    begin
    Operacao_Nao_Completada(E.Message);
    end;
    end; }
end;

procedure TCliente_Outros.Inserir(var Conexao: TADOConnection);
var
  qAux: TADOQuery;
begin
  // try
  try
    qAux := TADOQuery.Create(nil);
    with qAux, SQL do
    begin
      close;
      clear;
      Connection := Conexao;
      add('Insert into Cliente_Outros (Codigo, Nome_Pai, Nome_Mae, Nacionalidade, Naturalidade, Conjuge, Grau_Instrucao)');
      add('values');
      add('(:Codigo, :Nome_Pai, :Nome_Mae, :Nacionalidade, :Naturalidade, :Conjuge, :Grau_Instrucao)');

      Parameters.ParamByName('Codigo').Value :=
        FrmCadastro_Cliente.EdtCodigo.Text;
      Parameters.ParamByName('Nome_Pai').Value :=
        FrmCadastro_Cliente.EdtPai.Text;
      Parameters.ParamByName('Nome_Mae').Value :=
        FrmCadastro_Cliente.EdtMae.Text;
      Parameters.ParamByName('Nacionalidade').Value :=
        FrmCadastro_Cliente.EdtNacionalidade.Text;
      Parameters.ParamByName('Naturalidade').Value :=
        FrmCadastro_Cliente.EdtNaturalidade.Text;
      Parameters.ParamByName('Conjuge').Value :=
        FrmCadastro_Cliente.EdtConjuge.Text;
      Parameters.ParamByName('Grau_Instrucao').Value :=
        FrmCadastro_Cliente.EdtGrau_Instrucao.Text;
      ExecSQL;
      // lrControle := Insere;
      // UGeral.Mensagem_Padrao(lrControle);
    end;
  finally
    qAux.close;
    FreeAndNil(qAux);
  end;

  { except
    on E: Exception do
    begin
    ShowMessage('Erro: '+E.Message);
    //Operacao_Nao_Completada(E.Message);
    end;
    end; }
end;

{ TCliente_Autorizados }

procedure TCliente_Autorizados.Excluir(var Conexao: TADOConnection);
var
  qAux: TADOQuery;
begin
  try
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := Conexao;
        add('Delete from Cliente_Autorizados where Codigo = :Codigo');
        Parameters.ParamByName('Codigo').Value :=
          FrmCadastro_Cliente.qryautorizadosCodigo.AsInteger;
        ExecSQL;
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TCliente_Autorizados.Excluir_Tudo(var Conexao: TADOConnection);
var
  qAux: TADOQuery;
begin
  try
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := Conexao;
        add('Delete from Cliente_Autorizados where Codigo_Cliente = :Codigo');
        Parameters.ParamByName('Codigo').Value :=
          StrToInt(FrmCadastro_Cliente.EdtCodigo.Text);
        ExecSQL;
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TCliente_Autorizados.Inserir(var Conexao: TADOConnection);
var
  qAux: TADOQuery;
begin
  try
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := Conexao;
        add('Insert into Cliente_Autorizados (Codigo_Cliente, Nome_Autorizado, CPF_Autorizado)');
        add('values');
        add('(:Codigo_Cliente, :Nome_Autorizado, :CPF_Autorizado)');

        Parameters.ParamByName('Codigo_Cliente').Value :=
          FrmCadastro_Cliente.EdtCodigo.Text;
        Parameters.ParamByName('Nome_Autorizado').Value :=
          FrmCadastro_Cliente.EdtNome_Autorizado.Text;
        Parameters.ParamByName('CPF_Autorizado').Value :=
          FrmCadastro_Cliente.EdtCPF_Autorizado.Text;
        ExecSQL;
        lrControle := Insere;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // ShowMessage('Erro: '+E.Message);
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

{ TLancamento_Financeiro_Ocorrencia_Cobranca }

procedure TLancamento_Financeiro_Ocorrencia_Cobranca.Alterar;
var
  qAux: TADOQuery;
begin
  try
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := dm.ADOConnection1;
        add('update Lancamento_Financeiro_Ocorrencia_Cobranca set ');
        add('Data_Cobranca = :Data_Cobranca, ');
        add('Responsavel_Atendimento = :Responsavel_Atendimento, ');
        add('Origem_Atendimento = :Origem_Atendimento,');
        add('Codigo_Lancamento_Financeiro = :Codigo_Lancamento_Financeiro, ');
        Add('N_Documento = :N_Documento, ');
        add('Observacoes = :Observacoes');
        add('where Codigo = :Codigo');

        Parameters.ParamByName('Data_Cobranca').Value := StrToDateTime(FrmCadastro_Ocorrencia_Cobranca.MEdtData_Cobranca.Text);
        Parameters.ParamByName('Responsavel_Atendimento').Value :=  FrmCadastro_Ocorrencia_Cobranca.EdtResponsavel.text;
        Parameters.ParamByName('Origem_Atendimento').Value :=  FrmCadastro_Ocorrencia_Cobranca.RGOrigem.ItemIndex;
        Parameters.ParamByName('Codigo_Lancamento_Financeiro').Value :=  FrmCadastro_Ocorrencia_Cobranca.EdtCodigo_Lancamento.text;
        Parameters.ParamByName('N_Documento').Value :=  FrmCadastro_Ocorrencia_Cobranca.EdtN_Documento.text;
        Parameters.ParamByName('Observacoes').Value :=  FrmCadastro_Ocorrencia_Cobranca.MmoObservacoes.text;
        Parameters.ParamByName('Codigo').Value := StrToInt(FrmCadastro_Ocorrencia_Cobranca.EdtCodigo.Text);
        ExecSQL;
        lrControle := Insere;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // ShowMessage('Erro: '+E.Message);
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TLancamento_Financeiro_Ocorrencia_Cobranca.Excluir;
var
  qAux: TADOQuery;
begin
  try
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := dm.ADOConnection1;
        add('delete from Lancamento_Financeiro_Ocorrencia_Cobranca ');
        add('where Codigo = :Codigo');

        Parameters.ParamByName('Codigo').Value := StrToInt(FrmCadastro_Ocorrencia_Cobranca.EdtCodigo.Text);
        ExecSQL;
        lrControle := Insere;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // ShowMessage('Erro: '+E.Message);
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

procedure TLancamento_Financeiro_Ocorrencia_Cobranca.Inserir;
var
  qAux: TADOQuery;
begin
  try
    try
      qAux := TADOQuery.Create(nil);
      with qAux, SQL do
      begin
        close;
        clear;
        Connection := dm.ADOConnection1;
        add('Insert into Lancamento_Financeiro_Ocorrencia_Cobranca (Data_Cadastro, Data_Cobranca, Responsavel_Atendimento, Origem_Atendimento, Codigo_Lancamento_Financeiro, N_Documento, Observacoes)');
        add('values');
        add('(:Data_Cadastro, :Data_Cobranca, :Responsavel_Atendimento, :Origem_Atendimento, :Codigo_Lancamento_Financeiro, :N_Documento, :Observacoes)');

        Parameters.ParamByName('Data_Cadastro').Value := StrToDateTime(FrmCadastro_Ocorrencia_Cobranca.MEdtData_Cadastro.Text);
        Parameters.ParamByName('Data_Cobranca').Value := StrToDateTime(FrmCadastro_Ocorrencia_Cobranca.MEdtData_Cobranca.Text);
        Parameters.ParamByName('Responsavel_Atendimento').Value :=  FrmCadastro_Ocorrencia_Cobranca.EdtResponsavel.text;
        Parameters.ParamByName('Origem_Atendimento').Value :=  FrmCadastro_Ocorrencia_Cobranca.RGOrigem.ItemIndex;
        Parameters.ParamByName('Codigo_Lancamento_Financeiro').Value :=  FrmCadastro_Ocorrencia_Cobranca.EdtCodigo_Lancamento.text;
        Parameters.ParamByName('N_Documento').Value :=  FrmCadastro_Ocorrencia_Cobranca.EdtN_Documento.text;
        Parameters.ParamByName('Observacoes').Value :=  FrmCadastro_Ocorrencia_Cobranca.MmoObservacoes.text;
        ExecSQL;
        lrControle := Insere;
        UGeral.Mensagem_Padrao(lrControle);
      end;
    finally
      qAux.close;
      FreeAndNil(qAux);
    end;

  except
    on E: Exception do
    begin
      // ShowMessage('Erro: '+E.Message);
      Operacao_Nao_Completada(E.Message);
    end;
  end;
end;

end.
